(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-vendors"],{"00ee":function(e,t,n){var r=n("b622"),i=r("toStringTag"),o={};o[i]="z",e.exports="[object z]"===String(o)},"0366":function(e,t,n){var r=n("1c0b");e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},"0538":function(e,t,n){"use strict";var r=n("1c0b"),i=n("861d"),o=[].slice,s={},a=function(e,t,n){if(!(t in s)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";s[t]=Function("C,a","return new C("+r.join(",")+")")}return s[t](e,n)};e.exports=Function.bind||function(e){var t=r(this),n=o.call(arguments,1),s=function(){var r=n.concat(o.call(arguments));return this instanceof s?a(t,r.length,r):t.apply(e,r)};return i(t.prototype)&&(s.prototype=t.prototype),s}},"057f":function(e,t,n){var r=n("fc6a"),i=n("241c").f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],a=function(e){try{return i(e)}catch(t){return s.slice()}};e.exports.f=function(e){return s&&"[object Window]"==o.call(e)?a(e):i(r(e))}},"063a":function(e,t,n){"use strict";n.r(t),n.d(t,"CHATROOM_ENTRY_TYPE",(function(){return Ee})),n.d(t,"CHATROOM_ORDER",(function(){return m})),n.d(t,"CONNECTION_STATUS",(function(){return f})),n.d(t,"CONNECT_TYPE",(function(){return p})),n.d(t,"CONVERSATION_TYPE",(function(){return ve})),n.d(t,"ERROR_CODE",(function(){return d})),n.d(t,"FILE_TYPE",(function(){return _e})),n.d(t,"IMClient",(function(){return fe})),n.d(t,"MENTIONED_TYPE",(function(){return _})),n.d(t,"MESSAGE_DIRECTION",(function(){return me})),n.d(t,"MESSAGE_TYPE",(function(){return y})),n.d(t,"MESSAGS_TIME_ORDER",(function(){return g})),n.d(t,"NOTIFICATION_STATUS",(function(){return ye})),n.d(t,"RECALL_MESSAGE_TYPE",(function(){return v})),n.d(t,"RECEIVED_STATUS",(function(){return E})),n.d(t,"SDK_VERSION",(function(){return T})),n.d(t,"getInstance",(function(){return ge})),n.d(t,"init",(function(){return pe}));var r=n("78b2");n.d(t,"ChatroomEntryType",(function(){return r["ChatroomEntryType"]})),n.d(t,"ConnectionStatus",(function(){return r["ConnectionStatus"]})),n.d(t,"ConversationType",(function(){return r["ConversationType"]})),n.d(t,"FileType",(function(){return r["FileType"]})),n.d(t,"LogLevel",(function(){return r["LogLevel"]})),n.d(t,"MessageDirection",(function(){return r["MessageDirection"]})),n.d(t,"NotificationStatus",(function(){return r["NotificationStatus"]})),n.d(t,"UploadMethod",(function(){return r["UploadMethod"]}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function o(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function a(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}var c=new r["Logger"]("RCIM"),u={TIMEOUT:{code:-1,msg:"Network timeout"},SDK_INTERNAL_ERROR:{code:-2,msg:"SDK internal error"},PARAMETER_ERROR:{code:-3,msg:"Please check the parameters, the {param} expected a value of {expect} but received {current}"},REJECTED_BY_BLACKLIST:{code:405,msg:"Blacklisted by the other party"},SEND_TOO_FAST:{code:20604,msg:"Sending messages too quickly"},NOT_IN_GROUP:{code:22406,msg:"Not in group"},FORBIDDEN_IN_GROUP:{code:22408,msg:"Forbbiden from speaking in the group"},NOT_IN_CHATROOM:{code:23406,msg:"Not in chatRoom"},FORBIDDEN_IN_CHATROOM:{code:23408,msg:"Forbbiden from speaking in the chatRoom"},KICKED_FROM_CHATROOM:{code:23409,msg:"Kicked out and forbbiden from joining the chatRoom"},CHATROOM_NOT_EXIST:{code:23410,msg:"ChatRoom does not exist"},CHATROOM_IS_FULL:{code:23411,msg:"ChatRoom members exceeded"},PARAMETER_INVALID_CHATROOM:{code:23412,msg:"Invalid chatRoom parameters"},ROAMING_SERVICE_UNAVAILABLE_CHATROOM:{code:23414,msg:"ChatRoom message roaming service is not open, Please go to the developer to open this service"},RECALLMESSAGE_PARAMETER_INVALID:{code:25101,msg:"Invalid recall message parameter"},ROAMING_SERVICE_UNAVAILABLE_MESSAGE:{code:25102,msg:"Single group chat roaming service is not open, Please go to the developer to open this service"},PUSHSETTING_PARAMETER_INVALID:{code:26001,msg:"Invalid push parameter"},OPERATION_BLOCKED:{code:20605,msg:"Operation is blocked"},OPERATION_NOT_SUPPORT:{code:20606,msg:"Operation is not supported"},MSG_BLOCKED_SENSITIVE_WORD:{code:21501,msg:"The sent message contains sensitive words"},REPLACED_SENSITIVE_WORD:{code:21502,msg:"Sensitive words in the message have been replaced"},NOT_CONNECTED:{code:30001,msg:"Please connect successfully first"},NAVI_REQUEST_ERROR:{code:30007,msg:"Navigation http request failed"},CMP_REQUEST_ERROR:{code:30010,msg:"CMP sniff http request failed"},CONN_APPKEY_FAKE:{code:31002,msg:"Your appkey is fake"},CONN_MINI_SERVICE_NOT_OPEN:{code:31003,msg:"Mini program service is not open, Please go to the developer to open this service"},CONN_ACK_TIMEOUT:{code:31e3,msg:"Connection ACK timeout"},CONN_TOKEN_INCORRECT:{code:31004,msg:"Your token is not valid or expired"},CONN_NOT_AUTHRORIZED:{code:31005,msg:"AppKey and Token do not match"},CONN_REDIRECTED:{code:31006,msg:"Connection redirection"},CONN_APP_BLOCKED_OR_DELETED:{code:31008,msg:"AppKey is banned or deleted"},CONN_USER_BLOCKED:{code:31009,msg:"User blocked"},CONN_DOMAIN_INCORRECT:{code:31012,msg:"Connect domain error, Please check the set security domain"},ROAMING_SERVICE_UNAVAILABLE:{code:33007,msg:"Roaming service cloud is not open, Please go to the developer to open this service"},RC_CONNECTION_EXIST:{code:34001,msg:"Connection already exists"},CHATROOM_KV_EXCEED:{code:23423,msg:"ChatRoom KV setting exceeds maximum"},CHATROOM_KV_OVERWRITE_INVALID:{code:23424,msg:"ChatRoom KV already exists"},CHATROOM_KV_STORE_NOT_OPEN:{code:23426,msg:"ChatRoom KV storage service is not open, Please go to the developer to open this service"},CHATROOM_KEY_NOT_EXIST:{code:23427,msg:"ChatRoom key does not exist"},MSG_KV_NOT_SUPPORT:{code:34008,msg:"The message cannot be extended"},SEND_MESSAGE_KV_FAIL:{code:34009,msg:"Sending RC expansion message fail"},EXPANSION_LIMIT_EXCEET:{code:34010,msg:"The message expansion size is beyond the limit"},ILLGAL_PARAMS:{code:33003,msg:"Incorrect parameters passed in while calling the interface"}},d={};for(var l in u){var h=u[l].code;d[h]=l}var f={CONNECTED:0,CONNECTING:1,DISCONNECTED:2,NETWORK_UNAVAILABLE:3,SOCKET_ERROR:4,KICKED_OFFLINE_BY_OTHER_CLIENT:6,BLOCKED:12},p={COMET:"comet",WEBSOCKET:"websocket"},g={DESC:0,ASC:1},m={ASC:1,DESC:2},v="RC:RcCmd",_={ALL:1,SINGAL:2},y={TEXT:"RC:TxtMsg",VOICE:"RC:VcMsg",HQ_VOICE:"RC:HQVCMsg",IMAGE:"RC:ImgMsg",GIF:"RC:GIFMsg",RICH_CONTENT:"RC:ImgTextMsg",LOCATION:"RC:LBSMsg",FILE:"RC:FileMsg",SIGHT:"RC:SightMsg",COMBINE:"RC:CombineMsg",CHRM_KV_NOTIFY:"RC:chrmKVNotiMsg",LOG_COMMAND:"RC:LogCmdMsg",EXPANSION_NOTIFY:"RC:MsgExMsg",REFERENCE:"RC:ReferenceMsg"},E={READ:1,LISTENED:2,DOWNLOADED:4,RETRIEVED:8,UNREAD:0},T="4.4.1";function C(e){var t=e.conversationType,n=e.messageType,i=e.content,o=e.senderUserId,s=e.targetId,a=e.sentTime,c=e.receivedTime,u=e.messageUId,d=e.messageDirection,l=e.isPersited,h=e.isCounted,f=e.isOffLineMessage,p=e.canIncludeExpansion,g=e.expansion,m=e.receivedStatus,v=e.disableNotification,_=e.isMentioned,y=e.isStatusMessage,E=e.readReceiptInfo;return m||(m=r["ReceivedStatus"].UNREAD),{messageType:n,content:i,senderUserId:o,targetId:s,type:t,sentTime:a,receivedTime:c,messageUId:u,messageDirection:d,isPersited:l,isCounted:h,isOffLineMessage:f,isMentioned:_,disableNotification:v,isStatusMessage:y,canIncludeExpansion:p,expansion:g,receivedStatus:m,readReceiptInfo:E}}function R(e){Object(r["assert"])("options.messageType",e.messageType,r["AssertRules"].STRING,!0),Object(r["assert"])("options.content",e.content,(function(e){return Object(r["isObject"])(e)}),!0),Object(r["assert"])("options.isPersited",e.isPersited,r["AssertRules"].BOOLEAN),Object(r["assert"])("options.isCounted",e.isCounted,r["AssertRules"].BOOLEAN),Object(r["assert"])("options.pushContent",e.pushContent,r["AssertRules"].STRING),Object(r["assert"])("options.pushData",e.pushData,r["AssertRules"].STRING),Object(r["assert"])("options.isVoipPush",e.isVoipPush,r["AssertRules"].BOOLEAN),Object(r["assert"])("options.isStatusMessage",e.isStatusMessage,r["AssertRules"].BOOLEAN),Object(r["assert"])("options.isMentioned",e.isMentioned,r["AssertRules"].BOOLEAN),Object(r["assert"])("options.mentionedType",e.mentionedType,r["AssertRules"].NUMBER),Object(r["assert"])("options.mentionedUserIdList",e.mentionedUserIdList,(function(e){return Object(r["isArray"])(e)&&(0===e.length||e.every(r["isString"]))})),Object(r["assert"])("options.directionalUserIdList",e.directionalUserIdList,(function(e){return Object(r["isArray"])(e)&&(0===e.length||e.every(r["isString"]))})),Object(r["isUndefined"])(e.isPersited)&&Object(r["isUndefined"])(e.isCounted)&&Object(r["isUndefined"])(e.isStatusMessage)||c.warn("The parameters `isPersited`, `isCounted`, `isStatusMessage` will be deprecated in future releases due to inconsistance of the values on mobile side and web side. Please use `registerMessageType` instead for non-integrated message type.")}var S,b=function(e,t){if(!e)return[];var n=I(e),r=w(n.topConversationList,t),i=w(n.unToppedConversationList,t);return r.push.apply(r,i),r},I=function(e){var t=[],n=[];return Object(r["forEach"])(e,(function(e){var r=e.hasMentioned,i=e.mentionedInfo;e.hasMentioned=r,e.mentionedInfo=i,e.isTop?t.push(e):n.push(e)})),{topConversationList:t||[],unToppedConversationList:n||[]}},O=function(e){return e.type+"_"+e.targetId},w=function(e,t){return void 0===t&&(t=0),A(e,(function(e,n){n=n||{};var r=(e=e||{}).latestMessage||{},i=n.latestMessage||{},o=r.sentTime||0,s=i.sentTime||0;return t?s>=o:s<=o}))},N=function(e){var t=(e=e||{}).targetId,n=e.type,i=r["ConversationType"].PRIVATE,o={messageType:r["MessageType"].TextMessage,sentTime:r["DelayTimer"].getTime(),content:{content:""},senderUserId:t,targetId:t,type:n};return e.type=n||i,e.targetId=t||"",e.latestMessage=e.latestMessage||o,e},A=function(e,t){var n=function(e,t,r,i){if(i=i||function(e,t){return e<=t},t<r){for(var o=e[r],s=t-1,a=void 0,c=t;c<=r;c++)i(e[c],o)&&(a=e[++s],e[s]=e[c],e[c]=a);n(e,t,s-1,i),n(e,s+1,r,i)}return e};return n(e,0,e.length-1,t)},M=function(e){return!e.type||!e.targetId||!Object(r["isObject"])(e.latestMessage)||Object(r["isUndefined"])(e.unreadMessageCount)},P=function(e,t,n){var i=(n=n||{}).isAllowNull;for(var o in e=e||{},t=t||{}){var s=t[o];Object(r["isUndefined"])(s)&&!i||(e[o]=s)}return e},k=function(){function e(e,t){this._context=e,this.targetId=t.targetId,this.type=t.type}return e.prototype.destory=function(){return o(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return[4,this._context.removeConversation(this.type,this.targetId)];case 1:return e=n.sent(),t="type:"+this.type+",targetId:"+this.targetId,c.debug("destroy conversation ->"+t),e!==r["ErrorCode"].SUCCESS?(c.warn("destroy conversation fail ->"+e+":"+d[e]+","+t),[2,Promise.reject({code:e,msg:d[e]})]):[2]}}))}))},e.prototype.read=function(){return o(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return[4,this._context.clearUnreadCount(this.type,this.targetId)];case 1:return e=n.sent(),t="type:"+this.type+",targetId:"+this.targetId,c.debug("clear unreadMsgNum ->"+t),e!==r["ErrorCode"].SUCCESS?(c.warn("clear unreadMsgNum fail ->"+e+":"+d[e]+","+t),[2,Promise.reject({code:e,msg:d[e]})]):[2]}}))}))},e.prototype.getUnreadCount=function(){return o(this,void 0,void 0,(function(){var e,t,n,i;return s(this,(function(o){switch(o.label){case 0:return[4,this._context.getUnreadCount(this.type,this.targetId)];case 1:return e=o.sent(),t=e.code,n=e.data,i="type:"+this.type+",targetId:"+this.targetId,c.debug("get unreadCount ->"+i),t===r["ErrorCode"].SUCCESS?[2,n]:(c.warn("get unreadCount fail ->"+t+":"+d[t]+","+i),[2,Promise.reject({code:t,msg:d[t]})])}}))}))},e.prototype.send=function(e){return o(this,void 0,void 0,(function(){var t,n,i,o;return s(this,(function(s){switch(s.label){case 0:return R(e),Object.prototype.hasOwnProperty.call(e,"isPersited")||(e.isPersited=!0),Object.prototype.hasOwnProperty.call(e,"isCounted")||(e.isCounted=!0),t="type:"+this.type+",targetId:"+this.targetId,c.debug("send message  ->"+t),[4,this._context.sendMessage(this.type,this.targetId,e)];case 1:return n=s.sent(),i=n.code,o=n.data,i===r["ErrorCode"].SUCCESS?[2,C(o)]:(c.warn("send message fail ->"+i+":"+d[i]+","+t),[2,Promise.reject({code:i,msg:d[i],data:C({isMentioned:!!e.isMentioned,content:e.content,messageType:e.messageType,isPersited:e.isPersited||!1,isCounted:e.isCounted||!1,disableNotification:!!(null==e?void 0:e.disableNotification),canIncludeExpansion:!!(null==e?void 0:e.canIncludeExpansion),expansion:(null==e?void 0:e.expansion)||null,conversationType:this.type,targetId:this.targetId,senderUserId:this._context.getCurrentUserId(),messageUId:"",messageDirection:r["MessageDirection"].SEND,isOffLineMessage:!1,sentTime:(null==o?void 0:o.sentTime)||0,receivedTime:0,isStatusMessage:e.isStatusMessage||!1,receivedStatus:r["ReceivedStatus"].UNREAD})})])}}))}))},e.prototype.setStatus=function(e){return o(this,void 0,void 0,(function(){var t,n;return s(this,(function(i){switch(i.label){case 0:return Object(r["assert"])("options.notificationStatus",e.notificationStatus,(function(e){return 1===e||2===e})),Object(r["assert"])("options.isTop",e.isTop,r["AssertRules"].BOOLEAN),t="type:"+this.type+",targetId:"+this.targetId,c.debug("set conversation status ->"+t),[4,this._context.setConversationStatus(this.type,this.targetId,e.isTop,e.notificationStatus)];case 1:return(n=i.sent())!==r["ErrorCode"].SUCCESS?(c.warn("set conversation status fail ->"+n+":"+d[n]+","+t),[2,Promise.reject({code:n,msg:d[n]})]):[2]}}))}))},e.prototype.getMessages=function(e){return o(this,void 0,void 0,(function(){var t,n,i,o,a;return s(this,(function(s){switch(s.label){case 0:return Object(r["assert"])("options.timestamp",e.timestamp,r["AssertRules"].NUMBER),Object(r["assert"])("options.count",e.count,r["AssertRules"].NUMBER),Object(r["assert"])("options.order",e.order,(function(e){return 0===e||1===e})),t="type:"+this.type+",targetId:"+this.targetId,c.debug("get history message ->"+t),[4,this._context.getHistoryMessage(this.type,this.targetId,null==e?void 0:e.timestamp,null==e?void 0:e.count,null==e?void 0:e.order)];case 1:return n=s.sent(),i=n.code,o=n.data,i===r["ErrorCode"].SUCCESS&&o?(a=o.list.map((function(e){return C(e)})),[2,Promise.resolve({list:a,hasMore:o.hasMore})]):(c.warn("get history message fail ->"+i+":"+d[i]+","+t),[2,Promise.reject({code:i,msg:d[i]})])}}))}))},e.prototype.recall=function(e){return o(this,void 0,void 0,(function(){var t,n,i,o,a;return s(this,(function(s){switch(s.label){case 0:return Object(r["assert"])("options.messageUId",e.messageUId,r["AssertRules"].STRING,!0),Object(r["assert"])("options.sentTime",e.sentTime,r["AssertRules"].NUMBER,!0),Object(r["assert"])("options.disableNotification",null==e?void 0:e.disableNotification,r["AssertRules"].BOOLEAN),Object(r["assert"])("options.pushConfig",null==e?void 0:e.pushConfig,r["AssertRules"].OBJECT),t={user:e.user,channelId:"",disableNotification:null==e?void 0:e.disableNotification,pushConfig:null==e?void 0:e.pushConfig},n="type:"+this.type+",targetId:"+this.targetId+",messageUId:"+e.messageUId,c.debug("recall message ->"+n),[4,this._context.recallMessage(this.type,this.targetId,e.messageUId,e.sentTime,t)];case 1:return i=s.sent(),o=i.code,a=i.data,o===r["ErrorCode"].SUCCESS&&a?[2,C(a)]:(c.warn("recall message fail ->"+o+":"+d[o]+","+n),[2,Promise.reject({code:o,msg:d[o]})])}}))}))},e.prototype.deleteMessages=function(e){return o(this,void 0,void 0,(function(){var t,n;return s(this,(function(i){switch(i.label){case 0:return Object(r["assert"])("options",e,(function(e){return Object(r["isArray"])(e)&&e.length}),!0),e.forEach((function(e){Object(r["assert"])("options.messageUId",e.messageUId,r["AssertRules"].STRING,!0),Object(r["assert"])("options.sentTime",e.sentTime,r["AssertRules"].NUMBER,!0),Object(r["assert"])("options.messageDirection",e.messageDirection,(function(e){return 1===e||2===e}),!0)})),t="type:"+this.type+",targetId:"+this.targetId,c.debug("delete messages ->"+t),[4,this._context.deleteRemoteMessage(this.type,this.targetId,e)];case 1:return(n=i.sent())!==r["ErrorCode"].SUCCESS?(c.warn("delete message fail ->"+n+":"+d[n]+","+t),[2,Promise.reject({code:n,msg:d[n]})]):[2]}}))}))},e.prototype.clearMessages=function(e){return o(this,void 0,void 0,(function(){var t,n;return s(this,(function(i){switch(i.label){case 0:return Object(r["assert"])("options.timestamp",e.timestamp,r["AssertRules"].NUMBER,!0),t="type:"+this.type+",targetId:"+this.targetId,c.debug("clear message ->"+t),[4,this._context.deleteRemoteMessageByTimestamp(this.type,this.targetId,e.timestamp)];case 1:return(n=i.sent())!==r["ErrorCode"].SUCCESS?(c.warn("clear message ->"+n+":"+d[n]+","+t),[2,Promise.reject({code:n,msg:d[n]})]):[2]}}))}))},e.prototype.updateMessageExpansion=function(e,t){return o(this,void 0,void 0,(function(){var n,i,o,a,u,l,h;return s(this,(function(s){switch(s.label){case 0:return Object(r["assert"])("expansion",e,r["AssertRules"].OBJECT,!0),Object(r["assert"])("message",t,r["AssertRules"].OBJECT,!0),n=t.type,i=t.targetId,o=t.messageUId,a=t.canIncludeExpansion,u=t.expansion,l="type:"+n+",targetId:"+this.targetId+",messageUId:"+o,c.debug("update message expansion ->"+l),[4,this._context.sendExpansionMessage({conversationType:n,targetId:i,messageUId:o,expansion:e,canIncludeExpansion:a,originExpansion:u,channelId:""})];case 1:return(h=s.sent().code)!==r["ErrorCode"].SUCCESS?(c.warn("update message expansion fail ->"+h+":"+d[h]+","+l),[2,Promise.reject({code:h,msg:d[h]})]):[2]}}))}))},e.prototype.removeMessageExpansion=function(e,t){return o(this,void 0,void 0,(function(){var n,i,o,a,u,l;return s(this,(function(s){switch(s.label){case 0:return Object(r["assert"])("keys",e,r["AssertRules"].ARRAY,!0),Object(r["assert"])("message",t,r["AssertRules"].OBJECT,!0),n=t.type,i=t.targetId,o=t.messageUId,a=t.canIncludeExpansion,u="type:"+n+",targetId:"+this.targetId+",messageUId:"+o,c.debug("remove message expansion ->"+u),[4,this._context.sendExpansionMessage({conversationType:n,targetId:i,messageUId:o,canIncludeExpansion:a,keys:e,channelId:""})];case 1:return(l=s.sent().code)!==r["ErrorCode"].SUCCESS?(c.warn("remove message expansion fail ->"+l+":"+d[l]+","+u),[2,Promise.reject({code:l,msg:d[l]})]):[2]}}))}))},e.prototype.setDraft=function(e){return o(this,void 0,void 0,(function(){var t,n;return s(this,(function(i){switch(i.label){case 0:return Object(r["assert"])("draft",e,r["AssertRules"].STRING,!0),t="type:"+this.type+",targetId:"+this.targetId,c.debug("set draft ->"+t),[4,this._context.saveConversationMessageDraft(this.type,this.targetId,e)];case 1:return(n=i.sent())===r["ErrorCode"].SUCCESS?[2,Promise.resolve()]:(c.warn("set draft fail ->"+n+":"+d[n]+","+t),[2])}}))}))},e.prototype.getDraft=function(){return o(this,void 0,void 0,(function(){var e,t,n,i;return s(this,(function(o){switch(o.label){case 0:return[4,this._context.getConversationMessageDraft(this.type,this.targetId)];case 1:return e=o.sent(),t=e.code,n=e.data,i="type:"+this.type+",targetId:"+this.targetId,c.debug("get draft ->"+i),t===r["ErrorCode"].SUCCESS?[2,Promise.resolve(n)]:(c.warn("get draft fail ->"+t+":"+d[t]+","+i),[2,Promise.reject({code:t,msg:d[t]})])}}))}))},e.prototype.deleteDraft=function(){return o(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return e="type:"+this.type+",targetId:"+this.targetId,c.debug("delete draft  ->"+e),[4,this._context.clearConversationMessageDraft(this.type,this.targetId)];case 1:return(t=n.sent())===r["ErrorCode"].SUCCESS?[2,Promise.resolve()]:(c.warn("delete draft fail ->"+t+":"+d[t]+","+e),[2])}}))}))},e.prototype.sendReadReceiptMessage=function(e){return o(this,void 0,void 0,(function(){var t,n,i,o,a;return s(this,(function(s){switch(s.label){case 0:for(Object(r["assert"])("messageUIds",e,r["AssertRules"].ARRAY,!0),t=0,n=e;t<n.length;t++)i=n[t],Object(r["assert"])("messageUId",i,r["AssertRules"].STRING);return o="messageUIds:"+e.join(",")+",targetId:"+this.targetId,c.debug("send read receipt message ->"+o),[4,this._context.sendReadReceiptMessage(this.targetId,e)];case 1:return(a=s.sent().code)===r["ErrorCode"].SUCCESS?[2,Promise.resolve()]:(c.warn("send read receipt message fail ->"+a+":"+d[a]+","+o),[2,Promise.reject(a)])}}))}))},e.prototype.sendTypingStatusMessage=function(e){return o(this,void 0,void 0,(function(){var t,n,i,o,a;return s(this,(function(s){switch(s.label){case 0:return Object(r["assert"])("typingContentType",e,r["AssertRules"].STRING,!0),t="type:"+this.type+",targetId:"+this.targetId,c.debug("send typing status message ->"+t),n={messageType:"RC:TypSts",content:{typingContentType:e},isStatusMessage:!0,channelId:""},[4,this._context.sendMessage(this.type,this.targetId,n)];case 1:return i=s.sent(),o=i.code,a=i.data,o===r["ErrorCode"].SUCCESS?[2,C(a)]:(c.warn("send typing status message fail ->"+o+":"+d[o]+","+t),[2,Promise.reject({code:o,msg:d[o]})])}}))}))},e.prototype.getMessageReader=function(e){return o(this,void 0,void 0,(function(){var t,n,i,o;return s(this,(function(s){switch(s.label){case 0:return Object(r["assert"])("messageUId",e,r["AssertRules"].STRING,!0),t="messageUId:"+e+",targetId:"+this.targetId,c.debug("get message reader ->"+t),[4,this._context.getMessageReader(this.targetId,e)];case 1:return n=s.sent(),i=n.code,o=n.data,i===r["ErrorCode"].SUCCESS?[2,Promise.resolve(o)]:(c.warn("get message reader fail ->"+i+":"+d[i]+","+t),[2,Promise.reject(i)])}}))}))},e}(),L=function(){function e(e){this._context=e}return e.prototype.getList=function(e){return o(this,void 0,void 0,(function(){var t,n,i,o;return s(this,(function(s){switch(s.label){case 0:return c.debug("get conversation list ->"),[4,this._context.getConversationList(null==e?void 0:e.count,void 0,null==e?void 0:e.startTime,null==e?void 0:e.order)];case 1:return t=s.sent(),n=t.code,i=t.data,n===r["ErrorCode"].SUCCESS&&i?(o=i.map((function(e){return n=(t=e).conversationType,r=t.targetId,i=t.latestMessage,o=t.unreadMessageCount,s=t.hasMentioned,a=t.mentionedInfo,c=t.lastUnreadTime,u=t.notificationStatus,d=t.isTop,{type:n,targetId:r,latestMessage:i&&C(i),unreadMessageCount:o,hasMentioned:s,mentionedInfo:s?{type:null==a?void 0:a.type,userIdList:null==a?void 0:a.userIdList}:void 0,lastUnreadTime:c,notificationStatus:u,isTop:d};var t,n,r,i,o,s,a,c,u,d})),[2,b(o)]):(c.warn("get conversation list fail ->"+n+":"+d[n]),[2,Promise.reject({code:n,msg:d[n]})])}}))}))},e.prototype.get=function(e){return Object(r["assert"])("options.type",e.type,r["isValidConversationType"],!0),new k(this._context,e)},e.prototype.remove=function(e){return Object(r["assert"])("options.type",e.type,r["isValidConversationType"],!0),new k(this._context,e).destory()},e.prototype.getTotalUnreadCount=function(){return o(this,void 0,void 0,(function(){var e,t,n;return s(this,(function(i){switch(i.label){case 0:return c.debug("get total unread count ->"),[4,this._context.getTotalUnreadCount("")];case 1:return e=i.sent(),t=e.code,n=e.data,t===r["ErrorCode"].SUCCESS?[2,n]:(c.warn("getTotalUnreadCount fail ->"+t+":"+d[t]),[2,Promise.reject({code:t,msg:d[t]})])}}))}))},e.prototype.merge=function(e){return!e.conversationList&&c.warn("Parameter option.conversationList are required!"),function(e){var t=(e=e||{}).conversationList,n=e.updatedConversationList;t=t||[];var i=a(a([],n=n||[]),t),o={},s=[],c=[];return Object(r["forEach"])(i,(function(e){if(Object(r["isObject"])(e)){var t=e.type,n=e.targetId,i=O({type:t,targetId:n}),a=o[i]||{},u=Object(r["isUndefined"])(a.index)?s.length:a.index,d=a.val||{},l=d.updatedItems||{},h=e.updatedItems;e=P(e,d),Object(r["forEach"])(l,(function(t,n){e[n]=t.val})),Object(r["forEach"])(h,(function(t,n){var r=(l[n]||{}).time||0;t.time>r&&(e[n]=t.val)})),o[i]={index:u,val:e},s[u]=e,M(e)&&c.push(u)}})),Object(r["forEach"])(c,(function(e){var t=s[e];s[e]=N(t)})),s=b(s),Object(r["map"])(s,(function(e){return delete e.updatedItems,e}))}(e)},e}(),x=function(e){Object(r["assert"])("options.key",e.key,r["AssertRules"].STRING,!0),Object(r["assert"])("options.value",e.value,r["AssertRules"].STRING,!0),Object(r["assert"])("options.isAutoDelete",e.isAutoDelete,r["AssertRules"].BOOLEAN),Object(r["assert"])("options.isSendNotification",e.isSendNotification,r["AssertRules"].BOOLEAN),Object(r["assert"])("options.notificationExtra",e.notificationExtra,r["AssertRules"].STRING)},U=function(e){Object(r["assert"])("options.key",e.key,r["AssertRules"].STRING,!0),Object(r["assert"])("options.isSendNotification",e.isSendNotification,r["AssertRules"].BOOLEAN),Object(r["assert"])("options.notificationExtra",e.notificationExtra,r["AssertRules"].STRING)},D=function(){function e(e,t){this._context=e,this._id=t}return e.prototype.join=function(e){return o(this,void 0,void 0,(function(){var t,n;return s(this,(function(i){switch(i.label){case 0:return Object(r["assert"])("options.count",e.count,r["AssertRules"].NUMBER,!0),t="id:"+this._id,c.debug("join chatroom ->"+t),[4,this._context.joinChatroom(this._id,e.count)];case 1:return(n=i.sent())!==r["ErrorCode"].SUCCESS?(c.warn("join chatroom fail ->code+:"+d[n]+","+t),[2,Promise.reject({code:n,msg:d[n]})]):[2]}}))}))},e.prototype.joinExist=function(e){return o(this,void 0,void 0,(function(){var t,n;return s(this,(function(i){switch(i.label){case 0:return Object(r["assert"])("options.count",e.count,r["AssertRules"].NUMBER,!0),t="id:"+this._id,c.debug("join exist chatroom ->"+t),[4,this._context.joinExistChatroom(this._id,e.count)];case 1:return(n=i.sent())!==r["ErrorCode"].SUCCESS?(c.warn("join exist chatroom fail ->code:"+d[n]+","+t),[2,Promise.reject({code:n,msg:d[n]})]):[2]}}))}))},e.prototype.quit=function(){return o(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return e="id:"+this._id,c.debug("quit chatroom ->"+e),[4,this._context.quitChatroom(this._id)];case 1:return(t=n.sent())!==r["ErrorCode"].SUCCESS?(c.warn("quit chatroom fail ->code+:"+d[t]+","+e),[2,Promise.reject({code:t,msg:d[t]})]):[2]}}))}))},e.prototype.getInfo=function(e){return void 0===e&&(e={}),o(this,void 0,void 0,(function(){var t,n,i,o;return s(this,(function(s){switch(s.label){case 0:return Object(r["assert"])("options.count",e.count,r["AssertRules"].NUMBER),Object(r["assert"])("options.order",e.order,(function(e){return[0,1,2].includes(e)})),t="id:"+this._id,c.debug("get chatroom info ->"+t),[4,this._context.getChatroomInfo(this._id,e.count,e.order)];case 1:return n=s.sent(),i=n.code,o=n.data,i===r["ErrorCode"].SUCCESS&&o?[2,o]:(c.warn("get chatroom info fail ->code+:"+d[i]+","+t),[2,Promise.reject({code:i,msg:d[i]})])}}))}))},e.prototype.setEntry=function(e){return o(this,void 0,void 0,(function(){var t,n;return s(this,(function(i){switch(i.label){case 0:return x(e),t="id:"+this._id,c.debug("set chatroom entry->"+t),[4,this._context.setChatroomEntry(this._id,e)];case 1:return(n=i.sent())!==r["ErrorCode"].SUCCESS?(c.warn("set chatroom entry fail ->code+:"+d[n]+","+t),[2,Promise.reject({code:n,msg:d[n]})]):[2]}}))}))},e.prototype.forceSetEntry=function(e){return o(this,void 0,void 0,(function(){var t,n;return s(this,(function(i){switch(i.label){case 0:return x(e),t="id:"+this._id,c.debug("force set chatroom entry ->"+t),[4,this._context.forceSetChatroomEntry(this._id,e)];case 1:return(n=i.sent())!==r["ErrorCode"].SUCCESS?(c.warn("force set chatroom entry fail ->code+:"+d[n]+","+t),[2,Promise.reject({code:n,msg:d[n]})]):[2]}}))}))},e.prototype.removeEntry=function(e){return o(this,void 0,void 0,(function(){var t,n;return s(this,(function(i){switch(i.label){case 0:return U(e),t="id:"+this._id,c.debug("remove chatroom entry->"+t),[4,this._context.removeChatroomEntry(this._id,e)];case 1:return(n=i.sent())!==r["ErrorCode"].SUCCESS?(c.warn("remove chatroom entry fail ->code+:"+d[n]+","+t),[2,Promise.reject({code:n,msg:d[n]})]):[2]}}))}))},e.prototype.forceRemoveEntry=function(e){return o(this,void 0,void 0,(function(){var t,n;return s(this,(function(i){switch(i.label){case 0:return U(e),t="id:"+this._id,c.debug("force remove chatroom entry ->"+t),[4,this._context.forceRemoveChatroomEntry(this._id,e)];case 1:return(n=i.sent())!==r["ErrorCode"].SUCCESS?(c.warn("force remove chatroom entry fail ->code+:"+d[n]+","+t),[2,Promise.reject({code:n,msg:d[n]})]):[2]}}))}))},e.prototype.getEntry=function(e){return o(this,void 0,void 0,(function(){var t,n,i,o;return s(this,(function(s){switch(s.label){case 0:return Object(r["assert"])("key",e,(function(e){return Object(r["isString"])(e)&&/[\w+=-]+/.test(e)&&e.length<=128}),!0),t="id:"+this._id,c.debug("get chatroom entry->"+t),[4,this._context.getChatroomEntry(this._id,e)];case 1:return n=s.sent(),i=n.code,o=n.data,i===r["ErrorCode"].SUCCESS&&o?[2,o]:(c.warn("get chatroom entry fail ->code+:"+d[i]+","+t),[2,Promise.reject({code:i,msg:d[i]})])}}))}))},e.prototype.getAllEntries=function(){return o(this,void 0,void 0,(function(){var e,t,n,i;return s(this,(function(o){switch(o.label){case 0:return e="id:"+this._id,c.debug("get all chatroom entries->"+e),[4,this._context.getAllChatroomEntries(this._id)];case 1:return t=o.sent(),n=t.code,i=t.data,n===r["ErrorCode"].SUCCESS&&i?[2,i]:(c.warn("get all chatroom entries fail ->code+:"+d[n]+","+e),[2,Promise.reject({code:n,msg:d[n]})])}}))}))},e.prototype.send=function(e){return o(this,void 0,void 0,(function(){var t,n,i,o;return s(this,(function(s){switch(s.label){case 0:return R(e),t="id:"+this._id,c.debug("send chatroom message ->"+t),Object.prototype.hasOwnProperty.call(e,"isPersited")||(e.isPersited=!0),Object.prototype.hasOwnProperty.call(e,"isCounted")||(e.isCounted=!0),[4,this._context.sendMessage(r["ConversationType"].CHATROOM,this._id,e)];case 1:return n=s.sent(),i=n.code,o=n.data,i===r["ErrorCode"].SUCCESS?[2,C(o)]:(c.warn("send chatroom message fail ->code+:"+d[i]+","+t),[2,Promise.reject({code:i,msg:d[i]})])}}))}))},e.prototype.getMessages=function(e){return o(this,void 0,void 0,(function(){var t,n,i,o;return s(this,(function(s){switch(s.label){case 0:return Object(r["assert"])("options.timestamp",e.timestamp,r["AssertRules"].NUMBER),Object(r["assert"])("options.count",e.count,r["AssertRules"].NUMBER),Object(r["assert"])("options.order",e.order,(function(e){return 0===e||1===e})),t="id:"+this._id,c.debug("get chatroom history message->"+t),[4,this._context.getChatRoomHistoryMessages(this._id,e.count,e.order,e.timestamp)];case 1:return n=s.sent(),i=n.code,o=n.data,i===r["ErrorCode"].SUCCESS&&o?[2,{list:o.list.map((function(e){return C(e)})),hasMore:o.hasMore}]:(c.warn("get chatroom history message fail ->code+:"+d[i]+","+t),[2,Promise.reject({code:i,msg:d[i]})])}}))}))},e.prototype.recall=function(e){return o(this,void 0,void 0,(function(){var t,n,i,o,a;return s(this,(function(s){switch(s.label){case 0:return Object(r["assert"])("options.messageUId",e.messageUId,r["AssertRules"].STRING,!0),Object(r["assert"])("options.sentTime",e.sentTime,r["AssertRules"].NUMBER,!0),t="id:"+this._id+",messageUId:"+e.messageUId,c.debug("chatroom recall->"+t),n=r["ConversationType"].CHATROOM,[4,this._context.recallMessage(n,this._id,e.messageUId,e.sentTime,{channelId:"",user:e.user})];case 1:return i=s.sent(),o=i.code,a=i.data,o===r["ErrorCode"].SUCCESS&&a?[2,C(a)]:(c.warn("chatroom recall fail->code+:"+d[o]+","+t),[2,Promise.reject({code:o,msg:d[o]})])}}))}))},e}(),j=function(){function e(e){this._context=e}return e.prototype.get=function(e){return Object(r["assert"])("option.id",e.id,r["notEmptyString"],!0),new D(this._context,e.id)},e}(),V=function(){function e(e,t){this._options=e,this._context=t,this._roomId=e.id}return e.prototype.join=function(){return o(this,void 0,void 0,(function(){var e,t,n,i;return s(this,(function(o){switch(o.label){case 0:return e="roomId:"+this._roomId,c.debug("join ->"+e),[4,this._context.joinRTCRoom(this._roomId,this._options.mode,this._options.broadcastType)];case 1:return t=o.sent(),n=t.code,i=t.data,n===r["ErrorCode"].SUCCESS?[2,i]:(c.warn("join fail ->"+n+":"+d[n]+","+e),[2,Promise.reject(n)])}}))}))},e.prototype.quit=function(){return o(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return e="roomId:"+this._roomId,c.debug("quit ->"+e),[4,this._context.quitRTCRoom(this._roomId)];case 1:return(t=n.sent())===r["ErrorCode"].SUCCESS?[2,t]:(c.warn("quit fail ->"+t+":"+d[t]+","+e),[2,Promise.reject(t)])}}))}))},e.prototype.getRoomInfo=function(){return o(this,void 0,void 0,(function(){var e,t,n,i;return s(this,(function(o){switch(o.label){case 0:return e="roomId:"+this._roomId,c.debug("get roomInfo ->"+e),[4,this._context.getRTCRoomInfo(this._roomId)];case 1:return t=o.sent(),n=t.code,i=t.data,n===r["ErrorCode"].SUCCESS?[2,i]:(c.warn("get roomInfo fail ->"+n+":"+d[n]+","+e),[2,Promise.reject(n)])}}))}))},e.prototype.setUserInfo=function(e){return o(this,void 0,void 0,(function(){var t,n;return s(this,(function(i){switch(i.label){case 0:return t="roomId:"+this._roomId+",key:"+e.key+",value:"+e.value,c.debug("set userInfo ->"+t),[4,this._context.setRTCUserInfo(this._roomId,e.key,e.value)];case 1:return(n=i.sent())===r["ErrorCode"].SUCCESS?[2,n]:(c.warn("set userInfo fail ->"+n+":"+d[n]+","+t),[2,Promise.reject(n)])}}))}))},e.prototype.removeUserInfo=function(e){return o(this,void 0,void 0,(function(){var t,n;return s(this,(function(i){switch(i.label){case 0:return t="roomId:"+this._roomId+",keys:"+(e.keys||[]).join(","),c.debug("remove useerInfo ->"+t),[4,this._context.removeRTCUserInfo(this._roomId,e.keys)];case 1:return(n=i.sent())===r["ErrorCode"].SUCCESS?[2,n]:(c.warn("remove userInfo fail ->"+n+":"+d[n]+","+t),[2,Promise.reject(n)])}}))}))},e.prototype.setData=function(e,t,n,i,a){return o(this,void 0,void 0,(function(){var o,u;return s(this,(function(s){switch(s.label){case 0:return o="roomId:"+this._roomId+",key:"+e+",value:"+t,c.debug("set data ->"+o),[4,this._context.setRTCData(this._roomId,e,t,n,i,a)];case 1:return(u=s.sent())===r["ErrorCode"].SUCCESS?[2,u]:(c.warn("set data fail ->"+u+":"+d[u]+","+o),[2,Promise.reject(u)])}}))}))},e.prototype.setUserData=function(e,t,n,i){return this.setData(e,t,n,r["RTCApiType"].PERSON,i)},e.prototype.setRTCUserData=function(e,t,n){return o(this,void 0,void 0,(function(){var i,o;return s(this,(function(s){switch(s.label){case 0:return i="roomId:"+this._roomId,c.debug("set rtc user ->"+i),[4,this._context.setRTCTotalRes(this._roomId,e,t,n)];case 1:return(o=s.sent())===r["ErrorCode"].SUCCESS?[2,o]:(c.warn("set rtc user fail ->"+o+":"+d[o]+","+i),[2,Promise.reject(o)])}}))}))},e.prototype.getData=function(e,t,n){return o(this,void 0,void 0,(function(){var i,o,a,u;return s(this,(function(s){switch(s.label){case 0:return i="roomId:"+this._roomId,c.debug("get data ->"+i),[4,this._context.getRTCData(this._roomId,e,t,n)];case 1:return o=s.sent(),a=o.code,u=o.data,a===r["ErrorCode"].SUCCESS?[2,u]:(c.warn("get data fail ->"+a+":"+d[a]+","+i),[2,Promise.reject(a)])}}))}))},e.prototype.getUserData=function(e,t){return this.getData(e,t,r["RTCApiType"].PERSON)},e.prototype.removeData=function(e,t,n,i){return o(this,void 0,void 0,(function(){var o,a;return s(this,(function(s){switch(s.label){case 0:return o="roomId:"+this._roomId+",keys:"+e.join(","),c.debug("remove data ->"+o),[4,this._context.removeRTCData(this._roomId,e,t,n,i)];case 1:return(a=s.sent())===r["ErrorCode"].SUCCESS?[2,a]:(c.warn("remove data fail ->"+a+":"+d[a]+","+o),[2,Promise.reject(a)])}}))}))},e.prototype.removeUserData=function(e,t,n){return this.removeData(e,t,r["RTCApiType"].PERSON,n)},e.prototype.setRoomData=function(e,t,n,i){return this.setData(e,t,n,r["RTCApiType"].ROOM,i)},e.prototype.getRoomData=function(e,t){return this.getData(e,t,r["RTCApiType"].ROOM)},e.prototype.removeRoomData=function(e,t,n){return this.removeData(e,t,r["RTCApiType"].ROOM,n)},e.prototype.setState=function(e){return o(this,void 0,void 0,(function(){var t,n;return s(this,(function(i){switch(i.label){case 0:return t="roomId:"+this._roomId,c.debug("set state ->"+t),[4,this._context.setRTCState(this._roomId,e.report)];case 1:return(n=i.sent())===r["ErrorCode"].SUCCESS?[2,n]:(c.warn("set state fail ->"+n+":"+d[n]+","+t),[2,Promise.reject(n)])}}))}))},e.prototype.getUserList=function(){return o(this,void 0,void 0,(function(){var e,t,n,i;return s(this,(function(o){switch(o.label){case 0:return e="roomId:"+this._roomId,c.debug("get userList ->"+e),[4,this._context.getRTCUserInfoList(this._roomId)];case 1:return t=o.sent(),n=t.code,i=t.data,n===r["ErrorCode"].SUCCESS?[2,i]:(c.warn("get userList fail ->"+n+":"+d[n]+","+e),[2,Promise.reject(n)])}}))}))},e.prototype.getUserInfoList=function(){return o(this,void 0,void 0,(function(){var e,t,n,i;return s(this,(function(o){switch(o.label){case 0:return e="roomId:"+this._roomId,c.debug("get userInfo list ->"+e),[4,this._context.getRTCUserInfoList(this._roomId)];case 1:return t=o.sent(),n=t.code,i=t.data,n===r["ErrorCode"].SUCCESS?[2,null==i?void 0:i.users]:(c.warn("get userInfo list fail ->"+n+":"+d[n]+","+e),[2,Promise.reject(n)])}}))}))},e.prototype.getToken=function(){return o(this,void 0,void 0,(function(){var e,t,n,i;return s(this,(function(o){switch(o.label){case 0:return e="roomId:"+this._roomId,c.debug("getToken ->"+e),[4,this._context.getRTCToken(this._roomId,this._options.mode,this._options.broadcastType)];case 1:return t=o.sent(),n=t.data,(i=t.code)===r["ErrorCode"].SUCCESS?[2,n]:(c.warn("getToken fail ->"+i+":"+d[i]+","+e),[2,Promise.reject(i)])}}))}))},e.prototype.ping=function(){return o(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return e="roomId:"+this._roomId,c.debug("ping ->"+e),[4,this._context.rtcPing(this._roomId,this._options.mode,this._options.broadcastType)];case 1:return(t=n.sent())===r["ErrorCode"].SUCCESS?[2,t]:(c.warn("ping fail ->"+t+":"+d[t]+","+e),[2,Promise.reject(t)])}}))}))},e.prototype.send=function(e){return o(this,void 0,void 0,(function(){var t,n,o,a;return s(this,(function(s){switch(s.label){case 0:return t="roomId:"+this._roomId,c.debug("send ->"+t),[4,this._context.sendMessage(r["ConversationType"].RTC_ROOM,this._roomId,{content:i({},e.content),messageType:e.messageType})];case 1:return n=s.sent(),o=n.code,a=n.data,o===r["ErrorCode"].SUCCESS?[2,a]:(c.warn("send fail ->"+o+":"+d[o]+","+t),[2,Promise.reject(o)])}}))}))},e}(),B=function(){return!("undefined"==typeof uni||!function(e){for(var t=["canIUse","getSystemInfo"],n=0,r=t.length;n<r;n++)if(!e[t[n]])return!1;return!0}(uni))},F=B(),H={tag:"browser",httpReq:function(e){var t=e.method||r["HttpMethod"].GET,n=e.timeout||6e4,i=e.headers,o=e.query,s=e.body,a=Object(r["appendUrl"])(e.url,o);return new Promise((function(e){var r,o=(r="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,"undefined"!=typeof XMLHttpRequest&&r?new XMLHttpRequest:"undefined"!=typeof XDomainRequest?new XDomainRequest:new ActiveXObject("Microsoft.XMLHTTP")),c="[object XDomainRequest]"===Object.prototype.toString.call(o);if(o.open(t,a),i&&o.setRequestHeader)for(var u in i)o.setRequestHeader(u,i[u]);if(c){o.timeout=n,o.onload=function(){e({data:o.responseText,status:o.status||200})},o.onerror=function(){e({status:o.status||0})},o.ontimeout=function(){e({status:o.status||0})};var d="object"==typeof s?JSON.stringify(s):s;o.send(d)}else o.onreadystatechange=function(){4===o.readyState&&e({data:o.responseText,status:o.status})},o.onerror=function(){e({status:o.status||0})},setTimeout((function(){return e({status:o.status||0})}),n),o.send(s)}))},localStorage:null===window||void 0===window?void 0:window.localStorage,sessionStorage:null===window||void 0===window?void 0:window.sessionStorage,isSupportSocket:function(){var e="undefined"!=typeof WebSocket;return e||c.warn("websocket not support"),e},useNavi:!0,connectPlatform:"",isFromUniapp:F,createWebSocket:function(e,t){var n=new WebSocket(e,t);return n.binaryType="arraybuffer",{onClose:function(e){n.onclose=function(t){var n=t.code,r=t.reason;e(n,r)}},onError:function(e){n.onerror=e},onMessage:function(e){n.onmessage=function(t){e(t.data)}},onOpen:function(e){n.onopen=e},send:function(e){n.send(e)},close:function(e,t){n.close(e,t)}}},createDataChannel:function(e,t){return this.isSupportSocket()&&"websocket"===t?new r["WebSocketChannel"](this,e):new r["CometChannel"](this,e)}},G=B(),Y=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return wx[e].apply(wx,t)}catch(e){c.error(e)}}},q={setItem:Y("setStorageSync"),getItem:Y("getStorageSync"),removeItem:Y("removeStorageSync"),clear:Y("clearStorageSync")},K={tag:"wechat",httpReq:function(e){var t=e.method||r["HttpMethod"].GET,n=e.timeout||6e4,i=e.headers,o=e.query,s=e.body,a=Object(r["appendUrl"])(e.url,o);return new Promise((function(e){wx.request({url:a,method:t,headers:i,timeout:n,data:s,success:function(t){e({data:t.data,status:t.statusCode})},fail:function(){e({status:r["ErrorCode"].RC_HTTP_REQ_TIMEOUT})}})}))},localStorage:q,sessionStorage:q,isSupportSocket:function(){return!0},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:G,createWebSocket:function(e,t){var n=wx.connectSocket({url:e,protocols:t});return{onClose:function(e){n.onClose((function(t){e(t.code,t.reason)}))},onError:function(e){n.onError((function(t){e(t.errMsg)}))},onMessage:function(e){n.onMessage((function(t){e(t.data)}))},onOpen:function(e){n.onOpen(e)},send:function(e){n.send({data:e})},close:function(e,t){n.close({code:e,reason:t})}}},createDataChannel:function(e,t){return"websocket"===t?new r["WebSocketChannel"](this,e):new r["CometChannel"](this,e)}},W=B(),$=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return my[e].apply(my,t)}catch(e){c.error(e)}}},J={setItem:$("setStorageSync"),getItem:$("getStorageSync"),removeItem:$("removeStorageSync"),clear:$("clearStorageSync")},z={tag:"alipay",httpReq:function(e){var t=e.method||r["HttpMethod"].GET,n=e.timeout||6e4,i=e.headers,o=e.query,s=e.body,a=Object(r["appendUrl"])(e.url,o);return new Promise((function(e){my.request({url:a,method:t,headers:i,timeout:n,data:s,success:function(t){e({data:t.data,status:t.status})},fail:function(){e({status:r["ErrorCode"].RC_HTTP_REQ_TIMEOUT})}})}))},localStorage:J,sessionStorage:J,isSupportSocket:function(){return!1},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:W,createDataChannel:function(e,t){return"websocket"===t?new r["WebSocketChannel"](this,e):new r["CometChannel"](this,e)}},Q=B(),Z=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return console.log("tt",tt),tt[e].apply(tt,t)}catch(e){c.error(e)}}},X={setItem:Z("setStorageSync"),getItem:Z("getStorageSync"),removeItem:Z("removeStorageSync"),clear:Z("clearStorageSync")},ee={tag:"toutiao",isSupportSocket:function(){return!0},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:Q,localStorage:X,sessionStorage:X,httpReq:function(e){return new Promise((function(t,n){tt.request({url:e.url,data:e.body,header:e.headers,method:e.method,success:function(e){console.log("调用成功",e.data);var n=(null==e?void 0:e.data)||{},r={data:JSON.stringify(n),status:e.statusCode};t(r)},fail:function(e){console.log("调用失败",e.errMsg),n({data:e.errMsg})}})}))},createWebSocket:function(e,t){var n=tt.connectSocket({url:e,protocols:t});return{onOpen:function(e){n.onOpen(e)},onClose:function(e){n.onClose((function(t){return e(t.code,t.reason)}))},onError:function(e){n.onError((function(t){return e(t.errMsg)}))},onMessage:function(e){n.onMessage((function(t){return e(t.data)}))},send:function(e){n.send({data:e})},close:function(e,t){n.close({code:e,reason:t})}}},createDataChannel:function(e,t){return"websocket"===t?new r["WebSocketChannel"](this,e):new r["CometChannel"](this,e)}},te=B(),ne=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return console.log("swan",swan),swan[e].apply(swan,t)}catch(e){c.error(e)}}},re={setItem:ne("setStorageSync"),getItem:ne("getStorageSync"),removeItem:ne("removeStorageSync"),clear:ne("clearStorageSync")},ie={tag:"baidu",isSupportSocket:function(){return!0},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:te,localStorage:re,sessionStorage:re,httpReq:function(e){return new Promise((function(t,n){swan.request({url:e.url,data:e.body,header:e.headers,method:e.method,success:function(e){console.log("调用成功",e.data);var n=(null==e?void 0:e.data)||{},r={data:JSON.stringify(n),status:e.statusCode};t(r)},fail:function(e){console.log("调用失败",e.errorCode),n({data:e.errorCode})}})}))},createWebSocket:function(e,t){var n=swan.connectSocket({url:e,protocols:t});return{onOpen:function(e){n.onOpen(e)},onClose:function(e){n.onClose((function(t){return e(t.code,t.reason)}))},onError:function(e){n.onError((function(t){return e(t.errMsg)}))},onMessage:function(e){n.onMessage((function(t){return e(t.data)}))},send:function(e){n.send({data:e})},close:function(e,t){n.close({code:e,reason:t})}}},createDataChannel:function(e,t){return"websocket"===t?new r["WebSocketChannel"](this,e):new r["CometChannel"](this,e)}},oe=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return uni[e].apply(uni,t)}catch(e){c.error(e)}}},se={setItem:oe("setStorageSync"),getItem:oe("getStorageSync"),removeItem:oe("removeStorageSync"),clear:oe("clearStorageSync")},ae={tag:"uniapp",httpReq:function(e){var t=e.method||r["HttpMethod"].GET,n=e.timeout||6e4,i=e.headers,o=e.query,s=e.body,a=Object(r["appendUrl"])(e.url,o);return new Promise((function(e){uni.request({url:a,method:t,headers:i,timeout:n,data:s,success:function(t){e({data:t.data,status:t.statusCode})},fail:function(){e({status:r["ErrorCode"].RC_HTTP_REQ_TIMEOUT})}})}))},localStorage:se,sessionStorage:se,isSupportSocket:function(){return!0},useNavi:!0,connectPlatform:"",isFromUniapp:!0,createWebSocket:function(e,t){var n={complete:function(){},url:e,protocols:t},r=uni.connectSocket(n);return{onClose:function(e){r.onClose((function(t){e(t.code,t.reason)}))},onError:function(e){r.onError((function(t){e(t.errMsg)}))},onMessage:function(e){r.onMessage((function(t){e(t.data)}))},onOpen:function(e){r.onOpen(e)},send:function(e){r.send({data:e})},close:function(e,t){r.close({code:e,reason:t})}}},createDataChannel:function(e,t){return"websocket"===t?new r["WebSocketChannel"](this,e):new r["CometChannel"](this,e)}},ce=function(e){return e&&e.canIUse&&e.getSystemInfo},ue="undefined"!=typeof uni&&ce(uni)?function(){switch(Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_PLATFORM){case"app-plus":return ae;case"mp-baidu":return ie;case"mp-toutiao":return ee;case"mp-alipay":return z;case"mp-weixin":return K;case"h5":default:return H}}():"undefined"!=typeof wx&&ce(wx)?K:"undefined"!=typeof my&&ce(my)?z:"undefined"!=typeof tt&&ce(tt)?ee:"undefined"!=typeof swan&&ce(swan)?ie:H,de=[],le=[],he={message:function(e){de.forEach((function(t){return t(e)}))},status:function(e){le.forEach((function(t){return t(e)}))}},fe=function(){function e(e){this._token="",this._context=e,this.Conversation=new L(e),this.ChatRoom=new j(e),this.RTC=function(t){return Object(r["assert"])("options.id",t.id,r["notEmptyString"],!0),new V(t,e)}}return e.prototype.install=function(e,t){return this._context.install(e,t)},e.prototype.watch=function(e){var t=e.status,n=e.conversation,r=e.message,i=e.chatroom,o=e.expansion,s=e.typingStatus,a={};t&&(a.connectionState=function(e){try{t({status:e})}catch(e){c.error(e)}}),n&&(a.conversationState=function(e){try{var t=e.map((function(e){return n=(t=e).updatedItems,r=t.conversationType,i=t.targetId,o=t.latestMessage,s=t.unreadMessageCount,a=t.lastUnreadTime,c=t.notificationStatus,u=t.isTop,d=t.mentionedInfo,l=t.hasMentioned,h=o&&C(o),n&&n.latestMessage&&(n.latestMessage.val=h),{updatedItems:n,type:r,targetId:i,latestMessage:h,unreadMessageCount:s,lastUnreadTime:a,notificationStatus:c,isTop:u,mentionedInfo:d,hasMentioned:l};var t,n,r,i,o,s,a,c,u,d,l,h}));n({updatedConversationList:t})}catch(e){c.error(e)}}),r&&(a.message=function(e){try{r({message:C(e)})}catch(e){c.error(e)}}),i&&(a.chatroomState=function(e){try{i(e)}catch(e){c.error(e)}}),o&&(a.expansion=function(e){try{o(e)}catch(e){c.error(e)}}),s&&(a.typingState=function(e){try{s(e)}catch(e){c.error(e)}}),this._context.assignWatcher(a)},e.prototype.unwatch=function(){this._context.assignWatcher({message:void 0,connectionState:void 0,conversationState:void 0,chatroomState:void 0,expansion:void 0})},e.prototype.rtcInnerWatch=function(e){var t=e.message,n=e.status;t&&de.push((function(e){try{t({message:C(e)})}catch(e){c.error(e)}})),n&&le.push((function(e){try{n({status:e})}catch(e){c.error(e)}})),this._context.assignWatcher({rtcInnerWatcher:he})},e.prototype.rtcInnerUnwatch=function(){le.length=le.length=0,this._context.assignWatcher({rtcInnerWatcher:void 0})},e.prototype.connect=function(e){return o(this,void 0,void 0,(function(){var t,n;return s(this,(function(i){switch(i.label){case 0:return Object(r["assert"])("options.token",e.token,r["AssertRules"].STRING,!0),t=e.token,this._token=t,[4,this._context.connect(t,!0)];case 1:return(n=i.sent()).code===r["ErrorCode"].SUCCESS?[2,{id:n.userId}]:[2,Promise.reject({code:n.code,msg:d[n.code]})]}}))}))},e.prototype.reconnect=function(){return o(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return[4,this._context.reconnect()];case 1:return(e=t.sent()).code===r["ErrorCode"].SUCCESS?[2,{id:e.userId}]:[2,Promise.reject({code:e.code,msg:d[e.code]})]}}))}))},e.prototype.disconnect=function(){return this._context.disconnect()},e.prototype.getAppInfo=function(){return{appkey:this._context.appkey,token:this._token,navi:this._context.getInfoFromCache()}},e.prototype.getConnectedTime=function(){return this._context.getConnectedTime()},e.prototype.getConnectionStatus=function(){return this._context.getConnectionStatus()},e.prototype.getConnectionUserId=function(){return this._context.getCurrentUserId()},e.prototype.getFileToken=function(e,t,n,i){return Object(r["assert"])("fileType",e,r["isValidFileType"],!0),this._context.getFileToken(e,t,n,i)},e.prototype.getFileUrl=function(e,t,n,i,o){return Object(r["assert"])("fileType",e,r["isValidFileType"],!0),Object(r["assert"])("filename",t,r["AssertRules"].STRING),Object(r["assert"])("saveName",n,r["AssertRules"].STRING),Object(r["assert"])("serverType",o,r["AssertRules"].NUMBER),this._context.getFileUrl(e,t,n,i,o)},e.prototype.changeUser=function(e){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return c.warn("Method is deprecated"),Object(r["assert"])("options.token",e.token,r["AssertRules"].STRING,!0),[4,this.disconnect()];case 1:return t.sent(),[2,this.connect(e)]}}))}))},e.prototype.registerMessageType=function(e,t,n,r){this._context.registerMessageType(e,t,n,r)},e}(),pe=function(e){if(c.setLogLevel(e.logLevel),c.setLogStdout(e.logStdout),S)return c.error("The instance already exists. Do not repeatedly call the init method"),S;Object(r["assert"])("options.appkey",e.appkey,r["AssertRules"].STRING,!0),Object(r["assert"])("options.debug",e.debug,r["AssertRules"].BOOLEAN),Object(r["assert"])("options.navigators",e.navigators,(function(e){return Object(r["isArray"])(e)&&(0===e.length||e.every(r["isHttpUrl"]))}));var t=null==e?void 0:e.connectType;t?r["CONNECTION_TYPE"].WEBSOCKET!==t&&r["CONNECTION_TYPE"].COMET!==t&&(c.warn("RongIMLib connectionType must be "+r["CONNECTION_TYPE"].WEBSOCKET+" or "+r["CONNECTION_TYPE"].COMET),t=r["CONNECTION_TYPE"].WEBSOCKET):t=r["CONNECTION_TYPE"].WEBSOCKET;var n=r["APIContext"].init(ue,{appkey:e.appkey,apiVersion:"4.4.1",navigators:e.navigators||[],miniCMPProxy:e.customCMP||[],connectionType:t,logLevel:e.logLevel,logStdout:e.logStdout,indexDBSwitch:void 0===e.indexDBSwitch||e.indexDBSwitch});return c.warn("RongIMLib Version: 4.4.1, Commit: 5d5c99edad11e884337763df17b8d316c7ec4882"),S=new fe(n)},ge=function(){return S||c.error("Please call the init method first"),S},me=r["MessageDirection"],ve=r["ConversationType"],_e=r["FileType"],ye={DO_NOT_DISTURB:r["NotificationStatus"].OPEN,NOTIFY:r["NotificationStatus"].CLOSE},Ee=r["ChatroomEntryType"]},"0676":function(e,t){function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}e.exports=n,e.exports["default"]=e.exports,e.exports.__esModule=!0},"06cf":function(e,t,n){var r=n("83ab"),i=n("d1e7"),o=n("5c6c"),s=n("fc6a"),a=n("c04e"),c=n("5135"),u=n("0cfb"),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=s(e),t=a(t,!0),u)try{return d(e,t)}catch(n){}if(c(e,t))return o(!i.f.call(e,t),e[t])}},"0cb2":function(e,t,n){var r=n("7b0b"),i=Math.floor,o="".replace,s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,c,u,d){var l=n+e.length,h=c.length,f=a;return void 0!==u&&(u=r(u),f=s),o.call(d,f,(function(r,o){var s;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(l);case"<":s=u[o.slice(1,-1)];break;default:var a=+o;if(0===a)return r;if(a>h){var d=i(a/10);return 0===d?r:d<=h?void 0===c[d-1]?o.charAt(1):c[d-1]+o.charAt(1):r}s=c[a-1]}return void 0===s?"":s}))}},"0cfb":function(e,t,n){var r=n("83ab"),i=n("d039"),o=n("cc12");e.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},"11b0":function(e,t,n){function r(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),n("a630"),e.exports=r,e.exports["default"]=e.exports,e.exports.__esModule=!0},"14c3":function(e,t,n){var r=n("c6b6"),i=n("9263");e.exports=function(e,t){var n=e.exec;if("function"===typeof n){var o=n.call(e,t);if("object"!==typeof o)throw TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(e))throw TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},"159b":function(e,t,n){var r=n("da84"),i=n("fdbc"),o=n("17c2"),s=n("9112");for(var a in i){var c=r[a],u=c&&c.prototype;if(u&&u.forEach!==o)try{s(u,"forEach",o)}catch(d){u.forEach=o}}},"17c2":function(e,t,n){"use strict";var r=n("b727").forEach,i=n("a640"),o=i("forEach");e.exports=o?[].forEach:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}},"19aa":function(e,t){e.exports=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e}},"1be4":function(e,t,n){var r=n("d066");e.exports=r("document","documentElement")},"1c0b":function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},"1c7e":function(e,t,n){var r=n("b622"),i=r("iterator"),o=!1;try{var s=0,a={next:function(){return{done:!!s++}},return:function(){o=!0}};a[i]=function(){return this},Array.from(a,(function(){throw 2}))}catch(c){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var r={};r[i]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(c){}return n}},"1cdc":function(e,t,n){var r=n("342f");e.exports=/(?:iphone|ipod|ipad).*applewebkit/i.test(r)},"1d80":function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on "+e);return e}},"1dde":function(e,t,n){var r=n("d039"),i=n("b622"),o=n("2d00"),s=i("species");e.exports=function(e){return o>=51||!r((function(){var t=[],n=t.constructor={};return n[s]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},2236:function(e,t,n){var r=n("5a43");function i(e){if(Array.isArray(e))return r(e)}e.exports=i,e.exports["default"]=e.exports,e.exports.__esModule=!0},2266:function(e,t,n){var r=n("825a"),i=n("e95a"),o=n("50c4"),s=n("0366"),a=n("35a1"),c=n("2a62"),u=function(e,t){this.stopped=e,this.result=t};e.exports=function(e,t,n){var d,l,h,f,p,g,m,v=n&&n.that,_=!(!n||!n.AS_ENTRIES),y=!(!n||!n.IS_ITERATOR),E=!(!n||!n.INTERRUPTED),T=s(t,v,1+_+E),C=function(e){return d&&c(d),new u(!0,e)},R=function(e){return _?(r(e),E?T(e[0],e[1],C):T(e[0],e[1])):E?T(e,C):T(e)};if(y)d=e;else{if(l=a(e),"function"!=typeof l)throw TypeError("Target is not iterable");if(i(l)){for(h=0,f=o(e.length);f>h;h++)if(p=R(e[h]),p&&p instanceof u)return p;return new u(!1)}d=l.call(e)}g=d.next;while(!(m=g.call(d)).done){try{p=R(m.value)}catch(S){throw c(d),S}if("object"==typeof p&&p&&p instanceof u)return p}return new u(!1)}},"23cb":function(e,t,n){var r=n("a691"),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},"23e7":function(e,t,n){var r=n("da84"),i=n("06cf").f,o=n("9112"),s=n("6eeb"),a=n("ce4e"),c=n("e893"),u=n("94ca");e.exports=function(e,t){var n,d,l,h,f,p,g=e.target,m=e.global,v=e.stat;if(d=m?r:v?r[g]||a(g,{}):(r[g]||{}).prototype,d)for(l in t){if(f=t[l],e.noTargetGet?(p=i(d,l),h=p&&p.value):h=d[l],n=u(m?l:g+(v?".":"#")+l,e.forced),!n&&void 0!==h){if(typeof f===typeof h)continue;c(f,h)}(e.sham||h&&h.sham)&&o(f,"sham",!0),s(d,l,f,e)}}},"241c":function(e,t,n){var r=n("ca84"),i=n("7839"),o=i.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},2532:function(e,t,n){"use strict";var r=n("23e7"),i=n("5a34"),o=n("1d80"),s=n("ab13");r({target:"String",proto:!0,forced:!s("includes")},{includes:function(e){return!!~String(o(this)).indexOf(i(e),arguments.length>1?arguments[1]:void 0)}})},"25f0":function(e,t,n){"use strict";var r=n("6eeb"),i=n("825a"),o=n("d039"),s=n("ad6d"),a="toString",c=RegExp.prototype,u=c[a],d=o((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),l=u.name!=a;(d||l)&&r(RegExp.prototype,a,(function(){var e=i(this),t=String(e.source),n=e.flags,r=String(void 0===n&&e instanceof RegExp&&!("flags"in c)?s.call(e):n);return"/"+t+"/"+r}),{unsafe:!0})},2626:function(e,t,n){"use strict";var r=n("d066"),i=n("9bf2"),o=n("b622"),s=n("83ab"),a=o("species");e.exports=function(e){var t=r(e),n=i.f;s&&t&&!t[a]&&n(t,a,{configurable:!0,get:function(){return this}})}},"2a62":function(e,t,n){var r=n("825a");e.exports=function(e){var t=e["return"];if(void 0!==t)return r(t.call(e)).value}},"2cf4":function(e,t,n){var r,i,o,s=n("da84"),a=n("d039"),c=n("0366"),u=n("1be4"),d=n("cc12"),l=n("1cdc"),h=n("605d"),f=s.location,p=s.setImmediate,g=s.clearImmediate,m=s.process,v=s.MessageChannel,_=s.Dispatch,y=0,E={},T="onreadystatechange",C=function(e){if(E.hasOwnProperty(e)){var t=E[e];delete E[e],t()}},R=function(e){return function(){C(e)}},S=function(e){C(e.data)},b=function(e){s.postMessage(e+"",f.protocol+"//"+f.host)};p&&g||(p=function(e){var t=[],n=1;while(arguments.length>n)t.push(arguments[n++]);return E[++y]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},r(y),y},g=function(e){delete E[e]},h?r=function(e){m.nextTick(R(e))}:_&&_.now?r=function(e){_.now(R(e))}:v&&!l?(i=new v,o=i.port2,i.port1.onmessage=S,r=c(o.postMessage,o,1)):s.addEventListener&&"function"==typeof postMessage&&!s.importScripts&&f&&"file:"!==f.protocol&&!a(b)?(r=b,s.addEventListener("message",S,!1)):r=T in d("script")?function(e){u.appendChild(d("script"))[T]=function(){u.removeChild(this),C(e)}}:function(e){setTimeout(R(e),0)}),e.exports={set:p,clear:g}},"2d00":function(e,t,n){var r,i,o=n("da84"),s=n("342f"),a=o.process,c=a&&a.versions,u=c&&c.v8;u?(r=u.split("."),i=r[0]<4?1:r[0]+r[1]):s&&(r=s.match(/Edge\/(\d+)/),(!r||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/),r&&(i=r[1]))),e.exports=i&&+i},"2d0d":function(e,t,n){n("4ae1");var r=n("36c6"),i=n("6f8f"),o=n("6b58");function s(e){var t=i();return function(){var n,i=r(e);if(t){var s=r(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return o(this,n)}}e.exports=s,e.exports["default"]=e.exports,e.exports.__esModule=!0},3410:function(e,t,n){var r=n("23e7"),i=n("d039"),o=n("7b0b"),s=n("e163"),a=n("e177"),c=i((function(){s(1)}));r({target:"Object",stat:!0,forced:c,sham:!a},{getPrototypeOf:function(e){return s(o(e))}})},"342f":function(e,t,n){var r=n("d066");e.exports=r("navigator","userAgent")||""},"35a1":function(e,t,n){var r=n("f5df"),i=n("3f8c"),o=n("b622"),s=o("iterator");e.exports=function(e){if(void 0!=e)return e[s]||e["@@iterator"]||i[r(e)]}},"36c6":function(e,t,n){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports["default"]=e.exports,e.exports.__esModule=!0,r(t)}n("3410"),e.exports=r,e.exports["default"]=e.exports,e.exports.__esModule=!0},"37e8":function(e,t,n){var r=n("83ab"),i=n("9bf2"),o=n("825a"),s=n("df75");e.exports=r?Object.defineProperties:function(e,t){o(e);var n,r=s(t),a=r.length,c=0;while(a>c)i.f(e,n=r[c++],t[n]);return e}},"3bbe":function(e,t,n){var r=n("861d");e.exports=function(e){if(!r(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},"3c96":function(e,t){function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}e.exports=n,e.exports["default"]=e.exports,e.exports.__esModule=!0},"3ca3":function(e,t,n){"use strict";var r=n("6547").charAt,i=n("69f3"),o=n("7dd0"),s="String Iterator",a=i.set,c=i.getterFor(s);o(String,"String",(function(e){a(this,{type:s,string:String(e),index:0})}),(function(){var e,t=c(this),n=t.string,i=t.index;return i>=n.length?{value:void 0,done:!0}:(e=r(n,i),t.index+=e.length,{value:e,done:!1})}))},"3f4e":function(e,t,n){"use strict";n.d(t,"setupDevtoolsPlugin",(function(){return o}));var r=n("abc5"),i=n("b774");function o(e,t){const n=Object(r["a"])();if(n)n.emit(i["a"],e,t);else{const n=Object(r["b"])(),i=n.__VUE_DEVTOOLS_PLUGINS__=n.__VUE_DEVTOOLS_PLUGINS__||[];i.push({pluginDescriptor:e,setupFn:t})}}},"3f8c":function(e,t){e.exports={}},"428f":function(e,t,n){var r=n("da84");e.exports=r},4362:function(e,t,n){t.nextTick=function(e){var t=Array.prototype.slice.call(arguments);t.shift(),setTimeout((function(){e.apply(null,t)}),0)},t.platform=t.arch=t.execPath=t.title="browser",t.pid=1,t.browser=!0,t.env={},t.argv=[],t.binding=function(e){throw new Error("No such module. (Possibly not yet loaded)")},function(){var e,r="/";t.cwd=function(){return r},t.chdir=function(t){e||(e=n("df7c")),r=e.resolve(t,r)}}(),t.exit=t.kill=t.umask=t.dlopen=t.uptime=t.memoryUsage=t.uvCounters=function(){},t.features={}},"448a":function(e,t,n){var r=n("2236"),i=n("11b0"),o=n("6613"),s=n("0676");function a(e){return r(e)||i(e)||o(e)||s()}e.exports=a,e.exports["default"]=e.exports,e.exports.__esModule=!0},"44ad":function(e,t,n){var r=n("d039"),i=n("c6b6"),o="".split;e.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?o.call(e,""):Object(e)}:Object},"44d2":function(e,t,n){var r=n("b622"),i=n("7c73"),o=n("9bf2"),s=r("unscopables"),a=Array.prototype;void 0==a[s]&&o.f(a,s,{configurable:!0,value:i(null)}),e.exports=function(e){a[s][e]=!0}},"44de":function(e,t,n){var r=n("da84");e.exports=function(e,t){var n=r.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}},"44e7":function(e,t,n){var r=n("861d"),i=n("c6b6"),o=n("b622"),s=o("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[s])?!!t:"RegExp"==i(e))}},"466d":function(e,t,n){"use strict";var r=n("d784"),i=n("825a"),o=n("50c4"),s=n("1d80"),a=n("8aa5"),c=n("14c3");r("match",1,(function(e,t,n){return[function(t){var n=s(this),r=void 0==t?void 0:t[e];return void 0!==r?r.call(t,n):new RegExp(t)[e](String(n))},function(e){var r=n(t,e,this);if(r.done)return r.value;var s=i(e),u=String(this);if(!s.global)return c(s,u);var d=s.unicode;s.lastIndex=0;var l,h=[],f=0;while(null!==(l=c(s,u))){var p=String(l[0]);h[f]=p,""===p&&(s.lastIndex=a(u,o(s.lastIndex),d)),f++}return 0===f?null:h}]}))},4840:function(e,t,n){var r=n("825a"),i=n("1c0b"),o=n("b622"),s=o("species");e.exports=function(e,t){var n,o=r(e).constructor;return void 0===o||void 0==(n=r(o)[s])?t:i(n)}},4930:function(e,t,n){var r=n("2d00"),i=n("d039");e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},"4a4b":function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports["default"]=e.exports,e.exports.__esModule=!0,n(t,r)}e.exports=n,e.exports["default"]=e.exports,e.exports.__esModule=!0},"4ae1":function(e,t,n){var r=n("23e7"),i=n("d066"),o=n("1c0b"),s=n("825a"),a=n("861d"),c=n("7c73"),u=n("0538"),d=n("d039"),l=i("Reflect","construct"),h=d((function(){function e(){}return!(l((function(){}),[],e)instanceof e)})),f=!d((function(){l((function(){}))})),p=h||f;r({target:"Reflect",stat:!0,forced:p,sham:p},{construct:function(e,t){o(e),s(t);var n=arguments.length<3?e:o(arguments[2]);if(f&&!h)return l(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(u.apply(e,r))}var i=n.prototype,d=c(a(i)?i:Object.prototype),p=Function.apply.call(e,d,t);return a(p)?p:d}})},"4d64":function(e,t,n){var r=n("fc6a"),i=n("50c4"),o=n("23cb"),s=function(e){return function(t,n,s){var a,c=r(t),u=i(c.length),d=o(s,u);if(e&&n!=n){while(u>d)if(a=c[d++],a!=a)return!0}else for(;u>d;d++)if((e||d in c)&&c[d]===n)return e||d||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},"4de4":function(e,t,n){"use strict";var r=n("23e7"),i=n("b727").filter,o=n("1dde"),s=o("filter");r({target:"Array",proto:!0,forced:!s},{filter:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(e,t,n){"use strict";var r=n("0366"),i=n("7b0b"),o=n("9bdd"),s=n("e95a"),a=n("50c4"),c=n("8418"),u=n("35a1");e.exports=function(e){var t,n,d,l,h,f,p=i(e),g="function"==typeof this?this:Array,m=arguments.length,v=m>1?arguments[1]:void 0,_=void 0!==v,y=u(p),E=0;if(_&&(v=r(v,m>2?arguments[2]:void 0,2)),void 0==y||g==Array&&s(y))for(t=a(p.length),n=new g(t);t>E;E++)f=_?v(p[E],E):p[E],c(n,E,f);else for(l=y.call(p),h=l.next,n=new g;!(d=h.call(l)).done;E++)f=_?o(l,v,[d.value,E],!0):d.value,c(n,E,f);return n.length=E,n}},"50c4":function(e,t,n){var r=n("a691"),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},5135:function(e,t,n){var r=n("7b0b"),i={}.hasOwnProperty;e.exports=Object.hasOwn||function(e,t){return i.call(r(e),t)}},5319:function(e,t,n){"use strict";var r=n("d784"),i=n("825a"),o=n("50c4"),s=n("a691"),a=n("1d80"),c=n("8aa5"),u=n("0cb2"),d=n("14c3"),l=Math.max,h=Math.min,f=function(e){return void 0===e?e:String(e)};r("replace",2,(function(e,t,n,r){var p=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,g=r.REPLACE_KEEPS_$0,m=p?"$":"$0";return[function(n,r){var i=a(this),o=void 0==n?void 0:n[e];return void 0!==o?o.call(n,i,r):t.call(String(i),n,r)},function(e,r){if(!p&&g||"string"===typeof r&&-1===r.indexOf(m)){var a=n(t,e,this,r);if(a.done)return a.value}var v=i(e),_=String(this),y="function"===typeof r;y||(r=String(r));var E=v.global;if(E){var T=v.unicode;v.lastIndex=0}var C=[];while(1){var R=d(v,_);if(null===R)break;if(C.push(R),!E)break;var S=String(R[0]);""===S&&(v.lastIndex=c(_,o(v.lastIndex),T))}for(var b="",I=0,O=0;O<C.length;O++){R=C[O];for(var w=String(R[0]),N=l(h(s(R.index),_.length),0),A=[],M=1;M<R.length;M++)A.push(f(R[M]));var P=R.groups;if(y){var k=[w].concat(A,N,_);void 0!==P&&k.push(P);var L=String(r.apply(void 0,k))}else L=u(w,_,N,A,P,r);N>=I&&(b+=_.slice(I,N)+L,I=N+w.length)}return b+_.slice(I)}]}))},5692:function(e,t,n){var r=n("c430"),i=n("c6cd");(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.14.0",mode:r?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},"56ef":function(e,t,n){var r=n("d066"),i=n("241c"),o=n("7418"),s=n("825a");e.exports=r("Reflect","ownKeys")||function(e){var t=i.f(s(e)),n=o.f;return n?t.concat(n(e)):t}},"5a34":function(e,t,n){var r=n("44e7");e.exports=function(e){if(r(e))throw TypeError("The method doesn't accept regular expressions");return e}},"5a43":function(e,t){function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.exports=n,e.exports["default"]=e.exports,e.exports.__esModule=!0},"5bc3":function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}e.exports=r,e.exports["default"]=e.exports,e.exports.__esModule=!0},"5c6c":function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},"605d":function(e,t,n){var r=n("c6b6"),i=n("da84");e.exports="process"==r(i.process)},6069:function(e,t){e.exports="object"==typeof window},"60da":function(e,t,n){"use strict";var r=n("83ab"),i=n("d039"),o=n("df75"),s=n("7418"),a=n("d1e7"),c=n("7b0b"),u=n("44ad"),d=Object.assign,l=Object.defineProperty;e.exports=!d||i((function(){if(r&&1!==d({b:1},d(l({},"a",{enumerable:!0,get:function(){l(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach((function(e){t[e]=e})),7!=d({},e)[n]||o(d({},t)).join("")!=i}))?function(e,t){var n=c(e),i=arguments.length,d=1,l=s.f,h=a.f;while(i>d){var f,p=u(arguments[d++]),g=l?o(p).concat(l(p)):o(p),m=g.length,v=0;while(m>v)f=g[v++],r&&!h.call(p,f)||(n[f]=p[f])}return n}:d},6547:function(e,t,n){var r=n("a691"),i=n("1d80"),o=function(e){return function(t,n){var o,s,a=String(i(t)),c=r(n),u=a.length;return c<0||c>=u?e?"":void 0:(o=a.charCodeAt(c),o<55296||o>56319||c+1===u||(s=a.charCodeAt(c+1))<56320||s>57343?e?a.charAt(c):o:e?a.slice(c,c+2):s-56320+(o-55296<<10)+65536)}};e.exports={codeAt:o(!1),charAt:o(!0)}},"65f0":function(e,t,n){var r=n("861d"),i=n("e8b5"),o=n("b622"),s=o("species");e.exports=function(e,t){var n;return i(e)&&(n=e.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)?r(n)&&(n=n[s],null===n&&(n=void 0)):n=void 0),new(void 0===n?Array:n)(0===t?0:t)}},6613:function(e,t,n){n("fb6a"),n("d3b7"),n("b0c0"),n("a630"),n("3ca3");var r=n("5a43");function i(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}e.exports=i,e.exports["default"]=e.exports,e.exports.__esModule=!0},"69f3":function(e,t,n){var r,i,o,s=n("7f9a"),a=n("da84"),c=n("861d"),u=n("9112"),d=n("5135"),l=n("c6cd"),h=n("f772"),f=n("d012"),p="Object already initialized",g=a.WeakMap,m=function(e){return o(e)?i(e):r(e,{})},v=function(e){return function(t){var n;if(!c(t)||(n=i(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}};if(s||l.state){var _=l.state||(l.state=new g),y=_.get,E=_.has,T=_.set;r=function(e,t){if(E.call(_,e))throw new TypeError(p);return t.facade=e,T.call(_,e,t),t},i=function(e){return y.call(_,e)||{}},o=function(e){return E.call(_,e)}}else{var C=h("state");f[C]=!0,r=function(e,t){if(d(e,C))throw new TypeError(p);return t.facade=e,u(e,C,t),t},i=function(e){return d(e,C)?e[C]:{}},o=function(e){return d(e,C)}}e.exports={set:r,get:i,has:o,enforce:m,getterFor:v}},"6b58":function(e,t,n){var r=n("7037")["default"],i=n("3c96");function o(e,t){return!t||"object"!==r(t)&&"function"!==typeof t?i(e):t}e.exports=o,e.exports["default"]=e.exports,e.exports.__esModule=!0},"6c02":function(e,t,n){"use strict";n.d(t,"a",(function(){return Xe})),n.d(t,"b",(function(){return Y}));var r=n("7a23");n("3f4e");
/*!
  * vue-router v4.0.9
  * (c) 2021 Eduardo San Martin Morote
  * @license MIT
  */
const i="function"===typeof Symbol&&"symbol"===typeof Symbol.toStringTag,o=e=>i?Symbol(e):"_vr_"+e,s=o("rvlm"),a=o("rvd"),c=o("r"),u=o("rl"),d=o("rvl"),l="undefined"!==typeof window;function h(e){return e.__esModule||i&&"Module"===e[Symbol.toStringTag]}const f=Object.assign;function p(e,t){const n={};for(const r in t){const i=t[r];n[r]=Array.isArray(i)?i.map(e):e(i)}return n}let g=()=>{};const m=/\/$/,v=e=>e.replace(m,"");function _(e,t,n="/"){let r,i={},o="",s="";const a=t.indexOf("?"),c=t.indexOf("#",a>-1?a:0);return a>-1&&(r=t.slice(0,a),o=t.slice(a+1,c>-1?c:t.length),i=e(o)),c>-1&&(r=r||t.slice(0,c),s=t.slice(c,t.length)),r=I(null!=r?r:t,n),{fullPath:r+(o&&"?")+o+s,path:r,query:i,hash:s}}function y(e,t){let n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function E(e,t){return t&&e.toLowerCase().startsWith(t.toLowerCase())?e.slice(t.length)||"/":e}function T(e,t,n){let r=t.matched.length-1,i=n.matched.length-1;return r>-1&&r===i&&C(t.matched[r],n.matched[i])&&R(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function C(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function R(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let n in e)if(!S(e[n],t[n]))return!1;return!0}function S(e,t){return Array.isArray(e)?b(e,t):Array.isArray(t)?b(t,e):e===t}function b(e,t){return Array.isArray(t)?e.length===t.length&&e.every((e,n)=>e===t[n]):1===e.length&&e[0]===t}function I(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),r=e.split("/");let i,o,s=n.length-1;for(i=0;i<r.length;i++)if(o=r[i],1!==s&&"."!==o){if(".."!==o)break;s--}return n.slice(0,s).join("/")+"/"+r.slice(i-(i===r.length?1:0)).join("/")}var O,w;(function(e){e["pop"]="pop",e["push"]="push"})(O||(O={})),function(e){e["back"]="back",e["forward"]="forward",e["unknown"]=""}(w||(w={}));function N(e){if(!e)if(l){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return"/"!==e[0]&&"#"!==e[0]&&(e="/"+e),v(e)}const A=/^[^#]+#/;function M(e,t){return e.replace(A,"#")+t}function P(e,t){const n=document.documentElement.getBoundingClientRect(),r=e.getBoundingClientRect();return{behavior:t.behavior,left:r.left-n.left-(t.left||0),top:r.top-n.top-(t.top||0)}}const k=()=>({left:window.pageXOffset,top:window.pageYOffset});function L(e){let t;if("el"in e){let n=e.el;const r="string"===typeof n&&n.startsWith("#");0;const i="string"===typeof n?r?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!i)return;t=P(i,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(null!=t.left?t.left:window.pageXOffset,null!=t.top?t.top:window.pageYOffset)}function x(e,t){const n=history.state?history.state.position-t:-1;return n+e}const U=new Map;function D(e,t){U.set(e,t)}function j(e){const t=U.get(e);return U.delete(e),t}let V=()=>location.protocol+"//"+location.host;function B(e,t){const{pathname:n,search:r,hash:i}=t,o=e.indexOf("#");if(o>-1){let t=i.includes(e.slice(o))?e.slice(o).length:1,n=i.slice(t);return"/"!==n[0]&&(n="/"+n),E(n,"")}const s=E(n,e);return s+r+i}function F(e,t,n,r){let i=[],o=[],s=null;const a=({state:o})=>{const a=B(e,location),c=n.value,u=t.value;let d=0;if(o){if(n.value=a,t.value=o,s&&s===c)return void(s=null);d=u?o.position-u.position:0}else r(a);i.forEach(e=>{e(n.value,c,{delta:d,type:O.pop,direction:d?d>0?w.forward:w.back:w.unknown})})};function c(){s=n.value}function u(e){i.push(e);const t=()=>{const t=i.indexOf(e);t>-1&&i.splice(t,1)};return o.push(t),t}function d(){const{history:e}=window;e.state&&e.replaceState(f({},e.state,{scroll:k()}),"")}function l(){for(const e of o)e();o=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",d)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",d),{pauseListeners:c,listen:u,destroy:l}}function H(e,t,n,r=!1,i=!1){return{back:e,current:t,forward:n,replaced:r,position:window.history.length,scroll:i?k():null}}function G(e){const{history:t,location:n}=window;let r={value:B(e,n)},i={value:t.state};function o(r,o,s){const a=e.indexOf("#"),c=a>-1?(n.host&&document.querySelector("base")?e:e.slice(a))+r:V()+e+r;try{t[s?"replaceState":"pushState"](o,"",c),i.value=o}catch(u){console.error(u),n[s?"replace":"assign"](c)}}function s(e,n){const s=f({},t.state,H(i.value.back,e,i.value.forward,!0),n,{position:i.value.position});o(e,s,!0),r.value=e}function a(e,n){const s=f({},i.value,t.state,{forward:e,scroll:k()});o(s.current,s,!0);const a=f({},H(r.value,e,null),{position:s.position+1},n);o(e,a,!1),r.value=e}return i.value||o(r.value,{back:null,current:r.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0),{location:r,state:i,push:a,replace:s}}function Y(e){e=N(e);const t=G(e),n=F(e,t.state,t.location,t.replace);function r(e,t=!0){t||n.pauseListeners(),history.go(e)}const i=f({location:"",base:e,go:r,createHref:M.bind(null,e)},t,n);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>t.state.value}),i}function q(e){return"string"===typeof e||e&&"object"===typeof e}function K(e){return"string"===typeof e||"symbol"===typeof e}const W={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},$=o("nf");var J;(function(e){e[e["aborted"]=4]="aborted",e[e["cancelled"]=8]="cancelled",e[e["duplicated"]=16]="duplicated"})(J||(J={}));function z(e,t){return f(new Error,{type:e,[$]:!0},t)}function Q(e,t){return e instanceof Error&&$ in e&&(null==t||!!(e.type&t))}const Z="[^/]+?",X={sensitive:!1,strict:!1,start:!0,end:!0},ee=/[.+*?^${}()[\]/\\]/g;function te(e,t){const n=f({},X,t);let r=[],i=n.start?"^":"";const o=[];for(const d of e){const e=d.length?[]:[90];n.strict&&!d.length&&(i+="/");for(let t=0;t<d.length;t++){const r=d[t];let s=40+(n.sensitive?.25:0);if(0===r.type)t||(i+="/"),i+=r.value.replace(ee,"\\$&"),s+=40;else if(1===r.type){const{value:e,repeatable:n,optional:a,regexp:c}=r;o.push({name:e,repeatable:n,optional:a});const l=c||Z;if(l!==Z){s+=10;try{new RegExp(`(${l})`)}catch(u){throw new Error(`Invalid custom RegExp for param "${e}" (${l}): `+u.message)}}let h=n?`((?:${l})(?:/(?:${l}))*)`:`(${l})`;t||(h=a&&d.length<2?`(?:/${h})`:"/"+h),a&&(h+="?"),i+=h,s+=20,a&&(s+=-8),n&&(s+=-20),".*"===l&&(s+=-50)}e.push(s)}r.push(e)}if(n.strict&&n.end){const e=r.length-1;r[e][r[e].length-1]+=.7000000000000001}n.strict||(i+="/?"),n.end?i+="$":n.strict&&(i+="(?:/|$)");const s=new RegExp(i,n.sensitive?"":"i");function a(e){const t=e.match(s),n={};if(!t)return null;for(let r=1;r<t.length;r++){const e=t[r]||"",i=o[r-1];n[i.name]=e&&i.repeatable?e.split("/"):e}return n}function c(t){let n="",r=!1;for(const i of e){r&&n.endsWith("/")||(n+="/"),r=!1;for(const e of i)if(0===e.type)n+=e.value;else if(1===e.type){const{value:o,repeatable:s,optional:a}=e,c=o in t?t[o]:"";if(Array.isArray(c)&&!s)throw new Error(`Provided param "${o}" is an array but it is not repeatable (* or + modifiers)`);const u=Array.isArray(c)?c.join("/"):c;if(!u){if(!a)throw new Error(`Missing required param "${o}"`);i.length<2&&(n.endsWith("/")?n=n.slice(0,-1):r=!0)}n+=u}}return n}return{re:s,score:r,keys:o,parse:a,stringify:c}}function ne(e,t){let n=0;while(n<e.length&&n<t.length){const r=t[n]-e[n];if(r)return r;n++}return e.length<t.length?1===e.length&&80===e[0]?-1:1:e.length>t.length?1===t.length&&80===t[0]?1:-1:0}function re(e,t){let n=0;const r=e.score,i=t.score;while(n<r.length&&n<i.length){const e=ne(r[n],i[n]);if(e)return e;n++}return i.length-r.length}const ie={type:0,value:""},oe=/[a-zA-Z0-9_]/;function se(e){if(!e)return[[]];if("/"===e)return[[ie]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(e){throw new Error(`ERR (${n})/"${u}": ${e}`)}let n=0,r=n;const i=[];let o;function s(){o&&i.push(o),o=[]}let a,c=0,u="",d="";function l(){u&&(0===n?o.push({type:0,value:u}):1===n||2===n||3===n?(o.length>1&&("*"===a||"+"===a)&&t(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),o.push({type:1,value:u,regexp:d,repeatable:"*"===a||"+"===a,optional:"*"===a||"?"===a})):t("Invalid state to consume buffer"),u="")}function h(){u+=a}while(c<e.length)if(a=e[c++],"\\"!==a||2===n)switch(n){case 0:"/"===a?(u&&l(),s()):":"===a?(l(),n=1):h();break;case 4:h(),n=r;break;case 1:"("===a?n=2:oe.test(a)?h():(l(),n=0,"*"!==a&&"?"!==a&&"+"!==a&&c--);break;case 2:")"===a?"\\"==d[d.length-1]?d=d.slice(0,-1)+a:n=3:d+=a;break;case 3:l(),n=0,"*"!==a&&"?"!==a&&"+"!==a&&c--,d="";break;default:t("Unknown state");break}else r=n,n=4;return 2===n&&t(`Unfinished custom RegExp for param "${u}"`),l(),s(),i}function ae(e,t,n){const r=te(se(e.path),n);const i=f(r,{record:e,parent:t,children:[],alias:[]});return t&&!i.record.aliasOf===!t.record.aliasOf&&t.children.push(i),i}function ce(e,t){const n=[],r=new Map;function i(e){return r.get(e)}function o(e,n,r){let i=!r,a=de(e);a.aliasOf=r&&r.record;const u=pe(t,e),d=[a];if("alias"in e){const t="string"===typeof e.alias?[e.alias]:e.alias;for(const e of t)d.push(f({},a,{components:r?r.record.components:a.components,path:e,aliasOf:r?r.record:a}))}let l,h;for(const t of d){let{path:d}=t;if(n&&"/"!==d[0]){let e=n.record.path,r="/"===e[e.length-1]?"":"/";t.path=n.record.path+(d&&r+d)}if(l=ae(t,n,u),r?r.alias.push(l):(h=h||l,h!==l&&h.alias.push(l),i&&e.name&&!he(l)&&s(e.name)),"children"in a){let e=a.children;for(let t=0;t<e.length;t++)o(e[t],l,r&&r.children[t])}r=r||l,c(l)}return h?()=>{s(h)}:g}function s(e){if(K(e)){const t=r.get(e);t&&(r.delete(e),n.splice(n.indexOf(t),1),t.children.forEach(s),t.alias.forEach(s))}else{let t=n.indexOf(e);t>-1&&(n.splice(t,1),e.record.name&&r.delete(e.record.name),e.children.forEach(s),e.alias.forEach(s))}}function a(){return n}function c(e){let t=0;while(t<n.length&&re(e,n[t])>=0)t++;n.splice(t,0,e),e.record.name&&!he(e)&&r.set(e.record.name,e)}function u(e,t){let i,o,s,a={};if("name"in e&&e.name){if(i=r.get(e.name),!i)throw z(1,{location:e});s=i.record.name,a=f(ue(t.params,i.keys.filter(e=>!e.optional).map(e=>e.name)),e.params),o=i.stringify(a)}else if("path"in e)o=e.path,i=n.find(e=>e.re.test(o)),i&&(a=i.parse(o),s=i.record.name);else{if(i=t.name?r.get(t.name):n.find(e=>e.re.test(t.path)),!i)throw z(1,{location:e,currentLocation:t});s=i.record.name,a=f({},t.params,e.params),o=i.stringify(a)}const c=[];let u=i;while(u)c.unshift(u.record),u=u.parent;return{name:s,path:o,params:a,matched:c,meta:fe(c)}}return t=pe({strict:!1,end:!0,sensitive:!1},t),e.forEach(e=>o(e)),{addRoute:o,resolve:u,removeRoute:s,getRoutes:a,getRecordMatcher:i}}function ue(e,t){let n={};for(let r of t)r in e&&(n[r]=e[r]);return n}function de(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:le(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||{}:{default:e.component}}}function le(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(let r in e.components)t[r]="boolean"===typeof n?n:n[r];return t}function he(e){while(e){if(e.record.aliasOf)return!0;e=e.parent}return!1}function fe(e){return e.reduce((e,t)=>f(e,t.meta),{})}function pe(e,t){let n={};for(let r in e)n[r]=r in t?t[r]:e[r];return n}const ge=/#/g,me=/&/g,ve=/\//g,_e=/=/g,ye=/\?/g,Ee=/\+/g,Te=/%5B/g,Ce=/%5D/g,Re=/%5E/g,Se=/%60/g,be=/%7B/g,Ie=/%7C/g,Oe=/%7D/g,we=/%20/g;function Ne(e){return encodeURI(""+e).replace(Ie,"|").replace(Te,"[").replace(Ce,"]")}function Ae(e){return Ne(e).replace(be,"{").replace(Oe,"}").replace(Re,"^")}function Me(e){return Ne(e).replace(Ee,"%2B").replace(we,"+").replace(ge,"%23").replace(me,"%26").replace(Se,"`").replace(be,"{").replace(Oe,"}").replace(Re,"^")}function Pe(e){return Me(e).replace(_e,"%3D")}function ke(e){return Ne(e).replace(ge,"%23").replace(ye,"%3F")}function Le(e){return ke(e).replace(ve,"%2F")}function xe(e){try{return decodeURIComponent(""+e)}catch(t){}return""+e}function Ue(e){const t={};if(""===e||"?"===e)return t;const n="?"===e[0],r=(n?e.slice(1):e).split("&");for(let i=0;i<r.length;++i){const e=r[i].replace(Ee," ");let n=e.indexOf("="),o=xe(n<0?e:e.slice(0,n)),s=n<0?null:xe(e.slice(n+1));if(o in t){let e=t[o];Array.isArray(e)||(e=t[o]=[e]),e.push(s)}else t[o]=s}return t}function De(e){let t="";for(let n in e){const r=e[n];if(n=Pe(n),null==r){void 0!==r&&(t+=(t.length?"&":"")+n);continue}let i=Array.isArray(r)?r.map(e=>e&&Me(e)):[r&&Me(r)];i.forEach(e=>{void 0!==e&&(t+=(t.length?"&":"")+n,null!=e&&(t+="="+e))})}return t}function je(e){const t={};for(let n in e){let r=e[n];void 0!==r&&(t[n]=Array.isArray(r)?r.map(e=>null==e?null:""+e):null==r?r:""+r)}return t}function Ve(){let e=[];function t(t){return e.push(t),()=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)}}function n(){e=[]}return{add:t,list:()=>e,reset:n}}function Be(e,t,n,r,i){const o=r&&(r.enterCallbacks[i]=r.enterCallbacks[i]||[]);return()=>new Promise((s,a)=>{const c=e=>{!1===e?a(z(4,{from:n,to:t})):e instanceof Error?a(e):q(e)?a(z(2,{from:t,to:e})):(o&&r.enterCallbacks[i]===o&&"function"===typeof e&&o.push(e),s())},u=e.call(r&&r.instances[i],t,n,c);let d=Promise.resolve(u);e.length<3&&(d=d.then(c)),d.catch(e=>a(e))})}function Fe(e,t,n,r){const i=[];for(const o of e)for(const e in o.components){let s=o.components[e];if("beforeRouteEnter"===t||o.instances[e])if(He(s)){let a=s.__vccOpts||s;const c=a[t];c&&i.push(Be(c,n,r,o,e))}else{let a=s();0,i.push(()=>a.then(i=>{if(!i)return Promise.reject(new Error(`Couldn't resolve component "${e}" at "${o.path}"`));const s=h(i)?i.default:i;o.components[e]=s;let a=s.__vccOpts||s;const c=a[t];return c&&Be(c,n,r,o,e)()}))}}return i}function He(e){return"object"===typeof e||"displayName"in e||"props"in e||"__vccOpts"in e}function Ge(e){const t=Object(r["j"])(c),n=Object(r["j"])(u),i=Object(r["a"])(()=>t.resolve(Object(r["u"])(e.to))),o=Object(r["a"])(()=>{let{matched:e}=i.value,{length:t}=e;const r=e[t-1];let o=n.matched;if(!r||!o.length)return-1;let s=o.findIndex(C.bind(null,r));if(s>-1)return s;let a=$e(e[t-2]);return t>1&&$e(r)===a&&o[o.length-1].path!==a?o.findIndex(C.bind(null,e[t-2])):s}),s=Object(r["a"])(()=>o.value>-1&&We(n.params,i.value.params)),a=Object(r["a"])(()=>o.value>-1&&o.value===n.matched.length-1&&R(n.params,i.value.params));function d(n={}){return Ke(n)?t[Object(r["u"])(e.replace)?"replace":"push"](Object(r["u"])(e.to)).catch(g):Promise.resolve()}return{route:i,href:Object(r["a"])(()=>i.value.href),isActive:s,isExactActive:a,navigate:d}}const Ye=Object(r["g"])({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},setup(e,{slots:t}){const n=Object(r["q"])(Ge(e)),{options:i}=Object(r["j"])(c),o=Object(r["a"])(()=>({[Je(e.activeClass,i.linkActiveClass,"router-link-active")]:n.isActive,[Je(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=t.default&&t.default(n);return e.custom?i:Object(r["i"])("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:o.value},i)}}}),qe=Ye;function Ke(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&(void 0===e.button||0===e.button)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function We(e,t){for(let n in t){let r=t[n],i=e[n];if("string"===typeof r){if(r!==i)return!1}else if(!Array.isArray(i)||i.length!==r.length||r.some((e,t)=>e!==i[t]))return!1}return!0}function $e(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Je=(e,t,n)=>null!=e?e:null!=t?t:n,ze=Object(r["g"])({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},setup(e,{attrs:t,slots:n}){const i=Object(r["j"])(d),o=Object(r["a"])(()=>e.route||i.value),c=Object(r["j"])(a,0),u=Object(r["a"])(()=>o.value.matched[c]);Object(r["p"])(a,c+1),Object(r["p"])(s,u),Object(r["p"])(d,o);const l=Object(r["r"])();return Object(r["v"])(()=>[l.value,u.value,e.name],([e,t,n],[r,i,o])=>{t&&(t.instances[n]=e,i&&i!==t&&e&&e===r&&(t.leaveGuards.size||(t.leaveGuards=i.leaveGuards),t.updateGuards.size||(t.updateGuards=i.updateGuards))),!e||!t||i&&C(t,i)&&r||(t.enterCallbacks[n]||[]).forEach(t=>t(e))},{flush:"post"}),()=>{const i=o.value,s=u.value,a=s&&s.components[e.name],c=e.name;if(!a)return Qe(n.default,{Component:a,route:i});const d=s.props[e.name],h=d?!0===d?i.params:"function"===typeof d?d(i):d:null,p=e=>{e.component.isUnmounted&&(s.instances[c]=null)},g=Object(r["i"])(a,f({},h,t,{onVnodeUnmounted:p,ref:l}));return Qe(n.default,{Component:g,route:i})||g}}});function Qe(e,t){if(!e)return null;const n=e(t);return 1===n.length?n[0]:n}const Ze=ze;function Xe(e){const t=ce(e.routes,e);let n=e.parseQuery||Ue,i=e.stringifyQuery||De,o=e.history;const s=Ve(),a=Ve(),h=Ve(),m=Object(r["t"])(W);let v=W;l&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const E=p.bind(null,e=>""+e),C=p.bind(null,Le),R=p.bind(null,xe);function S(e,n){let r,i;return K(e)?(r=t.getRecordMatcher(e),i=n):i=e,t.addRoute(i,r)}function b(e){let n=t.getRecordMatcher(e);n&&t.removeRoute(n)}function I(){return t.getRoutes().map(e=>e.record)}function w(e){return!!t.getRecordMatcher(e)}function N(e,r){if(r=f({},r||m.value),"string"===typeof e){let i=_(n,e,r.path),s=t.resolve({path:i.path},r),a=o.createHref(i.fullPath);return f(i,s,{params:R(s.params),hash:xe(i.hash),redirectedFrom:void 0,href:a})}let s;"path"in e?s=f({},e,{path:_(n,e.path,r.path).path}):(s=f({},e,{params:C(e.params)}),r.params=C(r.params));let a=t.resolve(s,r);const c=e.hash||"";a.params=E(R(a.params));const u=y(i,f({},e,{hash:Ae(c),path:a.path}));let d=o.createHref(u);return f({fullPath:u,hash:c,query:i===De?je(e.query):e.query},a,{redirectedFrom:void 0,href:d})}function A(e){return"string"===typeof e?_(n,e,m.value.path):f({},e)}function M(e,t){if(v!==e)return z(8,{from:t,to:e})}function P(e){return B(e)}function U(e){return P(f(A(e),{replace:!0}))}function V(e){const t=e.matched[e.matched.length-1];if(t&&t.redirect){const{redirect:n}=t;let r="function"===typeof n?n(e):n;return"string"===typeof r&&(r=r.includes("?")||r.includes("#")?r=A(r):{path:r},r.params={}),f({query:e.query,hash:e.hash,params:e.params},r)}}function B(e,t){const n=v=N(e),r=m.value,o=e.state,s=e.force,a=!0===e.replace,c=V(n);if(c)return B(f(A(c),{state:o,force:s,replace:a}),t||n);const u=n;let d;return u.redirectedFrom=t,!s&&T(i,r,n)&&(d=z(16,{to:u,from:r}),re(r,r,!0,!1)),(d?Promise.resolve(d):H(u,r)).catch(e=>Q(e)?e:ee(e,u,r)).then(e=>{if(e){if(Q(e,2))return B(f(A(e.to),{state:o,force:s,replace:a}),t||u)}else e=Y(u,r,!0,a,o);return G(u,r,e),e})}function F(e,t){const n=M(e,t);return n?Promise.reject(n):Promise.resolve()}function H(e,t){let n;const[r,i,o]=tt(e,t);n=Fe(r.reverse(),"beforeRouteLeave",e,t);for(const s of r)s.leaveGuards.forEach(r=>{n.push(Be(r,e,t))});const c=F.bind(null,e,t);return n.push(c),et(n).then(()=>{n=[];for(const r of s.list())n.push(Be(r,e,t));return n.push(c),et(n)}).then(()=>{n=Fe(i,"beforeRouteUpdate",e,t);for(const r of i)r.updateGuards.forEach(r=>{n.push(Be(r,e,t))});return n.push(c),et(n)}).then(()=>{n=[];for(const r of e.matched)if(r.beforeEnter&&!t.matched.includes(r))if(Array.isArray(r.beforeEnter))for(const i of r.beforeEnter)n.push(Be(i,e,t));else n.push(Be(r.beforeEnter,e,t));return n.push(c),et(n)}).then(()=>(e.matched.forEach(e=>e.enterCallbacks={}),n=Fe(o,"beforeRouteEnter",e,t),n.push(c),et(n))).then(()=>{n=[];for(const r of a.list())n.push(Be(r,e,t));return n.push(c),et(n)}).catch(e=>Q(e,8)?e:Promise.reject(e))}function G(e,t,n){for(const r of h.list())r(e,t,n)}function Y(e,t,n,r,i){const s=M(e,t);if(s)return s;const a=t===W,c=l?history.state:{};n&&(r||a?o.replace(e.fullPath,f({scroll:a&&c&&c.scroll},i)):o.push(e.fullPath,i)),m.value=e,re(e,t,n,a),ne()}let q;function $(){q=o.listen((e,t,n)=>{let r=N(e);const i=V(r);if(i)return void B(f(i,{replace:!0}),r).catch(g);v=r;const s=m.value;l&&D(x(s.fullPath,n.delta),k()),H(r,s).catch(e=>Q(e,12)?e:Q(e,2)?(B(e.to,r).then(e=>{Q(e,20)&&!n.delta&&n.type===O.pop&&o.go(-1,!1)}).catch(g),Promise.reject()):(n.delta&&o.go(-n.delta,!1),ee(e,r,s))).then(e=>{e=e||Y(r,s,!1),e&&(n.delta?o.go(-n.delta,!1):n.type===O.pop&&Q(e,20)&&o.go(-1,!1)),G(r,s,e)}).catch(g)})}let J,Z=Ve(),X=Ve();function ee(e,t,n){ne(e);const r=X.list();return r.length?r.forEach(r=>r(e,t,n)):console.error(e),Promise.reject(e)}function te(){return J&&m.value!==W?Promise.resolve():new Promise((e,t)=>{Z.add([e,t])})}function ne(e){J||(J=!0,$(),Z.list().forEach(([t,n])=>e?n(e):t()),Z.reset())}function re(t,n,i,o){const{scrollBehavior:s}=e;if(!l||!s)return Promise.resolve();let a=!i&&j(x(t.fullPath,0))||(o||!i)&&history.state&&history.state.scroll||null;return Object(r["k"])().then(()=>s(t,n,a)).then(e=>e&&L(e)).catch(e=>ee(e,t,n))}const ie=e=>o.go(e);let oe;const se=new Set,ae={currentRoute:m,addRoute:S,removeRoute:b,hasRoute:w,getRoutes:I,resolve:N,options:e,push:P,replace:U,go:ie,back:()=>ie(-1),forward:()=>ie(1),beforeEach:s.add,beforeResolve:a.add,afterEach:h.add,onError:X.add,isReady:te,install(e){const t=this;e.component("RouterLink",qe),e.component("RouterView",Ze),e.config.globalProperties.$router=t,Object.defineProperty(e.config.globalProperties,"$route",{enumerable:!0,get:()=>Object(r["u"])(m)}),l&&!oe&&m.value===W&&(oe=!0,P(o.location).catch(e=>{0}));const n={};for(let o in W)n[o]=Object(r["a"])(()=>m.value[o]);e.provide(c,t),e.provide(u,Object(r["q"])(n)),e.provide(d,m);let i=e.unmount;se.add(e),e.unmount=function(){se.delete(e),se.size<1&&(q(),m.value=W,oe=!1,J=!1),i()}}};return ae}function et(e){return e.reduce((e,t)=>e.then(()=>t()),Promise.resolve())}function tt(e,t){const n=[],r=[],i=[],o=Math.max(t.matched.length,e.matched.length);for(let s=0;s<o;s++){const o=t.matched[s];o&&(e.matched.find(e=>C(e,o))?r.push(o):n.push(o));const a=e.matched[s];a&&(t.matched.find(e=>C(e,a))||i.push(a))}return[n,r,i]}},"6c57":function(e,t,n){var r=n("23e7"),i=n("da84");r({global:!0},{globalThis:i})},"6eeb":function(e,t,n){var r=n("da84"),i=n("9112"),o=n("5135"),s=n("ce4e"),a=n("8925"),c=n("69f3"),u=c.get,d=c.enforce,l=String(String).split("String");(e.exports=function(e,t,n,a){var c,u=!!a&&!!a.unsafe,h=!!a&&!!a.enumerable,f=!!a&&!!a.noTargetGet;"function"==typeof n&&("string"!=typeof t||o(n,"name")||i(n,"name",t),c=d(n),c.source||(c.source=l.join("string"==typeof t?t:""))),e!==r?(u?!f&&e[t]&&(h=!0):delete e[t],h?e[t]=n:i(e,t,n)):h?e[t]=n:s(t,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&u(this).source||a(this)}))},"6f8f":function(e,t,n){function r(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}n("4ae1"),e.exports=r,e.exports["default"]=e.exports,e.exports.__esModule=!0},7037:function(e,t,n){function r(t){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?(e.exports=r=function(e){return typeof e},e.exports["default"]=e.exports,e.exports.__esModule=!0):(e.exports=r=function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports["default"]=e.exports,e.exports.__esModule=!0),r(t)}n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),e.exports=r,e.exports["default"]=e.exports,e.exports.__esModule=!0},"703a":function(e,t,n){"use strict";n.r(t),n.d(t,"BackgroundPictureFillMode",(function(){return kt})),n.d(t,"MixLayoutMode",(function(){return Lt})),n.d(t,"MixVideoRenderMode",(function(){return xt})),n.d(t,"RCAbstractRoom",(function(){return Pt})),n.d(t,"RCAudienceClient",(function(){return Gt})),n.d(t,"RCAudienceLivingRoom",(function(){return qt})),n.d(t,"RCCameraVideoTrack",(function(){return at})),n.d(t,"RCFrameRate",(function(){return Se})),n.d(t,"RCLivingRoom",(function(){return jt})),n.d(t,"RCLivingType",(function(){return Ht})),n.d(t,"RCLocalAudioTrack",(function(){return tt})),n.d(t,"RCLocalFileAudioTrack",(function(){return ot})),n.d(t,"RCLocalFileTrack",(function(){return rt})),n.d(t,"RCLocalFileVideoTrack",(function(){return it})),n.d(t,"RCLocalTrack",(function(){return et})),n.d(t,"RCLocalVideoTrack",(function(){return nt})),n.d(t,"RCMCUConfigBuilder",(function(){return Dt})),n.d(t,"RCMediaType",(function(){return ft})),n.d(t,"RCMicphoneAudioTrack",(function(){return st})),n.d(t,"RCRTCClient",(function(){return Wt})),n.d(t,"RCRTCCode",(function(){return s})),n.d(t,"RCRTCRoom",(function(){return Vt})),n.d(t,"RCRemoteAudioTrack",(function(){return wt})),n.d(t,"RCRemoteTrack",(function(){return Ot})),n.d(t,"RCRemoteVideoTrack",(function(){return Nt})),n.d(t,"RCResolution",(function(){return be})),n.d(t,"RCScreenVideoTrack",(function(){return ct})),n.d(t,"RCTag",(function(){return zt})),n.d(t,"RCTrack",(function(){return Xe})),n.d(t,"device",(function(){return $t})),n.d(t,"helper",(function(){return Qt})),n.d(t,"installer",(function(){return Jt}));var r=n("78b2");
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function i(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}const o=new r["Logger"]("RCRTC");var s;!function(e){e[e.SUCCESS=1e4]="SUCCESS",e[e.SIGNAL_DISCONNECTED=5e4]="SIGNAL_DISCONNECTED",e[e.PARAMS_ERROR=50001]="PARAMS_ERROR",e[e.REPERT_JOIN_ROOM=50002]="REPERT_JOIN_ROOM",e[e.NOT_IN_ROOM=50003]="NOT_IN_ROOM",e[e.SERVICE_INVALID=50004]="SERVICE_INVALID",e[e.RTC_TOKEN_INVALID=50006]="RTC_TOKEN_INVALID",e[e.SIGNAL_ERROR=53001]="SIGNAL_ERROR",e[e.CREATE_OFFER_FAILED=53003]="CREATE_OFFER_FAILED",e[e.REQUEST_FAILED=53004]="REQUEST_FAILED",e[e.MCU_SERVER_NOT_FOUND=53005]="MCU_SERVER_NOT_FOUND",e[e.BROADCAST_SUB_LIST_NOT_EMPTY=53007]="BROADCAST_SUB_LIST_NOT_EMPTY",e[e.ROOM_HAS_BEEN_DESTROYED=53008]="ROOM_HAS_BEEN_DESTROYED",e[e.NOT_OPEN_VIDEO_AUDIO_SERVER=53009]="NOT_OPEN_VIDEO_AUDIO_SERVER",e[e.GET_USER_MEDIA_FAILED=53010]="GET_USER_MEDIA_FAILED",e[e.GET_DISPLAY_MEDIA_FAILED=53011]="GET_DISPLAY_MEDIA_FAILED",e[e.PERMISSION_DENIED=53012]="PERMISSION_DENIED",e[e.CREATE_CUSTOM_TRACK_FAILED=53013]="CREATE_CUSTOM_TRACK_FAILED",e[e.INVALID_TAGS=53014]="INVALID_TAGS",e[e.INVALID_USER_ID=53015]="INVALID_USER_ID",e[e.CREATE_FILE_TRACK_FAILED=53016]="CREATE_FILE_TRACK_FAILED",e[e.INVALID_FILE_INSTANCE=53017]="INVALID_FILE_INSTANCE",e[e.SET_REMOTE_DESCRIPTION_FAILED=53018]="SET_REMOTE_DESCRIPTION_FAILED",e[e.BROWSER_NOT_SUPPORT=53019]="BROWSER_NOT_SUPPORT",e[e.TRACK_NOT_READY=53020]="TRACK_NOT_READY",e[e.VIDEO_TRACK_MISS_MEDIA_ELEMENT=53021]="VIDEO_TRACK_MISS_MEDIA_ELEMENT",e[e.TRACK_PLAY_ERROR=53022]="TRACK_PLAY_ERROR",e[e.SIGNAL_AUDIENCE_JOIN_ROOM_FAILED=53023]="SIGNAL_AUDIENCE_JOIN_ROOM_FAILED",e[e.SIGNAL_ROOM_CHANGE_IDENTITY_FAILED=53024]="SIGNAL_ROOM_CHANGE_IDENTITY_FAILED"}(s||(s={}));const a=[];let c=!1;const u=()=>i(void 0,void 0,void 0,(function*(){if(0===a.length||c)return;c=!0;const{resolve:e,task:t,reject:n}=a.shift();let r;try{r=yield t(),e(r)}catch(e){n(e)}c=!1,u()})),d=e=>{const t=new Promise((t,n)=>{a.push({resolve:t,task:e,reject:n})});return u(),t};let l=!0,h=!0;function f(e,t,n){const r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function p(e,t,n){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);const o=e=>{const t=n(e);t&&(r.handleEvent?r.handleEvent(t):r(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(r,o),i.apply(this,[e,o])};const o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(n))return o.apply(this,arguments);const r=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function g(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(l=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function m(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(h=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function v(){if("object"==typeof window){if(l)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function _(e,t){h&&console.warn(e+" is deprecated, please use "+t+" instead.")}function y(e){return"[object Object]"===Object.prototype.toString.call(e)}function E(e){return y(e)?Object.keys(e).reduce((function(t,n){const r=y(e[n]),i=r?E(e[n]):e[n],o=r&&!Object.keys(i).length;return void 0===i||o?t:Object.assign(t,{[n]:i})}),{}):e}function T(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach(r=>{r.endsWith("Id")?T(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach(t=>{T(e,e.get(t),n)})}))}function C(e,t,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;const o=[];return e.forEach(e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)}),o.forEach(t=>{e.forEach(n=>{n.type===r&&n.trackId===t.id&&T(e,n,i)})}),i}const R=v;function S(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const r=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach(n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);const i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];let e={};"number"==typeof r.ideal?(e[i("min",n)]=r.ideal,t.optional.push(e),e={},e[i("max",n)]=r.ideal,t.optional.push(e)):(e[i("",n)]=r.ideal,t.optional.push(e))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach(e=>{void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])})}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"==typeof e.video){let o=e.video.facingMode;o=o&&("object"==typeof o?o:{ideal:o});const s=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||s)){let t;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?t=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then(n=>{let s=(n=n.filter(e=>"videoinput"===e.kind)).find(e=>t.some(t=>e.label.toLowerCase().includes(t)));return!s&&n.length&&t.includes("back")&&(s=n[n.length-1]),s&&(e.video.deviceId=o.exact?{exact:s.deviceId}:{ideal:s.deviceId}),e.video=r(e.video),R("chrome: "+JSON.stringify(e)),i(e)})}e.video=r(e.video)}return R("chrome: "+JSON.stringify(e)),i(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,r){i(e,e=>{n.webkitGetUserMedia(e,t,e=>{r&&r(o(e))})})}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return i(t,t=>e(t).then(e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(e=>{e.stop()}),new DOMException("","NotFoundError");return e},e=>Promise.reject(o(e))))}}}function b(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function I(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.track.id):{track:n.track};const i=new Event("track");i.track=n.track,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)}),t.stream.getTracks().forEach(n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.id):{track:n};const i=new Event("track");i.track=n,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else p(e,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function O(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){let i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach(e=>{this._senders.push(t(this,e))})};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],r.apply(this,[e]),e.getTracks().forEach(e=>{const t=this._senders.find(t=>t.track===e);t&&this._senders.splice(this._senders.indexOf(t),1)})}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function w(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,r]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const i=function(e){const t={};return e.result().forEach(e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(t=>{n[t]=e.stat(t)}),t[n.id]=n}),t},o=function(e){return new Map(Object.keys(e).map(t=>[t,e[t]]))};if(arguments.length>=2){const r=function(e){n(o(i(e)))};return t.apply(this,[r,e])}return new Promise((e,n)=>{t.apply(this,[function(t){e(o(i(t)))},n])}).then(n,r)}}function N(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>C(t,e.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),p(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>C(t,e.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,r;return this.getSenders().forEach(n=>{n.track===e&&(t?r=!0:t=n)}),this.getReceivers().forEach(t=>(t.track===e&&(n?r=!0:n=t),t.track===e)),r||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function A(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(e=>this._shimmedLocalStreams[e][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")});const t=this.getSenders();n.apply(this,arguments);const r=this.getSenders().filter(e=>-1===t.indexOf(e));this._shimmedLocalStreams[e.id]=[e].concat(r)};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]}),i.apply(this,arguments)}}function M(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return A(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(e=>this._reverseStreams[e.id])};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}r.apply(this,[t])};const i=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)}),new RTCSessionDescription({type:t.type,sdp:n})}function s(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find(e=>e===t))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const i=this.getSenders().find(e=>e.track===t);if(i)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const o=this._streams[n.id];if(o)o.addTrack(t),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const r=new e.MediaStream([t]);this._streams[n.id]=r,this._reverseStreams[r.id]=n,this.addStream(r)}return this.getSenders().find(e=>e.track===t)},["createOffer","createAnswer"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[t=>{const n=o(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then(e=>o(this,e))}};e.RTCPeerConnection.prototype[t]=r[t]}));const a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=s(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};const c=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=c.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach(n=>{this._streams[n].getTracks().find(t=>e.track===t)&&(t=this._streams[n])}),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function P(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}))}function k(e,t){p(e,"negotiationneeded",e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e})}var L,x=Object.freeze({__proto__:null,shimMediaStream:b,shimOnTrack:I,shimGetSendersWithDtmf:O,shimGetStats:w,shimSenderReceiverGetStats:N,shimAddTrackRemoveTrackWithNative:A,shimAddTrackRemoveTrack:M,shimPeerConnection:P,fixNegotiationNeeded:k,shimGetUserMedia:S,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then(t=>{const r=n.video&&n.video.width,i=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}}),U=(function(e){var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},t.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},t.getDescription=function(e){var n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){var n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((function(e){return 0===e.indexOf(n)}))},t.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},t.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},t.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},t.getMid=function(e){var n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){var r=t.matchPrefix(e+n,"a=ice-ufrag:")[0],i=t.matchPrefix(e+n,"a=ice-pwd:")[0];return r&&i?{usernameFragment:r.substr(12),password:i.substr(10)}:null},t.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},t.parseRtpParameters=function(e){for(var n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=t.splitLines(e)[0].split(" "),i=3;i<r.length;i++){var o=r[i],s=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(s){var a=t.parseRtpMap(s),c=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(a.parameters=c.length?t.parseFmtp(c[0]):{},a.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),n.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(a.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach((function(e){n.headerExtensions.push(t.parseExtmap(e))})),n},t.writeRtpDescription=function(e,n){var r="";r+="m="+e+" ",r+=n.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=n.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((function(e){r+=t.writeRtpMap(e),r+=t.writeFmtp(e),r+=t.writeRtcpFb(e)}));var i=0;return n.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(r+="a=maxptime:"+i+"\r\n"),r+="a=rtcp-mux\r\n",n.headerExtensions&&n.headerExtensions.forEach((function(e){r+=t.writeExtmap(e)})),r},t.parseRtpEncodingParameters=function(e){var n,r=[],i=t.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),s=-1!==i.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=a.length>0&&a[0].ssrc,u=t.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));u.length>0&&u[0].length>1&&u[0][0]===c&&(n=u[0][1]),i.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&n&&(t.rtx={ssrc:n}),r.push(t),o&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},r.push(t))}})),0===r.length&&c&&r.push({ssrc:c});var d=t.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?parseInt(d[0].substr(7),10):0===d[0].indexOf("b=AS:")?1e3*parseInt(d[0].substr(5),10)*.95-16e3:void 0,r.forEach((function(e){e.maxBitrate=d}))),r},t.parseRtcpParameters=function(e){var n={},r=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];r&&(n.cname=r.value,n.ssrc=r.ssrc);var i=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=i.length>0,n.compound=0===i.length;var o=t.matchPrefix(e,"a=rtcp-mux");return n.mux=o.length>0,n},t.parseMsid=function(e){var n,r=t.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(n=r[0].substr(7).split(" "))[0],track:n[1]};var i=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return i.length>0?{stream:(n=i[0].value.split(" "))[0],track:n[1]}:void 0},t.parseSctpDescription=function(e){var n,r=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");i.length>0&&(n=parseInt(i[0].substr(19),10)),isNaN(n)&&(n=65536);var o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:r.fmt,maxMessageSize:n};if(t.matchPrefix(e,"a=sctpmap:").length>0){var s=t.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:n}}},t.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,n,r){var i=void 0!==n?n:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.writeMediaSection=function(e,n,r,i){var o=t.writeRtpDescription(e.kind,n);if(o+=t.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=t.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var s="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+s,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+t.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+t.localCName+"\r\n"),o},t.getDirection=function(e,n){for(var r=t.splitLines(e),i=0;i<r.length;i++)switch(r[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[i].substr(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var n=t.splitLines(e)[0].substr(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){var n=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var n=t.splitLines(e),r=0;r<n.length;r++)if(n[r].length<2||"="!==n[r].charAt(1))return!1;return!0},e.exports=t}(L={exports:{}},L.exports),L.exports);function D(e,t,n,r,i){var o=U.writeRtpDescription(e.kind,t);if(o+=U.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=U.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":i||"active"),o+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var a="msid:"+(r?r.id:"-")+" "+s+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+U.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+U.localCName+"\r\n"),o}function j(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){var o=r(e.parameters.apt,n),s=r(t.parameters.apt,i);return o&&s&&o.name.toLowerCase()===s.name.toLowerCase()};return e.codecs.forEach((function(r){for(var o=0;o<t.codecs.length;o++){var s=t.codecs[o];if(r.name.toLowerCase()===s.name.toLowerCase()&&r.clockRate===s.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&s.parameters.apt&&!i(r,s,e.codecs,t.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(r.numChannels,s.numChannels),n.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter((function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}})),n}function V(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function B(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function F(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}var H=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function r(t,n,r,i){var o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=i,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var i=function(n){var r=this,i=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){r[e]=i[e].bind(i)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw F("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)})),delete e.url,e.urls=i?r[0]:r,!!r.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var o=n.iceCandidatePoolSize;o>0;o--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=U.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(i.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(i.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),i.prototype.onicecandidate=null,i.prototype.onaddstream=null,i.prototype.ontrack=null,i.prototype.onremovestream=null,i.prototype.onsignalingstatechange=null,i.prototype.oniceconnectionstatechange=null,i.prototype.onconnectionstatechange=null,i.prototype.onicegatheringstatechange=null,i.prototype.onnegotiationneeded=null,i.prototype.ondatachannel=null,i.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},i.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},i.prototype.getConfiguration=function(){return this._config},i.prototype.getLocalStreams=function(){return this.localStreams},i.prototype.getRemoteStreams=function(){return this.remoteStreams},i.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(r),r},i.prototype.addTrack=function(t,n){if(this._isClosed)throw F("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find((function(e){return e.track===t})))throw F("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},i.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var r=e.clone();e.getTracks().forEach((function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),r.getTracks().forEach((function(e){n.addTrack(e,r)}))}},i.prototype.removeTrack=function(t){if(this._isClosed)throw F("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw F("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},i.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},i.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},i.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},i.prototype._createIceGatherer=function(t,n){var r=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;i.state=n?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},i.prototype._gather=function(t,n){var r=this,i=this.transceivers[n].iceGatherer;if(!i.onlocalcandidate){var o=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,i.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),i.onlocalcandidate=function(e){if(!(r.usingBundle&&n>0)){var o=new Event("icecandidate");o.candidate={sdpMid:t,sdpMLineIndex:n};var s=e.candidate,a=!s||0===Object.keys(s).length;if(a)"new"!==i.state&&"gathering"!==i.state||(i.state="completed");else{"new"===i.state&&(i.state="gathering"),s.component=1,s.ufrag=i.getLocalParameters().usernameFragment;var c=U.writeCandidate(s);o.candidate=Object.assign(o.candidate,U.parseCandidate(c)),o.candidate.candidate=c,o.candidate.toJSON=function(){return{candidate:o.candidate.candidate,sdpMid:o.candidate.sdpMid,sdpMLineIndex:o.candidate.sdpMLineIndex,usernameFragment:o.candidate.usernameFragment}}}var u=U.getMediaSections(r._localDescription.sdp);u[o.candidate.sdpMLineIndex]+=a?"a=end-of-candidates\r\n":"a="+o.candidate.candidate+"\r\n",r._localDescription.sdp=U.getDescription(r._localDescription.sdp)+u.join("");var d=r.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==r.iceGatheringState&&(r.iceGatheringState="gathering",r._emitGatheringStateChange()),a||r._dispatchEvent("icecandidate",o),d&&(r._dispatchEvent("icecandidate",new Event("icecandidate")),r.iceGatheringState="complete",r._emitGatheringStateChange())}},e.setTimeout((function(){o.forEach((function(e){i.onlocalcandidate(e)}))}),0)}},i.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},i.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},i.prototype._transceive=function(e,n,r){var i=j(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(i.encodings=e.sendEncodingParameters,i.rtcp={cname:U.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(i.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(i)),r&&e.rtpReceiver&&i.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?i.encodings=e.recvEncodingParameters:i.encodings=[{}],i.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(i.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(i.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(i))},i.prototype.setLocalDescription=function(e){var t,n,r=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(F("TypeError",'Unsupported type "'+e.type+'"'));if(!V("setLocalDescription",e.type,r.signalingState)||r._isClosed)return Promise.reject(F("InvalidStateError","Can not set local "+e.type+" in state "+r.signalingState));if("offer"===e.type)t=U.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=U.parseRtpParameters(e);r.transceivers[t].localCapabilities=n})),r.transceivers.forEach((function(e,t){r._gather(e.mid,t)}));else if("answer"===e.type){t=U.splitSections(r._remoteDescription.sdp),n=t.shift();var i=U.matchPrefix(n,"a=ice-lite").length>0;t.forEach((function(e,t){var o=r.transceivers[t],s=o.iceGatherer,a=o.iceTransport,c=o.dtlsTransport,u=o.localCapabilities,d=o.remoteCapabilities;if((!U.isRejected(e)||0!==U.matchPrefix(e,"a=bundle-only").length)&&!o.rejected){var l=U.getIceParameters(e,n),h=U.getDtlsParameters(e,n);i&&(h.role="server"),r.usingBundle&&0!==t||(r._gather(o.mid,t),"new"===a.state&&a.start(s,l,i?"controlling":"controlled"),"new"===c.state&&c.start(h));var f=j(u,d);r._transceive(o,f.codecs.length>0,!1)}}))}return r._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?r._updateSignalingState("have-local-offer"):r._updateSignalingState("stable"),Promise.resolve()},i.prototype.setRemoteDescription=function(i){var o=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(F("TypeError",'Unsupported type "'+i.type+'"'));if(!V("setRemoteDescription",i.type,o.signalingState)||o._isClosed)return Promise.reject(F("InvalidStateError","Can not set remote "+i.type+" in state "+o.signalingState));var s={};o.remoteStreams.forEach((function(e){s[e.id]=e}));var a=[],c=U.splitSections(i.sdp),u=c.shift(),d=U.matchPrefix(u,"a=ice-lite").length>0,l=U.matchPrefix(u,"a=group:BUNDLE ").length>0;o.usingBundle=l;var h=U.matchPrefix(u,"a=ice-options:")[0];return o.canTrickleIceCandidates=!!h&&h.substr(14).split(" ").indexOf("trickle")>=0,c.forEach((function(r,c){var h=U.splitLines(r),f=U.getKind(r),p=U.isRejected(r)&&0===U.matchPrefix(r,"a=bundle-only").length,g=h[0].substr(2).split(" ")[2],m=U.getDirection(r,u),v=U.parseMsid(r),_=U.getMid(r)||U.generateIdentifier();if(p||"application"===f&&("DTLS/SCTP"===g||"UDP/DTLS/SCTP"===g))o.transceivers[c]={mid:_,kind:f,protocol:g,rejected:!0};else{var y,E,T,C,R,S,b,I,O;!p&&o.transceivers[c]&&o.transceivers[c].rejected&&(o.transceivers[c]=o._createTransceiver(f,!0));var w,N,A=U.parseRtpParameters(r);p||(w=U.getIceParameters(r,u),(N=U.getDtlsParameters(r,u)).role="client"),b=U.parseRtpEncodingParameters(r);var M=U.parseRtcpParameters(r),P=U.matchPrefix(r,"a=end-of-candidates",u).length>0,k=U.matchPrefix(r,"a=candidate:").map((function(e){return U.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===i.type||"answer"===i.type)&&!p&&l&&c>0&&o.transceivers[c]&&(o._disposeIceAndDtlsTransports(c),o.transceivers[c].iceGatherer=o.transceivers[0].iceGatherer,o.transceivers[c].iceTransport=o.transceivers[0].iceTransport,o.transceivers[c].dtlsTransport=o.transceivers[0].dtlsTransport,o.transceivers[c].rtpSender&&o.transceivers[c].rtpSender.setTransport(o.transceivers[0].dtlsTransport),o.transceivers[c].rtpReceiver&&o.transceivers[c].rtpReceiver.setTransport(o.transceivers[0].dtlsTransport)),"offer"!==i.type||p)"answer"!==i.type||p||(E=(y=o.transceivers[c]).iceGatherer,T=y.iceTransport,C=y.dtlsTransport,R=y.rtpReceiver,S=y.sendEncodingParameters,I=y.localCapabilities,o.transceivers[c].recvEncodingParameters=b,o.transceivers[c].remoteCapabilities=A,o.transceivers[c].rtcpParameters=M,k.length&&"new"===T.state&&(!d&&!P||l&&0!==c?k.forEach((function(e){B(y.iceTransport,e)})):T.setRemoteCandidates(k)),l&&0!==c||("new"===T.state&&T.start(E,w,"controlling"),"new"===C.state&&C.start(N)),!j(y.localCapabilities,y.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&y.sendEncodingParameters[0].rtx&&delete y.sendEncodingParameters[0].rtx,o._transceive(y,"sendrecv"===m||"recvonly"===m,"sendrecv"===m||"sendonly"===m),!R||"sendrecv"!==m&&"sendonly"!==m?delete y.rtpReceiver:(O=R.track,v?(s[v.stream]||(s[v.stream]=new e.MediaStream),n(O,s[v.stream]),a.push([O,R,s[v.stream]])):(s.default||(s.default=new e.MediaStream),n(O,s.default),a.push([O,R,s.default]))));else{(y=o.transceivers[c]||o._createTransceiver(f)).mid=_,y.iceGatherer||(y.iceGatherer=o._createIceGatherer(c,l)),k.length&&"new"===y.iceTransport.state&&(!P||l&&0!==c?k.forEach((function(e){B(y.iceTransport,e)})):y.iceTransport.setRemoteCandidates(k)),I=e.RTCRtpReceiver.getCapabilities(f),t<15019&&(I.codecs=I.codecs.filter((function(e){return"rtx"!==e.name}))),S=y.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var L,x=!1;"sendrecv"===m||"sendonly"===m?(x=!y.rtpReceiver,R=y.rtpReceiver||new e.RTCRtpReceiver(y.dtlsTransport,f),x&&(O=R.track,v&&"-"===v.stream||(v?(s[v.stream]||(s[v.stream]=new e.MediaStream,Object.defineProperty(s[v.stream],"id",{get:function(){return v.stream}})),Object.defineProperty(O,"id",{get:function(){return v.track}}),L=s[v.stream]):(s.default||(s.default=new e.MediaStream),L=s.default)),L&&(n(O,L),y.associatedRemoteMediaStreams.push(L)),a.push([O,R,L]))):y.rtpReceiver&&y.rtpReceiver.track&&(y.associatedRemoteMediaStreams.forEach((function(t){var n=t.getTracks().find((function(e){return e.id===y.rtpReceiver.track.id}));n&&function(t,n){n.removeTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(n,t)})),y.associatedRemoteMediaStreams=[]),y.localCapabilities=I,y.remoteCapabilities=A,y.rtpReceiver=R,y.rtcpParameters=M,y.sendEncodingParameters=S,y.recvEncodingParameters=b,o._transceive(o.transceivers[c],!1,x)}}})),void 0===o._dtlsRole&&(o._dtlsRole="offer"===i.type?"active":"passive"),o._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?o._updateSignalingState("have-remote-offer"):o._updateSignalingState("stable"),Object.keys(s).forEach((function(t){var n=s[t];if(n.getTracks().length){if(-1===o.remoteStreams.indexOf(n)){o.remoteStreams.push(n);var i=new Event("addstream");i.stream=n,e.setTimeout((function(){o._dispatchEvent("addstream",i)}))}a.forEach((function(e){var t=e[0],i=e[1];n.id===e[2].id&&r(o,t,i,[n])}))}})),a.forEach((function(e){e[2]||r(o,e[0],e[1],[])})),e.setTimeout((function(){o&&o.transceivers&&o.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},i.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},i.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},i.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},i.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},i.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},i.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(F("InvalidStateError","Can not call createOffer after close"));var r=n.transceivers.filter((function(e){return"audio"===e.kind})).length,i=n.transceivers.filter((function(e){return"video"===e.kind})).length,o=arguments[0];if(o){if(o.mandatory||o.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==o.offerToReceiveAudio&&(r=!0===o.offerToReceiveAudio?1:!1===o.offerToReceiveAudio?0:o.offerToReceiveAudio),void 0!==o.offerToReceiveVideo&&(i=!0===o.offerToReceiveVideo?1:!1===o.offerToReceiveVideo?0:o.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){"audio"===e.kind?--r<0&&(e.wantReceive=!1):"video"===e.kind&&--i<0&&(e.wantReceive=!1)}));r>0||i>0;)r>0&&(n._createTransceiver("audio"),r--),i>0&&(n._createTransceiver("video"),i--);var s=U.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(r,i){var o=r.track,s=r.kind,a=r.mid||U.generateIdentifier();r.mid=a,r.iceGatherer||(r.iceGatherer=n._createIceGatherer(i,n.usingBundle));var c=e.RTCRtpSender.getCapabilities(s);t<15019&&(c.codecs=c.codecs.filter((function(e){return"rtx"!==e.name}))),c.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),r.remoteCapabilities&&r.remoteCapabilities.codecs&&r.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),c.headerExtensions.forEach((function(e){(r.remoteCapabilities&&r.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var u=r.sendEncodingParameters||[{ssrc:1001*(2*i+1)}];o&&t>=15019&&"video"===s&&!u[0].rtx&&(u[0].rtx={ssrc:u[0].ssrc+1}),r.wantReceive&&(r.rtpReceiver=new e.RTCRtpReceiver(r.dtlsTransport,s)),r.localCapabilities=c,r.sendEncodingParameters=u})),"max-compat"!==n._config.bundlePolicy&&(s+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(e,t){s+=D(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),s+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,s+="a="+U.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(s+="a=end-of-candidates\r\n"))}));var a=new e.RTCSessionDescription({type:"offer",sdp:s});return Promise.resolve(a)},i.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(F("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(F("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var r=U.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(r+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),r+="a=ice-options:trickle\r\n";var i=U.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,o){if(!(o+1>i)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?r+="m=application 0 DTLS/SCTP 5000\r\n":r+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?r+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(r+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(r+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var s;e.stream&&("audio"===e.kind?s=e.stream.getAudioTracks()[0]:"video"===e.kind&&(s=e.stream.getVideoTracks()[0]),s&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var a=j(e.localCapabilities,e.remoteCapabilities);!a.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,r+=D(e,a,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(r+="a=rtcp-rsize\r\n")}}));var o=new e.RTCSessionDescription({type:"answer",sdp:r});return Promise.resolve(o)},i.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(r,i){if(!n._remoteDescription)return i(F("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var o=e.sdpMLineIndex;if(e.sdpMid)for(var s=0;s<n.transceivers.length;s++)if(n.transceivers[s].mid===e.sdpMid){o=s;break}var a=n.transceivers[o];if(!a)return i(F("OperationError","Can not add ICE candidate"));if(a.rejected)return r();var c=Object.keys(e.candidate).length>0?U.parseCandidate(e.candidate):{};if("tcp"===c.protocol&&(0===c.port||9===c.port))return r();if(c.component&&1!==c.component)return r();if((0===o||o>0&&a.iceTransport!==n.transceivers[0].iceTransport)&&!B(a.iceTransport,c))return i(F("OperationError","Can not add ICE candidate"));var u=e.candidate.trim();0===u.indexOf("a=")&&(u=u.substr(2)),(t=U.getMediaSections(n._remoteDescription.sdp))[o]+="a="+(c.type?u:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=U.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var d=0;d<n.transceivers.length&&(n.transceivers[d].rejected||(n.transceivers[d].iceTransport.addRemoteCandidate({}),(t=U.getMediaSections(n._remoteDescription.sdp))[d]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=U.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));d++);r()}))},i.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw F("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&r.push(e[t].getStats())}))})),Promise.all(r).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var r=n.prototype.getStats;n.prototype.getStats=function(){return r.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){var r;e[n].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(r=e[n]).type]||r.type,t.set(n,e[n])})),t}))}}}));var o=["createOffer","createAnswer"];return o.forEach((function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(o=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),i};function G(e){const t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch(e=>Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString(){return this.name}}}(e)))}}function Y(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}function q(e,t){if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){const t=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set(e){t.set.call(this,e);const n=new Event("enabled");n.enabled=e,this.dispatchEvent(n)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);const n=H(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=function(e,t){let n=!1;return(e=JSON.parse(JSON.stringify(e))).filter(e=>{if(e&&(e.urls||e.url)){let t=e.urls||e.url;e.url&&!e.urls&&_("RTCIceServer.url","RTCIceServer.urls");const r="string"==typeof t;return r&&(t=[t]),t=t.filter(e=>{if(0===e.indexOf("stun:"))return!1;const t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n}),delete e.url,e.urls=r?t[0]:t,!!t.length}})}(e.iceServers,t.version),v("ICE servers after filtering:",e.iceServers)),new n(e)},e.RTCPeerConnection.prototype=n.prototype}function K(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}var W=Object.freeze({__proto__:null,shimPeerConnection:q,shimReplaceTrack:K,shimGetUserMedia:G,shimGetDisplayMedia:Y});function $(e,t){const n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){_("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"==typeof n&&"object"==typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},r&&r.prototype.getSettings){const t=r.prototype.getSettings;r.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(r&&r.prototype.applyConstraints){const t=r.prototype.applyConstraints;r.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"==typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function J(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function z(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}));const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,i,o]=arguments;return r.apply(this,[e||null]).then(e=>{if(t.version<53&&!i)try{e.forEach(e=>{e.type=n[e.type]||e.type})}catch(t){if("TypeError"!==t.name)throw t;e.forEach((t,r)=>{e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))})}return e}).then(i,o)}}function Q(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Z(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),p(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function X(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){_("removeStream","removeTrack"),this.getSenders().forEach(t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)})})}function ee(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function te(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach(e=>{if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const r=t.apply(this,arguments);if(n){const{sender:t}=r,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e.sendEncodings,t.sendEncodings=e.sendEncodings,this.setParametersPromises.push(t.setParameters(n).then(()=>{delete t.sendEncodings}).catch(()=>{delete t.sendEncodings})))}return r})}function ne(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function re(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function ie(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}var oe=Object.freeze({__proto__:null,shimOnTrack:J,shimPeerConnection:z,shimSenderGetStats:Q,shimReceiverGetStats:Z,shimRemoveStream:X,shimRTCDataChannel:ee,shimAddTransceiver:te,shimGetParameters:ne,shimCreateOffer:re,shimCreateAnswer:ie,shimGetUserMedia:$,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}});function se(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach(n=>t.call(this,n,e)),e.getVideoTracks().forEach(n=>t.call(this,n,e))},e.RTCPeerConnection.prototype.addTrack=function(e,...n){return n&&n.forEach(e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach(e=>{n.includes(e.track)&&this.removeTrack(e)})})}}function ae(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach(e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)})}),t.apply(e,arguments)}}}function ce(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){const r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};let a=function(e,t,n){const r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=a,a=function(e,t,n){const r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=a,a=function(e,t,n){const r=s.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=a}function ue(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(de(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))}function de(e){return e&&void 0!==e.video?Object.assign({},e,{video:E(e.video)}):e}function le(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let r=e.iceServers[n];!r.hasOwnProperty("urls")&&r.hasOwnProperty("url")?(_("RTCIceServer.url","RTCIceServer.urls"),r=JSON.parse(JSON.stringify(r)),r.urls=r.url,delete r.url,t.push(r)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function he(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function fe(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find(e=>"audio"===e.receiver.track.kind);!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find(e=>"video"===e.receiver.track.kind);!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video")}return t.apply(this,arguments)}}function pe(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var ge=Object.freeze({__proto__:null,shimLocalStreamsAPI:se,shimRemoteStreamsAPI:ae,shimCallbacksAPI:ce,shimGetUserMedia:ue,shimConstraints:de,shimRTCIceServerUrls:le,shimTrackEventTransceiver:he,shimCreateOfferLegacy:fe,shimAudioContext:pe});function me(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const n=new t(e),r=U.parseCandidate(e.candidate),i=Object.assign(n,r);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,p(e,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t))}function ve(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const n=function(e){if(!e||!e.sdp)return!1;const t=U.splitSections(e.sdp);return t.shift(),t.some(e=>{const t=U.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})},r=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!=n?-1:n},i=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},o=function(e,n){let r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);const i=U.matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?r=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r},s=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const e=r(arguments[0]),t=i(e),n=o(arguments[0],e);let s;s=0===t&&0===n?Number.POSITIVE_INFINITY:0===t||0===n?Math.max(t,n):Math.min(t,n);const a={};Object.defineProperty(a,"maxMessageSize",{get:()=>s}),this._sctp=a}return s.apply(this,arguments)}}function _e(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},p(e,"datachannel",e=>(t(e.channel,e.target),e))}function ye(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function Ee(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter(e=>"a=extmap-allow-mixed"!==e.trim()).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function Te(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}var Ce=Object.freeze({__proto__:null,shimRTCIceCandidate:me,shimMaxMessageSize:ve,shimSendThrowTypeError:_e,shimConnectionState:ye,removeExtmapAllowMixed:Ee,shimAddIceCandidateNullOrEmpty:Te});const Re=function({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const n=v,r=function(e){const t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=f(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=f(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(n.mediaDevices&&n.userAgent.match(/Edge\/(\d+).(\d+)$/))t.browser="edge",t.version=f(n.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=f(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),i={browserDetails:r,commonShim:Ce,extractVersion:f,disableLog:g,disableWarnings:m};switch(r.browser){case"chrome":if(!x||!P||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(null===r.version)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=x,Te(e,r),S(e,r),b(e),P(e,r),I(e),M(e,r),O(e),w(e),N(e),k(e,r),me(e),ye(e),ve(e,r),_e(e),Ee(e,r);break;case"firefox":if(!oe||!z||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=oe,Te(e,r),$(e,r),z(e,r),J(e),X(e),Q(e),Z(e),ee(e),te(e),ne(e),re(e),ie(e),me(e),ye(e),ve(e,r),_e(e);break;case"edge":if(!W||!q||!t.shimEdge)return n("MS edge shim is not included in this adapter release."),i;n("adapter.js shimming edge."),i.browserShim=W,G(e),Y(e),q(e,r),K(e),ve(e,r),_e(e);break;case"safari":if(!ge||!t.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=ge,Te(e,r),le(e),fe(e),ce(e),se(e),ae(e),he(e),ue(e),pe(e),me(e),ve(e,r),_e(e),Ee(e,r);break;default:n("Unsupported browser!")}return i}({window:"undefined"==typeof window?void 0:window});var Se,be;!function(e){e.FPS_10="FPS_10",e.FPS_15="FPS_15",e.FPS_24="FPS_24",e.FPS_30="FPS_30"}(Se||(Se={})),function(e){e.W176_H132="W176_H132",e.W176_H144="W176_H144",e.W256_H144="W256_H144",e.W320_H180="W320_H180",e.W240_H240="W240_H240",e.W320_H240="W320_H240",e.W480_H360="W480_H360",e.W640_H360="W640_H360",e.W480_H480="W480_H480",e.W640_H480="W640_H480",e.W720_H480="W720_H480",e.W1280_H720="W1280_H720",e.W1920_H1080="W1920_H1080"}(be||(be={}));const Ie={[be.W176_H132]:{width:176,height:132,maxBitrate:150,minBitrate:80},[be.W176_H144]:{width:176,height:144,maxBitrate:160,minBitrate:80},[be.W256_H144]:{width:256,height:144,maxBitrate:240,minBitrate:120},[be.W320_H180]:{width:320,height:180,maxBitrate:280,minBitrate:120},[be.W240_H240]:{width:240,height:240,maxBitrate:280,minBitrate:120},[be.W320_H240]:{width:320,height:240,maxBitrate:400,minBitrate:120},[be.W480_H360]:{width:480,height:360,maxBitrate:650,minBitrate:150},[be.W640_H360]:{width:640,height:360,maxBitrate:800,minBitrate:180},[be.W480_H480]:{width:480,height:480,maxBitrate:800,minBitrate:180},[be.W640_H480]:{width:640,height:480,maxBitrate:900,minBitrate:200},[be.W720_H480]:{width:720,height:480,maxBitrate:1e3,minBitrate:200},[be.W1280_H720]:{width:1280,height:720,maxBitrate:2200,minBitrate:250},[be.W1920_H1080]:{width:1920,height:1080,maxBitrate:4e3,minBitrate:400}},Oe=(e,t)=>{const n=e*t;let r=Number.MAX_VALUE,i=null;for(const o in Ie){const e=Ie[o],t=Math.abs(e.width*e.height-n);t<r&&(i=e,r=t)}return i},we={10:1,15:1,24:1.5,30:1.5},Ne=e=>{let t=Number.MAX_VALUE,n=1;for(const r in we){const i=Math.abs(e-parseInt(r));i<t&&(t=i,n=we[r])}return n},Ae=(e,t)=>({name:e,content:JSON.stringify({uris:t,ignore:!0})}),Me=e=>JSON.stringify(e),Pe=e=>/^[a-zA-Z\d-=]+$/g.test(e),ke="http:"!==location.protocol||["localhost","127.0.0.1"].includes(location.hostname),Le=e=>{if(void 0===e)return 0;if(Object(r["isNumber"])(e))return e;const t=e;return t.exact||t.ideal||t.max||0},xe=e=>{const t=e.getConstraints();return{width:Le(t.width),height:Le(t.height),frameRate:Le(t.frameRate)}},Ue=e=>[e.msid,e.mediaType].join("_"),De=e=>{const t=e.split("_");return{mediaType:parseInt(t.pop()),tag:t.pop(),userId:t.join("_")}},je=(e,t)=>[e,t].join("_"),Ve=e=>e.map(e=>Object.assign({},e)),Be=(e,t)=>{e=e.slice();const n=[],r=[],i=[];return t.forEach(t=>{const r=Ue(t),o=e.findIndex(e=>Ue(e)===r);if(-1===o)return void n.push(t);const s=e[o];s.uri!==t.uri?n.push(t):s.state!==t.state&&i.push(t),e.splice(o,1)}),r.push(...e),{publishedList:n,unpublishedList:r,modifiedList:i}},Fe=()=>{let e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}));return e=e.replace(/-/g,"")+"0",e=parseInt(e,16),e=(e=>{const t="0123456789abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ+/".split(""),n=t.length+1;let r=+e;const i=[];do{const e=r%n;r=(r-e)/n,i.unshift(t[e])}while(r);return i.join("")})(e),e.length>22&&(e=e.slice(0,22)),e},He=e=>{const[t,n]=e.split("_").map(e=>parseInt(e.replace(/[^\d]/g,"")));return{width:t,height:n}},Ge=e=>!!be[e],Ye=e=>!!Se[e],qe=e=>parseInt(e.replace("FPS_","")),Ke=(()=>{const{browser:e,version:t,supportsUnifiedPlan:n}=Re.browserDetails;return{browser:e,version:t,supportsUnifiedPlan:!1!==n}})();function We(){return"captureStream"in HTMLMediaElement.prototype||"mozCaptureStream"in HTMLMediaElement.prototype}function $e(){return"mediaDevices"in navigator&&"getDisplayMedia"in navigator.mediaDevices}const Je=e=>"[object Null]"===Object.prototype.toString.call(e);var ze,Qe;!function(e){e.PUBLISH="RCRTC:PublishResource",e.UNPUBLISH="RCRTC:UnpublishResource",e.MODIFY="RCRTC:ModifyResource",e.TOTAL_CONTENT_RESOURCE="RCRTC:TotalContentResources",e.STATE="RCRTC:state",e.ROOM_NOTIFY="RCRTC:RoomNtf",e.USER_NOTIFY="RCRTC:UserNtf",e.KICK="RCRTC:kick"}(ze||(ze={}));class Ze{constructor(e,t,n,r=1e4){this._roomId=e,this._roomMode=t,this._context=n,this._gap=r,this._latestTimestamp=Date.now(),this._timer=null}start(){return i(this,void 0,void 0,(function*(){this._timer||(this._timer=setInterval(this._loop.bind(this),this._gap))}))}_loop(){var e;return i(this,void 0,void 0,(function*(){const t=yield new Promise(e=>{this._context.rtcPing(this._roomId,this._roomMode).then(e).catch(t=>{o.error("rtcping receive unknown error -> "+t),e(r["ErrorCode"].UNKNOWN)}),setTimeout(e,1e4,r["ErrorCode"].TIMEOUT)}),n=Date.now();t!==r["ErrorCode"].SUCCESS?(o.warn("rtcping failed -> code: "+t),(40003===t||n-this._latestTimestamp>6e4)&&(this.stop(),null===(e=this.onFailed)||void 0===e||e.call(this,40003===t))):this._latestTimestamp=n}))}stop(){this._timer&&(clearInterval(this._timer),this._timer=null)}}class Xe extends r["EventEmitter"]{constructor(e,t,n,r,i){super(),this._tag=e,this._userId=t,this._kind=n,this._isLocalTrack=r,this._roomId=i,this._localMuted=!1,this._remoteMuted=!1,this._streamId=[this._userId||this._roomId,this._tag].join("_"),this._id=[this._streamId,this.isAudioTrack()?0:1].join("_")}getStreamId(){return this._streamId}getTrackId(){return this._id}getUserId(){return this._userId}__innerGetMediaStreamTrack(){return this._msTrack}getTag(){return this._tag}isLocalTrack(){return this._isLocalTrack}isVideoTrack(){return"video"===this._kind}isAudioTrack(){return"audio"===this._kind}isReady(){var e;return"live"===(null===(e=this._msTrack)||void 0===e?void 0:e.readyState)}__innerSetMediaStreamTrack(e){this._msTrack=e,this._setLocalMuted(this._localMuted);const t=this._msStream=this._msStream||new MediaStream,n=t.getTracks()[0];n&&t.removeTrack(n),e?t.addTrack(e):this._element&&(this._element.pause(),this._element.srcObject=null)}_setLocalMuted(e){this._msTrack&&(this._msTrack.enabled=!e),this._localMuted=e}mute(){this._setLocalMuted(!0)}unmute(){this._setLocalMuted(!1)}isLocalMuted(){return this._localMuted}isOwnerMuted(){return this._remoteMuted}play(e){return i(this,void 0,void 0,(function*(){if(!this._msTrack)return o.warn("the track is not ready to play -> id: "+this._id),{code:s.TRACK_NOT_READY};"ended"===this._msTrack.readyState&&o.warn("the track's readyState is 'ended' -> id: "+this._id);const t=this.isVideoTrack();if(t&&(!e||!(e instanceof HTMLVideoElement)))return o.error("the video track need an <video> to play -> id: "+this._id),{code:s.VIDEO_TRACK_MISS_MEDIA_ELEMENT};this._element=t?e:this._element||new Audio,this._localMuted&&this._setLocalMuted(!1),this._element.srcObject&&this._element.srcObject===this._msStream||this._element.pause(),this._element.onloadstart=e=>{var t;o.debug(`HTMLMediaElement onloadstart -> id: ${null===(t=e.target)||void 0===t?void 0:t.id}, trackId: ${this._id}`)},this._element.ondurationchange=e=>{var t;o.debug(`HTMLMediaElement ondurationchange -> id: ${null===(t=e.target)||void 0===t?void 0:t.id}, trackId: ${this._id}`)},this._element.onloadedmetadata=e=>{var t;o.debug(`HTMLMediaElement onloadedmetadata -> id: ${null===(t=e.target)||void 0===t?void 0:t.id}, trackId: ${this._id}`)},this._element.onloadeddata=e=>{var t;o.debug(`HTMLMediaElement onloadeddata -> id: ${null===(t=e.target)||void 0===t?void 0:t.id}, trackId: ${this._id}`)},this._element.onabort=e=>{var t;o.info(`HTMLMediaElement onabort -> id: ${null===(t=e.target)||void 0===t?void 0:t.id}, trackId: ${this._id}`)},this._element.oncanplay=e=>{var t;o.info(`HTMLMediaElement oncanplay -> id: ${null===(t=e.target)||void 0===t?void 0:t.id}, trackId: ${this._id}`)},this._element.srcObject=this._msStream,this._element.autoplay=!0;try{this._element.play()}catch(e){return o.error(e),{code:s.TRACK_PLAY_ERROR}}return{code:s.SUCCESS}}))}__innerDestroy(){this._msTrack=void 0}}class et extends Xe{constructor(e,t,n,r){super(e,t,n,!0),this._isPublished=!1,this.__innerSetMediaStreamTrack(r),r.onended=()=>{r.onended=null,this.emit(et.EVENT_LOCAL_TRACK_END,this),this.removeAll(et.EVENT_LOCAL_TRACK_END)}}_setLocalMuted(e){super._setLocalMuted(e),this._remoteMuted=this._localMuted,this.emit(et.__INNER_EVENT_MUTED_CHANGE__,this)}__innerSetPublished(e){this._isPublished=e}isPublished(){return this._isPublished}destroy(){var e;null===(e=this._msTrack)||void 0===e||e.stop(),super.__innerDestroy(),this.emit(et.__INNER_EVENT_DESTROY__,this)}setBitrate(e=0,t=0,n=0){!Object(r["isNumber"])(e)||!Object(r["isNumber"])(t)||!Object(r["isNumber"])(n)||e<=0||t<=0||e<t?o.error("setBitrate params error ->"):this._bitrateInfo={max:e,min:t,start:n}}getBitrate(){var e,t;const{min:n,max:r}=(e=>{const{width:t,height:n,frameRate:r}=xe(e),i=Oe(t,n),o=Ne(r);return{min:i.minBitrate*o,max:i.maxBitrate*o}})(this._msTrack);return{min:(null===(e=this._bitrateInfo)||void 0===e?void 0:e.min)||n,max:(null===(t=this._bitrateInfo)||void 0===t?void 0:t.max)||r}}}et.EVENT_LOCAL_TRACK_END="local-track-end",et.__INNER_EVENT_MUTED_CHANGE__="inner-muted-change",et.__INNER_EVENT_DESTROY__="inner-destroy";class tt extends et{constructor(e,t,n){super(e,t,"audio",n)}setBitrate(e,t,n){o.warn("`setBitrate` invalid for audio track")}getBitrate(){return{start:32,max:32,min:32}}}class nt extends et{constructor(e,t,n,r=!1){super(e,t,"video",n),this._isTiny=r}__isTiny(){return this._isTiny}getStreamId(){const e=super.getStreamId();return this._isTiny?e+"_tiny":e}getTrackId(){const e=super.getTrackId();return this._isTiny?e+"_tiny":e}}class rt extends et{constructor(e,t,n,r,i){super(e,t,n,r),this._resource=i,rt.__innerSetMapping(this.getTrackId(),i)}static __innerSetMapping(e,t){const n=this._mapping.get(t)||[];n.push(e),this._mapping.set(t,n)}static __innerRemoveMapping(e,t){var n,r;const i=null===(n=this._mapping.get(t))||void 0===n?void 0:n.filter(t=>t!==e);i&&i.length>0?this._mapping.set(t,i):(this._mapping.delete(t),t.pause(),t.src="",null===(r=t.parentNode)||void 0===r||r.removeChild(t))}destroy(){this.isAudioTrack()&&this.mute(),rt.__innerRemoveMapping(this.getTrackId(),this._resource),super.destroy()}}rt._mapping=new Map;class it extends rt{constructor(e,t,n,r){super(e,t,"video",n,r)}}class ot extends rt{constructor(e,t,n,r){super(e,t,"audio",n,r)}_setLocalMuted(e){this._resource&&(this._resource.muted=e),super._setLocalMuted(e)}play(){return this._setLocalMuted(!1),Promise.resolve({code:s.SUCCESS})}}class st extends tt{}class at extends nt{}class ct extends nt{}!function(e){e[e.NORMAL=1]="NORMAL",e[e.TINY=2]="TINY"}(Qe||(Qe={}));const ut=(e,t)=>Math.round(8*t/e),dt=(e,t=2)=>{const n=10**t;return Math.round(e*n)/n},lt=(e,t,n,r)=>{if(0===t)return 0;if(!n||!r)return dt(e/t,3);const i=t-r;if(0===i)return 0;const o=e-n;return o<0||i<0?0:dt(o/i,3)},ht=e=>{const{jitter:t,rtt:n,packetsLostRate:r}=e;return!Je(t)||!Je(n)||0!==r};var ft,pt,gt,mt,vt;!function(e){e[e.AUDIO_ONLY=0]="AUDIO_ONLY",e[e.VIDEO_ONLY=1]="VIDEO_ONLY",e[e.AUDIO_VIDEO=2]="AUDIO_VIDEO"}(ft||(ft={}));class _t{constructor(e,t){this._rtcPeerConn=e,this._sdpSemantics=t,this._latestPacketsSent={},this._latestBytesSent={},this._latestBytesRecv={},this._latestPacketsRecv={}}updateBytesSent(e,t,n){let r,i;if(this._latestBytesSent[e]){const{bytesSent:o,timestamp:s}=this._latestBytesSent[e];r=t-o,i=n-s,this._latestBytesSent[e]={bytesSent:t,timestamp:n}}else r=t,i=1e3,this._latestBytesSent[e]={bytesSent:t,timestamp:n};return ut(i,r)}updateBytesRecv(e,t,n){let r,i;if(this._latestBytesRecv[e]){const{bytesRecv:o,timestamp:s}=this._latestBytesRecv[e];r=t-o,i=n-s,this._latestBytesRecv[e]={bytesRecv:t,timestamp:n}}else r=t,i=1e3,this._latestBytesRecv[e]={bytesRecv:t,timestamp:n};return ut(i,r)}updateSenderPacketsLost(e,t,n){let r;if(Object.prototype.hasOwnProperty.call(this._latestPacketsSent[e],"packetsSent")){const{packetsLost:i,packetsSent:o}=this._latestPacketsSent[e];r=lt(t,n,i,o),this._latestPacketsSent[e].packetsLost=t,this._latestPacketsSent[e].packetsSent=i===t?o:n}else r=lt(t,n),this._latestPacketsSent[e].packetsLost=t,this._latestPacketsSent[e].packetsSent=n;return r}updateReceiverPacketsLost(e,t,n){let r;if(this._latestPacketsRecv[e]){const{packetsLost:i,packetsRecv:o}=this._latestPacketsRecv[e];r=lt(t,n+t,i,o+i)}else r=lt(t,n);return this._latestPacketsRecv[e]={packetsLost:t,packetsRecv:n},r}clearLatestpacketsSent(e){e.forEach(e=>{if(parseInt(e.split("_").pop())===ft.VIDEO_ONLY){const t=e+"_tiny";delete this._latestPacketsSent[t],delete this._latestBytesSent[t]}delete this._latestPacketsSent[e],delete this._latestBytesSent[e]})}clearLatestPacketsRecv(e){e.forEach(e=>{delete this._latestPacketsRecv[e],delete this._latestBytesRecv[e]})}parseRTCStatsReport(e){const t=e.keys(),n={};let r=t.next();for(;!r.done;){const i=r.value,o=e.get(i);/^RTCCodec_/.test(i)||(n[i]=o),r=t.next()}return n}formatRCRTCStateReport(e){return{senders:[],receivers:[]}}getResourceIdByParseSdp(e){var t,n;const r=e.ssrc,i=e.kind||e.mediaType,o=null===(t=this._rtcPeerConn.currentLocalDescription)||void 0===t?void 0:t.sdp,s=null===(n=this._rtcPeerConn.currentRemoteDescription)||void 0===n?void 0:n.sdp;let a;a="unified-plan"===this._sdpSemantics?new RegExp("a=msid:(.*?) "):new RegExp(`a=ssrc:${r} msid:(.*?) `);const c=null==o?void 0:o.split("\r\nm="),u=null==c?void 0:c.filter(e=>e.includes("a=ssrc:"+r))[0],d=null==u?void 0:u.match(a);let l=d?d[1]:"";if(l)return`${l}_${"video"===i?1:0}`;const h=null==s?void 0:s.split("\r\nm="),f=null==h?void 0:h.filter(e=>e.includes("a=ssrc:"+r))[0],p=null==f?void 0:f.match(a);return l=p?p[1]:"",`${l}_${"video"===i?1:0}`}isValidSender(e){var t;const n=null===(t=this._rtcPeerConn.currentLocalDescription)||void 0===t?void 0:t.sdp,{ssrc:r}=e;return!(null==n?void 0:n.split("\r\nm=").some(e=>e.includes(r)&&e.includes("a=inactive")))}isValidReceiver(e){var t;const n=null===(t=this._rtcPeerConn.currentRemoteDescription)||void 0===t?void 0:t.sdp,{ssrc:r}=e;return!(null==n?void 0:n.split("\r\nm=").some(e=>e.includes(r)&&e.includes("a=inactive")))}}class yt extends _t{formatRCRTCStateReport(e){const t={senders:[],receivers:[]},n=Math.floor(e.RTCPeerConnection.timestamp);t.timestamp=n;const r=Object.keys(e);let i=0,o=0;r.filter(e=>/^RTCOutboundRTP(Video|Audio)Stream_/.test(e)).forEach(r=>{const s=e[r];if("unified-plan"===this._sdpSemantics&&!this.isValidSender(s))return;const{id:a,kind:c,transportId:u,mediaSourceId:d,remoteId:l,packetsSent:h,bytesSent:f,trackId:p,encoderImplementation:g,pliCount:m,nackCount:v,firCount:_}=s;if(!p)return;let{framesPerSecond:y,frameWidth:E,frameHeight:T}=s;"video"!==c||E||T||y||(E=e[p].frameWidth,T=e[p].frameHeight,y=d?e[d].framesPerSecond:null);const C=e[l];let R=null,S=null,b=0;C&&(R=C.jitter,S=C.roundTripTime,b=C.packetsLost),i+=b;const I=this.getResourceIdByParseSdp(s),O=d?e[d].audioLevel:e[p].audioLevel;let w=null;!this._latestPacketsSent[I]&&(this._latestPacketsSent[I]={}),C?w=this.updateSenderPacketsLost(I,b,h):this._latestPacketsSent[I].crtPacketsSent=h;let N=this.updateBytesSent(I,f,n);N<0&&(N=0),o+=N,t.senders.push({id:a,trackId:I,kind:c,packetsLostRate:w,remoteResource:!1,audioLevel:dt(O),frameWidth:E,frameHeight:T,frameRate:y,bitrate:N,jitter:R?Math.round(1e3*R):R,rtt:S,encoderImplementation:g,pliCount:m,nackCount:v,googFirsSent:-1,samplingRate:-1,googRenderDelayMs:-1,trackState:-1})}),r.filter(e=>/RTCRemoteInboundRtp(Video|Audio)Stream_/.test(e)).forEach(n=>{const{localId:r,jitter:i,roundTripTime:o,packetsLost:s}=e[n],a=t.senders.filter(e=>e.id===r)[0];if(a&&!ht(a)){const t=this.getResourceIdByParseSdp(e[a.id]);a.jitter=Math.round(1e3*i),a.rtt=o;const n=this._latestPacketsSent[t].crtPacketsSent;a.packetsLostRate=this.updateSenderPacketsLost(t,s,n)}});let s=0;r.filter(e=>/^RTCInboundRTP(Video|Audio)Stream_/.test(e)).forEach(r=>{const o=e[r];if("unified-plan"===this._sdpSemantics&&!this.isValidReceiver(o))return;const{trackId:a,packetsLost:c,packetsReceived:u,jitter:d,bytesReceived:l,framesPerSecond:h,kind:f,codecImplementationName:p,nackCount:g,pliCount:m}=o;if(!a)return;let{frameWidth:v,frameHeight:_,audioLevel:y}=o;"video"===f?v||_||(v=e[a].frameWidth,_=e[a].frameHeight):y||(y=e[a].audioLevel),i+=c;const E=this.getResourceIdByParseSdp(o),T=this.updateReceiverPacketsLost(E,c,u);let C=this.updateBytesRecv(E,l,n);C<0&&(C=0),s+=C,t.receivers.push({trackId:E,kind:f,packetsLostRate:T,remoteResource:!0,audioLevel:dt(y),frameWidth:v,frameHeight:_,frameRate:h,bitrate:C,jitter:d?Math.round(1e3*d):0,codecImplementationName:p,nackCount:g,pliCount:m,rtt:null,samplingRate:-1,googFirsReceived:-1,googRenderDelayMs:-1,trackState:-1})});const a=r.filter(e=>/^RTCTransport_/.test(e))[0];if(a){const n=e[a],{selectedCandidatePairId:r}=n;if(r){const n=e[r],{availableOutgoingBitrate:a,availableIncomingBitrate:c,currentRoundTripTime:u,localCandidateId:d,remoteCandidateId:l}=n,h=e[d],{ip:f,port:p,networkType:g}=h,m=e[l],{ip:v,port:_,protocol:y}=m;t.iceCandidatePair={IP:f,port:p,networkType:g,remoteIP:v,remotePort:_,protocol:y,bitrateRecv:s,bitrateSend:o,rtt:1e3*u,availableOutgoingBitrate:a,availableIncomingBitrate:c,totalPacketsLost:i},t.receivers.forEach(e=>{e.rtt=u})}}return t}}class Et extends _t{formatRCRTCStateReport(e){const t=+new Date,n={senders:[],receivers:[],timestamp:t};let r=0,i=0,o=0;for(const s in e){const a=e[s],c=a.type;if("outbound-rtp"===c){if("unified-plan"===this._sdpSemantics&&!this.isValidSender(a))continue;const{id:o,kind:s,bytesSent:c,packetsSent:u,bitrateMean:d,framerateMean:l,nackCount:h,pliCount:f,remoteId:p}=a,{jitter:g,roundTripTime:m,packetsLost:v}=p?e[p]:{jitter:null,roundTripTime:null,packetsLost:0},_=this.getResourceIdByParseSdp(a);r+=v;let y=null;!this._latestPacketsSent[_]&&(this._latestPacketsSent[_]={}),p?y=this.updateSenderPacketsLost(_,v,u):this._latestPacketsSent[_].crtPacketsSent=u;let E=0;"video"===s?d&&(E=Math.floor(d/1e3)):E=this.updateBytesSent(_,c,t),E<0&&(E=0),i+=E,n.senders.push({trackId:_,kind:s,packetsLostRate:y,remoteResource:!1,audioLevel:null,frameWidth:null,frameHeight:null,frameRate:Math.floor(l),bitrate:E,jitter:g?Math.round(1e3*g):null,rtt:m,encoderImplementation:null,pliCount:f,nackCount:h,googFirsSent:-1,samplingRate:-1,googRenderDelayMs:-1,trackState:-1})}if("remote-inbound-rtp"===c){const{localId:t}=a,r=this.getResourceIdByParseSdp(e[t]),i=n.senders.filter(e=>e.trackId===r)[0];i&&ht(i)&&(i.jitter=Math.round(1e3*a.jitter),i.rtt=a.rtt,i.packetsLostRate=this.updateSenderPacketsLost(r,a.packetsLost,this._latestPacketsSent[r].crtPacketsSent))}if("inbound-rtp"===c){if("unified-plan"===this._sdpSemantics&&!this.isValidReceiver(a))continue;const{id:e,packetsLost:i,bytesReceived:s,packetsReceived:c,jitter:u,framerateMean:d,kind:l,bitrateMean:h,nackCount:f,pliCount:p}=a,g=this.getResourceIdByParseSdp(a);r+=i;const m=this.updateReceiverPacketsLost(g,i,c);let v=0;"video"===l?h&&(v=Math.floor(h/1e3)):v=this.updateBytesRecv(g,s,t),v<0&&(v=0),o+=v,n.receivers.push({trackId:g,kind:l,packetsLostRate:m,remoteResource:!0,audioLevel:null,frameWidth:null,frameHeight:null,frameRate:Math.floor(d),bitrate:v,jitter:u?Math.round(1e3*u):null,codecImplementationName:null,nackCount:f,pliCount:p,rtt:null,samplingRate:-1,googFirsReceived:-1,googRenderDelayMs:-1,trackState:-1})}if("candidate-pair"===c&&"succeeded"===a.state){const t=e[a.localCandidateId],{address:s,port:c}=t,u=e[a.remoteCandidateId],{address:d,port:l,protocol:h}=u;n.iceCandidatePair={IP:s,port:c,networkType:null,remoteIP:d,remotePort:l,protocol:h,bitrateRecv:o,bitrateSend:i,rtt:null,availableOutgoingBitrate:null,availableIncomingBitrate:null,totalPacketsLost:r}}}return n.iceCandidatePair&&(n.iceCandidatePair.bitrateSend=i),n.iceCandidatePair&&(n.iceCandidatePair.bitrateRecv=o),n}}class Tt extends _t{formatRCRTCStateReport(e){const t={senders:[],receivers:[]},n=Math.floor(e.RTCPeerConnection.timestamp);t.timestamp=n;const r=Object.keys(e);let i=0,o=0;r.filter(e=>/^RTCOutboundRTP(Video|Audio)Stream_/.test(e)).forEach(r=>{const i=e[r];if("unified-plan"===this._sdpSemantics&&!this.isValidSender(i))return;const s=this.getResourceIdByParseSdp(i),{mediaType:a,transportId:c,remoteId:u,packetsSent:d,bytesSent:l,trackId:h,encoderImplementation:f,pliCount:p,nackCount:g,firCount:m}=i;if(!h)return;const{audioLevel:v,frameHeight:_,frameWidth:y}=e[h];let E=this.updateBytesSent(s,l,n);E<0&&(E=0),o+=E,t.senders.push({trackId:s,kind:a,packetsLostRate:null,remoteResource:!1,audioLevel:dt(v),frameWidth:y,frameHeight:_,frameRate:null,bitrate:E,jitter:null,rtt:null,encoderImplementation:f,pliCount:p,nackCount:g,googFirsSent:-1,samplingRate:-1,googRenderDelayMs:-1,trackState:-1})});let s=0;r.filter(e=>/^RTCInboundRTP(Video|Audio)Stream_/.test(e)).forEach(r=>{const o=e[r];if("unified-plan"===this._sdpSemantics&&!this.isValidReceiver(o))return;const{trackId:a,packetsLost:c,packetsReceived:u,jitter:d,bytesReceived:l,mediaType:h,nackCount:f,pliCount:p}=o,g=this.getResourceIdByParseSdp(o);if(!a)return;const{frameHeight:m,frameWidth:v,audioLevel:_}=e[a];i+=c;const y=this.updateReceiverPacketsLost(g,c,u);let E=this.updateBytesRecv(g,l,n);E<0&&(E=0),s+=E,t.receivers.push({trackId:g,kind:h,packetsLostRate:y,remoteResource:!0,audioLevel:dt(_),frameWidth:v,frameHeight:m,frameRate:null,bitrate:E,jitter:d,codecImplementationName:null,nackCount:f,pliCount:p,rtt:null,samplingRate:-1,googFirsReceived:-1,googRenderDelayMs:-1,trackState:-1})});const a=r.filter(e=>/^RTCTransport_/.test(e))[0];if(a){const n=e[a],{selectedCandidatePairId:r}=n;if(r){const n=e[r],{availableOutgoingBitrate:a,availableIncomingBitrate:c,currentRoundTripTime:u,localCandidateId:d,remoteCandidateId:l}=n,h=e[d],{address:f,port:p}=h,g=e[l],{address:m,port:v,protocol:_}=g;t.iceCandidatePair={IP:f||null,port:p,networkType:null,remoteIP:m,remotePort:v,protocol:_,bitrateRecv:s,bitrateSend:o,rtt:1e3*u,availableOutgoingBitrate:a,availableIncomingBitrate:c,totalPacketsLost:i},t.receivers.forEach(e=>{e.rtt=u})}}return t}}class Ct{constructor(e){this._peer=e,this._outboundStreams={}}static setSdpSemantics(e){const{browser:t,version:n,supportsUnifiedPlan:r}=Ke;r?/chrome/i.test(t)?this._sdpSemantics=n>92?"unified-plan":n<72?"plan-b":e:/firefox/i.test(t)?this._sdpSemantics="unified-plan":/safari/i.test(t)?this._sdpSemantics=n<12?"plan-b":"unified-plan":this._sdpSemantics="unified-plan":this._sdpSemantics="plan-b"}static getSdpSemantics(){return Ct._sdpSemantics}getOutboundVideoInfo(){const e=[];for(const t in this._outboundStreams){const n=this._outboundStreams[t].getVideoTracks()[0];if(!n)continue;const r=/_tiny$/.test(t),{width:i,height:o}=xe(n);e.push({trackId:n.id,simulcast:r?Qe.TINY:Qe.NORMAL,resolution:`${i}x${o}`})}return e}setRemoteAnswer(e){return i(this,void 0,void 0,(function*(){e=e.replace(/\s+\r\n/g,"\r\n");try{yield this._peer.setRemoteDescription({type:"answer",sdp:e})}catch(e){return o.error(e),s.SET_REMOTE_DESCRIPTION_FAILED}return s.SUCCESS}))}getStatParsr(e,t){return/chrome/i.test(Ke.browser)?new yt(e,t):/Firefox/i.test(Ke.browser)?new Et(e,t):/Safari/i.test(Ke.browser)?new Tt(e,t):null}}class Rt extends Ct{constructor(){super(...arguments),this.senders={},this._localTracks=[]}addLocalTrack(e){this._localTracks.includes(e)||this._localTracks.push(e);const t=e.getStreamId(),n=e.__innerGetMediaStreamTrack(),r=this._outboundStreams[t]||(this._outboundStreams[t]=new MediaStream);r.getTracks().forEach(e=>{e.kind===n.kind&&r.removeTrack(e)}),r.addTrack(n);const i=e.getTrackId(),o=this.senders[i];o?o.replaceTrack(n):this.senders[i]=this._peer.addTrack(n,r)}removeLocalTrack(e){const t=this._localTracks.findIndex(t=>t===e);t>=0&&this._localTracks.splice(t,1);const n=e.getTrackId(),r=this.senders[n];r&&(r.replaceTrack(null),this._peer.removeTrack(r),delete this.senders[n])}updateSubRemoteTracks(e){}updateRecvTransceiverMap(e,t){}setBitrate(e,t,n){this._maxBitrate=e,this._minBitrate=t,this._startBitrate=n||.7*e}createOffer(e){return i(this,void 0,void 0,(function*(){const t=yield this._peer.createOffer({iceRestart:e,offerToReceiveAudio:!0,offerToReceiveVideo:!0});for(const e in this._outboundStreams){const n=this._outboundStreams[e].id;t.sdp=t.sdp.replace(new RegExp(n,"g"),e)}return yield this._peer.setLocalDescription(t),{type:"offer",semantics:"plan-b",sdp:t.sdp}}))}setRemoteAnswer(e){let t=0,n=0;this._localTracks.forEach(e=>{const{min:r,max:i}=e.getBitrate();n+=r,t+=i}),t=this._maxBitrate&&this._maxBitrate>0?Math.min(t,this._maxBitrate):t,n=this._minBitrate&&this._minBitrate>0?Math.max(n,this._minBitrate):n;const r=this._startBitrate||Math.round(.7*t),i="b=AS:"+t;e=e.replace(/[\r\n]+m=video[^\r\n]+/,e=>`${e}\r\n${i}`);const o=[";x-google-min-bitrate="+n,";x-google-max-bitrate="+t,";x-google-start-bitrate="+r].join("");return e=e.replace(/[\r\n]+[^\r\n]+profile-level-id[^\r\n]+/g,e=>e+o),super.setRemoteAnswer(e)}}class St extends Ct{constructor(){super(...arguments),this._sendTransceiver={},this._localTracks={},this._recvAudio=[],this._recvVideo=[],this._recvTransceiver={},this._subedTracks=[]}setBitrate(e,t,n){o.warn("the interface named `setBitrate` is invalid while sdpSemantics value is `unified-plan`")}addLocalTrack(e){const t=e.getTrackId(),n=e.getStreamId(),r=e.__innerGetMediaStreamTrack();this._localTracks[t]=e;const i=this._outboundStreams[n]||(this._outboundStreams[n]=new MediaStream);i.getTracks().forEach(e=>{e.kind===r.kind&&i.removeTrack(e)}),i.addTrack(r);const o=this._sendTransceiver[t];o?(o.sender.replaceTrack(r),o.direction="sendonly"):this._sendTransceiver[t]=this._peer.addTransceiver(r,{direction:"sendonly",streams:[i]})}removeLocalTrack(e){const t=e.getTrackId(),n=e.getStreamId(),r=e.__innerGetMediaStreamTrack();delete this._localTracks[t];const i=this._sendTransceiver[t];if(!i)return;i.direction="inactive",this._peer.removeTrack(i.sender),i.sender.replaceTrack(null),this._outboundStreams[n].removeTrack(r);const o=this._sendTransceiver[t+"_tiny"];if(!o)return;o.direction="inactive";const s=o.sender,a=s.track;this._peer.removeTrack(s),s.replaceTrack(null),this._outboundStreams[n+"_tiny"].removeTrack(a),a.stop()}updateRecvTransceiverMap(e,t){const{mediaType:n}=De(e);this._recvTransceiver[e]=t;const r=n===ft.AUDIO_ONLY?this._recvAudio:this._recvVideo,i=r.findIndex(e=>e===t);i>=0&&r.splice(i,1)}updateSubRemoteTracks(e){const t=e.slice(),n=this._subedTracks.slice();this._subedTracks=e.slice();for(let i=t.length-1;i>=0;i-=1){const e=t[i],r=n.findIndex(t=>t===e);r>=0&&(t.splice(i,1),n.splice(r,1))}n.length&&n.forEach(e=>{const t=e.getTrackId();e.__innerSetMediaStreamTrack(void 0),this._recvTransceiver[t].direction="inactive"});const r={audio:0,video:0};t.length&&t.forEach(e=>{const t=e.isAudioTrack()?"audio":"video",n=this._recvTransceiver[e.getTrackId()];n?n.direction="recvonly":r[t]+=1});for(let i=this._recvAudio.length;i<r.audio;i+=1)this._recvAudio.push(this._peer.addTransceiver("audio",{direction:"recvonly"}));for(let i=this._recvVideo.length;i<r.video;i+=1)this._recvVideo.push(this._peer.addTransceiver("video",{direction:"recvonly"}))}createOffer(e){return i(this,void 0,void 0,(function*(){const t=yield this._peer.createOffer({iceRestart:e});let n=t.sdp;for(const e in this._outboundStreams){const t=this._outboundStreams[e].id;n=n.replace(new RegExp(t,"g"),e)}return n=(e=>e.split(/\r\n(?=m=)/).map(e=>(e=>/a=(recvonly|inactive)/.test(e)?e.replace(/\r\na=(ssrc|msid)[^\r\n]+/g,""):e)(e)).join("\r\n"))(n),n=n.replace(/a=ice-options:trickle/g,"a=ice-options:trickle\r\na=ice-options:renomination"),t.sdp=n,yield this._peer.setLocalDescription(t),{type:"offer",semantics:"unified-plan",sdp:n}}))}setRemoteAnswer(e){e=e.split(/\r\n(?=m=)/).map(e=>{var t;const n=e.match(/a=mid:[^\s]+/);if(!n)return e;const r=n[0].replace("a=mid:","");let i="";for(const l in this._sendTransceiver)if(this._sendTransceiver[l].mid===r){i=l;break}if(!i)return e;const o=null===(t=this._localTracks[i])||void 0===t?void 0:t.getBitrate();if(!o)return e;const{max:s,min:a}=o,c=s&&s>0?o.start||.7*s:0,u=[];if(s&&s>0&&u.push(";x-google-max-bitrate="+s),a&&a>0&&u.push(";x-google-min-bitrate="+a),c>0&&u.push(";x-google-start-bitrate="+c),0===u.length)return e;const d=u.join("");return e.replace(/[\r\n]+[^\r\n]+profile-level-id[^\r\n]+/g,e=>e+d)}).join("\r\n");const t=/[\r\n]+\r\n[\r\n]+/g;return t.test(e)&&(o.warn("answer sdp invalid -> "+JSON.stringify(e)),e=e.replace(t,"\r\n")),super.setRemoteAnswer(e)}}class bt extends r["EventEmitter"]{constructor(e,t){super(),this._reTryExchange=e,this._polarisReport=t,this.pubLocalTracks={},this._reportTimer=null,this._reportListener=null;const n=Ct.getSdpSemantics(),r=this._rtcPeerConn=new RTCPeerConnection({sdpSemantics:n});this._sdpStrategy="plan-b"===n?new Rt(r):new St(r),this._rtcPeerConn.oniceconnectionstatechange=this._onICEConnectionStateChange.bind(this),this._rtcPeerConn.ontrack=this._onTrackReady.bind(this),this.reportParser=this._sdpStrategy.getStatParsr(this._rtcPeerConn,n),this._reportTimer=setInterval(this._reportHandle.bind(this),1e3)}getLocalTracks(){return Object.values(this.pubLocalTracks)}_onICEConnectionStateChange(){"failed"===this._rtcPeerConn.iceConnectionState&&(o.error("oniceconnectionstatechange -> failed"),this._reTryExchange(),this._reTryExchangeTimer=setInterval(this._reTryExchange,5e3))}_onTrackReady(e){const t=[e.streams[0].id,"audio"===e.receiver.track.kind?ft.AUDIO_ONLY:ft.VIDEO_ONLY].join("_");this._updateRecvTransceiverMap(t,e.transceiver),this.emit(bt.__INNER_EVENT_TRACK_READY__,e)}setBitrate(e,t,n){return i(this,void 0,void 0,(function*(){this._sdpStrategy.setBitrate(e,t,n)}))}createOffer(e){return i(this,void 0,void 0,(function*(){const t=yield this._sdpStrategy.createOffer(e);return o.debug("sdpDemantics -> "+t.semantics),o.debug("offer -> "+JSON.stringify(t.sdp)),t}))}setRemoteAnswer(e){return i(this,void 0,void 0,(function*(){return o.debug("answer -> "+JSON.stringify(e)),this._sdpStrategy.setRemoteAnswer(e)}))}getLocalTrack(e){return this.pubLocalTracks[e]||null}addLocalTrack(e){this.pubLocalTracks[e.getTrackId()]=e,this._sdpStrategy.addLocalTrack(e),e.off(et.__INNER_EVENT_MUTED_CHANGE__,this._onLocalTrackMuted,this),e.off(et.__INNER_EVENT_DESTROY__,this._onLocalTrackDestroied,this),e.on(et.__INNER_EVENT_MUTED_CHANGE__,this._onLocalTrackMuted,this),e.on(et.__INNER_EVENT_DESTROY__,this._onLocalTrackDestroied,this)}removeLocalTrackById(e){const t=this.getLocalTrack(e);t&&this.removeLocalTrack(t)}removeAllLocalTrack(){Object.keys(this.pubLocalTracks).forEach(e=>{/_tiny$/.test(e)||this.removeLocalTrackById(e)})}removeLocalTrack(e){const t=e.getTrackId();delete this.pubLocalTracks[t],this._sdpStrategy.removeLocalTrack(e),e.__innerSetPublished(!1),e.off(et.__INNER_EVENT_MUTED_CHANGE__,this._onLocalTrackMuted,this),e.off(et.__INNER_EVENT_DESTROY__,this._onLocalTrackDestroied,this);const n=t+"_tiny",r=this.getLocalTrack(n);r&&(this._sdpStrategy.removeLocalTrack(r),delete this.pubLocalTracks[n],r.destroy())}_updateRecvTransceiverMap(e,t){this._sdpStrategy.updateRecvTransceiverMap(e,t)}updateSubRemoteTracks(e){this._sdpStrategy.updateSubRemoteTracks(e)}getOutboundVideoInfo(){return this._sdpStrategy.getOutboundVideoInfo()}_onLocalTrackMuted(e){const t=this.getLocalTrack(e.getTrackId()+"_tiny");t&&(t.__innerGetMediaStreamTrack().enabled=!e.isLocalMuted()),this.emit(et.__INNER_EVENT_MUTED_CHANGE__,e)}_onLocalTrackDestroied(e){this.emit(et.__INNER_EVENT_DESTROY__,e)}registerReportListener(e){this._reportListener=e}_createRCRTCStateReport(e){const{timestamp:t,iceCandidatePair:n,senders:r,receivers:i}=JSON.parse(JSON.stringify(e));null==n||delete n.totalPacketsLost;for(const o in n)Je(n[o])&&delete n[o];return{timestamp:t,iceCandidatePair:n,senders:r.map(e=>{const t={};return e.trackId&&(t.trackId=e.trackId),e.kind&&(t.kind=e.kind),(e.packetsLostRate||0===e.packetsLostRate)&&(t.packetsLostRate=e.packetsLostRate),t.remoteResource=e.remoteResource,(e.audioLevel||0===e.audioLevel)&&(t.audioLevel=e.audioLevel),e.frameWidth&&(t.frameWidth=e.frameWidth),e.frameHeight&&(t.frameHeight=e.frameHeight),e.frameRate&&(t.frameRate=e.frameRate),(e.bitrate||0===e.bitrate)&&(t.bitrate=e.bitrate),e.jitter&&(t.jitter=e.jitter),t}),receivers:i.map(e=>{const t={};return e.trackId&&(t.trackId=e.trackId),e.kind&&(t.kind=e.kind),(e.packetsLostRate||0===e.packetsLostRate)&&(t.packetsLostRate=e.packetsLostRate),t.remoteResource=e.remoteResource,(e.audioLevel||0===e.audioLevel)&&(t.audioLevel=e.audioLevel),e.frameWidth&&(t.frameWidth=e.frameWidth),e.frameHeight&&(t.frameHeight=e.frameHeight),e.frameRate&&(t.frameRate=e.frameRate),(e.bitrate||0===e.bitrate)&&(t.bitrate=e.bitrate),e.jitter&&(t.jitter=e.jitter),t})}}_reportHandle(){var e,t,n,r,o;return i(this,void 0,void 0,(function*(){const i=yield this._rtcPeerConn.getStats(),s=null===(e=this.reportParser)||void 0===e?void 0:e.parseRTCStatsReport(i),a=null===(t=this.reportParser)||void 0===t?void 0:t.formatRCRTCStateReport(s);if(!a)return;const c=this._createRCRTCStateReport(a);null===(r=null===(n=this._reportListener)||void 0===n?void 0:n.onStateReport)||void 0===r||r.call(n,c),(a.senders.length||a.receivers.length)&&(null===(o=this._polarisReport)||void 0===o||o.sendR3R4Data(a))}))}destroy(){this.clear(),this.clearReTryExchangeTimer(),this._reportTimer&&(clearInterval(this._reportTimer),this._reportTimer=null),this.registerReportListener(null),this._rtcPeerConn.close(),this.reportParser=null}clearReTryExchangeTimer(){clearInterval(this._reTryExchangeTimer)}}bt.__INNER_EVENT_TRACK_READY__="inner-track-ready",function(e){e[e.DISABLE=0]="DISABLE",e[e.ENABLE=1]="ENABLE"}(pt||(pt={})),function(e){e[e.MeetingOrAnchor=1]="MeetingOrAnchor",e[e.Audience=2]="Audience"}(gt||(gt={}));class It{constructor(e,t,n,r,i=gt.MeetingOrAnchor){this._context=e,this._runtime=t,this._roomId=n,this._crtRTCRoom=r,this._userRole=i}_send(e){this._context.getConnectionStatus()===r["ConnectionStatus"].CONNECTED&&this._context.setRTCState(this._roomId,e)}_getClientID(){const e="uuid";let t=this._runtime.localStorage.getItem(e);return t||(t=Fe(),this._runtime.localStorage.setItem(e,t)),t}_getRealResourceId(e){let t=e;const n=e.indexOf("_tiny");return n>-1&&(t=e.slice(0,n)),t}_getPolarisTrackId(e){let t="";const n=e.split("_");if(e.includes("_tiny")){const e=n.pop(),r=parseInt(n.pop())===ft.AUDIO_ONLY?"audio":"video",i=n.pop();t=[n.join("_"),i,e,r].join("_")}else{const e=parseInt(n.pop())===ft.AUDIO_ONLY?"audio":"video",r=n.pop();t=[n.join("_"),r,e].join("_")}return t}sendR3R4Data(e){const{iceCandidatePair:t,senders:n,receivers:r}=e,i=(null==t?void 0:t.bitrateSend)||-1,o=(null==t?void 0:t.bitrateRecv)||-1,s=(null==t?void 0:t.networkType)||"unknown",a=(null==t?void 0:t.rtt)||-1,c=`${(null==t?void 0:t.IP)||-1}:${null==t?void 0:t.port}`,u=(null==t||t.remoteIP,null==t||t.remotePort,(null==t?void 0:t.availableIncomingBitrate)||-1),d=(null==t?void 0:t.availableOutgoingBitrate)||-1,l=(null==t?void 0:t.totalPacketsLost)||-1,h=this._context.getCurrentId();let f=`R3\t${i}\t-1\t-1\t-1\t${s}\t${a}\t${c}\t${u}\t${d}\t${l}\t${h}\r`,p=`R4\t${o}\t-1\t-1\t-1\t${s}\t${a}\t${c}\t${u}\t${d}\t${l}\t${h}\r`;const g=n.map(e=>{var t;const{trackId:n,audioLevel:r,samplingRate:i,bitrate:o,packetsLostRate:s,frameRate:a,frameWidth:c,frameHeight:u,googRenderDelayMs:d,jitter:l,nackCount:h,pliCount:f,rtt:p,googFirsSent:g,encoderImplementation:m}=e,v=this._getPolarisTrackId(n),_=this._getRealResourceId(n);return{trackId:v,googCodecName:m||String(-1),audioLevel:r||0===r?r:-1,bitrate:o||0===o?o:-1,packetsLostRate:s||0===s?s:-1,frameRate:a||-1,resolution:c&&u?`${c} * ${u}`:"-1",jitter:l||-1,nackCount:h||0===h?h:-1,pliCount:f||0===f?f:-1,rtt:p||-1,googFirsSent:g,samplingRate:i,googRenderDelayMs:d,encoderImplementation:m||String(-1),trackState:(null===(t=this._crtRTCRoom.getLocalTrack(_))||void 0===t?void 0:t.isLocalMuted())?pt.DISABLE:pt.ENABLE}}),m=r.filter(e=>!!e.trackId).map(e=>{var t;const{trackId:n,audioLevel:r,samplingRate:i,bitrate:o,packetsLostRate:s,frameRate:a,frameWidth:c,frameHeight:u,googRenderDelayMs:d,jitter:l,nackCount:h,pliCount:f,rtt:p,googFirsReceived:g,codecImplementationName:m}=e,v=this._getPolarisTrackId(n),_=this._getRealResourceId(n);return{trackId:v,googCodecName:m||String(-1),audioLevel:r||0===r?r:-1,bitrate:o||0===o?o:-1,packetsLostRate:s||0===s?s:-1,frameRate:a||-1,resolution:c&&u?`${c} * ${u}`:"-1",jitter:l||-1,nackCount:h||0===h?h:-1,pliCount:f||0===f?f:-1,rtt:p||-1,googFirsReceived:g,samplingRate:i,googRenderDelayMs:d,codecImplementationName:m||String(-1),trackState:(null===(t=this._crtRTCRoom.getRemoteTrack(_))||void 0===t?void 0:t.isLocalMuted())?pt.DISABLE:pt.ENABLE}});f+=g.map(e=>`${e.trackId}\t${e.googCodecName}\t${e.audioLevel}\t${e.samplingRate}\t${e.bitrate}\t${e.packetsLostRate}\t${e.frameRate}\t${e.resolution}\t${e.googRenderDelayMs}\t${e.jitter}\t${e.nackCount}\t${e.pliCount}\t${e.rtt}\t${e.googFirsSent}\t${e.encoderImplementation}\t${e.trackState}`).join("\n"),this._send(f+"\r"+this._userRole),p+=m.map(e=>`${e.trackId}\t${e.googCodecName}\t${e.audioLevel}\t${e.samplingRate}\t${e.bitrate}\t${e.packetsLostRate}\t${e.frameRate}\t${e.resolution}\t${e.googRenderDelayMs}\t${e.jitter}\t${e.nackCount}\t${e.pliCount}\t${e.rtt}\t${e.googFirsReceived}\t${e.codecImplementationName}\t${e.trackState}`).join("\n"),this._send(p+"\r"+this._userRole)}sendR1(){const e=`R1\t5.1.1\t${this._context.getCoreVersion()}\tweb\t${navigator.platform}\t-1\t${Ke.browser}\t${Ke.version}\t${this._getClientID()}\t${this._userRole}`;this._send(e)}sendR2(e,t,n){const r=`R2\t${e}\t${t}\t${this._getClientID()}\r${n.join("\t")}\r${this._userRole}`;this._send(r)}}class Ot extends Xe{constructor(e,t,n,r){super(e,t,n,!1,r),this._isSubscribed=!1}__innerSetRemoteMuted(e){this._remoteMuted=e}__innerSetSubscribed(e){this._isSubscribed=e}isSubscribed(){return this._isSubscribed}}class wt extends Ot{constructor(e,t,n){super(e,t,"audio",n)}}class Nt extends Ot{constructor(e,t,n){super(e,t,"video",n)}}!function(e){e.PUBLISH="publish",e.SUBSCRIBE="subscribe"}(mt||(mt={})),function(e){e.BEGIN="begin",e.END="end"}(vt||(vt={}));const At=e=>{const t={},n=Object.keys(e.users);return n.length&&n.forEach(n=>{const r=[],i=e.users[n];if(i.uris)try{r.push(...JSON.parse(i.uris))}catch(e){o.warn(`invalid user data -> userId: ${n}, userData: ${i}`)}t[n]=r}),t},Mt=e=>e instanceof Xe?e.getTrackId():e.track.getTrackId();class Pt{constructor(e,t,n,r,i,s,a,c,u){this._context=e,this._runtime=t,this._roomId=n,this._roomMode=i,this._service=s,this._initOptions=a,this._clientEvent=c,this._remoteTracks={},this._subscribedList=[],this._destroyed=!1,this._appListener=null,this._token=r.token,this._sessionId=r.sessionId,this._roomResources=u?{}:At(r),this._initRemoteTracks();const l=this._context.getCurrentId(),h=this._roomResources[l]=this._roomResources[l]||[];o.debug("room data -> "+JSON.stringify(this._roomResources)),h.length>0&&d(()=>this._unpublishPrev(h)),u&&this._afterChangedRole(At(r)),this._pinger=new Ze(n,this._roomMode,e,this._initOptions.pingGap),this._pinger.onFailed=this._kickoff.bind(this),this._pinger.start(),this._polarisReport=new It(this._context,this._runtime,this._roomId,this),this._polarisReport.sendR1(),this._pc=new bt(this._reTryExchange.bind(this),this._polarisReport),this._pc.on(bt.__INNER_EVENT_TRACK_READY__,this._onTrackReady,this),this._pc.on(et.__INNER_EVENT_MUTED_CHANGE__,this._onLocalTrackMuted,this),this._pc.on(et.__INNER_EVENT_DESTROY__,this._onLocalTrackDestroied,this)}_initRemoteTracks(){const e=this._context.getCurrentId();for(const t in this._roomResources){const n=this._roomResources[t];t!==e&&0!==n.length&&n.forEach(e=>{const t=Ue(e),{tag:n,userId:r,mediaType:i}=De(t),o=i===ft.AUDIO_ONLY?new wt(n,r):new Nt(n,r);o.__innerSetRemoteMuted(0===e.state),this._remoteTracks[t]=o})}}setBitrate(e,t,n){o.warn("`RCAbstractRoom.setBitrate` will be deprecated, use `RCLocalTrack.setBitrate` instead."),Object(r["assert"])("max",e,e=>Object(r["isNumber"])(e)&&e>Math.max(t||1,200),!0),Object(r["assert"])("min",t,t=>Object(r["isNumber"])(t)&&t>=1&&(!Object(r["isNumber"])(e)||t<e),!0),Object(r["assert"])("start",n,n=>Object(r["isNumber"])(n)&&n>t&&n<=e),this._pc.setBitrate(e,t,n)}_onTrackReady(e){const t=e.streams[0].id,n=e.receiver.track,r=[t,"audio"===n.kind?ft.AUDIO_ONLY:ft.VIDEO_ONLY].join("_"),i=this._remoteTracks[r];i?(i.__innerSetMediaStreamTrack(n),this._callAppListener("onTrackReady",i)):o.warn("cannot found remote track "+n.id)}_callAppListener(e,...t){var n;const r=null===(n=this._appListener)||void 0===n?void 0:n[e];if(r)try{r(...t)}catch(e){o.error(e)}}_onUserUnpublish(e){return i(this,void 0,void 0,(function*(){yield this.unsubscribe(e),e.forEach(e=>{e.__innerDestroy(),delete this._remoteTracks[e.getTrackId()]}),this._onTrackUnpublish(e)}))}_onTrackUnpublish(e){this._callAppListener("onTrackUnpublish",e)}_unpublishPrev(e){return i(this,void 0,void 0,(function*(){const t=e.slice();e.length=0,o.info("unpublish uris prev login: "+JSON.stringify(t));const n=yield this._context.setRTCTotalRes(this._roomId,Ae(ze.UNPUBLISH,t),Me([]),ze.TOTAL_CONTENT_RESOURCE,Me([]));n!==r["ErrorCode"].SUCCESS?o.error("unpublish prev uris failed -> code: "+n):o.debug("unpublish uris prev login succeed")}))}__parseInnerMessage(e){const{targetId:t,conversationType:n}=e;if(n!==r["ConversationType"].RTC_ROOM)return!1;if(t!==this._roomId)return!0;const i=e.content;switch(e.messageType){case ze.KICK:this._kickoff(!0);break;case ze.STATE:this._stateHandle(i);break;case ze.MODIFY:case ze.PUBLISH:case ze.UNPUBLISH:case ze.TOTAL_CONTENT_RESOURCE:this._resourceHandle(i,e.messageType,e.senderUserId);break;case ze.ROOM_NOTIFY:this._callAppListener("onRoomAttributeChange",e.messageType,e.content);break;case ze.USER_NOTIFY:o.warn("TODO: "+ze.USER_NOTIFY);break;default:this._callAppListener("onMessageReceive",e.messageType,e.content,e.senderUserId,e.messageUId)}return!0}_kickoff(e){o.warn("onKickOff byServer:",e),this._clientEvent(),this._leaveHandle(!e),this._callAppListener("onKickOff",e)}_resourceHandle(e,t,n){return i(this,void 0,void 0,(function*(){const{uris:r,ignore:i}=e;if(i)return;const a=[],c=[],u=[];let d;const l=this._roomResources[n]||(this._roomResources[n]=[]);switch(t){case ze.MODIFY:u.push(...r);break;case ze.PUBLISH:a.push(...r);break;case ze.UNPUBLISH:c.push(...r);break;case ze.TOTAL_CONTENT_RESOURCE:d=Be(l,r),a.push(...d.publishedList),c.push(...d.unpublishedList),u.push(...d.modifiedList)}if(a.length>0){const e=l.map(Ue),t=[],n=[];if(a.forEach(r=>{const i=Ue(r),o=e.indexOf(i),{userId:s,tag:a,mediaType:c}=De(i);o>-1?l[o]=r:l.push(r);let u=this._remoteTracks[i];u?u.isSubscribed()&&t.push(u):(u=c===ft.AUDIO_ONLY?new wt(a,s):new Nt(a,s),this._remoteTracks[i]=u,n.push(u)),u.__innerSetRemoteMuted(0===r.state)}),t.length){const e=t.map(e=>e.getTrackId());o.debug("resub tracks -> "+JSON.stringify(e));const{code:n}=yield this.__subscribe(t,!0);n!==s.SUCCESS&&o.error(`resub tracks failed -> code: ${n}, ids: ${JSON.stringify(e)}`)}this._onTrackPublish(n)}if(c.length>0){const e=c.map(Ue);for(let n=l.length-1;n>=0;n-=1){const t=l[n];e.includes(Ue(t))&&l.splice(n,1)}const t=c.map(e=>{const t=Ue(e);return this._remoteTracks[t]});yield this._onUserUnpublish(t)}if(u.length>0){const e=l.map(Ue);for(let t=0;t<u.length;t+=1){const n=u[t],r=Ue(n),i=e.indexOf(r);l[i].state=n.state;const o=this._remoteTracks[r];o.__innerSetRemoteMuted(0===n.state),o.isAudioTrack()?this._onAudioMuteChange(o):this._onVideoMuteChange(o)}}}))}_onTrackPublish(e){this._callAppListener("onTrackPublish",e)}_stateHandle(e){const{users:t}=e;if(0===t.length)return;const n=[],r=[];if(t.forEach(e=>{0==+e.state?(!this._roomResources[e.userId]&&n.push(e.userId),this._roomResources[e.userId]=this._roomResources[e.userId]||[]):r.push(e.userId)}),r.length>0){const e=[];r.forEach(t=>{e.push(...this.getRemoteTracksByUserId(t)),delete this._roomResources[t]}),e.length&&(this.unsubscribe(e),e.forEach(e=>delete this._remoteTracks[e.getTrackId()]))}n.length>0&&this._callAppListener("onUserJoin",n),r.length>0&&this._callAppListener("onUserLeave",r)}getRoomId(){return this._roomId}getRemoteUserIds(){const e=this._context.getCurrentId();return Object.keys(this._roomResources).filter(t=>t!==e)}getRemoteTracks(){const e=[];return this.getRemoteUserIds().forEach(t=>{e.push(...this.getRemoteTracksByUserId(t))}),e}getRemoteTracksByUserId(e){const t=[];for(const n in this._remoteTracks){const r=this._remoteTracks[n];r.getUserId()===e&&t.push(r)}return t}getSessionId(){return this._sessionId}sendMessage(e,t){return i(this,void 0,void 0,(function*(){const{code:n}=yield this._context.sendMessage(r["ConversationType"].RTC_ROOM,this._roomId,{messageType:e,content:t,isStatusMessage:!0});return n!==r["ErrorCode"].SUCCESS?(o.error("send message failed -> code: "+n),{code:s.SIGNAL_ERROR}):{code:s.SUCCESS}}))}setRoomAttribute(e,t,n,a=!1){return i(this,void 0,void 0,(function*(){const i=yield this._context.setRTCData(this._roomId,e,t,a,r["RTCApiType"].ROOM,n);return i!==r["ErrorCode"].SUCCESS?(o.error("SetRoomAttributeValue Failed: "+i),{code:s.SIGNAL_ERROR}):{code:s.SUCCESS}}))}deleteRoomAttributes(e,t,n=!1){return i(this,void 0,void 0,(function*(){const i=yield this._context.removeRTCData(this._roomId,e,n,r["RTCApiType"].ROOM,t);return i!==r["ErrorCode"].SUCCESS?(o.error("DeleteRoomAttribute Failed: "+i),{code:s.SIGNAL_ERROR}):{code:s.SUCCESS}}))}getRoomAttributes(e=[],t=!1){return i(this,void 0,void 0,(function*(){const{code:n,data:i}=yield this._context.getRTCData(this._roomId,e,t,r["RTCApiType"].ROOM);return n!==r["ErrorCode"].SUCCESS?(o.error("GetRoomAttributes Failed: "+n),{code:s.SIGNAL_ERROR}):{code:s.SUCCESS,data:i}}))}_setUserAttributeValue(e,t,n){return this._context.setRTCData(this._roomId,e,t,!1,r["RTCApiType"].PERSON,n)}_deleteUserAttributes(e,t){return this._context.removeRTCData(this._roomId,e,!1,r["RTCApiType"].PERSON,t)}_getUserAttributes(e){return this._context.getRTCData(this._roomId,e,!1,r["RTCApiType"].PERSON)}isDestroyed(){return this._destroyed}__destroy(e){return this._leaveHandle(e)}_leaveHandle(e){return i(this,void 0,void 0,(function*(){this._destroyed||(this._destroyed=!0,e&&(yield this._context.quitRTCRoom(this._roomId)),this._pc.removeAllLocalTrack(),this._pinger.stop(),yield this._service.exit(this._getRTCReqestHeaders()),this._pc.destroy(),this._polarisReport=null)}))}_onLocalTrackDestroied(e){}_onLocalTrackMuted(e){return i(this,void 0,void 0,(function*(){const t=e.getTrackId(),n=this._context.getCurrentId(),i=[{resourceId:t,enabled:!e.isLocalMuted()}],s=this._roomResources[n]||[],a=[];for(let e=0;e<s.length;e+=1){const t=s[e],n=Ue(t),r=i.findIndex(e=>e.resourceId===n);if(r>=0){const{enabled:e}=i[r];t.state=e?1:0,a.push(t);break}}const c=yield d(()=>this._context.setRTCTotalRes(this._roomId,Ae(ze.MODIFY,a),Me(s),ze.TOTAL_CONTENT_RESOURCE));c!==r["ErrorCode"].SUCCESS&&o.error("notice `track.enabled` change failed -> code: "+c)}))}publish(e){return i(this,void 0,void 0,(function*(){return d(()=>this.__publish(e))}))}__publish(e){return i(this,void 0,void 0,(function*(){if(this._assertRoomDestroyed())return o.error("publish failed, room has been destroyed. -> roomId: "+this._roomId),{code:s.ROOM_HAS_BEEN_DESTROYED};if(!Object(r["validate"])("tracks",e,()=>Object(r["isArray"])(e)&&e.length>0&&e.every(e=>e instanceof et||e.track instanceof et),!0))return o.error("publish failed, tracks is invalid -> roomId: "+this._roomId),{code:s.PARAMS_ERROR};o.debug(`publish tracks -> roomId: ${this._roomId}, tracks: ${e.map(Mt)}`);const t=this._context.getCurrentId();e.forEach(e=>{const{track:t,pubTiny:n}=e instanceof et?{pubTiny:!1,track:e}:e;if(this._pc.addLocalTrack(t),t.isVideoTrack()&&n){let e;try{e=t.__innerGetMediaStreamTrack().clone();const r=n.frameRate||Se.FPS_15,i=n.resolution||be.W176_H144,{width:o,height:s}=He(i),a=qe(r);e.applyConstraints({width:o,height:s,frameRate:a})}catch(n){return null==e||e.stop(),void o.warn(`pubTiny failed -> id: ${t.getTrackId()}, msg: ${n.message}`)}this._pc.addLocalTrack(new nt(t.getTag(),t.getUserId(),e,!0))}}),this._pc.clearReTryExchangeTimer();const n=yield this._createExchangeParams(this._subscribedList,!1),i=yield this._exchangeHandle(n);if(i.code!==s.SUCCESS)return o.error(`publish failed -> roomId: ${this._roomId}, code: ${i.code}`),{code:i.code};const{publishList:a,sdp:c,resultCode:u,message:d,urls:l,mcuPublishList:h}=i.data;if(u!==s.SUCCESS)return o.error(`publish failed -> roomId: ${this._roomId}, code: ${u}, msg: ${d}`),{code:u};const f=yield this._pc.setRemoteAnswer(c.sdp);if(f!==s.SUCCESS)return{code:f};const p=this._roomResources[t],g=a.map(e=>Object.assign({tag:e.msid.split("_").pop(),state:this._getResourceState(Ue(e))},e)),{publishedList:m}=Be(p,g),v=(null==h?void 0:h.map(e=>Object.assign({tag:e.msid.split("_").pop(),state:1},e)))||[],_=yield this._context.setRTCTotalRes(this._roomId,Ae(ze.PUBLISH,m),Me(g),ze.TOTAL_CONTENT_RESOURCE,Me(v));if(_!==r["ErrorCode"].SUCCESS)return o.error("send publish streams notification failed: "+_),{code:s.SIGNAL_ERROR};this._roomResources[t]=g;const y=m.map(e=>Ue(e));return this._polarisReport&&this._polarisReport.sendR2(mt.PUBLISH,vt.BEGIN,y),e.forEach(e=>{const{track:t}=e instanceof et?{track:e}:e;t.__innerSetPublished(!0)}),o.debug("publish success: "+y.join(",")),this._roomMode===r["RTCMode"].LIVE?{code:s.SUCCESS,liveUrl:null==l?void 0:l.liveUrl}:{code:s.SUCCESS}}))}_reTryExchange(){return i(this,void 0,void 0,(function*(){d(()=>i(this,void 0,void 0,(function*(){const e=yield this._createExchangeParams(this._subscribedList,!0),t=yield this._exchangeHandle(e);if(t.code!==s.SUCCESS)return o.error("reTryExchange failed: "+t.code),{code:t.code};const{sdp:n,resultCode:r}=t.data;if(r!==s.SUCCESS)return o.error("reTryExchange failed: "+r),{code:r};this._pc.clearReTryExchangeTimer();const i=yield this._pc.setRemoteAnswer(n.sdp);return i!==s.SUCCESS?{code:i}:void 0})))}))}_exchangeHandle(e){return this._service.exchange(this._getRTCReqestHeaders(),e)}_getRTCReqestHeaders(){return{"App-Key":this._context.getAppkey(),RoomId:this._roomId,Token:this._token,RoomType:this._roomMode,UserId:this._context.getCurrentId()}}_createExchangeParams(e,t){return i(this,void 0,void 0,(function*(){return{sdp:yield this._pc.createOffer(t),extend:JSON.stringify({resolutionInfo:this._pc.getOutboundVideoInfo()}),subscribeList:e.map(e=>({simulcast:e.subTiny?Qe.TINY:Qe.NORMAL,resolution:"",uri:this._getResourceById(e.track.getTrackId()).uri})),switchstream:!1}}))}_getResourceState(e){var t;return(null===(t=this.getLocalTrack(e))||void 0===t?void 0:t.isLocalMuted())?0:1}unpublish(e){return i(this,void 0,void 0,(function*(){return d(()=>this.__unpublish(e))}))}__unpublish(e){var t,n;return i(this,void 0,void 0,(function*(){if(this._assertRoomDestroyed())return o.warn("room has been destroyed, no need to unpublish tracks -> roomId: "+this._roomId),{code:s.SUCCESS};const i=this._context.getCurrentId();if(!Object(r["validate"])("tracks",e,()=>e.every(e=>e.getUserId()===i&&e instanceof et),!0))return o.warn(`unpublish failed, tracks is invalid -> roomId: ${this._roomId}, tracks: ${e.map(Mt)}`),{code:s.PARAMS_ERROR};const a=e.map(e=>e.getTrackId()),c=a.map(this._getResourceById.bind(this)).filter(e=>!!e);if(0===c.length)return{code:s.SUCCESS};const u=this._roomResources[i].filter(e=>!c.includes(e));a.forEach(e=>this._pc.removeLocalTrackById(e)),null===(t=this._polarisReport)||void 0===t||t.sendR2(mt.PUBLISH,vt.END,a),this._pc.clearReTryExchangeTimer();const d=yield this._createExchangeParams(this._subscribedList,!1),l=yield this._exchangeHandle(d);if(l.code!==s.SUCCESS)return o.error("exchange failed -> code: "+l.code),{code:l.code};null===(n=this._pc.reportParser)||void 0===n||n.clearLatestpacketsSent(a);const{publishList:h,sdp:f,resultCode:p,message:g,mcuPublishList:m}=l.data;p!==s.SUCCESS&&o.error(`unpublish streams failed -> code: ${p}, msg: ${g}`);const v=m?m.map(e=>Object.assign({tag:e.msid.split("_").pop(),state:1},e)):[],_=yield this._context.setRTCTotalRes(this._roomId,Ae(ze.UNPUBLISH,c),Me(u),ze.TOTAL_CONTENT_RESOURCE,Me(v));if(_!==r["ErrorCode"].SUCCESS)return o.error("send unpublish notification failed:",_),{code:s.SIGNAL_ERROR};o.debug("unpublish success -> tracks: "+a.join(","));const y=yield this._pc.setRemoteAnswer(f.sdp);if(y!==s.SUCCESS)return{code:y};const E=h.map(e=>Object.assign({tag:e.msid.split("_").pop(),state:this._getResourceState(Ue(e))},e));return this._roomResources[i]=E,{code:s.SUCCESS}}))}_getResourceById(e){const{userId:t}=De(e);return this._roomResources[t].find(t=>Ue(t)===e)}_isValidResourceId(e){var t;const{userId:n}=De(e);return!!(null===(t=this._roomResources[n])||void 0===t?void 0:t.find(t=>Ue(t)===e))}subscribe(e){return i(this,void 0,void 0,(function*(){return d(()=>this.__subscribe(e,!1))}))}__subscribe(e,t=!1){var n;return i(this,void 0,void 0,(function*(){if(this._assertRoomDestroyed())return o.error("subscribe failed, room has been destroyed -> roomId: "+this._roomId),{code:s.ROOM_HAS_BEEN_DESTROYED};if(!Object(r["validate"])("tracks",e,()=>Object(r["isArray"])(e)&&e.length>0&&e.every(e=>e instanceof Ot||e.track instanceof Ot),!0))return o.error("subscribe failed, tracks is invalid -> roomId: "+this._roomId),{code:s.PARAMS_ERROR};o.info(`subscribe -> roomId: ${this._roomId}, tracks: ${e.map(Mt)}`);const i=this._subscribedList.map(e=>Object.assign({},e)),a=e.map(e=>e instanceof Ot?{track:e}:e);let c=!1;const u=[];return a.forEach(e=>{const t=e.track.getTrackId();u.push(t);const n=i.find(e=>e.track.getTrackId()===t);n&&n.subTiny===e.subTiny||(n?n.subTiny=e.subTiny:i.push(e),c=!0)}),c||t?(null===(n=this._polarisReport)||void 0===n||n.sendR2(mt.SUBSCRIBE,vt.BEGIN,u),this._updateSubListHandle(i,!0)):{code:s.SUCCESS}}))}unsubscribe(e){return i(this,void 0,void 0,(function*(){return d(()=>this.__unsubscribe(e))}))}__unsubscribe(e){var t;return i(this,void 0,void 0,(function*(){if(this._assertRoomDestroyed())return o.warn("room has beed destroyed, no need to unsubscribe tracks -> roomId: "+this._roomId),{code:s.SUCCESS};if(!Object(r["validate"])("tracks",e,()=>Object(r["isArray"])(e)&&e.length>0&&e.every(e=>e instanceof Ot),!0))return o.error("unsubscribe failed, tracks is invalid -> roomId: "+this._roomId),{code:s.PARAMS_ERROR};o.info(`unsubscribe -> roomId: ${this._roomId}, tracks: ${e.map(Mt)}`);const n=this._subscribedList.map(e=>Object.assign({},e)).filter(t=>!e.includes(t.track));return null===(t=this._polarisReport)||void 0===t||t.sendR2(mt.SUBSCRIBE,vt.END,e.map(e=>e.getTrackId())),this._updateSubListHandle(n,!1)}))}_assertRoomDestroyed(){if(this._destroyed){const e="This room has been destroyed. Please use `RCRTCClient.joinRTCRoom` or `RCRTCClient.joinLivingRoom` to catch another instance.";return o.warn(e),s.ROOM_HAS_BEEN_DESTROYED}}getLocalTrack(e){return this._pc.getLocalTrack(e)}getLocalTracks(){return this._pc.getLocalTracks()}getRemoteTrack(e){return this._remoteTracks[e]||null}updateSubList(e){return i(this,void 0,void 0,(function*(){return d(()=>this._updateSubListHandle(e,!1))}))}_updateSubListHandle(e,t=!1){var n;return i(this,void 0,void 0,(function*(){if(this._assertRoomDestroyed())return{code:s.ROOM_HAS_BEEN_DESTROYED};if(!Object(r["validate"])("resources",e,()=>Object(r["isArray"])(e)&&e.every(e=>e instanceof Ot||e.track instanceof Ot),!0))return o.error("update sublist failed, tracks is invalid -> roomId: "+this._roomId),{code:s.PARAMS_ERROR};o.info(`update subscribe list -> roomId: ${this._roomId}, forceReq: ${t}, tracks: ${e.map(Mt)}`);let i=e.map(e=>e instanceof Ot?{track:e}:Object.assign({},e));const a={};i=i.filter(e=>{const t=e.track.getTrackId();return!a[t]&&(a[t]=!0)}).map(e=>Object.assign({},e));const c=this._subscribedList.map(e=>Object.assign({},e));if(!t){let e=!1;if(i.forEach(t=>{const n=c.findIndex(e=>e.track===t.track);-1!==n?c.splice(n,1)[0].subTiny!==t.subTiny&&(e=!0):e=!0}),c.length&&(e=!0),!e)return{code:s.SUCCESS}}this._pc.clearReTryExchangeTimer(),this._pc.updateSubRemoteTracks(i.map(e=>e.track));const u=yield this._createExchangeParams(i,!1),d=yield this._exchangeHandle(u);if(c.length){const e=c.map(e=>e.track.getTrackId());null===(n=this._pc.reportParser)||void 0===n||n.clearLatestPacketsRecv(e)}const l=i.map(e=>e.track.getTrackId());if(d.code!==s.SUCCESS)return{code:d.code};const{sdp:h,resultCode:f,message:p}=d.data;if(f!==s.SUCCESS)return o.error("change subscribe list failed: "+f),{code:f};o.debug("subscribe success: "+l.join(","));const g=yield this._pc.setRemoteAnswer(h.sdp);if(g!==s.SUCCESS)return{code:g};for(const e in this._remoteTracks){const t=i.some(t=>t.track.getTrackId()===e);this._remoteTracks[e].__innerSetSubscribed(t)}return this._subscribedList.splice(0,this._subscribedList.length,...i),{code:s.SUCCESS}}))}registerRoomEventListener(e){this._appListener=e}registerReportListener(e){this._pc.registerReportListener(e)}__onReconnected(e){return i(this,void 0,void 0,(function*(){const{code:t,data:n}=yield this._context.joinRTCRoom(this._roomId,this._roomMode,e);if(t!==r["ErrorCode"].SUCCESS)return void o.error("RTC __onReconnected getRTCRoomInfo failed: "+t);o.debug("RTC __onReconnected getRTCRoomInfo success: "+JSON.stringify(n));const i=[],s={},a={},c={},u=At(n),d=Object.keys(u),l=Object.keys(this._roomResources);for(let e=d.length-1;e>=0;e-=1){const t=d[e],n=l.indexOf(t);if(-1===n)return i.push(t),void(s[t]=Ve(u[t]));const r=this._roomResources[t],o=u[t],{publishedList:h,modifiedList:f,unpublishedList:p}=Be(r,o);s[t]=Ve(h),a[t]=Ve(p),c[t]=Ve(f),l.splice(n,1)}l.length&&l.forEach(e=>{delete this._roomResources[e]}),Object.assign(this._roomResources,u),l.length&&this._callAppListener("onUserLeave",l),i.length&&this._callAppListener("onUserJoin",i);for(const e in a){const t=a[e];if(t.length){const e=t.map(e=>this._remoteTracks[Ue(e)]);yield this._onUserUnpublish(e)}}Object.keys(s).forEach(e=>{const t=s[e];if(0===t.length)return;const n=t.map(e=>{const t=Ue(e),{userId:n,tag:r,mediaType:i}=De(t),o=this._remoteTracks[t]=i===ft.AUDIO_ONLY?new wt(r,n):new Nt(r,n);return o.__innerSetRemoteMuted(0===e.state),o});this._onTrackPublish(n)}),Object.keys(c).forEach(e=>{c[e].forEach(e=>{const t=Ue(e),n=this._remoteTracks[t];n.__innerSetRemoteMuted(0===e.state),n.isAudioTrack()?this._onAudioMuteChange(n):this._onVideoMuteChange(n)})})}))}_onAudioMuteChange(e){this._callAppListener("onAudioMuteChange",e)}_onVideoMuteChange(e){this._callAppListener("onVideoMuteChange",e)}_afterChangedRole(e){const t=this._context.getCurrentId(),n=Object.keys(e);setTimeout(()=>{const r=n.filter(e=>e!==t);r.length>0&&this._callAppListener("onUserJoin",r);for(const n in e)n!==t&&this._resourceHandle({uris:e[n]},ze.TOTAL_CONTENT_RESOURCE,n)})}}var kt,Lt,xt;!function(e){e[e.CROP=1]="CROP",e[e.WHOLE=2]="WHOLE"}(kt||(kt={})),function(e){e[e.CUSTOMIZE=1]="CUSTOMIZE",e[e.SUSPENSION=2]="SUSPENSION",e[e.ADAPTATION=3]="ADAPTATION"}(Lt||(Lt={})),function(e){e[e.CROP=1]="CROP",e[e.WHOLE=2]="WHOLE"}(xt||(xt={}));const Ut=()=>({version:1,mode:Lt.SUSPENSION});class Dt{constructor(e,t){this._onFlush=e,this._isValidTrackId=t,this._values=Ut()}setHostVideoTrack(e){if(!this._isValidTrackId(e))return o.error("setHostVideoTrack failed: videoTrackId is invalid -> "+e),this;const{mediaType:t,tag:n,userId:r}=De(e);return t!==ft.VIDEO_ONLY?(o.error("setHostVideoTrack failed: kind of resource is not 'video' -> "+e),this):(this._values.host_stream_id=je(r,n),this)}setMixLayoutMode(e){return[Lt.CUSTOMIZE,Lt.SUSPENSION,Lt.ADAPTATION].includes(e)?(this._values.mode=e,this):(o.error("layout mode is invalid: "+e),this)}_addOutputValue(e,t,n="normal"){const r=this._values.output||(this._values.output={video:{normal:{width:640,height:480}}});if("cdn"===e)return void(r.cdn=t);if("audio"===e)return void(r.audio={bitrate:t});const i=r.video;if("normal"!==n&&"tiny"!==n)if("backgroundColor"!==n)if("exparams"!==n){if("backgroundPicture"===n){const e=i.backgroundPicture||(i.backgroundPicture={fillMode:kt.CROP,picture:[]});Object.assign(e,t)}}else i.exparams={renderMode:t};else i.backgroundColor=t;else{const e=i[n]||(i[n]={});Object.assign(e,t)}}setOutputVideoResolution(e){if(!Ge(e))return o.warn("setOutputVideoResolution failed: `resolution` is invalid"),this;const{width:t,height:n}=He(e);return this._addOutputValue("video",{width:t,height:n},"normal"),this}setOutputVideoFPS(e){if(!Ye(e))return o.warn("setOutputVideoFPS failed: `fps` is invalid"),this;const t=qe(e);return this._addOutputValue("video",{fps:t},"normal"),this}setOutputVideoBitrate(e){return!Object(r["isNumber"])(e)||e<=0?o.error("bitrate is invalid: "+e):this._addOutputValue("video",{bitrate:e},"normal"),this}setOutputTinyVideoResolution(e){if(!Ge(e))return o.warn("setOutputTinyVideoResolution failed: `resolution` is invalid"),this;const{width:t,height:n}=He(e);return this._addOutputValue("video",{width:t,height:n},"tiny"),this}setOutputTinyVideoFPS(e){if(!Ye(e))return o.warn("setOutputTinyVideoFPS failed: `fps` is invalid"),this;const t=qe(e);return this._addOutputValue("video",{fps:t},"tiny"),this}setOutputTinyVideoBitrate(e){return!Object(r["isNumber"])(e)||e<=0?o.error("bitrate is invalid: "+e):this._addOutputValue("video",{bitrate:e},"tiny"),this}setOutputVideoRenderMode(e){return[xt.CROP,xt.WHOLE].includes(e)?this._addOutputValue("video",e,"exparams"):o.error("renderMode is invalid: "+e),this}setOutputAudioBitrate(e){return Object(r["isNumber"])(e)&&e>0?this._addOutputValue("audio",e):o.error("bitrate is invalid: "+e),this}setOutputBackgroundColor(e){return/^0x[a-fA-F0-9]{6}$/.test(e)?this._addOutputValue("video",e,"backgroundColor"):o.error("color is invalid: "+e),this}addOutputBackgroundPicture(e,t,n,i,s){var a,c,u;if(!Object(r["isHttpUrl"])(e))return o.error("uri is invalid: "+e),this;if([t,n,i,s].some(e=>!Object(r["isNumber"])(e)||e<0||e>1))return o.error(`some attrs of (x, y, w, h) is invalid: ${t}, ${n}, ${i}, ${s}`),this;const d=(null===(u=null===(c=null===(a=this._values.output)||void 0===a?void 0:a.video)||void 0===c?void 0:c.backgroundPicture)||void 0===u?void 0:u.picture)||[];return d.push({uri:e,w:i,h:s,x:t,y:n}),this._addOutputValue("video",{picture:d},"backgroundPicture"),this}removeOutputBackgroundPicture(e){var t,n,i;if(!Object(r["isHttpUrl"])(e))return o.error("uri is invalid: "+e),this;let s=null===(i=null===(n=null===(t=this._values.output)||void 0===t?void 0:t.video)||void 0===n?void 0:n.backgroundPicture)||void 0===i?void 0:i.picture;return s&&(s=s.filter(t=>t.uri!==e),this._addOutputValue("video",{pictures:s},"backgroundPicture")),this}clearOutputBackgroundPicture(){return this._addOutputValue("video",{pictures:[]},"backgroundPicture"),this}setOutputBackgroundPictureFillMode(e){return[kt.CROP,kt.WHOLE].includes(e)?this._addOutputValue("video",{fillMode:e},"backgroundPicture"):o.error("fillMode is invalid: "+e),this}addPublishStreamUrls(e){var t,n;const i=/^rtmp:\/\/.+/;if(!Object(r["isArray"])(e)||0===e.length||e.some(e=>!i.test(e)))return o.error("urls is invalid: "+e),this;const s=(null===(n=null===(t=this._values.output)||void 0===t?void 0:t.cdn)||void 0===n?void 0:n.concat())||[];let a=!1;return e.forEach(e=>{s.some(t=>t.pushurl===e)||(a=!0,s.push({pushurl:e}))}),s.length>5?(o.error("publish stream url no more than 5"),this):(a&&this._addOutputValue("cdn",s),this)}removePublishStreamUrls(e){var t,n;const i=/^rtmp:\/\/.+/;if(!Object(r["isArray"])(e)||0===e.length||e.some(e=>!i.test(e)))return o.error("urls is invalid: "+e),this;const s=(null===(n=null===(t=this._values.output)||void 0===t?void 0:t.cdn)||void 0===n?void 0:n.concat())||[];for(let r=s.length-1;r>=0;r-=1){const{pushurl:t}=s[r],n=e.indexOf(t);n>=0&&(e.splice(n,1),s.splice(r,1))}return this._addOutputValue("cdn",s),this}clearPublishStreamUrls(){return this._addOutputValue("cdn",[]),this}addCustomizeLayoutVideo(e,t,n,i,s){if(!this._isValidTrackId(e))return o.error("trackId is invalid: "+e),this;if(!Object(r["isNumber"])(t)||!Object(r["isNumber"])(n))return o.error(`some attrs of (x, y) is invalid: ${t}, ${n}`),this;if([i,s].some(e=>!Object(r["isNumber"])(e)||e<0))return o.error(`some attrs of (width, height) is invalid: ${i}, ${s}`),this;const{userId:a,tag:c,mediaType:u}=De(e);if(u!==ft.VIDEO_ONLY)return o.error("kind of resource is not 'video': "+e),this;const d=je(a,c);return(this._values.input||(this._values.input={video:[]})).video.push({user_id:a,stream_id:d,x:t,y:n,width:i,height:s}),this}removeCustomizeLayoutVideo(e){if(!this._isValidTrackId(e))return o.error("trackId is invalid: "+e),this;const{userId:t,tag:n,mediaType:r}=De(e);if(r!==ft.VIDEO_ONLY)return o.error("kind of resource is not 'video': "+e),this;const i=je(t,n),s=this._values.input||(this._values.input={video:[]});return s.video=s.video.filter(e=>e.stream_id===i),this}clearCustomizeLayoutVideo(){return(this._values.input||(this._values.input={video:[]})).video=[],this}flush(){return i(this,void 0,void 0,(function*(){const e=JSON.parse(JSON.stringify(this._values)),{code:t}=yield this._onFlush(e);return this._values=Ut(),{code:t}}))}}class jt extends Pt{constructor(e,t,n,i,o,s,a,c,u=!1){super(e,t,n,i,r["RTCMode"].LIVE,o,s,a,u),this._livingType=c,this._mcuConfigBuilder=new Dt(this._onMCUConfigFlush.bind(this),this._isValidResourceId.bind(this))}getLivingType(){return this._livingType}getMCUConfigBuilder(){return this._mcuConfigBuilder}_onMCUConfigFlush(e){return i(this,void 0,void 0,(function*(){const t={"App-Key":this._context.getAppkey(),Token:this._token,RoomId:this.getRoomId(),UserId:this._context.getCurrentId(),SessionId:this.getSessionId()},{code:n}=yield this._service.setMcuConfig(t,e);return n!==s.SUCCESS&&o.error("set MCU config failed: "+n),o.debug("set MCU config success"),{code:n}}))}__onReconnected(){return super.__onReconnected(this._livingType)}}class Vt extends Pt{constructor(e,t,n,i,o,s,a){super(e,t,n,i,r["RTCMode"].RTC,o,s,a,!1)}}const Bt=()=>({"Content-Type":"application/json;charset=UTF-8","Cache-Control":"no-cache",ClientType:`web|${Ke.browser}|${Ke.version}`,ClientVersion:"5.1.1","Client-Session-Id":"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),"Request-Id":Date.now().toString()});class Ft{constructor(e,t,n,r=5e3){this._runtime=e,this._context=t,this._msUrl=n,this._timeout=r,this._msInNavi=[],this._failedMs=[],this._rtcFinger=void 0,this._clusterId="",this._configUrl=""}getNaviMS(){return this._msUrl?[this._msUrl]:this._clusterId?["https://"+this._clusterId]:(0===this._msInNavi.length&&(0===this._failedMs.length?this._msInNavi.push(...(e=>{var t;if(!e)return[];let n;try{n=JSON.parse(e.voipCallInfo||'{ "strategy": 0 }')}catch(t){return o.warn("parse `voipCallInfo` of navi failed: "+e.voipCallInfo),[]}if(0===n.strategy)return[];const r=null===(t=n.callEngine)||void 0===t?void 0:t.filter(e=>4===e.engineType);if(!r||0===r.length)return[];const i=r[0],s=[];return i.mediaServer&&s.push(i.mediaServer.replace(/^(https?:\/\/)?/,"https://")),i.backupMediaServer&&i.backupMediaServer.forEach(e=>{s.push(e.replace(/^(https?:\/\/)?/,"https://"))}),s})(this._context.getNaviInfo())):(this._msInNavi.push(...this._failedMs),this._failedMs.length=0)),this._msInNavi.map(e=>e.trim()))}_request(e,t,n){return i(this,void 0,void 0,(function*(){const i=this.getNaviMS();if(0===i.length)return{code:s.NOT_OPEN_VIDEO_AUDIO_SERVER};this._rtcFinger&&(n.rtcFinger=this._rtcFinger);for(let a=0;a<i.length;a+=1){const c=`${i[a]}${e}`;o.debug("requiest -> "+c);const{status:u,data:d}=yield this._runtime.httpReq({url:c,body:JSON.stringify(n),headers:Object.assign(Object.assign({},Bt()),t),method:r["HttpMethod"].POST,timeout:this._timeout});if(200===u){const e=JSON.parse(d);return e.rtcFinger&&(this._rtcFinger=e.rtcFinger),e.clusterId&&(this._clusterId=e.clusterId),{code:s.SUCCESS,data:e}}this._failedMs.push(...this._msInNavi.splice(a,1))}return{code:s.REQUEST_FAILED}}))}exchange(e,t){var n;return i(this,void 0,void 0,(function*(){const r=yield this._request("/exchange",e,t);if(r.code===s.SUCCESS&&(null===(n=r.data)||void 0===n?void 0:n.resultCode)===s.SUCCESS){const e=r.data.urls;e&&(this._configUrl=e.configUrl)}return r}))}exit(e){return i(this,void 0,void 0,(function*(){const{code:t}=yield this._request("/exit",e,{});return t}))}broadcastSubscribe(e,t){return this._request("/broadcast/subscribe",e,t)}broadcastExit(e){return i(this,void 0,void 0,(function*(){const{code:t}=yield this._request("/broadcast/exit",e,{});return{code:t}}))}setMcuConfig(e,t){return i(this,void 0,void 0,(function*(){if(!this._configUrl)return{code:s.MCU_SERVER_NOT_FOUND};const n=this._configUrl.replace(/^(https?:\/\/)?/,"https://")+"/server/mcu/config",{status:i,data:o}=yield this._runtime.httpReq({url:n,headers:Object.assign(Object.assign({},Bt()),e),body:JSON.stringify(t),method:r["HttpMethod"].POST});return 200===i?{code:JSON.parse(o).resultCode}:{code:s.REQUEST_FAILED}}))}}var Ht;!function(e){e[e.VIDEO=0]="VIDEO",e[e.AUDIO=1]="AUDIO"}(Ht||(Ht={}));class Gt{constructor(e,t,n){this._context=e,this._rtcToken="",this._liveUrl="",this._subTracks=[],this._livingType=null,this._mediaType=null,this._subTiny=!1,this._fromRetry=!1,this._appListener=null,this._service=new Ft(t,e,n.mediaServer)}_getReqHeaders(e){return i(this,void 0,void 0,(function*(){const t=this._context.getCurrentId(),n=t;if(!this._rtcToken){const{code:t,data:i}=yield this._context.getRTCToken(n,r["RTCMode"].LIVE,e);if(t!==r["ErrorCode"].SUCCESS)return o.error("getRTCToken failed: "+t),{code:s.SIGNAL_ERROR};this._rtcToken=i.rtcToken}return{code:s.SUCCESS,headers:{"App-Key":this._context.getAppkey(),UserId:t,RoomId:n,RoomType:r["RTCMode"].LIVE,Token:this._rtcToken}}}))}_clearSubscribeInfo(){var e;this._liveUrl="",this._livingType=null,this._mediaType=null,this._subTiny=!1,this._subTracks.length=0,null===(e=this._pc)||void 0===e||e.destroy(),this._pc=null}_reTryExchange(){var e;return i(this,void 0,void 0,(function*(){this._fromRetry=!0;const{code:t}=yield this.subscribe(this._liveUrl,this._livingType,this._mediaType,this._subTiny);t===s.SUCCESS&&(null===(e=this._pc)||void 0===e||e.clearReTryExchangeTimer())}))}subscribe(e,t,n,r=!1){return i(this,void 0,void 0,(function*(){return d(()=>this.__subscribe(e,t,n,r))}))}__subscribe(e,t,n,a=!1){var c;return i(this,void 0,void 0,(function*(){!this._fromRetry&&(null===(c=this._pc)||void 0===c||c.clearReTryExchangeTimer()),this._fromRetry=!1;const i=[];if(!Object(r["isString"])(e))return o.error("liveUrl is invalid: "+e),{code:s.PARAMS_ERROR,tracks:i};if(![Ht.AUDIO,Ht.VIDEO].includes(t))return o.error("livingType is invalid: "+t),{code:s.PARAMS_ERROR,tracks:i};if(![ft.AUDIO_ONLY,ft.VIDEO_ONLY,ft.AUDIO_VIDEO].includes(n))return o.error("mediaType is invalid: "+n),{code:s.PARAMS_ERROR,tracks:i};if(this._liveUrl&&this._liveUrl!==e)return{code:s.BROADCAST_SUB_LIST_NOT_EMPTY,tracks:i};this._pc||(this._pc=new bt(this._reTryExchange.bind(this)),this._pc.on(bt.__INNER_EVENT_TRACK_READY__,this._onTrackReady,this),this.registerReportListener(this._reportListener)),this._liveUrl=e;const{code:u,headers:d}=yield this._getReqHeaders(t);if(u!==s.SUCCESS)return{code:u,tracks:i};const l="rc_mcu_"+Date.now(),h="RongCloudRTC";this._subTracks.length=0,this._subTracks.push(new wt(h,l),new Nt(h,l)),this._pc.updateSubRemoteTracks(this._subTracks.slice());const f={sdp:yield this._pc.createOffer(!0),liveUrl:e,mediaType:n,simulcast:a?Qe.TINY:Qe.NORMAL,switchstream:!1},p=yield this._service.broadcastSubscribe(d,f);if(p.code!==s.SUCCESS)return o.error("andience subscribe failed: "+p.code),{code:p.code,tracks:i};const g=p.data;if(g.resultCode!==s.SUCCESS)return o.error(`andience subscribe failed! code: ${g.resultCode}; message: ${g.message}`),{code:g.resultCode,tracks:i};o.debug("andience subscribe success: "+e),this._livingType=t,this._mediaType=n,this._subTiny=a;const{sdp:m,subscribedList:v}=g,_=[];return v.forEach(e=>{const{mediaType:t}=e,n=this._subTracks[t];_.push(n),n.__innerSetRemoteMuted(!0)}),this._pc.setRemoteAnswer(m.sdp),{code:s.SUCCESS,tracks:_}}))}unsubscribe(){return i(this,void 0,void 0,(function*(){return d(()=>this.__unsubscribe())}))}__unsubscribe(){var e;return i(this,void 0,void 0,(function*(){if(null===(e=this._pc)||void 0===e||e.clearReTryExchangeTimer(),!this._rtcToken||!this._liveUrl)return{code:s.SUCCESS};const{headers:t}=yield this._getReqHeaders(),{code:n}=yield this._service.broadcastExit(t);return n!==s.SUCCESS?o.error("broadcast unsubscribe failed: "+n):o.debug("broadcast unsubscribe success"),this._clearSubscribeInfo(),{code:n}}))}registerReportListener(e){var t;this._reportListener=e,null===(t=this._pc)||void 0===t||t.registerReportListener(e)}registerTrackEventListener(e){this._appListener=e}_onTrackReady(e){var t,n;const r=e.receiver.track,i="audio"===r.kind?ft.AUDIO_ONLY:ft.VIDEO_ONLY,s=this._subTracks[i];s.__innerSetMediaStreamTrack(r);try{null===(n=null===(t=this._appListener)||void 0===t?void 0:t.onTrackReady)||void 0===n||n.call(t,s)}catch(e){o.error(e)}}}const Yt=Object.assign(Object.assign({},He(be.W176_H144)),{frameRate:qe(Se.FPS_15)});class qt{constructor(e,t,n,r,i,s){this._context=e,this._runtime=t,this._initOptions=n,this._roomId=r,this._token=i,this._livingType=s,this._roomAnchorList=[],this._roomRes={},this._remoteTracks={},this._appListener=null,this._subscribedList=[],this._sessionId="",this._destroyed=!1,this._service=new Ft(this._runtime,this._context,this._initOptions.mediaServer,this._initOptions.timeout),this._polarisReport=new It(this._context,this._runtime,this._roomId,this,gt.Audience),this._polarisReport.sendR1(),this._pc=new bt(this._reTryExchange.bind(this),this._polarisReport),this._pc.on(bt.__INNER_EVENT_TRACK_READY__,e=>{const t=e.streams[0].id,n=e.receiver.track,r=[t,"audio"===n.kind?ft.AUDIO_ONLY:ft.VIDEO_ONLY].join("_"),i=this._remoteTracks[r];i?(i.__innerSetMediaStreamTrack(n),this._callAppListener("onTrackReady",i)):o.warn("cannot found RCRemoteTrack:",n.id)}),this._context.onrtcdatachange=this.singalDataChange.bind(this)}_assertRoomDestroyed(){if(this._destroyed){const e="This room has been destroyed. Please use `RCRTCClient.joinLivingRoomAsAudience` to catch another instance.";return o.warn(e),s.ROOM_HAS_BEEN_DESTROYED}}singalDataChange(e){o.debug("singalDataChange",e);const t=[];e.forEach(e=>{const{key:n,value:r,timestamp:i,uid:o}=e;if(-1!==n.indexOf("RC_RES_")){const e=JSON.parse(r||"{}"),n=JSON.parse(e.mcu_uris||"[]");t.push(...n)}else{if("RC_ANCHOR_LIST"===n){const e=JSON.parse(r||"[]"),{joinUserIds:t,leftUserIds:n}=this._diffAnchorList(e);t.length>0&&this._handleNewJoinedAnchor(t),n.length>0&&this._handleLeftedAnchor(n)}"RC_RTC_SESSIONID"===n&&(this._sessionId=r)}}),this._diffRoomResourse(t)}_diffAnchorList(e){const t=e.filter(e=>this._roomAnchorList.indexOf(e)<0);return{leftUserIds:this._roomAnchorList.filter(t=>e.indexOf(t)<0),joinUserIds:t}}_handleNewJoinedAnchor(e){this._callAppListener("onAnchorJoin",e),this._roomAnchorList.push(...e)}_handleLeftedAnchor(e){this._callAppListener("onAnchorLeave",e),this._roomAnchorList=this._roomAnchorList.filter(t=>!(e.indexOf(t)>-1))}_diffRoomResourse(e){return i(this,void 0,void 0,(function*(){const t=[],n=[],r=[];e.forEach(e=>{const n=Ue(e),{userId:i,tag:o,mediaType:s}=De(n),a=[this._roomId,o,s].join("_");if(!this._remoteTracks[a]){const n=s===ft.AUDIO_ONLY?new wt(o,"",this._roomId):new Nt(o,"",this._roomId);t.push(n),this._remoteTracks[a]=n,this._roomRes[n.getTrackId()]=e}r.push(a)}),Object.keys(this._remoteTracks).forEach(e=>{r.indexOf(e)<0&&n.push(this._remoteTracks[e])}),t.length>0&&this._callAppListener("onTrackPublish",t),n.length>0&&this._onUserUnpublish(n)}))}_onUserUnpublish(e){return i(this,void 0,void 0,(function*(){yield this.unsubscribe(e),e.forEach(e=>{this._subscribedList=this._subscribedList.filter(t=>t.track.getTrackId()!==e.getTrackId()),delete this._roomRes[e.getTrackId()],e.__innerDestroy(),delete this._remoteTracks[e.getTrackId()]}),this._callAppListener("onTrackUnpublish",e)}))}_callAppListener(e,...t){var n;const r=null===(n=this._appListener)||void 0===n?void 0:n[e];if(r)try{r(...t)}catch(e){o.error(e)}}_reTryExchange(){return i(this,void 0,void 0,(function*(){d(()=>i(this,void 0,void 0,(function*(){const{reqBody:e}=yield this._createSubscribeParams(this._subscribedList,{},!0),t=yield this._exchangeHandle(e);if(t.code!==s.SUCCESS)return o.error("reTryExchange failed: "+t.code),{code:t.code};const{sdp:n,resultCode:r}=t.data;if(r!==s.SUCCESS)return o.error("reTryExchange failed: "+r),{code:r};this._pc.clearReTryExchangeTimer();const i=this._roomRes[0].msid,a=[this._roomId,"RongCloudRTC"].join("_");n.sdp=n.sdp.replace(new RegExp(i,"g"),a);const c=yield this._pc.setRemoteAnswer(n.sdp);return c!==s.SUCCESS?{code:c}:void 0})))}))}registerRoomEventListener(e){this._appListener=e}_createSubscribeParams(e,t,n){return i(this,void 0,void 0,(function*(){const r=yield this._pc.createOffer(n),i={resolutionInfo:[]},o={min:0,max:0};return Object.keys(t).forEach(e=>{const{mediaStream:n,tinyStream:s}=t[e];[n,s].forEach((t,n)=>{var s;const a=1===n?[e,"tiny"].join("_"):e;r.sdp=null===(s=r.sdp)||void 0===s?void 0:s.replace(new RegExp(t.id,"g"),a);const c=t.getVideoTracks()[0];if(!c)return;const u=0===n,{width:d,height:l,frameRate:h}=u?xe(c):Yt;i.resolutionInfo.push({trackId:c.id,simulcast:u?Qe.NORMAL:Qe.TINY,resolution:`${d}x${l}`});const f=Oe(d,l),p=Ne(h);o.min+=f.minBitrate*p,o.max+=f.maxBitrate*p})}),{reqBody:{sdp:{type:"offer",sdp:r.sdp},switchstream:!1,newVersionFlag:!0,subscribeList:e.map(e=>({simulcast:e.subTiny?Qe.TINY:Qe.NORMAL,resolution:"",uri:this._roomRes[e.track.getTrackId()].uri}))},dynamicBitrate:o,offer:r}}))}_subscribeHandle(e,t=!1){var n;return i(this,void 0,void 0,(function*(){if(this._assertRoomDestroyed())return{code:s.ROOM_HAS_BEEN_DESTROYED};if(!Object(r["validate"])("tracks",e,()=>Object(r["isArray"])(e)&&e.length>0&&e.every(e=>e instanceof Ot||e.track instanceof Ot),!0))return{code:s.PARAMS_ERROR};const i=this._subscribedList.map(e=>Object.assign({},e)),o=e.map(e=>e instanceof Ot?{track:e}:e);let a=!1;const c=[];return o.forEach(e=>{const t=e.track.getTrackId();c.push(t);const n=i.find(e=>e.track.getTrackId()===t);n&&n.subTiny===e.subTiny||(n?n.subTiny=e.subTiny:i.push(e),a=!0)}),a||t?(null===(n=this._polarisReport)||void 0===n||n.sendR2(mt.SUBSCRIBE,vt.BEGIN,c),this._updateSubListHandle(i,!0)):{code:s.SUCCESS}}))}_getReqHeaders(){const e=this._context.getCurrentId();return{"App-Key":this._context.getAppkey(),RoomId:e,Token:this._token,RoomType:r["RTCMode"].LIVE,UserId:e,"Session-Id":this._sessionId}}_exchangeHandle(e){return this._service.broadcastSubscribe(this._getReqHeaders(),e)}_updateSubListHandle(e,t=!1){var n;return i(this,void 0,void 0,(function*(){if(this._assertRoomDestroyed())return{code:s.ROOM_HAS_BEEN_DESTROYED};if(!Object(r["validate"])("resources",e,()=>Object(r["isArray"])(e)&&e.every(e=>e instanceof Ot||e.track instanceof Ot),!0))return{code:s.PARAMS_ERROR};let i=e.map(e=>e instanceof Ot?{track:e}:Object.assign({},e));const a={};i=i.filter(e=>{const t=e.track.getTrackId();return!a[t]&&(a[t]=!0)}).map(e=>Object.assign({},e));const c=this._subscribedList.map(e=>Object.assign({},e));if(!t){let e=!1;if(i.forEach(t=>{const n=c.findIndex(e=>e.track===t.track);-1!==n?c.splice(n,1)[0].subTiny!==t.subTiny&&(e=!0):e=!0}),c.length&&(e=!0),!e)return{code:s.SUCCESS}}const{reqBody:u}=yield this._createSubscribeParams(i,{},!1),d=yield this._exchangeHandle(u);if(c.length){const e=[];c.forEach(t=>{e.push(t.track.getTrackId())}),null===(n=this._pc.reportParser)||void 0===n||n.clearLatestPacketsRecv(e)}if(d.code!==s.SUCCESS)return{code:d.code};const{sdp:l,resultCode:h,message:f}=d.data;if(h!==s.SUCCESS)return o.error("change subscribe list failed:",f,h),{code:h};if(i.length>0){const e=this._roomRes[i[0].track.getTrackId()].msid,{tag:t,userId:n}=De(i[0].track.getTrackId()),r=[n,t].join("_");l.sdp=l.sdp.replace(new RegExp(e,"g"),r)}const p=yield this._pc.setRemoteAnswer(l.sdp);if(p!==s.SUCCESS)return{code:p};for(const e in this._remoteTracks){const t=i.some(t=>t.track.getTrackId()===e);this._remoteTracks[e].__innerSetSubscribed(t)}return this._subscribedList.splice(0,this._subscribedList.length,...i),{code:s.SUCCESS}}))}subscribe(e){return i(this,void 0,void 0,(function*(){return this._subscribeHandle(e,!1)}))}unsubscribe(e){var t;return i(this,void 0,void 0,(function*(){const n=this._subscribedList.map(e=>Object.assign({},e)).filter(t=>!e.includes(t.track));return null===(t=this._polarisReport)||void 0===t||t.sendR2(mt.SUBSCRIBE,vt.END,e.map(e=>e.getTrackId())),this._updateSubListHandle(n,!1)}))}__destroy(e){return i(this,void 0,void 0,(function*(){this._destroyed||(this._destroyed=!0,e&&(yield this._context.quitLivingRoomAsAudience(this._roomId)),yield this._service.broadcastExit(this._getReqHeaders()),this._pc.destroy(),this._polarisReport=null)}))}getRemoteTrack(e){return this._remoteTracks[e]}getLocalTrack(e){return{}}__onReconnected(){return i(this,void 0,void 0,(function*(){const{code:e}=yield this._context.joinLivingRoomAsAudience(this._roomId,r["RTCMode"].LIVE);e!==r["ErrorCode"].SUCCESS&&o.error("join living room error when on reconnected")}))}registerReportListener(e){var t;this._reportListener=e,null===(t=this._pc)||void 0===t||t.registerReportListener(e)}}const Kt=(e,t)=>{const n=[];return n[0]=(null==t?void 0:t.withoutAudio)?void 0:e.getAudioTracks()[0],n[1]=(null==t?void 0:t.withoutVideo)?void 0:e.getVideoTracks()[0],n};class Wt{constructor(e,t,n){this._context=e,this._runtime=t,this._options=n,this._crtRoom=null,this._audience=null,this._crtAudienceLivingRoom=null,Ct.setSdpSemantics(n.sdpSemantics||"plan-b"),this._service=new Ft(this._runtime,this._context,this._options.mediaServer,this._options.timeout),this._context.onconnectionstatechange=this._onIMStatusChange.bind(this),this._context.ondisconnect=this._onIMDisconnect.bind(this),this._context.ondestroy=this._onIMUninit.bind(this),this._context.onmessage=this._handleMessage.bind(this)}_handleMessage(e){var t;return e.conversationType===r["ConversationType"].RTC_ROOM&&(null===(t=this._crtRoom)||void 0===t||t.__parseInnerMessage(e),!0)}getCurrentId(){return this._context.getCurrentId()}joinRTCRoom(e){return d(()=>this._joinRTCRoom(e))}_joinRTCRoom(e){return i(this,void 0,void 0,(function*(){if(!Object(r["validate"])("roomId",e,r["notEmptyString"],!0))return{code:s.PARAMS_ERROR};if(this._crtRoom)return{code:s.REPERT_JOIN_ROOM};if(this._context.getConnectionStatus()!==r["ConnectionStatus"].CONNECTED)return{code:s.SIGNAL_DISCONNECTED};if(!this._service.getNaviMS().length)return{code:s.NOT_OPEN_VIDEO_AUDIO_SERVER};o.debug("joinRoom -> roomId: "+e);const{code:t,data:n}=yield this._context.joinRTCRoom(e,r["RTCMode"].RTC);if(t!==r["ErrorCode"].SUCCESS)return o.error("joinRoom failed -> code: "+t),{code:t};o.debug(`joinRoom success -> userId: ${this._context.getCurrentId()}, roomId: ${e}, data: ${JSON.stringify(n)}`);const i=new Vt(this._context,this._runtime,e,n,this._service,this._options,this._releaseCrtRoomObj.bind(this));return this._crtRoom=i,{room:i,code:s.SUCCESS,userIds:i.getRemoteUserIds(),tracks:i.getRemoteTracks()}}))}joinLivingRoom(e,t){return d(()=>this._joinLivingRoom(e,t))}_joinLivingRoom(e,t){return i(this,void 0,void 0,(function*(){if(!Object(r["validate"])("roomId",e,r["notEmptyString"],!0)||!Object(r["validate"])("livingType",t,e=>e===Ht.AUDIO||e===Ht.VIDEO))return{code:s.PARAMS_ERROR};if(this._crtRoom)return{code:s.REPERT_JOIN_ROOM};if(this._context.getConnectionStatus()!==r["ConnectionStatus"].CONNECTED)return{code:s.SIGNAL_DISCONNECTED};if(!this._service.getNaviMS().length)return{code:s.NOT_OPEN_VIDEO_AUDIO_SERVER};o.debug("joinRoom, roomId: "+e);const{code:n,data:i}=yield this._context.joinRTCRoom(e,r["RTCMode"].LIVE,t);if(n!==r["ErrorCode"].SUCCESS)return o.error("joinRoom failed -> code: "+n),{code:n};o.debug(`JoinRoom success -> userId: ${this._context.getCurrentId()}, roomId: ${e}, data: ${JSON.stringify(i)}`);const a=new jt(this._context,this._runtime,e,i,this._service,this._options,this._releaseCrtRoomObj.bind(this),t,!1);return this._crtRoom=a,{room:a,code:s.SUCCESS,userIds:a.getRemoteUserIds(),tracks:a.getRemoteTracks()}}))}getAudienceClient(){return this._audience||(this._audience=new Gt(this._context,this._runtime,this._options)),this._audience}_onIMStatusChange(e){o.debug("signal server connection state changed: "+e),e===r["ConnectionStatus"].CONNECTED&&this._crtRoom&&this._crtRoom.__onReconnected()}_onIMDisconnect(){o.debug("TODO -> on IM disconnect")}_onIMUninit(){o.debug("TODO -> on IM client ondestroy")}leaveRoom(e){return d(()=>this._leaveRoom(e))}_leaveRoom(e){return i(this,void 0,void 0,(function*(){return this._crtRoom?(yield this._crtRoom.__destroy(!0),o.debug(`quitRTCRoom -> userId: ${this._context.getCurrentId()} , roomId: ${this._crtRoom.getRoomId()}`),this._crtRoom=null,{code:s.SUCCESS}):{code:s.SUCCESS}}))}_releaseCrtRoomObj(){this._crtRoom=null}_getMediaStream(e,t="getUserMedia"){return i(this,void 0,void 0,(function*(){try{const n=yield navigator.mediaDevices[t](e);return{code:s.SUCCESS,stream:n}}catch(e){if("Permission denied"===e.message)return{code:s.PERMISSION_DENIED};o.error("get user media failed -> "+e.message)}return{code:"getUserMedia"===t?s.GET_USER_MEDIA_FAILED:s.GET_DISPLAY_MEDIA_FAILED}}))}createMicrophoneAudioTrack(e="RongCloudRTC",t){return i(this,void 0,void 0,(function*(){if(!Pe(e))return{code:s.INVALID_TAGS};const n=this._context.getCurrentId();if(!n)return{code:s.INVALID_USER_ID};const{stream:r,code:i}=yield this._getMediaStream({audio:{deviceId:null==t?void 0:t.micphoneId,sampleRate:null==t?void 0:t.sampleRate}});if(i!==s.SUCCESS)return{code:i};const o=r.getAudioTracks()[0];return{code:i,track:new st(e,n,o)}}))}createCameraVideoTrack(e="RongCloudRTC",t){return i(this,void 0,void 0,(function*(){if(!Pe(e))return{code:s.INVALID_TAGS};const n=this._context.getCurrentId();if(!n)return{code:s.INVALID_USER_ID};const r=Ge(null==t?void 0:t.resolution)?t.resolution:be.W640_H480,{width:i,height:o}=He(r),{stream:a,code:c}=yield this._getMediaStream({video:{deviceId:null==t?void 0:t.cameraId,frameRate:qe((null==t?void 0:t.frameRate)||Se.FPS_15),width:i,height:o}});if(c!==s.SUCCESS)return{code:c};const u=a.getVideoTracks()[0];return{code:c,track:new at(e,n,u)}}))}createMicrophoneAndCameraTracks(e="RongCloudRTC",t){var n,r,o,a,c;return i(this,void 0,void 0,(function*(){const i=[];if(!Pe(e))return{code:s.INVALID_TAGS,tracks:i};const u=this._context.getCurrentId();if(!u)return{code:s.INVALID_USER_ID,tracks:i};const d=Ge(null===(n=null==t?void 0:t.video)||void 0===n?void 0:n.resolution)?t.video.resolution:be.W640_H480,{width:l,height:h}=He(d),{stream:f,code:p}=yield this._getMediaStream({video:{deviceId:null===(r=null==t?void 0:t.video)||void 0===r?void 0:r.cameraId,frameRate:qe((null===(o=null==t?void 0:t.video)||void 0===o?void 0:o.frameRate)||Se.FPS_15),width:l,height:h},audio:{deviceId:null===(a=null==t?void 0:t.audio)||void 0===a?void 0:a.micphoneId,sampleRate:null===(c=null==t?void 0:t.audio)||void 0===c?void 0:c.sampleRate}});return p!==s.SUCCESS||f.getTracks().forEach(t=>{"video"===t.kind?i.push(new at(e,u,t)):i.unshift(new st(e,u,t))}),{code:p,tracks:i}}))}createScreenVideoTrack(e="screenshare",t){return i(this,void 0,void 0,(function*(){if(!Pe(e))return{code:s.INVALID_TAGS};const n=this._context.getCurrentId();if(!n)return{code:s.INVALID_USER_ID};if(!$e())return{code:s.BROWSER_NOT_SUPPORT};const r=/Electron/.test(navigator.userAgent);if(r&&!(null==t?void 0:t.chromeMediaSourceId))return{code:s.PARAMS_ERROR};const i=Ge(null==t?void 0:t.resolution)?t.resolution:be.W1280_H720,{width:o,height:a}=He(i),c=r?{mandatory:{chromeMediaSourceId:t.chromeMediaSourceId,chromeMediaSource:"desktop",minWidth:o,maxWidth:o,minHeight:a,maxHeight:a}}:{frameRate:qe((null==t?void 0:t.frameRate)||Se.FPS_15),width:o,height:a},{stream:u,code:d}=yield this._getMediaStream({video:c,audio:!1},r?"getUserMedia":"getDisplayMedia");if(d!==s.SUCCESS)return{code:d};const l=u.getVideoTracks()[0];return{code:d,track:new ct(e,n,l)}}))}createLocalAudioTrack(e,t){return i(this,void 0,void 0,(function*(){if(!Pe(e))return{code:s.INVALID_TAGS};if(!t||"[object MediaStreamTrack]"!==t.toString()||"audio"!==t.kind)return{code:s.CREATE_CUSTOM_TRACK_FAILED};const n=this._context.getCurrentId();return n?{code:s.SUCCESS,track:new tt(e,n,t)}:{code:s.INVALID_USER_ID}}))}createLocalVideoTrack(e,t){return i(this,void 0,void 0,(function*(){if(!Pe(e))return{code:s.INVALID_TAGS};if(!t||"[object MediaStreamTrack]"!==t.toString()||"video"!==t.kind)return{code:s.CREATE_CUSTOM_TRACK_FAILED};const n=this._context.getCurrentId();return n?{code:s.SUCCESS,track:new nt(e,n,t)}:{code:s.INVALID_USER_ID}}))}createLocalFileTracks(e,t,n){return i(this,void 0,void 0,(function*(){if(!Pe(e))return{code:s.INVALID_TAGS,tracks:[]};if(!We())return{code:s.BROWSER_NOT_SUPPORT,tracks:[]};const i=t instanceof File?URL.createObjectURL(t):t;if(!Object(r["isHttpUrl"])(i)&&!/^blob:/.test(i))return o.warn("createLocalFileTracks failed: params error -> url: "+i),{code:s.PARAMS_ERROR,tracks:[]};const a=this._context.getCurrentId();return a?new Promise(t=>{const r=document.createElement("video");(null==n?void 0:n.withoutAudio)&&(r.muted=!0),r.onloadedmetadata=()=>{const c=[];let u;try{const e=r.mozCaptureStream?"mozCaptureStream":"captureStream";u=r[e]()}catch(e){o.error("create RCLocalFileTrack failed, captureSteam error. -> url: "+i),o.error(e),t({code:s.CREATE_FILE_TRACK_FAILED,tracks:c})}const[d,l]=Kt(u,n);d&&c.push(new ot(e,a,d,r)),l&&c.push(new it(e,a,l,r)),0===c.length&&(r.pause(),r.src=""),r.onerror=null,t({code:s.SUCCESS,tracks:c})},r.onerror=()=>{o.error("create RCLocalFileTrack failed -> url: "+i),t({code:s.CREATE_FILE_TRACK_FAILED,tracks:[]})},r.src=i,r.loop=!0,r.play()}):{code:s.INVALID_USER_ID,tracks:[]}}))}createLocalTracks(e,t,n){return i(this,void 0,void 0,(function*(){const r=[];if(!Pe(e))return{code:s.INVALID_TAGS,tracks:r};if(!(t instanceof MediaStream))return{code:s.PARAMS_ERROR,tracks:r};const i=this._context.getCurrentId();if(!i)return{code:s.INVALID_USER_ID,tracks:r};const[o,a]=Kt(t,n);return o&&r.push(new tt(e,i,o)),a&&r.push(new nt(e,i,a)),{code:s.SUCCESS,tracks:r}}))}joinLivingRoomAsAudience(e,t){return i(this,void 0,void 0,(function*(){if(!Object(r["validate"])("roomId",e,r["notEmptyString"],!0)||!Object(r["validate"])("livingType",t,e=>e===Ht.AUDIO||e===Ht.VIDEO))return{code:s.PARAMS_ERROR};if(this._crtAudienceLivingRoom)return{code:s.REPERT_JOIN_ROOM};if(!this._service.getNaviMS().length)return{code:s.NOT_OPEN_VIDEO_AUDIO_SERVER};const{code:n,data:i}=yield this._context.joinLivingRoomAsAudience(e,r["RTCMode"].LIVE,t);if(n!==r["ErrorCode"].SUCCESS)return o.error("audienceJoinLivingRoomError:",n),{code:s.SIGNAL_AUDIENCE_JOIN_ROOM_FAILED};const a=new qt(this._context,this._runtime,this._options,e,i.token,t);return this._crtAudienceLivingRoom=a,{room:a,code:s.SUCCESS}}))}leaveLivingRoomAsAudience(e){return i(this,void 0,void 0,(function*(){return this._crtAudienceLivingRoom?this._crtAudienceLivingRoom!==e?{code:s.PARAMS_ERROR}:(yield this._crtAudienceLivingRoom.__destroy(!0),this._crtAudienceLivingRoom=null,{code:s.SUCCESS}):{code:s.SUCCESS}}))}upgradeToAnchorRoom(e){return i(this,void 0,void 0,(function*(){if(!Object(r["validate"])("room._roomId",e._roomId,r["notEmptyString"],!0))return{code:s.PARAMS_ERROR};if(this._crtRoom)return{code:s.REPERT_JOIN_ROOM};const{code:t,data:n}=yield this._context.rtcIdentityChange(e._roomId,r["RTCIdentityChangeType"].ViewerToAnchor,e._livingType);if(t!==r["ErrorCode"].SUCCESS)return o.error("change room identity error",t),{code:s.SIGNAL_ROOM_CHANGE_IDENTITY_FAILED};yield this._crtAudienceLivingRoom.__destroy(!1);const i=new jt(this._context,this._runtime,e._roomId,n,this._service,this._options,this._releaseCrtRoomObj.bind(this),e._livingType,!0);return this._crtRoom=i,this._crtAudienceLivingRoom=null,{room:i,code:s.SUCCESS}}))}downgradeToAudienceRoom(e){return i(this,void 0,void 0,(function*(){if(!Object(r["validate"])("room._roomId",e._roomId,r["notEmptyString"],!0))return{code:s.PARAMS_ERROR};if(this._crtAudienceLivingRoom)return{code:s.REPERT_JOIN_ROOM};const{code:t,data:n}=yield this._context.rtcIdentityChange(e._roomId,r["RTCIdentityChangeType"].AnchorToViewer,e.getLivingType());if(t!==r["ErrorCode"].SUCCESS)return o.error("change room identity error",t),{code:s.SIGNAL_ROOM_CHANGE_IDENTITY_FAILED};const{token:i}=n,a=new qt(this._context,this._runtime,this._options,e._roomId,i,e.getLivingType());return this._crtAudienceLivingRoom=a,this._crtRoom.__destroy(!1),this._crtRoom=null,{room:a,code:s.SUCCESS}}))}}const $t={getCameras:()=>i(void 0,void 0,void 0,(function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter(e=>"videoinput"===e.kind)})),getMicrophones:()=>i(void 0,void 0,void 0,(function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter(e=>"audioinput"===e.kind)})),getSpeakers:()=>i(void 0,void 0,void 0,(function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter(e=>"audiooutput"===e.kind)}))},Jt={tag:"RCRTC",verify:e=>"browser"!==e.tag?(o.error(`RCRTC Plugin is not support the runtime '${e.tag}'`),!1):!!ke||(o.error("Please use the https protocol or use `http://localhost` to open the page!"),!1),setup:(e,t,n={})=>(o.setLogLevel(n.logLevel),o.setLogStdout(n.logStdout),o.warn("RCRTC Version: 5.1.1, Commit: 9fe1c42610f10eb0a00dce5e3fee186348b99481"),o.warn("browserInfo.browser -> "+Ke.browser),o.warn("browserInfo.supportsUnifiedPlan -> "+Ke.supportsUnifiedPlan),o.warn("browserInfo.version -> "+Ke.version),Object(r["assert"])("options.mediaServer",n.mediaServer,e=>!(!Object(r["isHttpUrl"])(e)||"https:"===location.protocol&&!/^https/.test(e))),Object(r["assert"])("options.timeout",n.timeout,e=>Object(r["isNumber"])(e)&&e>=5e3&&e<=3e4),Object(r["assert"])("options.pingGap",n.pingGap,e=>Object(r["isNumber"])(e)&&e>=3e3&&e<=1e4),new Wt(e,t,n))},zt={DEFAULT:"RongCloudRTC"},Qt={transResolution:He,transFrameRate:qe,parseTrackId:De,ifSupportLocalFileTrack:We,ifSupportScreenShare:$e}},7418:function(e,t){t.f=Object.getOwnPropertySymbols},"746f":function(e,t,n){var r=n("428f"),i=n("5135"),o=n("e538"),s=n("9bf2").f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});i(t,e)||s(t,e,{value:o.f(e)})}},7839:function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"78b2":function(e,t,n){"use strict";n.r(t),function(e){var r;n.d(t,"AEngine",(function(){return zr})),n.d(t,"ANavi",(function(){return Zr})),n.d(t,"APIContext",(function(){return Mi})),n.d(t,"AppStorage",(function(){return O})),n.d(t,"AssertRules",(function(){return Z})),n.d(t,"CONNECTION_TYPE",(function(){return i})),n.d(t,"CPP_PROTOCAL_MSGTYPE_OPTION",(function(){return R})),n.d(t,"CallLibMsgType",(function(){return mr})),n.d(t,"ChatroomEntryType",(function(){return We})),n.d(t,"CometChannel",(function(){return Jr})),n.d(t,"ConnectResultCode",(function(){return jr})),n.d(t,"ConnectionStatus",(function(){return Br})),n.d(t,"ConversationType",(function(){return J})),n.d(t,"DelayTimer",(function(){return Je})),n.d(t,"ErrorCode",(function(){return Oe})),n.d(t,"EventEmitter",(function(){return Ee})),n.d(t,"FileType",(function(){return X})),n.d(t,"HttpMethod",(function(){return Kr})),n.d(t,"IM_COMET_PULLMSG_TIMEOUT",(function(){return E})),n.d(t,"IM_PING_INTERVAL_TIME",(function(){return m})),n.d(t,"IM_PING_MIN_TIMEOUT",(function(){return _})),n.d(t,"IM_PING_TIMEOUT",(function(){return v})),n.d(t,"IM_SIGNAL_TIMEOUT",(function(){return p})),n.d(t,"LiveRole",(function(){return jn})),n.d(t,"LiveType",(function(){return Dn})),n.d(t,"LogLevel",(function(){return L})),n.d(t,"LogType",(function(){return x})),n.d(t,"Logger",(function(){return _e})),n.d(t,"MAX_MESSAGE_CONTENT_BYTES",(function(){return y})),n.d(t,"MINI_COMET_CONNECT_URIS",(function(){return f})),n.d(t,"MINI_SOCKET_CONNECT_URIS",(function(){return h})),n.d(t,"MentionedType",(function(){return An})),n.d(t,"MessageDirection",(function(){return _r})),n.d(t,"MessageType",(function(){return Pn})),n.d(t,"NAVI_CACHE_DURATION",(function(){return a})),n.d(t,"NAVI_REQ_TIMEOUT",(function(){return c})),n.d(t,"NotificationStatus",(function(){return Vn})),n.d(t,"PING_REQ_TIMEOUT",(function(){return u})),n.d(t,"PUBLIC_CLOUD_NAVI_URIS",(function(){return l})),n.d(t,"PluginContext",(function(){return Ci})),n.d(t,"RCAssertError",(function(){return Re})),n.d(t,"RTCApiType",(function(){return fr})),n.d(t,"RTCIdentityChangeType",(function(){return pr})),n.d(t,"RTCMode",(function(){return Un})),n.d(t,"RTCPluginContext",(function(){return Ri})),n.d(t,"ReceivedStatus",(function(){return s})),n.d(t,"SEND_MESSAGE_TYPE_OPTION",(function(){return C})),n.d(t,"STATUS_MESSAGE",(function(){return S})),n.d(t,"STORAGE_ROOT_KEY",(function(){return T})),n.d(t,"TagChangeType",(function(){return Ai})),n.d(t,"UploadMethod",(function(){return mi})),n.d(t,"WEB_SOCKET_TIMEOUT",(function(){return d})),n.d(t,"WebSocketChannel",(function(){return $r})),n.d(t,"appendUrl",(function(){return B})),n.d(t,"assert",(function(){return Se})),n.d(t,"cloneByJSON",(function(){return Be})),n.d(t,"forEach",(function(){return xe})),n.d(t,"getBrowser",(function(){return He})),n.d(t,"getMimeKey",(function(){return Ae})),n.d(t,"getUploadFileName",(function(){return Ne})),n.d(t,"indexOf",(function(){return De})),n.d(t,"isArray",(function(){return re})),n.d(t,"isArrayBuffer",(function(){return ie})),n.d(t,"isBoolean",(function(){return te})),n.d(t,"isFunction",(function(){return ce})),n.d(t,"isHttpUrl",(function(){return le})),n.d(t,"isInObject",(function(){return Ve})),n.d(t,"isInclude",(function(){return je})),n.d(t,"isNull",(function(){return de})),n.d(t,"isNumber",(function(){return ne})),n.d(t,"isObject",(function(){return ae})),n.d(t,"isString",(function(){return ee})),n.d(t,"isUndefined",(function(){return ue})),n.d(t,"isValidChrmEntryKey",(function(){return ke})),n.d(t,"isValidChrmEntryValue",(function(){return Le})),n.d(t,"isValidConversationType",(function(){return fe})),n.d(t,"isValidFileType",(function(){return pe})),n.d(t,"map",(function(){return Ue})),n.d(t,"notEmptyArray",(function(){return se})),n.d(t,"notEmptyObject",(function(){return he})),n.d(t,"notEmptyString",(function(){return oe})),n.d(t,"pushConfigsToJSON",(function(){return Me})),n.d(t,"pushJSONToConfigs",(function(){return Pe})),n.d(t,"todo",(function(){return D})),n.d(t,"usingCppEngine",(function(){return Fe})),n.d(t,"validate",(function(){return be})),n.d(t,"version",(function(){return Pi})),function(e){e[e.READ=1]="READ",e[e.LISTENED=2]="LISTENED",e[e.DOWNLOADED=4]="DOWNLOADED",e[e.RETRIEVED=8]="RETRIEVED",e[e.UNREAD=0]="UNREAD"}(r||(r={}));var i,o,s=r,a=72e5,c=1e4,u=5e3,d=5e3,l=["https://nav.cn.ronghub.com","https://nav2-cn.ronghub.com"],h=["wsproxy.cn.ronghub.com","wsap-cn.ronghub.com"],f=["cometproxy-cn.ronghub.com","mini-cn.ronghub.com"],p=3e4,m=15e3,v=15e3,_=2e3,y=131072,E=45e3,T="RCV4-",C={"RC:TxtMsg":{isCounted:!0,isPersited:!0},"RC:ImgMsg":{isCounted:!0,isPersited:!0},"RC:VcMsg":{isCounted:!0,isPersited:!0},"RC:ImgTextMsg":{isCounted:!0,isPersited:!0},"RC:FileMsg":{isCounted:!0,isPersited:!0},"RC:HQVCMsg":{isCounted:!0,isPersited:!0},"RC:LBSMsg":{isCounted:!0,isPersited:!0},"RC:PSImgTxtMsg":{isCounted:!0,isPersited:!0},"RC:PSMultiImgTxtMsg":{isCounted:!0,isPersited:!0},"RCJrmf:RpMsg":{isCounted:!0,isPersited:!0},"RCJrmf:RpOpendMsg":{isCounted:!0,isPersited:!0},"RC:CombineMsg":{isCounted:!0,isPersited:!0},"RC:ReferenceMsg":{isCounted:!0,isPersited:!0},"RC:SightMsg":{isCounted:!0,isPersited:!0},"RC:GIFMsg":{isCounted:!0,isPersited:!0},"RC:InfoNtf":{isCounted:!1,isPersited:!0},"RC:ContactNtf":{isCounted:!1,isPersited:!0},"RC:ProfileNtf":{isCounted:!1,isPersited:!0},"RC:CmdNtf":{isCounted:!1,isPersited:!0},"RC:GrpNtf":{isCounted:!1,isPersited:!0},"RC:RcCmd":{isCounted:!1,isPersited:!0},"RC:CmdMsg":{isCounted:!1,isPersited:!1},"RC:TypSts":{isCounted:!1,isPersited:!1},"RC:PSCmd":{isCounted:!1,isPersited:!1},"RC:SRSMsg":{isCounted:!1,isPersited:!1},"RC:RRReqMsg":{isCounted:!1,isPersited:!1},"RC:RRRspMsg":{isCounted:!1,isPersited:!1},"RC:CsChaR":{isCounted:!1,isPersited:!1},"RC:CSCha":{isCounted:!1,isPersited:!1},"RC:CsEva":{isCounted:!1,isPersited:!1},"RC:CsContact":{isCounted:!1,isPersited:!1},"RC:CsHs":{isCounted:!1,isPersited:!1},"RC:CsHsR":{isCounted:!1,isPersited:!1},"RC:CsSp":{isCounted:!1,isPersited:!1},"RC:CsEnd":{isCounted:!1,isPersited:!1},"RC:CsUpdate":{isCounted:!1,isPersited:!1},"RC:ReadNtf":{isCounted:!1,isPersited:!1},"RC:chrmKVNotiMsg":{isCounted:!1,isPersited:!1},"RC:VCAccept":{isCounted:!1,isPersited:!1},"RC:VCRinging":{isCounted:!1,isPersited:!1},"RC:VCSummary":{isCounted:!1,isPersited:!1},"RC:VCHangup":{isCounted:!1,isPersited:!1},"RC:VCInvite":{isCounted:!1,isPersited:!1},"RC:VCModifyMedia":{isCounted:!1,isPersited:!1},"RC:VCModifyMem":{isCounted:!1,isPersited:!1},"RC:MsgExMsg":{isCounted:!1,isPersited:!1},"RC:RRMsg":{isCounted:!1,isPersited:!1}},R={"RC:DizNtf":{isCounted:!1,isPersited:!1}},S=["RC:TypSts"];!function(e){e.WEBSOCKET="websocket",e.COMET="comet"}(i||(i={}));var b=function(e){return o||(o={set:function(t,n){e.localStorage.setItem(t,JSON.stringify(n))},get:function(t){var n;try{n=JSON.parse(e.localStorage.getItem(t))}catch(e){n=null}return n},remove:function(t){return e.localStorage.removeItem(t)},getKeys:function(){var t=[];for(var n in e.localStorage)t.push(n);return t}}),o},I=function(){function e(e){this._caches={},e&&(this._caches=e)}return e.prototype.set=function(e,t){this._caches[e]=t},e.prototype.remove=function(e){var t=this.get(e);return delete this._caches[e],t},e.prototype.get=function(e){return this._caches[e]},e.prototype.getKeys=function(){var e=[];for(var t in this._caches)e.push(t);return e},e}(),O=function(){function e(e,t){var n,r=t?"RCV4-"+t:"RCV4-";this._rootStorage=b(e);var i=this._rootStorage.get(r)||{};this._cache=new I(((n={})[r]=i,n)),this._storageKey=r}return e.prototype._get=function(){var e=this._storageKey;return this._cache.get(e)||{}},e.prototype._set=function(e){var t=this._storageKey;e=e||{},this._cache.set(t,e),this._rootStorage.set(t,e)},e.prototype.set=function(e,t){var n=this._get();n[e]=t,this._set(n)},e.prototype.remove=function(e){var t=this._get();delete t[e],this._set(t)},e.prototype.clear=function(){var e=this._storageKey;this._rootStorage.remove(e),this._cache.remove(e)},e.prototype.get=function(e){return this._get()[e]},e.prototype.getKeys=function(){var e=this._get(),t=[];for(var n in e)t.push(n);return t},e.prototype.getValues=function(){return this._get()||{}},e}(),w=function(e,t){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function N(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}w(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var A=function(){return(A=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function M(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function P(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function k(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}var L,x,U=function(e){function t(t){return e.call(this,"TODO => "+t)||this}return N(t,e),t}(Error),D=function(e){return new U(e)},j=function(e,t,n){if(void 0===t||void 0===n)return e.toUpperCase();var r=e.slice(t,n);return e.replace(r,(function(e){return e.toUpperCase()}))},V=function(e,t){void 0===t&&(t="utf-8");var n,r=0;if("utf-16"===t)for(var i=0,o=e.length;i<o;i++)r+=(n=e.charCodeAt(i))<=65535?2:4;else for(i=0,o=e.length;i<o;i++)r+=(n=e.charCodeAt(i))<127?1:n<=2047?2:n<=65535?3:4;return r},B=function(e,t){if(e=e.replace(/\?$/,""),!t)return e;var n=Object.keys(t).map((function(e){return e+"="+t[e]})).filter((function(e){return!!e}));return n.length?[e,n.join("&")].join("?"):e},F=function(e){return e.match(/\d+(\.\d+){2}/)[0]};!function(e){e[e.LOG=0]="LOG",e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR",e[e.FATAL=4]="FATAL",e[e.NONE=1e3]="NONE"}(L||(L={})),function(e){e.IM="IM",e.RTC="RTC"}(x||(x={}));var H="RC_Logs";function G(e){!function(e,t,n){var r;if(!e.objectStoreNames.contains(t)){var i=A({},n.objectStoreParams);r=e.createObjectStore(t,i),n.indexs&&n.indexs.length>0&&n.indexs.forEach((function(e){r.createIndex(e.indexName,e.key,{unique:e.unique})}))}}(e,H,{indexs:[{indexName:"time",key:"time",unique:!1}],objectStoreParams:{keyPath:"key"}})}var Y,q=function(){function e(){}return e.init=function(){if("undefined"!=typeof window&&window&&window.indexedDB){var t=window.indexedDB.open("RC_ENGINE_DB",1);t.onerror=function(e){console.warn("open indexDB request failed "+e.target.error)},t.onsuccess=function(t){e._db=t.target.result,e._instance=new e},t.onupgradeneeded=function(t){e._db=t.target.result,G(t.target.result)}}else console.warn("IndexDB is not currently supported in the environment!")},e.getInstance=function(){return e._instance},e.prototype.addList=function(t,n){return new Promise((function(r){if(e._db){var i=e._db.transaction([t],"readwrite"),o=i.objectStore(t);n.forEach((function(e){null==o||o.add(e)})),i.oncomplete=function(e){r(!0)},i.onerror=function(e){r(!1)}}else r(!1)}))},e.prototype.getRangeData=function(t,n,r,i){return new Promise((function(o){if(e._db){var s=e._db.transaction([t],"readwrite").objectStore(t),a=IDBKeyRange.bound(r,i),c=s.index(n),u=[];c.openCursor(a).onsuccess=function(e){var t=e.target.result;t?(u.push(t.value),t.continue()):o(u)}}else o([])}))},e.prototype.getCount=function(t,n){return new Promise((function(r){if(e._db){var i=e._db.transaction([t],"readonly").objectStore(t).index(n),o=i.count();o.onsuccess=function(){r(o.result)},i.openCursor().onsuccess=function(e){var t=e.target.result;t&&t.continue()}}else r(0)}))},e.prototype.removeFirstData=function(t,n,r){return new Promise((function(i){if(e._db){var o=e._db.transaction([t],"readwrite").objectStore(t),s=o.index(n).getAllKeys(IDBKeyRange.lowerBound(0),r);s.onsuccess=function(){var e=s.result;e.length>0&&(o.delete(IDBKeyRange.bound(e[0],e[e.length-1])).onsuccess=function(){i(!0)})}}else i(!1)}))},e._db=null,e}(),K=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},W=function(){var e=K();if(e=e.replace(/-/g,"")+"a",(e=function(e){var t="0123456789abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZa0".split(""),n=t.length+1,r=+e,i=[];do{var o=r%n;r=(r-o)/n,i.unshift(t[o])}while(r);return i.join("")}(e=parseInt(e,16))).length>22&&(e=e.slice(0,22)),e.length<22)for(var t=22-e.length,n=0;n<t;n++)e+="0";return e};!function(e){e[e.NONE=0]="NONE",e[e.PRIVATE=1]="PRIVATE",e[e.DISCUSSION=2]="DISCUSSION",e[e.GROUP=3]="GROUP",e[e.CHATROOM=4]="CHATROOM",e[e.CUSTOMER_SERVICE=5]="CUSTOMER_SERVICE",e[e.SYSTEM=6]="SYSTEM",e[e.APP_PUBLIC_SERVICE=7]="APP_PUBLIC_SERVICE",e[e.PUBLIC_SERVICE=8]="PUBLIC_SERVICE",e[e.RTC_ROOM=12]="RTC_ROOM"}(Y||(Y={}));var $,J=Y;!function(e){e[e.IMAGE=1]="IMAGE",e[e.AUDIO=2]="AUDIO",e[e.VIDEO=3]="VIDEO",e[e.FILE=4]="FILE",e[e.SIGHT=5]="SIGHT",e[e.COMBINE_HTML=6]="COMBINE_HTML"}($||($={}));var z,Q,Z,X=$,ee=function(e){return"string"==typeof e},te=function(e){return"boolean"==typeof e},ne=function(e){return"number"==typeof e&&!isNaN(e)},re=function(e){return-1!==Object.prototype.toString.call(e).indexOf("Array")},ie=function(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)},oe=function(e){return ee(e)&&e.length>0},se=function(e){return re(e)&&e.length>0},ae=function(e){return"[object Object]"===Object.prototype.toString.call(e)},ce=function(e){return"[object Function]"===Object.prototype.toString.call(e)},ue=function(e){return void 0===e||"[object Undefined]"===Object.prototype.toString.call(e)},de=function(e){return"[object Null]"===Object.prototype.toString.call(e)},le=function(e){return ee(e)&&/https?:\/\//.test(e)},he=function(e){for(var t in e)return!0;return!1},fe=function(e){return ne(e)&&Object.prototype.hasOwnProperty.call(J,e)},pe=function(e){return ne(e)&&Object.prototype.hasOwnProperty.call(X,e)},ge=((z={})[L.DEBUG]=console.debug.bind(console),z[L.INFO]=console.info.bind(console),z[L.WARN]=console.warn.bind(console),z[L.ERROR]=console.error.bind(console),z[L.FATAL]=console.log.bind(console),z),me=function(e){return ee(e)||ne(e)||ue(e)||te(e)?e:e instanceof Error?JSON.stringify({name:e.name,message:e.message,stack:e.stack}):JSON.stringify(e)},ve=0,_e=function(){function e(e,t,n){this.tag=e,this.type=t,this.initiator=n,this._outLevel=L.WARN,this.debug=this.log.bind(this,L.DEBUG),this.info=this.log.bind(this,L.INFO),this.warn=this.log.bind(this,L.WARN),this.error=this.log.bind(this,L.ERROR),this.fatal=this.log.bind(this,L.FATAL)}return e.init=function(t){e.userId=t},e.reset=function(){e.userId=""},e.prototype._defaultStdout=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];ge[e].apply(ge,k([t+":"],n))},e.prototype.__pushLocalLog=function(t,n,r){var i;i=this.type?this.type:["RCRTCLog","RCCall","RCRTC","RTC-A"].includes(this.tag)?x.RTC:x.IM;var o=Date.now();o===Math.floor(ve/1e3)?ve++:ve=1e3*o,V(n)>=1e3&&(n=function(e,t,n){if(void 0===n&&(n="utf-8"),!e||!t)return"";var r="utf-8"===n?3:2,i=0,o=0,s="";for(o=0;o<e.length;o++){if(e.charCodeAt(o)>255?i+=r:i++,i>t)return s;s+=e.charAt(o)}return e}(n,1e3));var s=JSON.stringify({message:n,userId:e.userId}).replace(/"/g,'""'),a=/^[\w]+-[\w]+-[\w]+?/.test(r)?r:(this.initiator||"L")+"-"+r+"-O",c={sessionId:e.sessionId,time:o,level:4-t,content:e.sessionId+","+Date.now()+","+i+","+(4-t)+","+a+',"'+s+'"\n',key:e.sessionId+"_"+ve.toString(),userId:e.userId};e.databaseLogList.push(c),e.databaseLogList.length>=100&&this.__insertLogIntoDatabase()},e.prototype.__insertLogIntoDatabase=function(){return M(this,void 0,void 0,(function(){var t,n,r;return P(this,(function(i){switch(i.label){case 0:return t=k([],e.databaseLogList),e.databaseLogList=[],(n=q.getInstance())?[4,n.addList(H,t)]:[3,3];case 1:return r=i.sent(),[4,n.getCount(H,"time")];case 2:return i.sent()>1e5&&n.removeFirstData(H,"time",2e3),[2,r];case 3:return[2,!1]}}))}))},e.prototype.setLogLevel=function(e){this._outLevel="number"!=typeof e?L.WARN:e},e.prototype.setLogStdout=function(e){this._logStdout=e},e.prototype.log=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.__pushLocalLog(e,t.map(me).join(" "),this.tag),!(e<this._outLevel)){var r=(new Date).toISOString()+"["+this.tag+"]["+L[e]+"]",i=r+" - "+t.map(me).join(" ");this._logStdout?this._logStdout(e,i):this._stdout?this._stdout(e,i):this._defaultStdout.apply(this,k([e,r],t))}},e.prototype.reportLog=function(t,n,r){this.__pushLocalLog(4-t,r,n);var i=JSON.stringify({message:r}).replace(/"/g,'""');i='"'+i+'"';var o={level:t,content:[e.sessionId,Date.now(),this.type,t,n,i].join()+"\n"};e.realTimeLogList.push(o),e.realTimeLogList.length>=600&&(e.realTimeLogList=e.realTimeLogList.slice(-500))},e.prototype.set=function(e,t){this.warn("logger.set has being deprecated!")},e.prototype.setStdout=function(e){this._stdout=e},e.prototype.__clearRealTimeLog=function(){e.realTimeLogList=[]},e.databaseLogList=[],e.realTimeLogList=[],e.sessionId=W(),e.userId="",e}(),ye=new _e("RCLog"),Ee=function(){function e(){this._map={}}return e.prototype.on=function(e,t,n){var r=this._map[e]||(this._map[e]=[]);r.some((function(e){return e.listener===t&&e.target===n}))||r.push({listener:t,target:n})},e.prototype.once=function(e,t,n){var r=this._map[e]||(this._map[e]=[]);r.some((function(e){return e.listener===t&&e.target===n}))||r.push({listener:t,target:n,once:!0})},e.prototype.off=function(e,t,n){var r=this._map[e];r&&((r=r.filter((function(e){return e.listener!==t||e.target!==n}))).length?this._map[e]=r:delete this._map[e])},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this._map[e];if(r)for(var i=r.length-1;i>=0;i-=1){var o=r[i],s=o.target,a=o.once,c=o.listener;a&&r.splice(i,1);try{c.call.apply(c,k([s],t))}catch(e){ye.error(e)}}},e.prototype.removeAll=function(e){delete this._map[e]},e.prototype.clear=function(){Object.keys(this._map).forEach(this.removeAll,this)},e}();!function(e){e[e.STRING=0]="STRING",e[e.ONLY_STRING=1]="ONLY_STRING",e[e.NUMBER=2]="NUMBER",e[e.BOOLEAN=3]="BOOLEAN",e[e.OBJECT=4]="OBJECT",e[e.ARRAY=5]="ARRAY",e[e.CALLBACK=6]="CALLBACK"}(Z||(Z={}));var Te,Ce=((Q={})[Z.STRING]=oe,Q[Z.ONLY_STRING]=ee,Q[Z.NUMBER]=ne,Q[Z.BOOLEAN]=function(e){return"boolean"==typeof e},Q[Z.OBJECT]=ae,Q[Z.ARRAY]=re,Q[Z.CALLBACK]=function(e){var t=!0;return ae(e)||(t=!1),(e=e||{}).onSuccess&&!ce(e.onSuccess)&&(t=!1),e.onError&&!ce(e.onError)&&(t=!1),t},Q),Re=function(e){function t(t){var n=e.call(this,t)||this;return n.name="RCAssertError",n}return N(t,e),t}(Error),Se=function(e,t,n,r){if(void 0===r&&(r=!1),!be(e,t,n,r))throw new Re("'"+e+"' is invalid: "+JSON.stringify(t))},be=function(e,t,n,r){void 0===r&&(r=!1),n=Ce[n]||n;var i=r&&!n(t)||!r&&!(ue(t)||null===t||n(t));return i&&ye.error("'"+e+"' is invalid: "+JSON.stringify(t)),!i};!function(e){e[e.TIMEOUT=-1]="TIMEOUT",e[e.UNKNOWN=-2]="UNKNOWN",e[e.PARAMETER_ERROR=-3]="PARAMETER_ERROR",e[e.EXTRA_METHOD_UNDEFINED=-4]="EXTRA_METHOD_UNDEFINED",e[e.MAIN_PROCESS_ERROR=-5]="MAIN_PROCESS_ERROR",e[e.SUCCESS=0]="SUCCESS",e[e.RC_MSG_UNAUTHORIZED=20406]="RC_MSG_UNAUTHORIZED",e[e.RC_DISCUSSION_GROUP_ID_INVALID=20407]="RC_DISCUSSION_GROUP_ID_INVALID",e[e.SEND_FREQUENCY_TOO_FAST=20604]="SEND_FREQUENCY_TOO_FAST",e[e.NOT_IN_DISCUSSION=21406]="NOT_IN_DISCUSSION",e[e.FORBIDDEN_IN_GROUP=22408]="FORBIDDEN_IN_GROUP",e[e.RECALL_MESSAGE=25101]="RECALL_MESSAGE",e[e.NOT_IN_GROUP=22406]="NOT_IN_GROUP",e[e.NOT_IN_CHATROOM=23406]="NOT_IN_CHATROOM",e[e.FORBIDDEN_IN_CHATROOM=23408]="FORBIDDEN_IN_CHATROOM",e[e.RC_CHATROOM_USER_KICKED=23409]="RC_CHATROOM_USER_KICKED",e[e.RC_CHATROOM_NOT_EXIST=23410]="RC_CHATROOM_NOT_EXIST",e[e.RC_CHATROOM_IS_FULL=23411]="RC_CHATROOM_IS_FULL",e[e.RC_CHATROOM_PATAMETER_INVALID=23412]="RC_CHATROOM_PATAMETER_INVALID",e[e.CHATROOM_GET_HISTORYMSG_ERROR=23413]="CHATROOM_GET_HISTORYMSG_ERROR",e[e.CHATROOM_NOT_OPEN_HISTORYMSG_STORE=23414]="CHATROOM_NOT_OPEN_HISTORYMSG_STORE",e[e.CHATROOM_KV_EXCEED=23423]="CHATROOM_KV_EXCEED",e[e.CHATROOM_KV_OVERWRITE_INVALID=23424]="CHATROOM_KV_OVERWRITE_INVALID",e[e.CHATROOM_KV_STORE_NOT_OPEN=23426]="CHATROOM_KV_STORE_NOT_OPEN",e[e.CHATROOM_KEY_NOT_EXIST=23427]="CHATROOM_KEY_NOT_EXIST",e[e.SENSITIVE_SHIELD=21501]="SENSITIVE_SHIELD",e[e.SENSITIVE_REPLACE=21502]="SENSITIVE_REPLACE",e[e.JOIN_IN_DISCUSSION=21407]="JOIN_IN_DISCUSSION",e[e.CREATE_DISCUSSION=21408]="CREATE_DISCUSSION",e[e.INVITE_DICUSSION=21409]="INVITE_DICUSSION",e[e.GET_USERINFO_ERROR=23407]="GET_USERINFO_ERROR",e[e.REJECTED_BY_BLACKLIST=405]="REJECTED_BY_BLACKLIST",e[e.RC_NET_CHANNEL_INVALID=30001]="RC_NET_CHANNEL_INVALID",e[e.RC_NET_UNAVAILABLE=30002]="RC_NET_UNAVAILABLE",e[e.RC_MSG_RESP_TIMEOUT=30003]="RC_MSG_RESP_TIMEOUT",e[e.RC_HTTP_SEND_FAIL=30004]="RC_HTTP_SEND_FAIL",e[e.RC_HTTP_REQ_TIMEOUT=30005]="RC_HTTP_REQ_TIMEOUT",e[e.RC_HTTP_RECV_FAIL=30006]="RC_HTTP_RECV_FAIL",e[e.RC_NAVI_RESOURCE_ERROR=30007]="RC_NAVI_RESOURCE_ERROR",e[e.RC_NODE_NOT_FOUND=30008]="RC_NODE_NOT_FOUND",e[e.RC_DOMAIN_NOT_RESOLVE=30009]="RC_DOMAIN_NOT_RESOLVE",e[e.RC_SOCKET_NOT_CREATED=30010]="RC_SOCKET_NOT_CREATED",e[e.RC_SOCKET_DISCONNECTED=30011]="RC_SOCKET_DISCONNECTED",e[e.RC_PING_SEND_FAIL=30012]="RC_PING_SEND_FAIL",e[e.RC_PONG_RECV_FAIL=30013]="RC_PONG_RECV_FAIL",e[e.RC_MSG_SEND_FAIL=30014]="RC_MSG_SEND_FAIL",e[e.RC_MSG_CONTENT_EXCEED_LIMIT=30016]="RC_MSG_CONTENT_EXCEED_LIMIT",e[e.RC_CONN_ACK_TIMEOUT=31e3]="RC_CONN_ACK_TIMEOUT",e[e.RC_CONN_PROTO_VERSION_ERROR=31001]="RC_CONN_PROTO_VERSION_ERROR",e[e.RC_CONN_ID_REJECT=31002]="RC_CONN_ID_REJECT",e[e.RC_CONN_SERVER_UNAVAILABLE=31003]="RC_CONN_SERVER_UNAVAILABLE",e[e.RC_CONN_USER_OR_PASSWD_ERROR=31004]="RC_CONN_USER_OR_PASSWD_ERROR",e[e.RC_CONN_NOT_AUTHRORIZED=31005]="RC_CONN_NOT_AUTHRORIZED",e[e.RC_CONN_REDIRECTED=31006]="RC_CONN_REDIRECTED",e[e.RC_CONN_PACKAGE_NAME_INVALID=31007]="RC_CONN_PACKAGE_NAME_INVALID",e[e.RC_CONN_APP_BLOCKED_OR_DELETED=31008]="RC_CONN_APP_BLOCKED_OR_DELETED",e[e.RC_CONN_USER_BLOCKED=31009]="RC_CONN_USER_BLOCKED",e[e.RC_DISCONN_KICK=31010]="RC_DISCONN_KICK",e[e.RC_DISCONN_EXCEPTION=31011]="RC_DISCONN_EXCEPTION",e[e.RC_QUERY_ACK_NO_DATA=32001]="RC_QUERY_ACK_NO_DATA",e[e.RC_MSG_DATA_INCOMPLETE=32002]="RC_MSG_DATA_INCOMPLETE",e[e.BIZ_ERROR_CLIENT_NOT_INIT=33001]="BIZ_ERROR_CLIENT_NOT_INIT",e[e.BIZ_ERROR_DATABASE_ERROR=33002]="BIZ_ERROR_DATABASE_ERROR",e[e.BIZ_ERROR_INVALID_PARAMETER=33003]="BIZ_ERROR_INVALID_PARAMETER",e[e.BIZ_ERROR_NO_CHANNEL=33004]="BIZ_ERROR_NO_CHANNEL",e[e.BIZ_ERROR_RECONNECT_SUCCESS=33005]="BIZ_ERROR_RECONNECT_SUCCESS",e[e.BIZ_ERROR_CONNECTING=33006]="BIZ_ERROR_CONNECTING",e[e.MSG_ROAMING_SERVICE_UNAVAILABLE=33007]="MSG_ROAMING_SERVICE_UNAVAILABLE",e[e.MSG_INSERT_ERROR=33008]="MSG_INSERT_ERROR",e[e.MSG_DEL_ERROR=33009]="MSG_DEL_ERROR",e[e.TAG_NOT_EXIST=33101]="TAG_NOT_EXIST",e[e.NO_TAG_IN_CONVER=33102]="NO_TAG_IN_CONVER",e[e.CONVER_REMOVE_ERROR=34001]="CONVER_REMOVE_ERROR",e[e.CONVER_GETLIST_ERROR=34002]="CONVER_GETLIST_ERROR",e[e.CONVER_SETOP_ERROR=34003]="CONVER_SETOP_ERROR",e[e.CONVER_TOTAL_UNREAD_ERROR=34004]="CONVER_TOTAL_UNREAD_ERROR",e[e.CONVER_TYPE_UNREAD_ERROR=34005]="CONVER_TYPE_UNREAD_ERROR",e[e.CONVER_ID_TYPE_UNREAD_ERROR=34006]="CONVER_ID_TYPE_UNREAD_ERROR",e[e.CONVER_CLEAR_ERROR=34007]="CONVER_CLEAR_ERROR",e[e.EXPANSION_LIMIT_EXCEET=34010]="EXPANSION_LIMIT_EXCEET",e[e.MESSAGE_KV_NOT_SUPPORT=34008]="MESSAGE_KV_NOT_SUPPORT",e[e.CLEAR_HIS_TIME_ERROR=34011]="CLEAR_HIS_TIME_ERROR",e[e.CONVER_OUT_LIMIT_ERROR=34013]="CONVER_OUT_LIMIT_ERROR",e[e.CONVER_GET_ERROR=34009]="CONVER_GET_ERROR",e[e.GROUP_SYNC_ERROR=35001]="GROUP_SYNC_ERROR",e[e.GROUP_MATCH_ERROR=35002]="GROUP_MATCH_ERROR",e[e.READ_RECEIPT_ERROR=35003]="READ_RECEIPT_ERROR",e[e.CHATROOM_ID_ISNULL=36001]="CHATROOM_ID_ISNULL",e[e.CHARTOOM_JOIN_ERROR=36002]="CHARTOOM_JOIN_ERROR",e[e.CHATROOM_HISMESSAGE_ERROR=36003]="CHATROOM_HISMESSAGE_ERROR",e[e.CHATROOM_KV_NOT_FOUND=36004]="CHATROOM_KV_NOT_FOUND",e[e.BLACK_ADD_ERROR=37001]="BLACK_ADD_ERROR",e[e.BLACK_GETSTATUS_ERROR=37002]="BLACK_GETSTATUS_ERROR",e[e.BLACK_REMOVE_ERROR=37003]="BLACK_REMOVE_ERROR",e[e.DRAF_GET_ERROR=38001]="DRAF_GET_ERROR",e[e.DRAF_SAVE_ERROR=38002]="DRAF_SAVE_ERROR",e[e.DRAF_REMOVE_ERROR=38003]="DRAF_REMOVE_ERROR",e[e.SUBSCRIBE_ERROR=39001]="SUBSCRIBE_ERROR",e[e.NOT_SUPPORT=39002]="NOT_SUPPORT",e[e.QNTKN_FILETYPE_ERROR=41001]="QNTKN_FILETYPE_ERROR",e[e.QNTKN_GET_ERROR=41002]="QNTKN_GET_ERROR",e[e.COOKIE_ENABLE=51001]="COOKIE_ENABLE",e[e.GET_MESSAGE_BY_ID_ERROR=61001]="GET_MESSAGE_BY_ID_ERROR",e[e.HAVNODEVICEID=24001]="HAVNODEVICEID",e[e.DEVICEIDISHAVE=24002]="DEVICEIDISHAVE",e[e.FEILD=24009]="FEILD",e[e.VOIPISNULL=24013]="VOIPISNULL",e[e.NOENGINETYPE=24010]="NOENGINETYPE",e[e.NULLCHANNELNAME=24011]="NULLCHANNELNAME",e[e.VOIPDYANMICERROR=24012]="VOIPDYANMICERROR",e[e.NOVOIP=24014]="NOVOIP",e[e.INTERNALERRROR=24015]="INTERNALERRROR",e[e.VOIPCLOSE=24016]="VOIPCLOSE",e[e.CLOSE_BEFORE_OPEN=51001]="CLOSE_BEFORE_OPEN",e[e.ALREADY_IN_USE=51002]="ALREADY_IN_USE",e[e.INVALID_CHANNEL_NAME=51003]="INVALID_CHANNEL_NAME",e[e.VIDEO_CONTAINER_IS_NULL=51004]="VIDEO_CONTAINER_IS_NULL",e[e.DELETE_MESSAGE_ID_IS_NULL=61001]="DELETE_MESSAGE_ID_IS_NULL",e[e.CANCEL=1]="CANCEL",e[e.REJECT=2]="REJECT",e[e.HANGUP=3]="HANGUP",e[e.BUSYLINE=4]="BUSYLINE",e[e.NO_RESPONSE=5]="NO_RESPONSE",e[e.ENGINE_UN_SUPPORTED=6]="ENGINE_UN_SUPPORTED",e[e.NETWORK_ERROR=7]="NETWORK_ERROR",e[e.REMOTE_CANCEL=11]="REMOTE_CANCEL",e[e.REMOTE_REJECT=12]="REMOTE_REJECT",e[e.REMOTE_HANGUP=13]="REMOTE_HANGUP",e[e.REMOTE_BUSYLINE=14]="REMOTE_BUSYLINE",e[e.REMOTE_NO_RESPONSE=15]="REMOTE_NO_RESPONSE",e[e.REMOTE_ENGINE_UN_SUPPORTED=16]="REMOTE_ENGINE_UN_SUPPORTED",e[e.REMOTE_NETWORK_ERROR=17]="REMOTE_NETWORK_ERROR",e[e.VOIP_NOT_AVALIABLE=18]="VOIP_NOT_AVALIABLE"}(Te||(Te={}));var Ie,Oe=Te,we=function(e){if(!ae(e)||void 0===e.low||void 0===e.high)return e;var t=e.low;return t<0&&(t+=4294967296),t=t.toString(16),parseInt(e.high.toString(16)+"00000000".replace(new RegExp("0{"+t.length+"}$"),t),16)},Ne=function(e,t){var n=Math.floor(1e3*Math.random()%1e4),r=K(),i=function(e){e=e||"-";var t=new Date;return""+t.getFullYear()+e+(t.getMonth()+1)+e+t.getDate()}(),o=(new Date).getTime(),s="";if(t){var a=t.split(".");s="."+a[a.length-1]}return e+"__RC-"+i+"_"+n+"_"+o+r+s},Ae=function(e){var t="application/octet-stream";switch(e){case X.IMAGE:t="image/jpeg";break;case X.AUDIO:t="audio/amr";break;case X.VIDEO:t="video/3gpp";break;case X.SIGHT:t="video/mpeg4";break;case X.COMBINE_HTML:t="text/html"}return t},Me=function(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n=e.threadId,r=e.apnsCollapseId,i=e.category,o=e.richMediaUri,s=t.channelIdMi,a=t.channelIdHW,c=t.channelIdOPPO,u=t.typeVivo,d=t.googleConfig,l={};l["thread-id"]=n||"",l["apns-collapse-id"]=r||"",l.category=i||"",l.richMediaUri=o||"";var h={};h.collapse_key=null==d?void 0:d.collapseKey,h.imageUrl=null==d?void 0:d.imageUrl;var f=null==d?void 0:d.priority;f&&!["high","normal"].includes(f)&&(f="normal"),h.priority=f;var p=[{HW:{channelId:a||""}},{MI:{channelId:s||""}},{OPPO:{channelId:c||""}},{VIVO:{classification:u||""}},{APNS:l},{FCM:h}];return JSON.stringify(p)},Pe=function(e,t){var n={},r={notificationId:t||""};if(!e)return{iOSConfig:n,androidConfig:r};try{var i=JSON.parse(e);null==i||i.forEach((function(e){var t,i,o,s,a=Object.keys(e);if(0!==a.length){var c=a[0];switch(c){case"HW":return void(r.channelIdHW=null===(t=e[c])||void 0===t?void 0:t.channelId);case"MI":return void(r.channelIdMi=null===(i=e[c])||void 0===i?void 0:i.channelId);case"OPPO":return void(r.channelIdOPPO=null===(o=e[c])||void 0===o?void 0:o.channelId);case"VIVO":return void(r.typeVivo=null===(s=e[c])||void 0===s?void 0:s.classification);case"APNS":return n.threadId=e[c]["thread-id"],n.apnsCollapseId=e[c]["apns-collapse-id"],n.category=e[c].category,void(n.richMediaUri=e[c].richMediaUri);case"FCM":r.googleConfig={collapseKey:e[c].collapse_key||"",imageUrl:e[c].imageUrl||"",priority:e[c].priority||""}}}}))}catch(t){ye.error("Wrong format for pushConfigs field! content: "+e)}return{iOSConfig:n,androidConfig:r}},ke=function(e){var t=/^[A-Za-z0-9_=+-]+$/.test(e),n=e.length;return t&&n<=128&&n>=1},Le=function(e){var t=e.length;return t<=4096&&t>=1},xe=function(e,t,n){t=t||function(){};var r=(n=n||{}).isReverse;ae(e)&&function(){for(var n in e)t(e[n],n,e)}(),(re(e)||ee(e))&&function(){if(r)for(var n=e.length-1;n>=0;n--)t(e[n],n);else for(var i=0,o=e.length;i<o;i++)t(e[i],i)}()},Ue=function(e,t){return xe(e,(function(n,r){e[r]=t(n,r)})),e},De=function(e,t){if(e.indexOf)return e.indexOf(t);var n=-1;return xe(e,(function(e,r){t===e&&(n=r)})),n},je=function(e,t){return-1!==De(e,t)},Ve=function(e,t){var n=[];return xe(e,(function(e){n.push(e)})),-1!==De(n,t)},Be=function(e){return JSON.parse(JSON.stringify(e))},Fe=function(){return"undefined"!=typeof RCCppEngine},He=function(e){if("browser"!==e.tag)return{type:e.tag,version:"UnKonw"};var t,n,r=navigator.userAgent,i={IE:/rv:([\d.]+)\) like Gecko|MSIE ([\d.]+)/,Edge:/Edge\/([\d.]+)/,Firefox:/Firefox\/([\d.]+)/,Opera:/(?:OPERA|OPR).([\d.]+)/,WeChat:/MicroMessenger\/([\d.]+)/,QQBrowser:/QQBrowser\/([\d.]+)/,Chrome:/Chrome\/([\d.]+)/,Safari:/Version\/([\d.]+).*Safari/,iOSChrome:/Mobile\/([\d.]+).*Safari/};for(var o in i)if(i.hasOwnProperty(o)){var s=r.match(i[o]);if(s){n=o,t=s[1]||s[2];break}}return{type:n||"UnKonw",version:t||"UnKonw"}};!function(e){e[e.UPDATE=1]="UPDATE",e[e.DELETE=2]="DELETE"}(Ie||(Ie={}));var Ge,Ye,qe,Ke,We=Ie,$e=function(e){var t={},n=JSON.parse(e);return xe(n,(function(e,n){t[n]=e.v})),t},Je={_delayTime:0,setTime:function(e){var t=(new Date).getTime();Je._delayTime=t-e},getTime:function(){var e=Je._delayTime;return(new Date).getTime()-e}};!function(e){e[e.AT_MOST_ONCE=0]="AT_MOST_ONCE",e[e.AT_LEAST_ONCE=1]="AT_LEAST_ONCE",e[e.EXACTLY_ONCE=2]="EXACTLY_ONCE",e[e.DEFAULT=3]="DEFAULT"}(Ge||(Ge={})),function(e){e[e.SYMMETRIC=0]="SYMMETRIC",e[e.CONNECT=1]="CONNECT",e[e.CONN_ACK=2]="CONN_ACK",e[e.PUBLISH=3]="PUBLISH",e[e.PUB_ACK=4]="PUB_ACK",e[e.QUERY=5]="QUERY",e[e.QUERY_ACK=6]="QUERY_ACK",e[e.QUERY_CONFIRM=7]="QUERY_CONFIRM",e[e.SUBSCRIBE=8]="SUBSCRIBE",e[e.SUB_ACK=9]="SUB_ACK",e[e.UNSUBSCRIBE=10]="UNSUBSCRIBE",e[e.UNSUB_ACK=11]="UNSUB_ACK",e[e.PING_REQ=12]="PING_REQ",e[e.PING_RESP=13]="PING_RESP",e[e.DISCONNECT=14]="DISCONNECT",e[e.RESERVER2=15]="RESERVER2"}(Ye||(Ye={})),function(e){e.CONN_ACK="ConnAckMessage",e.DISCONNECT="DisconnectMessage",e.PING_REQ="PingReqMessage",e.PING_RESP="PingRespMessage",e.PUBLISH="PublishMessage",e.PUB_ACK="PubAckMessage",e.QUERY="QueryMessage",e.QUERY_CON="QueryConMessage",e.QUERY_ACK="QueryAckMessage"}(qe||(qe={})),function(e){e.PUB="pub",e.QUERY="qry"}(Ke||(Ke={}));var ze,Qe=function(){function e(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=Ge.AT_LEAST_ONCE),void 0===r&&(r=!1),this._retain=!1,this.qos=Ge.AT_LEAST_ONCE,this._dup=!1,this.syncMsg=!1;var i=e>0;e&&i&&1===arguments.length?(this._retain=(1&e)>0,this.qos=(6&e)>>1,this._dup=(8&e)>0,this.type=e>>4&15,this.syncMsg=8==(8&e)):(this.type=e,this._retain=t,this.qos=n,this._dup=r)}return e.prototype.encode=function(){var e=this.type<<4;return e|=this._retain?1:0,e|=this.qos<<1,e|(this._dup?8:0)},e}(),Ze=function(){function e(){}return e.writeUTF=function(e,t){var n=[],r=0;if(ee(e))for(var i=0,o=e.length;i<o;i++){var s=e.charCodeAt(i);s>=0&&s<=127?(r+=1,n.push(s)):s>=128&&s<=2047?(r+=2,n.push(192|31&s>>6),n.push(128|63&s)):s>=2048&&s<=65535&&(r+=3,n.push(224|15&s>>12),n.push(128|63&s>>6),n.push(128|63&s))}for(i=0,o=n.length;i<o;i++)n[i]>255&&(n[i]&=255);return t?n:r<=255?[0,r].concat(n):[r>>8,255&r].concat(n)},e.readUTF=function(e){for(var t,n,r=[],i=-1,o=e,s="";++i<o.length;){var a=Number(o[i]);if(a===(127&a)||(240==(240&a)?a=(a=(a=(a^=240)<<6|128^o[++i])<<6|128^o[++i])<<6|128^o[++i]:224==(224&a)?a=(a=(a^=224)<<6|128^o[++i])<<6|128^o[++i]:192==(192&a)&&(a=(a^=192)<<6|128^o[++i])),!isFinite(a)||a<0||a>1114111||Math.floor(a)!==a)throw RangeError("Invalid code point: "+a);a<=65535?r.push(a):(t=(a-=65536)>>10|55296,n=a%1024|56320,r.push(t,n)),(i+1===o.length||r.length>16384)&&(s+=String.fromCharCode.apply(null,r),r.length=0)}return s},e}(),Xe=function(){function e(e){this._position=0,this._poolLen=0,this._pool=e,this._poolLen=e.length}return e.prototype.check=function(){return this._position>=this._pool.length},e.prototype.readInt=function(){var e=this;if(e.check())return-1;for(var t="",n=0;n<4;n++){var r=e._pool[e._position++].toString(16);1===r.length&&(r="0"+r),t+=r.toString()}return parseInt(t,16)},e.prototype.readLong=function(){var e=this;if(e.check())return-1;for(var t="",n=0;n<8;n++){var r=e._pool[e._position++].toString(16);1===r.length&&(r="0"+r),t+=r}return parseInt(t,16)},e.prototype.readByte=function(){if(this.check())return-1;var e=this._pool[this._position++];return e>255&&(e&=255),e},e.prototype.readUTF=function(){if(this.check())return"";var e=this.readByte()<<8|this.readByte(),t=this._pool.subarray(this._position,this._position+=e);return Ze.readUTF(t)},e.prototype.readAll=function(){return this._pool.subarray(this._position,this._poolLen)},e}(),et=function(){function e(){this._pool=[],this._position=0,this._writen=0}return e.prototype.write=function(e){return-1!==Object.prototype.toString.call(e).indexOf("Array")?this._pool=this._pool.concat(e):e>=0&&(e>255&&(e&=255),this._pool.push(e),this._writen++),e},e.prototype.writeArr=function(e){return this._pool=this._pool.concat(e),e},e.prototype.writeUTF=function(e){var t=Ze.writeUTF(e);this._pool=this._pool.concat(t),this._writen+=t.length},e.prototype.getBytesArray=function(){return this._pool},e}(),tt="UpStreamMessage",nt="PushExtra",rt="DownStreamMessage",it="DownStreamMessages",ot="SessionsAttQryInput",st="SessionsAttOutput",at="SyncRequestMsg",ct="ChrmPullMsg",ut="NotifyMsg",dt="HistoryMsgInput",lt="HistoryMsgOuput",ht="RelationQryInput",ft="RelationsOutput",pt="DeleteSessionsInput",gt="SessionInfo",mt="DeleteSessionsOutput",vt="RelationsInput",_t="DeleteMsgInput",yt="CleanHisMsgInput",Et="SessionMsgReadInput",Tt="ChrmInput",Ct="QueryChatRoomInfoInput",Rt="QueryChatRoomInfoOutput",St="RtcInput",bt="RtcUserListOutput",It="SetUserStatusInput",Ot="RtcSetDataInput",wt="RtcUserSetDataInput",Nt="RtcDataInput",At="RtcSetOutDataInput",Mt="MCFollowInput",Pt="RtcTokenOutput",kt="RtcQryOutput",Lt="RtcQryUserOutDataInput",xt="RtcUserOutDataOutput",Ut="RtcQueryListInput",Dt="RtcRoomInfoOutput",jt="RtcValueInfo",Vt="RtcKeyDeleteInput",Bt="GetQNupTokenInput",Ft="GetQNupTokenOutput",Ht="GetQNdownloadUrlInput",Gt="GetDownloadUrlInput",Yt="GetQNdownloadUrlOutput",qt="GetDownloadUrlOutput",Kt="SetChrmKV",Wt="ChrmKVOutput",$t="QueryChrmKV",Jt="SetUserSettingInput",zt="SetUserSettingOutput",Qt="PullUserSettingInput",Zt="PullUserSettingOutput",Xt="UserSettingNotification",en="SessionReq",tn="SessionStates",nn="SessionState",rn="SessionStateItem",on="SessionStateModifyReq",sn="SessionStateModifyResp",an="GrpReadReceiptMsg",cn="GrpReadReceiptQryReq",un="GrpReadReceiptQryResp",dn="GrpMsgReadUser",ln="SessionTagAddInput",hn="SessionTagItem",fn="SessionTagDelInput",pn="SessionDisTagReq",gn="ReportSDKInput",mn="ReportSDKOutput",vn="RtcNotifyMsg",_n="RtcPullKV",yn="RtcKVOutput",En=((ze={})[tt]=["sessionId","classname","content","pushText","userId","configFlag","appData","extraContent","pushExt"],ze[it]=["list","syncTime","finished"],ze[rt]=["fromUserId","type","groupId","classname","content","dataTime","status","msgId","extraContent","pushContent","configFlag","pushExt"],ze[nt]=["title","templateIdNoUse","pushId","pushConfigs","templateId"],ze[ot]=["nothing"],ze[st]=["inboxTime","sendboxTime","totalUnreadCount"],ze[at]=["syncTime","ispolling","isweb","isPullSend","isKeeping","sendBoxSyncTime"],ze[ct]=["syncTime","count"],ze[ut]=["type","time","chrmId"],ze[dt]=["targetId","time","count","order"],ze[lt]=["list","syncTime","hasMsg"],ze[ht]=["type","count","startTime","order"],ze[ft]=["info"],ze[pt]=["sessions"],ze[gt]=["type","channelId"],ze[mt]=["nothing"],ze[vt]=["type","msg","count","offset","startTime","endTime"],ze[_t]=["type","conversationId","msgs"],ze[yt]=["targetId","dataTime","conversationType"],ze[Et]=["type","msgTime","channelId"],ze[Tt]=["nothing"],ze[Ct]=["count","order"],ze[Rt]=["userTotalNums","userInfos"],ze[Bt]=["type","key","httpMethod","queryString"],ze[Ht]=["type","key","fileName"],ze[Gt]=["type","key","fileName"],ze[Ft]=["deadline","token","bosToken","bosDate","path","osskeyId","ossPolicy","ossSign","ossBucketName"],ze[Yt]=["downloadUrl"],ze[qt]=["downloadUrl"],ze[Kt]=["entry","bNotify","notification","type"],ze[Wt]=["entries","bFullUpdate","syncTime"],ze[$t]=["timestamp"],ze[Jt]=["version","value"],ze[zt]=["version","reserve"],ze[Qt]=["version","reserve"],ze[Zt]=["items","version"],ze.UserSettingItem=["targetId","type","key","value","version","status","tags"],ze[en]=["time"],ze[tn]=["version","state"],ze[nn]=["type","channelId","time","stateItem"],ze[rn]=["sessionStateType","value","tags"],ze[on]=["version","state"],ze[sn]=["version"],ze[an]=["msgId","busChannel"],ze[cn]=["msgId","busChannel"],ze[un]=["totalMemberNum","list"],ze[dn]=["readTime","userId"],ze[ln]=["version","tags"],ze[hn]=["tagId","name","createdTime","isTop"],ze[fn]=["version","tags"],ze[pn]=["tagId"],ze[Xt]=["version","reserve"],ze[gn]=["sdkInfo"],ze[mn]=["nothing"],ze),Tn={},Cn=function(e){var t=En[e];Tn[e]=function(){for(var e={},n={getArrayData:function(){return e}},r=function(r){var i=t[r],o="set"+j(i,0,1);n[o]=function(t){e[i]=t}},i=0;i<t.length;i++)r(i);return n},Tn[e].decode=function(e){var t={};ee(e)&&(e=JSON.parse(e));var n=function(n){var r="get"+j(n,0,1);t[n]=e[n],t[r]=function(){return e[n]}};for(var r in e)n(r);return t}};for(var Rn in En)Cn(Rn);Tn.getModule=function(e){return Tn[e]()};var Sn,bn,In,On="\npackage Modules;\nmessage probuf {\n  message "+It+"\n  {\n    optional int32 status=1;\n  }\n\n  message SetUserStatusOutput\n  {\n    optional int32 nothing=1;\n  }\n\n  message GetUserStatusInput\n  {\n    optional int32 nothing=1;\n  }\n\n  message GetUserStatusOutput\n  {\n    optional string status=1;\n    optional string subUserId=2;\n  }\n\n  message SubUserStatusInput\n  {\n    repeated string userid =1;\n  }\n\n  message SubUserStatusOutput\n  {\n    optional int32 nothing=1;\n  }\n  message VoipDynamicInput\n  {\n    required int32  engineType = 1;\n    required string channelName = 2;\n    optional string channelExtra = 3;\n  }\n\n  message VoipDynamicOutput\n  {\n      required string dynamicKey=1;\n  }\n  message "+ut+" {\n    required int32 type = 1;\n    optional int64 time = 2;\n    optional string chrmId=3;\n  }\n  message "+at+" {\n    required int64 syncTime = 1;\n    required bool ispolling = 2;\n    optional bool isweb=3;\n    optional bool isPullSend=4;\n    optional bool isKeeping=5;\n    optional int64 sendBoxSyncTime=6;\n  }\n  message "+tt+" {\n    required int32 sessionId = 1;\n    required string classname = 2;\n    required bytes content = 3;\n    optional string pushText = 4;\n    optional string appData = 5;\n    repeated string userId = 6;\n    optional int64 delMsgTime = 7;\n    optional string delMsgId = 8;\n    optional int32 configFlag = 9;\n    optional int64 clientUniqueId = 10;\n    optional string extraContent = 11;\n    optional PushExtra pushExt = 12;\n  }\n  message "+nt+" {\n    optional string title = 1;\n    optional int32  templateIdNoUse= 2;\n    optional string pushId = 3;\n    optional string pushConfigs = 4;\n    optional string templateId = 5;\n  }\n  message "+it+" {\n    repeated DownStreamMessage list = 1;\n    required int64 syncTime = 2;\n    optional bool finished = 3;\n  }\n  message "+rt+" {\n    required string fromUserId = 1;\n    required ChannelType type = 2;\n    optional string groupId = 3;\n    required string classname = 4;\n    required bytes content = 5;\n    required int64 dataTime = 6;\n    required int64 status = 7;\n    optional int64 extra = 8;\n    optional string msgId = 9;\n    optional int32 direction = 10;\n    optional int32 plantform =11;\n    optional int32 isRemoved = 12;\n    optional string source = 13;\n    optional int64 clientUniqueId = 14;\n    optional string extraContent = 15;\n    optional string pushContent = 16;\n    optional int32 configFlag = 17;\n    optional PushExtra pushExt = 18;\n  }\n  enum ChannelType {\n    PERSON = 1;\n    PERSONS = 2;\n    GROUP = 3;\n    TEMPGROUP = 4;\n    CUSTOMERSERVICE = 5;\n    NOTIFY = 6;\n    MC=7;\n    MP=8;\n  }\n  message CreateDiscussionInput {\n    optional string name = 1;\n  }\n  message CreateDiscussionOutput {\n    required string id = 1;\n  }\n  message ChannelInvitationInput {\n    repeated string users = 1;\n  }\n  message LeaveChannelInput {\n    required int32 nothing = 1;\n  }\n  message ChannelEvictionInput {\n    required string user = 1;\n  }\n  message RenameChannelInput {\n    required string name = 1;\n  }\n  message ChannelInfoInput {\n    required int32 nothing = 1;\n  }\n  message ChannelInfoOutput {\n    required ChannelType type = 1;\n    required string channelId = 2;\n    required string channelName = 3;\n    required string adminUserId = 4;\n    repeated string firstTenUserIds = 5;\n    required int32 openStatus = 6;\n  }\n  message ChannelInfosInput {\n    required int32 page = 1;\n    optional int32 number = 2;\n  }\n  message ChannelInfosOutput {\n    repeated ChannelInfoOutput channels = 1;\n    required int32 total = 2;\n  }\n  message MemberInfo {\n    required string userId = 1;\n    required string userName = 2;\n    required string userPortrait = 3;\n    required string extension = 4;\n  }\n  message GroupMembersInput {\n    required int32 page = 1;\n    optional int32 number = 2;\n  }\n  message GroupMembersOutput {\n    repeated MemberInfo members = 1;\n    required int32 total = 2;\n  }\n  message GetUserInfoInput {\n    required int32 nothing = 1;\n  }\n  message GetUserInfoOutput {\n    required string userId = 1;\n    required string userName = 2;\n    required string userPortrait = 3;\n  }\n  message GetSessionIdInput {\n    required int32 nothing = 1;\n  }\n  message GetSessionIdOutput {\n    required int32 sessionId = 1;\n  }\n  enum FileType {\n    image = "+X.IMAGE+";\n    audio = "+X.AUDIO+";\n    video = "+X.VIDEO+";\n    file = "+X.FILE+";\n  }\n  message "+Bt+" {\n    required FileType type = 1;\n    optional string key = 2;\n    optional string httpMethod = 3;\n    optional string queryString = 4;\n  }\n  message "+Ht+" {\n    required FileType type = 1;\n    required string key = 2;\n    optional string  fileName = 3;\n  }\n  message "+Gt+" {\n    required FileType type = 1;\n    required string key = 2;\n    optional string fileName = 3;\n   }\n  message "+Ft+" {\n    required int64 deadline = 1;\n    required string token = 2;\n    optional string bosToken = 3;\n    optional string bosDate = 4;\n    optional string path = 5;\n    optional string osskeyId = 6;\n    optional string ossPolicy = 7;\n    optional string ossSign = 8;\n    optional string ossBucketName = 9;\n    optional string s3Credential = 10;\n    optional string s3Algorithm = 11;\n    optional string s3Date = 12;\n    optional string s3Policy = 13;\n    optional string s3Signature = 14;\n    optional string s3BucketName = 15;\n    optional string stcAuthorization = 16;\n    optional string stcContentSha256 = 17;\n    optional string stcDate = 18;\n    optional string stcBucketName = 19;\n  }\n  message "+Yt+" {\n    required string downloadUrl = 1;\n  }\n  message "+qt+" {\n    required string downloadUrl = 1;\n  }\n  message Add2BlackListInput {\n    required string userId = 1;\n  }\n  message RemoveFromBlackListInput {\n    required string userId = 1;\n  }\n  message QueryBlackListInput {\n    required int32 nothing = 1;\n  }\n  message QueryBlackListOutput {\n    repeated string userIds = 1;\n  }\n  message BlackListStatusInput {\n    required string userId = 1;\n  }\n  message BlockPushInput {\n    required string blockeeId = 1;\n  }\n  message ModifyPermissionInput {\n    required int32 openStatus = 1;\n  }\n  message GroupInput {\n    repeated GroupInfo groupInfo = 1;\n  }\n  message GroupOutput {\n    required int32 nothing = 1;\n  }\n  message GroupInfo {\n    required string id = 1;\n    required string name = 2;\n  }\n  message GroupHashInput {\n    required string userId = 1;\n    required string groupHashCode = 2;\n  }\n  message GroupHashOutput {\n    required GroupHashType result = 1;\n  }\n  enum GroupHashType {\n    group_success = 0x00;\n    group_failure = 0x01;\n  }\n  message "+Tt+" {\n    required int32 nothing = 1;\n  }\n  message ChrmOutput {\n    required int32 nothing = 1;\n  }\n  message "+ct+" {\n    required int64 syncTime = 1;\n    required int32 count = 2;\n  }\n\n  message ChrmPullMsgNew\n  {\n    required int32 count = 1;\n    required int64 syncTime = 2;\n    optional string chrmId=3;\n  }\n  message "+ht+"\n  {\n    optional ChannelType type = 1;\n    optional int32 count = 2;\n    optional int64 startTime = 3;\n    optional int32 order = 4;\n  }\n  message "+vt+"\n  {\n    required ChannelType type = 1;\n    optional DownStreamMessage msg =2;\n    optional int32 count = 3;\n    optional int32 offset = 4;\n    optional int64 startTime = 5;\n    optional int64 endTime = 6;\n  }\n  message "+ft+"\n  {\n    repeated RelationInfo info = 1;\n  }\n  message RelationInfo\n  {\n    required ChannelType type = 1;\n    required string userId = 2;\n    optional DownStreamMessage msg =3;\n    optional int64 readMsgTime= 4;\n    optional int64 unreadCount= 5;\n    optional string channelId = 6;\n  }\n  message RelationInfoReadTime\n  {\n    required ChannelType type = 1;\n    required int64 readMsgTime= 2;\n    required string targetId = 3;\n  }\n  message "+yt+"\n  {\n      required string targetId = 1;\n      required int64 dataTime = 2;\n      optional int32 conversationType= 3;\n  }\n  message HistoryMessageInput\n  {\n    required string targetId = 1;\n    required int64 dataTime =2;\n    required int32 size  = 3;\n  }\n\n  message HistoryMessagesOuput\n  {\n    repeated DownStreamMessage list = 1;\n    required int64 syncTime = 2;\n    required int32 hasMsg = 3;\n  }\n  message "+Ct+"\n  {\n    required int32 count= 1;\n    optional int32 order= 2;\n  }\n\n  message "+Rt+"\n  {\n    optional int32 userTotalNums = 1;\n    repeated ChrmMember userInfos = 2;\n  }\n  message ChrmMember\n  {\n    required int64 time = 1;\n    required string id = 2;\n  }\n  message MPFollowInput\n  {\n    required string id = 1;\n  }\n\n  message MPFollowOutput\n  {\n    required int32 nothing = 1;\n    optional MpInfo info =2;\n  }\n\n  message "+Mt+"\n  {\n    required string id = 1;\n  }\n\n  message MCFollowOutput\n  {\n    required int32 nothing = 1;\n    optional MpInfo info =2;\n  }\n\n  message MpInfo\n  {\n    required string mpid=1;\n    required string name = 2;\n    required string type = 3;\n    required int64 time=4;\n    optional string portraitUrl=5;\n    optional string extra =6;\n  }\n\n  message SearchMpInput\n  {\n    required int32 type=1;\n    required string id=2;\n  }\n\n  message SearchMpOutput\n  {\n    required int32 nothing=1;\n    repeated MpInfo info = 2;\n  }\n\n  message PullMpInput\n  {\n    required int64 time=1;\n    required string mpid=2;\n  }\n\n  message PullMpOutput\n  {\n    required int32 status=1;\n    repeated MpInfo info = 2;\n  }\n  message "+dt+"\n  {\n    optional string targetId = 1;\n    optional int64 time = 2;\n    optional int32 count  = 3;\n    optional int32 order = 4;\n  }\n\n  message "+lt+"\n  {\n    repeated DownStreamMessage list=1;\n    required int64 syncTime=2;\n    required int32 hasMsg=3;\n  }\n  message "+Ut+"{\n    optional int32 order=1;\n  }\n\n  message "+Vt+"{\n    repeated string key=1;\n  }\n\n  message "+jt+"{\n    required string key=1;\n    required string value=2;\n  }\n\n  message RtcUserInfo{\n    required string userId=1;\n    repeated "+jt+" userData=2; //用户资源信息\n  }\n\n  message "+bt+"{\n    repeated RtcUserInfo list=1;\n    optional string token=2;\n    optional string sessionId=3;\n    repeated RtcValueInfo roomInfo = 4; //房间key value\n  }\n  message RtcRoomInfoOutput{\n    optional string roomId = 1;\n    repeated "+jt+" roomData = 2;\n    optional int32 userCount = 3;\n    repeated RtcUserInfo list=4;\n  }\n  message "+St+"{\n    required int32 roomType=1;\n    optional int32 broadcastType=2;\n    optional RtcValueInfo extraInnerData = 3;\n    optional bool needSysChatroom = 4; //是否需要同步聊天室\n    optional IdentityChangeType identityChangeType = 5; //身份变更类型\n  }\n  message RtcQryInput{\n    required bool isInterior=1;\n    required targetType target=2;\n    repeated string key=3;\n  }\n  message "+kt+"{\n    repeated "+jt+" outInfo=1;\n  }\n  message RtcDelDataInput{\n    repeated string key=1;\n    required bool isInterior=2;\n    required targetType target=3;\n  }\n  message "+Nt+"{\n    required bool interior=1;\n    required targetType target=2;\n    repeated string key=3;\n    optional string objectName=4;\n    optional string content=5;\n  }\n  message "+Ot+"{\n    required bool interior=1;\n    required targetType target=2;\n    required string key=3;\n    required string value=4;\n    optional string objectName=5;\n    optional string content=6;\n  }\n  message "+wt+" {\n    repeated "+jt+" valueInfo = 1;\n    required string objectName = 2;\n    repeated "+jt+" content = 3;\n  }\n  message RtcOutput\n  {\n    optional int32 nothing=1;\n  }\n  message "+Pt+"{\n    required string rtcToken=1;\n  }\n  enum targetType {\n    ROOM =1 ;\n    PERSON = 2;\n  }\n  message "+At+"{\n    required targetType target=1;\n    repeated "+jt+" valueInfo=2;\n    optional string objectName=3;\n    optional string content=4;\n  }\n  message "+Lt+"{\n    repeated string userId = 1;\n  }\n  message "+xt+"{\n    repeated RtcUserInfo user = 1;\n  }\n  message "+ot+"{\n    required int32 nothing = 1;\n  }\n  message "+st+"{\n    required int64 inboxTime = 1;\n    required int64 sendboxTime = 2;\n    required int64 totalUnreadCount = 3;\n  }\n  message "+Et+"\n  {\n    required ChannelType type = 1;\n    required int64 msgTime = 2;\n    required string channelId = 3;\n  }\n  message SessionMsgReadOutput\n  {\n    optional int32 nothing=1;\n  }\n  message "+pt+"\n  {\n    repeated SessionInfo sessions = 1;\n  }\n  message "+gt+"\n  {\n    required ChannelType type = 1;\n    required string channelId = 2;\n  }\n  message "+mt+"\n  {\n    optional int32 nothing=1;\n  }\n  message "+_t+"\n  {\n    optional ChannelType type = 1;\n    optional string conversationId = 2;\n    repeated DeleteMsg msgs = 3;\n  }\n  message DeleteMsg\n  {\n    optional string msgId = 1;\n    optional int64 msgDataTime = 2;\n    optional int32 direct = 3;\n  }\n  message ChrmKVEntity {\n    required string key = 1;\n    required string value = 2;\n    optional int32 status = 3;\n    optional int64 timestamp = 4;\n    optional string uid = 5;\n  }\n  message "+Kt+" {\n    required ChrmKVEntity entry = 1;\n    optional bool bNotify = 2;\n    optional UpStreamMessage notification = 3;\n    optional ChannelType type = 4;\n  }\n  message "+Wt+" {\n    repeated ChrmKVEntity entries = 1;\n    optional bool bFullUpdate = 2;\n    optional int64 syncTime = 3;\n  }\n  message "+$t+" {\n    required int64 timestamp = 1;\n  }\n  message "+Jt+" {\n    required int64 version=1;\n    required string value=2;\n  }\n  message "+zt+" {\n    required int64 version=1;\n    required bool reserve=2;\n  }\n  message "+Qt+" {\n    required int64 version=1;\n    optional bool reserve=2;\n  }\n  message "+Zt+" {\n    repeated UserSettingItem items = 1;\n    required int64 version=2;\n  }\n  message UserSettingItem {\n    required string targetId= 1;\n    required ChannelType type = 2;\n    required string key = 4;\n    required bytes value = 5;\n    required int64 version=6;\n    required int32 status=7;\n    repeated SessionTagItem tags= 8;\n  }\n  message "+en+" {\n    required int64 time = 1;\n  }\n  message "+tn+" {\n    required int64 version=1;\n    repeated SessionState state= 2;\n  }\n  message "+nn+" {\n    required ChannelType type = 1;\n    required string channelId = 2;\n    optional int64 time = 3;\n    repeated SessionStateItem stateItem = 4;\n  }\n  message "+rn+" {\n    required SessionStateType sessionStateType = 1;\n    required string value = 2;\n    repeated SessionTagItem tags = 3;\n  }\n  enum SessionStateType {\n    IsSilent = 1;\n    IsTop = 2;\n    Tags = 3;\n  }\n  message "+on+" {\n    required int64 version=1;\n    repeated SessionState state= 2;\n  }\n  message "+sn+" {\n    required int64 version=1;\n  }\n  message "+an+" {\n    repeated string msgId=1; //已读消息ID\n    optional string busChannel = 2; // 该消息所属会话的业务标识\n  }\n  message "+cn+" {\n    repeated string msgId=1; //已读消息ID\n    optional string busChannel = 2; // 该消息所属会话的业务标识\n  }\n  message "+un+" {\n    required int32 totalMemberNum = 1;//群内总人数\n    repeated GrpMsgReadUser list = 2;//已读用户列表（list复类型）\n  }\n  message "+dn+" {\n    required int64 readTime = 1;//已读时间\n    required string userId = 2;//已读用户id\n  }\n  message "+ln+" {\n    required int64 version=1;\n    repeated SessionTagItem tags=2;\n  }\n  message "+hn+" {\n    required string tagId=1;\n    optional string name=2;\n    optional int64 createdTime=3;\n    optional bool isTop=4;\n  }\n  message "+fn+" {\n    required int64 version=1;\n    repeated SessionTagItem tags=2;\n  }\n  message "+pn+" {\n    repeated string tagId=1;\n  }\n  message "+Xt+" {\n    required int64 version=1;\n    required bool reserve=2;\n  }\n  message "+gn+' {\n    required string sdkInfo=1; // 用户集成的 sdk 信息,json 格式 {"web-rtc": "4.0.3.7"}\n  }\n  message '+mn+"\n  {\n    optional int32 nothing=1; //占位\n  }\n  message "+vn+" \n  {\n    required int32 type= 1;   //(通知类型 1:rtc房间状态KV变更通知)\n    optional int64 time= 2;   //消息产生时间\n    optional string roomId=3; //主播房间id\n  }\n  message "+_n+"\n  {\n    required int64 timestamp = 1;\n    required string roomId = 2;\n  }\n  message "+yn+"\n  {\n    repeated RtcKVEntity entries = 1;\n    optional bool bFullUpdate = 2;\n    optional int64 syncTime = 3; \n  }\n  message RtcKVEntity \n  {\n    required string key = 1;\n    required string value = 2;\n    optional int32 status = 3;\n    optional int64 timestamp = 4;\n    optional string uid = 5;\n  }\n  enum IdentityChangeType \n  {\n    AnchorToViewer = 1; //1为主播变观众\n    ViewerToAnchor = 2; //2为观众变主播\n  }\n}\n",wn=(Sn=On,function(t,n){var r,i,o={};return o.ByteBuffer=t,o.c=t,r=t,o.Long=n||null,o.VERSION="5.0.1",o.WIRE_TYPES={},o.WIRE_TYPES.VARINT=0,o.WIRE_TYPES.BITS64=1,o.WIRE_TYPES.LDELIM=2,o.WIRE_TYPES.STARTGROUP=3,o.WIRE_TYPES.ENDGROUP=4,o.WIRE_TYPES.BITS32=5,o.PACKABLE_WIRE_TYPES=[o.WIRE_TYPES.VARINT,o.WIRE_TYPES.BITS64,o.WIRE_TYPES.BITS32],o.TYPES={int32:{name:"int32",wireType:o.WIRE_TYPES.VARINT,defaultValue:0},uint32:{name:"uint32",wireType:o.WIRE_TYPES.VARINT,defaultValue:0},sint32:{name:"sint32",wireType:o.WIRE_TYPES.VARINT,defaultValue:0},int64:{name:"int64",wireType:o.WIRE_TYPES.VARINT,defaultValue:o.Long?o.Long.ZERO:void 0},uint64:{name:"uint64",wireType:o.WIRE_TYPES.VARINT,defaultValue:o.Long?o.Long.UZERO:void 0},sint64:{name:"sint64",wireType:o.WIRE_TYPES.VARINT,defaultValue:o.Long?o.Long.ZERO:void 0},bool:{name:"bool",wireType:o.WIRE_TYPES.VARINT,defaultValue:!1},double:{name:"double",wireType:o.WIRE_TYPES.BITS64,defaultValue:0},string:{name:"string",wireType:o.WIRE_TYPES.LDELIM,defaultValue:""},bytes:{name:"bytes",wireType:o.WIRE_TYPES.LDELIM,defaultValue:null},fixed32:{name:"fixed32",wireType:o.WIRE_TYPES.BITS32,defaultValue:0},sfixed32:{name:"sfixed32",wireType:o.WIRE_TYPES.BITS32,defaultValue:0},fixed64:{name:"fixed64",wireType:o.WIRE_TYPES.BITS64,defaultValue:o.Long?o.Long.UZERO:void 0},sfixed64:{name:"sfixed64",wireType:o.WIRE_TYPES.BITS64,defaultValue:o.Long?o.Long.ZERO:void 0},float:{name:"float",wireType:o.WIRE_TYPES.BITS32,defaultValue:0},enum:{name:"enum",wireType:o.WIRE_TYPES.VARINT,defaultValue:0},message:{name:"message",wireType:o.WIRE_TYPES.LDELIM,defaultValue:null},group:{name:"group",wireType:o.WIRE_TYPES.STARTGROUP,defaultValue:null}},o.MAP_KEY_TYPES=[o.TYPES.int32,o.TYPES.sint32,o.TYPES.sfixed32,o.TYPES.uint32,o.TYPES.fixed32,o.TYPES.int64,o.TYPES.sint64,o.TYPES.sfixed64,o.TYPES.uint64,o.TYPES.fixed64,o.TYPES.bool,o.TYPES.string,o.TYPES.bytes],o.ID_MIN=1,o.ID_MAX=536870911,o.convertFieldsToCamelCase=!1,o.populateAccessors=!0,o.populateDefaults=!0,o.Util=function(){var t={};return t.IS_NODE=!("object"!=typeof e||e+""!="[object process]"||e.browser),t.XHR=function(){var e,t=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],n=null;for(e=0;e<t.length;e++){try{n=t[e]()}catch(e){continue}break}if(!n)throw Error("XMLHttpRequest is not supported");return n},t.fetch=function(e,n){if(n&&"function"!=typeof n&&(n=null),t.IS_NODE)if(n)g.readFile(e,(function(e,t){n(e?null:""+t)}));else try{return g.readFileSync(e)}catch(t){return null}else{var r=t.XHR();if(r.open("GET",e,!!n),r.setRequestHeader("Accept","text/plain"),"function"==typeof r.overrideMimeType&&r.overrideMimeType("text/plain"),!n)return r.send(null),200==r.status||0==r.status&&"string"==typeof r.responseText?r.responseText:null;if(r.onreadystatechange=function(){4==r.readyState&&(200==r.status||0==r.status&&"string"==typeof r.responseText?n(r.responseText):n(null))},4==r.readyState)return;r.send(null)}},t.toCamelCase=function(e){return e.replace(/_([a-zA-Z])/g,(function(e,t){return t.toUpperCase()}))},t}(),o.Lang={DELIM:/[\s\{\}=;:\[\],'"\(\)<>]/g,RULE:/^(?:required|optional|repeated|map)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0[xX][0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,ID:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,STRING_DQ:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,STRING_SQ:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},o.DotProto=function(e,t){function n(e,n){var r=-1,i=1;if("-"==e.charAt(0)&&(i=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))r=parseInt(e);else if(t.NUMBER_HEX.test(e))r=parseInt(e.substring(2),16);else{if(!t.NUMBER_OCT.test(e))throw Error("illegal id value: "+(i<0?"-":"")+e);r=parseInt(e.substring(1),8)}if(r=0|i*r,!n&&r<0)throw Error("illegal id value: "+(i<0?"-":"")+e);return r}function r(e){var n=1;if("-"==e.charAt(0)&&(n=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))return n*parseInt(e,10);if(t.NUMBER_HEX.test(e))return n*parseInt(e.substring(2),16);if(t.NUMBER_OCT.test(e))return n*parseInt(e.substring(1),8);if("inf"===e)return 1/0*n;if("nan"===e)return NaN;if(t.NUMBER_FLT.test(e))return n*parseFloat(e);throw Error("illegal number value: "+(n<0?"-":"")+e)}function i(e,t,n){void 0===e[t]?e[t]=n:(Array.isArray(e[t])||(e[t]=[e[t]]),e[t].push(n))}var o,s,a={},c=function(e){this.source=e+"",this.index=0,this.line=1,this.stack=[],this._stringOpen=null},u=c.prototype;return u._readString=function(){var e,n='"'===this._stringOpen?t.STRING_DQ:t.STRING_SQ;if(n.lastIndex=this.index-1,!(e=n.exec(this.source)))throw Error("unterminated string");return this.index=n.lastIndex,this.stack.push(this._stringOpen),this._stringOpen=null,e[1]},u.next=function(){var e,n,r,i,o;if(this.stack.length>0)return this.stack.shift();if(this.index>=this.source.length)return null;if(null!==this._stringOpen)return this._readString();do{for(e=!1;t.WHITESPACE.test(r=this.source.charAt(this.index));)if("\n"===r&&++this.line,++this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if(++this.index,"/"===this.source.charAt(this.index)){for(;"\n"!==this.source.charAt(++this.index);)if(this.index==this.source.length)return null;++this.index,++this.line,e=!0}else{if("*"!==(r=this.source.charAt(this.index)))return"/";do{if("\n"===r&&++this.line,++this.index===this.source.length)return null;n=r,r=this.source.charAt(this.index)}while("*"!==n||"/"!==r);++this.index,e=!0}}while(e);if(this.index===this.source.length)return null;if(i=this.index,t.DELIM.lastIndex=0,!t.DELIM.test(this.source.charAt(i++)))for(;i<this.source.length&&!t.DELIM.test(this.source.charAt(i));)++i;return('"'===(o=this.source.substring(this.index,this.index=i))||"'"===o)&&(this._stringOpen=o),o},u.peek=function(){if(0===this.stack.length){var e=this.next();if(null===e)return null;this.stack.push(e)}return this.stack[0]},u.skip=function(e){var t=this.next();if(t!==e)throw Error("illegal '"+t+"', '"+e+"' expected")},u.omit=function(e){return this.peek()===e&&(this.next(),!0)},u.toString=function(){return"Tokenizer ("+this.index+"/"+this.source.length+" at line "+this.line+")"},a.Tokenizer=c,(s=(o=function(e){this.tn=new c(e),this.proto3=!1}).prototype).parse=function(){var e,n={name:"[ROOT]",package:null,messages:[],enums:[],imports:[],options:{},services:[]},r=!0;try{for(;e=this.tn.next();)switch(e){case"package":if(!r||null!==n.package)throw Error("unexpected 'package'");if(e=this.tn.next(),!t.TYPEREF.test(e))throw Error("illegal package name: "+e);this.tn.skip(";"),n.package=e;break;case"import":if(!r)throw Error("unexpected 'import'");"public"===(e=this.tn.peek())&&this.tn.next(),e=this._readString(),this.tn.skip(";"),n.imports.push(e);break;case"syntax":if(!r)throw Error("unexpected 'syntax'");this.tn.skip("="),"proto3"===(n.syntax=this._readString())&&(this.proto3=!0),this.tn.skip(";");break;case"message":this._parseMessage(n,null),r=!1;break;case"enum":this._parseEnum(n),r=!1;break;case"option":this._parseOption(n);break;case"service":this._parseService(n);break;case"extend":this._parseExtend(n);break;default:throw Error("unexpected '"+e+"'")}}catch(e){throw e.message="Parse error at line "+this.tn.line+": "+e.message,e}return delete n.name,n},o.parse=function(e){return new o(e).parse()},s._readString=function(){var e,t,n="";do{if("'"!==(t=this.tn.next())&&'"'!==t)throw Error("illegal string delimiter: "+t);n+=this.tn.next(),this.tn.skip(t),e=this.tn.peek()}while('"'===e||'"'===e);return n},s._readValue=function(e){var n=this.tn.peek();if('"'===n||"'"===n)return this._readString();if(this.tn.next(),t.NUMBER.test(n))return r(n);if(t.BOOL.test(n))return"true"===n.toLowerCase();if(e&&t.TYPEREF.test(n))return n;throw Error("illegal value: "+n)},s._parseOption=function(e,n){var r,i=this.tn.next(),o=!1;if("("===i&&(o=!0,i=this.tn.next()),!t.TYPEREF.test(i))throw Error("illegal option name: "+i);r=i,o&&(this.tn.skip(")"),r="("+r+")",i=this.tn.peek(),t.FQTYPEREF.test(i)&&(r+=i,this.tn.next())),this.tn.skip("="),this._parseOptionValue(e,r),n||this.tn.skip(";")},s._parseOptionValue=function(e,n){var r=this.tn.peek();if("{"!==r)i(e.options,n,this._readValue(!0));else for(this.tn.skip("{");"}"!==(r=this.tn.next());){if(!t.NAME.test(r))throw Error("illegal option name: "+n+"."+r);this.tn.omit(":")?i(e.options,n+"."+r,this._readValue(!0)):this._parseOptionValue(e,n+"."+r)}},s._parseService=function(e){var n,r=this.tn.next();if(!t.NAME.test(r))throw Error("illegal service name at line "+this.tn.line+": "+r);for(n={name:r,rpc:{},options:{}},this.tn.skip("{");"}"!==(r=this.tn.next());)if("option"===r)this._parseOption(n);else{if("rpc"!==r)throw Error("illegal service token: "+r);this._parseServiceRPC(n)}this.tn.omit(";"),e.services.push(n)},s._parseServiceRPC=function(e){var n,r,i="rpc",o=this.tn.next();if(!t.NAME.test(o))throw Error("illegal rpc service method name: "+o);if(n=o,r={request:null,response:null,request_stream:!1,response_stream:!1,options:{}},this.tn.skip("("),"stream"===(o=this.tn.next()).toLowerCase()&&(r.request_stream=!0,o=this.tn.next()),!t.TYPEREF.test(o))throw Error("illegal rpc service request type: "+o);if(r.request=o,this.tn.skip(")"),"returns"!==(o=this.tn.next()).toLowerCase())throw Error("illegal rpc service request type delimiter: "+o);if(this.tn.skip("("),"stream"===(o=this.tn.next()).toLowerCase()&&(r.response_stream=!0,o=this.tn.next()),r.response=o,this.tn.skip(")"),"{"===(o=this.tn.peek())){for(this.tn.next();"}"!==(o=this.tn.next());){if("option"!==o)throw Error("illegal rpc service token: "+o);this._parseOption(r)}this.tn.omit(";")}else this.tn.skip(";");void 0===e[i]&&(e[i]={}),e[i][n]=r},s._parseMessage=function(e,r){var i=!!r,o=this.tn.next(),s={name:"",fields:[],enums:[],messages:[],options:{},services:[],oneofs:{}};if(!t.NAME.test(o))throw Error("illegal "+(i?"group":"message")+" name: "+o);for(s.name=o,i&&(this.tn.skip("="),r.id=n(this.tn.next()),s.isGroup=!0),"["===(o=this.tn.peek())&&r&&this._parseFieldOptions(r),this.tn.skip("{");"}"!==(o=this.tn.next());)if(t.RULE.test(o))this._parseMessageField(s,o);else if("oneof"===o)this._parseMessageOneOf(s);else if("enum"===o)this._parseEnum(s);else if("message"===o)this._parseMessage(s);else if("option"===o)this._parseOption(s);else if("service"===o)this._parseService(s);else if("extensions"===o)s.extensions=this._parseExtensionRanges();else if("reserved"===o)this._parseIgnored();else if("extend"===o)this._parseExtend(s);else{if(!t.TYPEREF.test(o))throw Error("illegal message token: "+o);if(!this.proto3)throw Error("illegal field rule: "+o);this._parseMessageField(s,"optional",o)}return this.tn.omit(";"),e.messages.push(s),s},s._parseIgnored=function(){for(;";"!==this.tn.peek();)this.tn.next();this.tn.skip(";")},s._parseMessageField=function(e,r,i){var o,s,a;if(!t.RULE.test(r))throw Error("illegal message field rule: "+r);if(o={rule:r,type:"",name:"",options:{},id:0},"map"===r){if(i)throw Error("illegal type: "+i);if(this.tn.skip("<"),s=this.tn.next(),!t.TYPE.test(s)&&!t.TYPEREF.test(s))throw Error("illegal message field type: "+s);if(o.keytype=s,this.tn.skip(","),s=this.tn.next(),!t.TYPE.test(s)&&!t.TYPEREF.test(s))throw Error("illegal message field: "+s);if(o.type=s,this.tn.skip(">"),s=this.tn.next(),!t.NAME.test(s))throw Error("illegal message field name: "+s);o.name=s,this.tn.skip("="),o.id=n(this.tn.next()),"["===(s=this.tn.peek())&&this._parseFieldOptions(o),this.tn.skip(";")}else if("group"===(i=void 0!==i?i:this.tn.next())){if(a=this._parseMessage(e,o),!/^[A-Z]/.test(a.name))throw Error("illegal group name: "+a.name);o.type=a.name,o.name=a.name.toLowerCase(),this.tn.omit(";")}else{if(!t.TYPE.test(i)&&!t.TYPEREF.test(i))throw Error("illegal message field type: "+i);if(o.type=i,s=this.tn.next(),!t.NAME.test(s))throw Error("illegal message field name: "+s);o.name=s,this.tn.skip("="),o.id=n(this.tn.next()),"["===(s=this.tn.peek())&&this._parseFieldOptions(o),this.tn.skip(";")}return e.fields.push(o),o},s._parseMessageOneOf=function(e){var n,r,i,o=this.tn.next();if(!t.NAME.test(o))throw Error("illegal oneof name: "+o);for(r=o,i=[],this.tn.skip("{");"}"!==(o=this.tn.next());)(n=this._parseMessageField(e,"optional",o)).oneof=r,i.push(n.id);this.tn.omit(";"),e.oneofs[r]=i},s._parseFieldOptions=function(e){this.tn.skip("[");for(var t=!0;"]"!==this.tn.peek();)t||this.tn.skip(","),this._parseOption(e,!0),t=!1;this.tn.next()},s._parseEnum=function(e){var r,i={name:"",values:[],options:{}},o=this.tn.next();if(!t.NAME.test(o))throw Error("illegal name: "+o);for(i.name=o,this.tn.skip("{");"}"!==(o=this.tn.next());)if("option"===o)this._parseOption(i);else{if(!t.NAME.test(o))throw Error("illegal name: "+o);this.tn.skip("="),r={name:o,id:n(this.tn.next(),!0)},"["===(o=this.tn.peek())&&this._parseFieldOptions({options:{}}),this.tn.skip(";"),i.values.push(r)}this.tn.omit(";"),e.enums.push(i)},s._parseExtensionRanges=function(){var t,n,i,o=[];do{for(n=[];;){switch(t=this.tn.next()){case"min":i=e.ID_MIN;break;case"max":i=e.ID_MAX;break;default:i=r(t)}if(n.push(i),2===n.length)break;if("to"!==this.tn.peek()){n.push(i);break}this.tn.next()}o.push(n)}while(this.tn.omit(","));return this.tn.skip(";"),o},s._parseExtend=function(e){var n,r=this.tn.next();if(!t.TYPEREF.test(r))throw Error("illegal extend reference: "+r);for(n={ref:r,fields:[]},this.tn.skip("{");"}"!==(r=this.tn.next());)if(t.RULE.test(r))this._parseMessageField(n,r);else{if(!t.TYPEREF.test(r))throw Error("illegal extend token: "+r);if(!this.proto3)throw Error("illegal field rule: "+r);this._parseMessageField(n,"optional",r)}return this.tn.omit(";"),e.messages.push(n),n},s.toString=function(){return"Parser at line "+this.tn.line},a.Parser=o,a}(o,o.Lang),o.Reflect=function(e){function n(t,n){if(t&&"number"==typeof t.low&&"number"==typeof t.high&&"boolean"==typeof t.unsigned&&t.low==t.low&&t.high==t.high)return new e.Long(t.low,t.high,void 0===n?t.unsigned:n);if("string"==typeof t)return e.Long.fromString(t,n||!1,10);if("number"==typeof t)return e.Long.fromNumber(t,n||!1);throw Error("not convertible to Long")}function i(t,n){var r=n.readVarint32(),o=7&r,s=r>>>3;switch(o){case e.WIRE_TYPES.VARINT:do{r=n.readUint8()}while(128==(128&r));break;case e.WIRE_TYPES.BITS64:n.offset+=8;break;case e.WIRE_TYPES.LDELIM:r=n.readVarint32(),n.offset+=r;break;case e.WIRE_TYPES.STARTGROUP:i(s,n);break;case e.WIRE_TYPES.ENDGROUP:if(s===t)return!1;throw Error("Illegal GROUPEND after unknown group: "+s+" ("+t+" expected)");case e.WIRE_TYPES.BITS32:n.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+t+": "+o)}return!0}var o,s,a,c,u,d,l,h,f,p,g,m,v,_,y,E,T={},C=function(e,t,n){this.builder=e,this.parent=t,this.name=n,this.className},R=C.prototype;return R.fqn=function(){for(var e=this.name,t=this;null!=(t=t.parent);)e=t.name+"."+e;return e},R.toString=function(e){return(e?this.className+" ":"")+this.fqn()},R.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},T.T=C,(s=(o=function(e,t,n,r,i){C.call(this,e,t,n),this.className="Namespace",this.children=[],this.options=r||{},this.syntax=i||"proto2"}).prototype=Object.create(C.prototype)).getChildren=function(e){var t,n,r;if(null==(e=e||null))return this.children.slice();for(t=[],n=0,r=this.children.length;r>n;++n)this.children[n]instanceof e&&t.push(this.children[n]);return t},s.addChild=function(e){var t;if(t=this.getChild(e.name))if(t instanceof u.Field&&t.name!==t.originalName&&null===this.getChild(t.originalName))t.name=t.originalName;else{if(!(e instanceof u.Field&&e.name!==e.originalName&&null===this.getChild(e.originalName)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+e.name);e.name=e.originalName}this.children.push(e)},s.getChild=function(e){var t,n,r="number"==typeof e?"id":"name";for(t=0,n=this.children.length;n>t;++t)if(this.children[t][r]===e)return this.children[t];return null},s.resolve=function(e,t){var n,r="string"==typeof e?e.split("."):e,i=this,o=0;if(""===r[o]){for(;null!==i.parent;)i=i.parent;o++}do{do{if(!(i instanceof T.Namespace)){i=null;break}if(!((n=i.getChild(r[o]))&&n instanceof T.T&&(!t||n instanceof T.Namespace))){i=null;break}i=n,o++}while(o<r.length);if(null!=i)break;if(null!==this.parent)return this.parent.resolve(e,t)}while(null!=i);return i},s.qn=function(e){var t,n,r=[],i=e;do{r.unshift(i.name),i=i.parent}while(null!==i);for(t=1;t<=r.length;t++)if(n=r.slice(r.length-t),e===this.resolve(n,e instanceof T.Namespace))return n.join(".");return e.fqn()},s.build=function(){var e,t,n,r={},i=this.children;for(t=0,n=i.length;n>t;++t)(e=i[t])instanceof o&&(r[e.name]=e.build());return Object.defineProperty&&Object.defineProperty(r,"$options",{value:this.buildOpt()}),r},s.buildOpt=function(){var e,t,n,r,i={},o=Object.keys(this.options);for(e=0,t=o.length;t>e;++e)n=o[e],r=this.options[o[e]],i[n]=r;return i},s.getOption=function(e){return void 0===e?this.options:void 0!==this.options[e]?this.options[e]:null},T.Namespace=o,c=(a=function(t,n,r,i){if(this.type=t,this.resolvedType=n,this.isMapKey=r,this.syntax=i,r&&e.MAP_KEY_TYPES.indexOf(t)<0)throw Error("Invalid map key type: "+t.name)}).prototype,a.defaultFieldValue=function(t){if("string"==typeof t&&(t=e.TYPES[t]),void 0===t.defaultValue)throw Error("default value for type "+t.name+" is not supported");return t==e.TYPES.bytes?new r(0):t.defaultValue},c.verifyValue=function(r){var i,o,s,a=function(e,t){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+e+" ("+t+")")}.bind(this);switch(this.type){case e.TYPES.int32:case e.TYPES.sint32:case e.TYPES.sfixed32:return("number"!=typeof r||r==r&&r%1!=0)&&a(typeof r,"not an integer"),r>4294967295?0|r:r;case e.TYPES.uint32:case e.TYPES.fixed32:return("number"!=typeof r||r==r&&r%1!=0)&&a(typeof r,"not an integer"),r<0?r>>>0:r;case e.TYPES.int64:case e.TYPES.sint64:case e.TYPES.sfixed64:if(e.Long)try{return n(r,!1)}catch(t){a(typeof r,t.message)}else a(typeof r,"requires Long.js");case e.TYPES.uint64:case e.TYPES.fixed64:if(e.Long)try{return n(r,!0)}catch(t){a(typeof r,t.message)}else a(typeof r,"requires Long.js");case e.TYPES.bool:return"boolean"!=typeof r&&a(typeof r,"not a boolean"),r;case e.TYPES.float:case e.TYPES.double:return"number"!=typeof r&&a(typeof r,"not a number"),r;case e.TYPES.string:return"string"==typeof r||r&&r instanceof String||a(typeof r,"not a string"),""+r;case e.TYPES.bytes:return t.isByteBuffer(r)?r:t.wrap(r);case e.TYPES.enum:for(i=this.resolvedType.getChildren(e.Reflect.Enum.Value),s=0;s<i.length;s++){if(i[s].name==r)return i[s].id;if(i[s].id==r)return i[s].id}if("proto3"===this.syntax)return("number"!=typeof r||r==r&&r%1!=0)&&a(typeof r,"not an integer"),(r>4294967295||r<0)&&a(typeof r,"not in range for uint32"),r;a(r,"not a valid enum value");case e.TYPES.group:case e.TYPES.message:if(r&&"object"==typeof r||a(typeof r,"object expected"),r instanceof this.resolvedType.clazz)return r;if(r instanceof e.Builder.Message){for(s in o={},r)r.hasOwnProperty(s)&&(o[s]=r[s]);r=o}return new this.resolvedType.clazz(r)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+r+" (undefined type "+this.type+")")},c.calculateLength=function(t,n){if(null===n)return 0;var i;switch(this.type){case e.TYPES.int32:return n<0?r.calculateVarint64(n):r.calculateVarint32(n);case e.TYPES.uint32:return r.calculateVarint32(n);case e.TYPES.sint32:return r.calculateVarint32(r.zigZagEncode32(n));case e.TYPES.fixed32:case e.TYPES.sfixed32:case e.TYPES.float:return 4;case e.TYPES.int64:case e.TYPES.uint64:return r.calculateVarint64(n);case e.TYPES.sint64:return r.calculateVarint64(r.zigZagEncode64(n));case e.TYPES.fixed64:case e.TYPES.sfixed64:return 8;case e.TYPES.bool:return 1;case e.TYPES.enum:return r.calculateVarint32(n);case e.TYPES.double:return 8;case e.TYPES.string:return i=r.calculateUTF8Bytes(n),r.calculateVarint32(i)+i;case e.TYPES.bytes:if(n.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+n.remaining()+" bytes remaining");return r.calculateVarint32(n.remaining())+n.remaining();case e.TYPES.message:return i=this.resolvedType.calculate(n),r.calculateVarint32(i)+i;case e.TYPES.group:return(i=this.resolvedType.calculate(n))+r.calculateVarint32(t<<3|e.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+n+" (unknown type)")},c.encodeValue=function(t,n,i){var o,s;if(null===n)return i;switch(this.type){case e.TYPES.int32:n<0?i.writeVarint64(n):i.writeVarint32(n);break;case e.TYPES.uint32:i.writeVarint32(n);break;case e.TYPES.sint32:i.writeVarint32ZigZag(n);break;case e.TYPES.fixed32:i.writeUint32(n);break;case e.TYPES.sfixed32:i.writeInt32(n);break;case e.TYPES.int64:case e.TYPES.uint64:i.writeVarint64(n);break;case e.TYPES.sint64:i.writeVarint64ZigZag(n);break;case e.TYPES.fixed64:i.writeUint64(n);break;case e.TYPES.sfixed64:i.writeInt64(n);break;case e.TYPES.bool:"string"==typeof n?i.writeVarint32("false"===n.toLowerCase()?0:!!n):i.writeVarint32(n?1:0);break;case e.TYPES.enum:i.writeVarint32(n);break;case e.TYPES.float:i.writeFloat32(n);break;case e.TYPES.double:i.writeFloat64(n);break;case e.TYPES.string:i.writeVString(n);break;case e.TYPES.bytes:if(n.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+n.remaining()+" bytes remaining");o=n.offset,i.writeVarint32(n.remaining()),i.append(n),n.offset=o;break;case e.TYPES.message:s=(new r).LE(),this.resolvedType.encode(n,s),i.writeVarint32(s.offset),i.append(s.flip());break;case e.TYPES.group:this.resolvedType.encode(n,i),i.writeVarint32(t<<3|e.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+n+" (unknown type)")}return i},c.decode=function(t,n,r){if(n!=this.type.wireType)throw Error("Unexpected wire type for element");var i,o;switch(this.type){case e.TYPES.int32:return 0|t.readVarint32();case e.TYPES.uint32:return t.readVarint32()>>>0;case e.TYPES.sint32:return 0|t.readVarint32ZigZag();case e.TYPES.fixed32:return t.readUint32()>>>0;case e.TYPES.sfixed32:return 0|t.readInt32();case e.TYPES.int64:return t.readVarint64();case e.TYPES.uint64:return t.readVarint64().toUnsigned();case e.TYPES.sint64:return t.readVarint64ZigZag();case e.TYPES.fixed64:return t.readUint64();case e.TYPES.sfixed64:return t.readInt64();case e.TYPES.bool:return!!t.readVarint32();case e.TYPES.enum:return t.readVarint32();case e.TYPES.float:return t.readFloat();case e.TYPES.double:return t.readDouble();case e.TYPES.string:return t.readVString();case e.TYPES.bytes:if(o=t.readVarint32(),t.remaining()<o)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+o+" required but got only "+t.remaining());return(i=t.clone()).limit=i.offset+o,t.offset+=o,i;case e.TYPES.message:return o=t.readVarint32(),this.resolvedType.decode(t,o);case e.TYPES.group:return this.resolvedType.decode(t,-1,r)}throw Error("[INTERNAL] Illegal decode type")},c.valueFromString=function(t){if(!this.isMapKey)throw Error("valueFromString() called on non-map-key element");switch(this.type){case e.TYPES.int32:case e.TYPES.sint32:case e.TYPES.sfixed32:case e.TYPES.uint32:case e.TYPES.fixed32:return this.verifyValue(parseInt(t));case e.TYPES.int64:case e.TYPES.sint64:case e.TYPES.sfixed64:case e.TYPES.uint64:case e.TYPES.fixed64:return this.verifyValue(t);case e.TYPES.bool:return"true"===t;case e.TYPES.string:return this.verifyValue(t);case e.TYPES.bytes:return r.fromBinary(t)}},c.valueToString=function(t){if(!this.isMapKey)throw Error("valueToString() called on non-map-key element");return this.type===e.TYPES.bytes?t.toString("binary"):t.toString()},T.Element=a,(d=(u=function(e,t,n,r,i,s){o.call(this,e,t,n,r,s),this.className="Message",this.extensions=void 0,this.clazz=null,this.isGroup=!!i,this._fields=null,this._fieldsById=null,this._fieldsByName=null}).prototype=Object.create(o.prototype)).build=function(n){var i,o,s,a;if(this.clazz&&!n)return this.clazz;for(i=function(e,n){function i(t,n,o,s){var a,c,u,d,l,h,f;if(null===t||"object"!=typeof t)return s&&s instanceof e.Reflect.Enum&&null!==(a=e.Reflect.Enum.getName(s.object,t))?a:t;if(r.isByteBuffer(t))return n?t.toBase64():t.toBuffer();if(e.Long.isLong(t))return o?t.toString():e.Long.fromValue(t);if(Array.isArray(t))return c=[],t.forEach((function(e,t){c[t]=i(e,n,o,s)})),c;if(c={},t instanceof e.Map){for(d=(u=t.entries()).next();!d.done;d=u.next())c[t.keyElem.valueToString(d.value[0])]=i(d.value[1],n,o,t.valueElem.resolvedType);return c}for(f in l=t.$type,h=void 0,t)t.hasOwnProperty(f)&&(c[f]=l&&(h=l.getChild(f))?i(t[f],n,o,h.resolvedType):i(t[f],n,o));return c}var o,s,a=n.getChildren(e.Reflect.Message.Field),c=n.getChildren(e.Reflect.Message.OneOf),u=function(t){var i,o,s,d;for(e.Builder.Message.call(this),i=0,o=c.length;o>i;++i)this[c[i].name]=null;for(i=0,o=a.length;o>i;++i)this[(s=a[i]).name]=s.repeated?[]:s.map?new e.Map(s):null,!s.required&&"proto3"!==n.syntax||null===s.defaultValue||(this[s.name]=s.defaultValue);if(arguments.length>0)if(1!==arguments.length||null===t||"object"!=typeof t||!("function"!=typeof t.encode||t instanceof u)||Array.isArray(t)||t instanceof e.Map||r.isByteBuffer(t)||t instanceof ArrayBuffer||e.Long&&t instanceof e.Long)for(i=0,o=arguments.length;o>i;++i)void 0!==(d=arguments[i])&&this.$set(a[i].name,d);else this.$set(t)},d=u.prototype=Object.create(e.Builder.Message.prototype);for(d.add=function(t,r,i){var o=n._fieldsByName[t];if(!i){if(!o)throw Error(this+"#"+t+" is undefined");if(!(o instanceof e.Reflect.Message.Field))throw Error(this+"#"+t+" is not a field: "+o.toString(!0));if(!o.repeated)throw Error(this+"#"+t+" is not a repeated field");r=o.verifyValue(r,!0)}return null===this[t]&&(this[t]=[]),this[t].push(r),this},d.$add=d.add,d.set=function(t,r,i){var o,s,a;if(t&&"object"==typeof t){for(o in i=r,t)t.hasOwnProperty(o)&&void 0!==(r=t[o])&&this.$set(o,r,i);return this}if(s=n._fieldsByName[t],i)this[t]=r;else{if(!s)throw Error(this+"#"+t+" is not a field: undefined");if(!(s instanceof e.Reflect.Message.Field))throw Error(this+"#"+t+" is not a field: "+s.toString(!0));this[s.name]=r=s.verifyValue(r)}return s&&s.oneof&&(a=this[s.oneof.name],null!==r?(null!==a&&a!==s.name&&(this[a]=null),this[s.oneof.name]=s.name):a===t&&(this[s.oneof.name]=null)),this},d.$set=d.set,d.get=function(t,r){if(r)return this[t];var i=n._fieldsByName[t];if(!(i&&i instanceof e.Reflect.Message.Field))throw Error(this+"#"+t+" is not a field: undefined");if(!(i instanceof e.Reflect.Message.Field))throw Error(this+"#"+t+" is not a field: "+i.toString(!0));return this[i.name]},d.$get=d.get,o=0;o<a.length;o++)(s=a[o])instanceof e.Reflect.Message.ExtensionField||n.builder.options.populateAccessors&&function(e){var t,r,i,o=e.originalName.replace(/(_[a-zA-Z])/g,(function(e){return e.toUpperCase().replace("_","")}));o=o.substring(0,1).toUpperCase()+o.substring(1),t=e.originalName.replace(/([A-Z])/g,(function(e){return"_"+e})),r=function(t,n){return this[e.name]=n?t:e.verifyValue(t),this},i=function(){return this[e.name]},null===n.getChild("set"+o)&&(d["set"+o]=r),null===n.getChild("set_"+t)&&(d["set_"+t]=r),null===n.getChild("get"+o)&&(d["get"+o]=i),null===n.getChild("get_"+t)&&(d["get_"+t]=i)}(s);return d.encode=function(e,r){var i,o;"boolean"==typeof e&&(r=e,e=void 0),i=!1,e||(e=new t,i=!0),o=e.littleEndian;try{return n.encode(this,e.LE(),r),(i?e.flip():e).LE(o)}catch(t){throw e.LE(o),t}},u.encode=function(e,t,n){return new u(e).encode(t,n)},d.calculate=function(){return n.calculate(this)},d.encodeDelimited=function(e){var t,i=!1;return e||(e=new r,i=!0),t=(new r).LE(),n.encode(this,t).flip(),e.writeVarint32(t.remaining()),e.append(t),i?e.flip():e},d.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(t){throw t.encoded&&(t.encoded=t.encoded.toArrayBuffer()),t}},d.toArrayBuffer=d.encodeAB,d.encodeNB=function(){try{return this.encode().toBuffer()}catch(t){throw t.encoded&&(t.encoded=t.encoded.toBuffer()),t}},d.toBuffer=d.encodeNB,d.encode64=function(){try{return this.encode().toBase64()}catch(t){throw t.encoded&&(t.encoded=t.encoded.toBase64()),t}},d.toBase64=d.encode64,d.encodeHex=function(){try{return this.encode().toHex()}catch(t){throw t.encoded&&(t.encoded=t.encoded.toHex()),t}},d.toHex=d.encodeHex,d.toRaw=function(e,t){return i(this,!!e,!!t,this.$type)},d.encodeJSON=function(){return JSON.stringify(i(this,!0,!0,this.$type))},u.decode=function(e,t){var i,o;"string"==typeof e&&(e=r.wrap(e,t||"base64")),i=(e=r.isByteBuffer(e)?e:r.wrap(e)).littleEndian;try{return o=n.decode(e.LE()),e.LE(i),o}catch(t){throw e.LE(i),t}},u.decodeDelimited=function(e,t){var i,o,s;if("string"==typeof e&&(e=r.wrap(e,t||"base64")),(e=r.isByteBuffer(e)?e:r.wrap(e)).remaining()<1)return null;if(i=e.offset,o=e.readVarint32(),e.remaining()<o)return e.offset=i,null;try{return s=n.decode(e.slice(e.offset,e.offset+o).LE()),e.offset+=o,s}catch(t){throw e.offset+=o,t}},u.decode64=function(e){return u.decode(e,"base64")},u.decodeHex=function(e){return u.decode(e,"hex")},u.decodeJSON=function(e){return new u(JSON.parse(e))},d.toString=function(){return n.toString()},Object.defineProperty&&(Object.defineProperty(u,"$options",{value:n.buildOpt()}),Object.defineProperty(d,"$options",{value:u.$options}),Object.defineProperty(u,"$type",{value:n}),Object.defineProperty(d,"$type",{value:n})),u}(e,this),this._fields=[],this._fieldsById={},this._fieldsByName={},s=0,a=this.children.length;a>s;s++)if((o=this.children[s])instanceof g||o instanceof u||o instanceof _){if(i.hasOwnProperty(o.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+o.toString(!0)+" cannot override static property '"+o.name+"'");i[o.name]=o.build()}else if(o instanceof u.Field)o.build(),this._fields.push(o),this._fieldsById[o.id]=o,this._fieldsByName[o.name]=o;else if(!(o instanceof u.OneOf||o instanceof v))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[s].toString(!0));return this.clazz=i},d.encode=function(e,t,n){var r,i,o,s,a,c=null;for(o=0,s=this._fields.length;s>o;++o)i=e[(r=this._fields[o]).name],r.required&&null===i?null===c&&(c=r):r.encode(n?i:r.verifyValue(i),t,e);if(null!==c)throw(a=Error("Missing at least one required field for "+this.toString(!0)+": "+c)).encoded=t,a;return t},d.calculate=function(e){for(var t,n,r=0,i=0,o=this._fields.length;o>i;++i){if(n=e[(t=this._fields[i]).name],t.required&&null===n)throw Error("Missing at least one required field for "+this.toString(!0)+": "+t);r+=t.calculate(n,e)}return r},d.decode=function(t,n,r){var o,s,a,c,u,d,l,h,f,p,g,m;for(n="number"==typeof n?n:-1,u=t.offset,d=new this.clazz;t.offset<u+n||-1===n&&t.remaining()>0;){if(a=(o=t.readVarint32())>>>3,(s=7&o)===e.WIRE_TYPES.ENDGROUP){if(a!==r)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+a+" ("+(r?r+" expected":"not a group")+")");break}if(c=this._fieldsById[a])c.repeated&&!c.options.packed?d[c.name].push(c.decode(s,t)):c.map?(h=c.decode(s,t),d[c.name].set(h[0],h[1])):(d[c.name]=c.decode(s,t),c.oneof&&(null!==(f=d[c.oneof.name])&&f!==c.name&&(d[f]=null),d[c.oneof.name]=c.name));else switch(s){case e.WIRE_TYPES.VARINT:t.readVarint32();break;case e.WIRE_TYPES.BITS32:t.offset+=4;break;case e.WIRE_TYPES.BITS64:t.offset+=8;break;case e.WIRE_TYPES.LDELIM:l=t.readVarint32(),t.offset+=l;break;case e.WIRE_TYPES.STARTGROUP:for(;i(a,t););break;default:throw Error("Illegal wire type for unknown field "+a+" in "+this.toString(!0)+"#decode: "+s)}}for(p=0,g=this._fields.length;g>p;++p)if(null===d[(c=this._fields[p]).name])if("proto3"===this.syntax)d[c.name]=c.defaultValue;else{if(c.required)throw(m=Error("Missing at least one required field for "+this.toString(!0)+": "+c.name)).decoded=d,m;e.populateDefaults&&null!==c.defaultValue&&(d[c.name]=c.defaultValue)}return d},T.Message=u,(h=(l=function(t,n,r,i,o,s,a,c,d,l){C.call(this,t,n,s),this.className="Message.Field",this.required="required"===r,this.repeated="repeated"===r,this.map="map"===r,this.keyType=i||null,this.type=o,this.resolvedType=null,this.id=a,this.options=c||{},this.defaultValue=null,this.oneof=d||null,this.syntax=l||"proto2",this.originalName=this.name,this.element=null,this.keyElement=null,!this.builder.options.convertFieldsToCamelCase||this instanceof u.ExtensionField||(this.name=e.Util.toCamelCase(this.name))}).prototype=Object.create(C.prototype)).build=function(){this.element=new a(this.type,this.resolvedType,!1,this.syntax),this.map&&(this.keyElement=new a(this.keyType,void 0,!0,this.syntax)),"proto3"!==this.syntax||this.repeated||this.map?void 0!==this.options.default&&(this.defaultValue=this.verifyValue(this.options.default)):this.defaultValue=a.defaultFieldValue(this.type)},h.verifyValue=function(t,n){var r,i,o;if(n=n||!1,r=function(e,t){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+e+" ("+t+")")}.bind(this),null===t)return this.required&&r(typeof t,"required"),"proto3"===this.syntax&&this.type!==e.TYPES.message&&r(typeof t,"proto3 field without field presence cannot be null"),null;if(this.repeated&&!n){for(Array.isArray(t)||(t=[t]),o=[],i=0;i<t.length;i++)o.push(this.element.verifyValue(t[i]));return o}return this.map&&!n?t instanceof e.Map?t:(t instanceof Object||r(typeof t,"expected ProtoBuf.Map or raw object for map field"),new e.Map(this,t)):(!this.repeated&&Array.isArray(t)&&r(typeof t,"no array expected"),this.element.verifyValue(t))},h.hasWirePresence=function(t,n){if("proto3"!==this.syntax)return null!==t;if(this.oneof&&n[this.oneof.name]===this.name)return!0;switch(this.type){case e.TYPES.int32:case e.TYPES.sint32:case e.TYPES.sfixed32:case e.TYPES.uint32:case e.TYPES.fixed32:return 0!==t;case e.TYPES.int64:case e.TYPES.sint64:case e.TYPES.sfixed64:case e.TYPES.uint64:case e.TYPES.fixed64:return 0!==t.low||0!==t.high;case e.TYPES.bool:return t;case e.TYPES.float:case e.TYPES.double:return 0!==t;case e.TYPES.string:return t.length>0;case e.TYPES.bytes:return t.remaining()>0;case e.TYPES.enum:return 0!==t;case e.TYPES.message:return null!==t;default:return!0}},h.encode=function(t,n,i){var o,s,a,c,u;if(null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===t||this.repeated&&0==t.length)return n;try{if(this.repeated)if(this.options.packed&&e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(n.writeVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),n.ensureCapacity(n.offset+=1),s=n.offset,o=0;o<t.length;o++)this.element.encodeValue(this.id,t[o],n);a=n.offset-s,(c=r.calculateVarint32(a))>1&&(u=n.slice(s,n.offset),s+=c-1,n.offset=s,n.append(u)),n.writeVarint32(a,s-c)}else for(o=0;o<t.length;o++)n.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,t[o],n);else this.map?t.forEach((function(t,i){var o=r.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,i)+r.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,t);n.writeVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),n.writeVarint32(o),n.writeVarint32(8|this.keyType.wireType),this.keyElement.encodeValue(1,i,n),n.writeVarint32(16|this.type.wireType),this.element.encodeValue(2,t,n)}),this):this.hasWirePresence(t,i)&&(n.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,t,n))}catch(e){throw Error("Illegal value for "+this.toString(!0)+": "+t+" ("+e+")")}return n},h.calculate=function(t,n){var i,o,s;if(t=this.verifyValue(t),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===t||this.repeated&&0==t.length)return 0;i=0;try{if(this.repeated)if(this.options.packed&&e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(i+=r.calculateVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),s=0,o=0;o<t.length;o++)s+=this.element.calculateLength(this.id,t[o]);i+=r.calculateVarint32(s),i+=s}else for(o=0;o<t.length;o++)i+=r.calculateVarint32(this.id<<3|this.type.wireType),i+=this.element.calculateLength(this.id,t[o]);else this.map?t.forEach((function(t,n){var o=r.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,n)+r.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,t);i+=r.calculateVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),i+=r.calculateVarint32(o),i+=o}),this):this.hasWirePresence(t,n)&&(i+=r.calculateVarint32(this.id<<3|this.type.wireType),i+=this.element.calculateLength(this.id,t))}catch(e){throw Error("Illegal value for "+this.toString(!0)+": "+t+" ("+e+")")}return i},h.decode=function(t,n,r){var i,o,s,c,u,d,l;if(!(!this.map&&t==this.type.wireType||!r&&this.repeated&&this.options.packed&&t==e.WIRE_TYPES.LDELIM||this.map&&t==e.WIRE_TYPES.LDELIM))throw Error("Illegal wire type for field "+this.toString(!0)+": "+t+" ("+this.type.wireType+" expected)");if(t==e.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0&&!r){for(o=n.readVarint32(),o=n.offset+o,s=[];n.offset<o;)s.push(this.decode(this.type.wireType,n,!0));return s}if(this.map){if(c=a.defaultFieldValue(this.keyType),i=a.defaultFieldValue(this.type),o=n.readVarint32(),n.remaining()<o)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+o+" required but got only "+n.remaining());for((u=n.clone()).limit=u.offset+o,n.offset+=o;u.remaining()>0;)if(t=7&(d=u.readVarint32()),1==(l=d>>>3))c=this.keyElement.decode(u,t,l);else{if(2!==l)throw Error("Unexpected tag in map field key/value submessage");i=this.element.decode(u,t,l)}return[c,i]}return this.element.decode(n,t,this.id)},T.Message.Field=l,(f=function(e,t,n,r,i,o,s){l.call(this,e,t,n,null,r,i,o,s),this.extension}).prototype=Object.create(l.prototype),T.Message.ExtensionField=f,p=function(e,t,n){C.call(this,e,t,n),this.fields=[]},T.Message.OneOf=p,(g=function(e,t,n,r,i){o.call(this,e,t,n,r,i),this.className="Enum",this.object=null}).getName=function(e,t){var n,r,i=Object.keys(e);for(r=0;r<i.length;++r)if(e[n=i[r]]===t)return n;return null},(g.prototype=Object.create(o.prototype)).build=function(t){var n,r,i,o;if(this.object&&!t)return this.object;for(n=new e.Builder.Enum,i=0,o=(r=this.getChildren(g.Value)).length;o>i;++i)n[r[i].name]=r[i].id;return Object.defineProperty&&Object.defineProperty(n,"$options",{value:this.buildOpt(),enumerable:!1}),this.object=n},T.Enum=g,(m=function(e,t,n,r){C.call(this,e,t,n),this.className="Enum.Value",this.id=r}).prototype=Object.create(C.prototype),T.Enum.Value=m,(v=function(e,t,n,r){C.call(this,e,t,n),this.field=r}).prototype=Object.create(C.prototype),T.Extension=v,((_=function(e,t,n,r){o.call(this,e,t,n,r),this.className="Service",this.clazz=null}).prototype=Object.create(o.prototype)).build=function(t){return this.clazz&&!t?this.clazz:this.clazz=function(e,t){var n,i=function(t){e.Builder.Service.call(this),this.rpcImpl=t||function(e,t,n){setTimeout(n.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},o=i.prototype=Object.create(e.Builder.Service.prototype),s=t.getChildren(e.Reflect.Service.RPCMethod);for(n=0;n<s.length;n++)!function(e){o[e.name]=function(n,i){try{try{n=e.resolvedRequestType.clazz.decode(r.wrap(n))}catch(e){if(!(e instanceof TypeError))throw e}if(null===n||"object"!=typeof n)throw Error("Illegal arguments");n instanceof e.resolvedRequestType.clazz||(n=new e.resolvedRequestType.clazz(n)),this.rpcImpl(e.fqn(),n,(function(n,r){if(!n){try{r=e.resolvedResponseType.clazz.decode(r)}catch(e){}return r&&r instanceof e.resolvedResponseType.clazz?void i(null,r):void i(Error("Illegal response type received in service method "+t.name+"#"+e.name))}i(n)}))}catch(e){setTimeout(i.bind(this,e),0)}},i[e.name]=function(t,n,r){new i(t)[e.name](n,r)},Object.defineProperty&&(Object.defineProperty(i[e.name],"$options",{value:e.buildOpt()}),Object.defineProperty(o[e.name],"$options",{value:i[e.name].$options}))}(s[n]);return Object.defineProperty&&(Object.defineProperty(i,"$options",{value:t.buildOpt()}),Object.defineProperty(o,"$options",{value:i.$options}),Object.defineProperty(i,"$type",{value:t}),Object.defineProperty(o,"$type",{value:t})),i}(e,this)},T.Service=_,((y=function(e,t,n,r){C.call(this,e,t,n),this.className="Service.Method",this.options=r||{}}).prototype=Object.create(C.prototype)).buildOpt=s.buildOpt,T.Service.Method=y,(E=function(e,t,n,r,i,o,s,a){y.call(this,e,t,n,a),this.className="Service.RPCMethod",this.requestName=r,this.responseName=i,this.requestStream=o,this.responseStream=s,this.resolvedRequestType=null,this.resolvedResponseType=null}).prototype=Object.create(y.prototype),T.Service.RPCMethod=E,T}(o),o.Builder=function(e,t,n){function r(e){e.messages&&e.messages.forEach((function(t){t.syntax=e.syntax,r(t)})),e.enums&&e.enums.forEach((function(t){t.syntax=e.syntax}))}var i=function(e){this.ns=new n.Namespace(this,null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null,this.options=e||{}},o=i.prototype;return i.isMessage=function(e){return"string"==typeof e.name&&void 0===e.values&&void 0===e.rpc},i.isMessageField=function(e){return"string"==typeof e.rule&&"string"==typeof e.name&&"string"==typeof e.type&&void 0!==e.id},i.isEnum=function(e){return"string"==typeof e.name&&!(void 0===e.values||!Array.isArray(e.values)||0===e.values.length)},i.isService=function(e){return!("string"!=typeof e.name||"object"!=typeof e.rpc||!e.rpc)},i.isExtend=function(e){return"string"==typeof e.ref},o.reset=function(){return this.ptr=this.ns,this},o.define=function(e){if("string"!=typeof e||!t.TYPEREF.test(e))throw Error("illegal namespace: "+e);return e.split(".").forEach((function(e){var t=this.ptr.getChild(e);null===t&&this.ptr.addChild(t=new n.Namespace(this,this.ptr,e)),this.ptr=t}),this),this},o.create=function(t){var r,o,s,a,c;if(!t)return this;if(Array.isArray(t)){if(0===t.length)return this;t=t.slice()}else t=[t];for(r=[t];r.length>0;){if(t=r.pop(),!Array.isArray(t))throw Error("not a valid namespace: "+JSON.stringify(t));for(;t.length>0;){if(o=t.shift(),i.isMessage(o)){if(s=new n.Message(this,this.ptr,o.name,o.options,o.isGroup,o.syntax),a={},o.oneofs&&Object.keys(o.oneofs).forEach((function(e){s.addChild(a[e]=new n.Message.OneOf(this,s,e))}),this),o.fields&&o.fields.forEach((function(e){if(null!==s.getChild(0|e.id))throw Error("duplicate or invalid field id in "+s.name+": "+e.id);if(e.options&&"object"!=typeof e.options)throw Error("illegal field options in "+s.name+"#"+e.name);var t=null;if("string"==typeof e.oneof&&!(t=a[e.oneof]))throw Error("illegal oneof in "+s.name+"#"+e.name+": "+e.oneof);e=new n.Message.Field(this,s,e.rule,e.keytype,e.type,e.name,e.id,e.options,t,o.syntax),t&&t.fields.push(e),s.addChild(e)}),this),c=[],o.enums&&o.enums.forEach((function(e){c.push(e)})),o.messages&&o.messages.forEach((function(e){c.push(e)})),o.services&&o.services.forEach((function(e){c.push(e)})),o.extensions&&(s.extensions="number"==typeof o.extensions[0]?[o.extensions]:o.extensions),this.ptr.addChild(s),c.length>0){r.push(t),t=c,c=null,this.ptr=s,s=null;continue}c=null}else if(i.isEnum(o))s=new n.Enum(this,this.ptr,o.name,o.options,o.syntax),o.values.forEach((function(e){s.addChild(new n.Enum.Value(this,s,e.name,e.id))}),this),this.ptr.addChild(s);else if(i.isService(o))s=new n.Service(this,this.ptr,o.name,o.options),Object.keys(o.rpc).forEach((function(e){var t=o.rpc[e];s.addChild(new n.Service.RPCMethod(this,s,e,t.request,t.response,!!t.request_stream,!!t.response_stream,t.options))}),this),this.ptr.addChild(s);else{if(!i.isExtend(o))throw Error("not a valid definition: "+JSON.stringify(o));if(s=this.ptr.resolve(o.ref,!0))o.fields.forEach((function(t){var r,i,o,a;if(null!==s.getChild(0|t.id))throw Error("duplicate extended field id in "+s.name+": "+t.id);if(s.extensions&&(r=!1,s.extensions.forEach((function(e){t.id>=e[0]&&t.id<=e[1]&&(r=!0)})),!r))throw Error("illegal extended field id in "+s.name+": "+t.id+" (not within valid ranges)");i=t.name,this.options.convertFieldsToCamelCase&&(i=e.Util.toCamelCase(i)),o=new n.Message.ExtensionField(this,s,t.rule,t.type,this.ptr.fqn()+"."+i,t.id,t.options),a=new n.Extension(this,this.ptr,t.name,o),o.extension=a,this.ptr.addChild(a),s.addChild(o)}),this);else if(!/\.?google\.protobuf\./.test(o.ref))throw Error("extended message "+o.ref+" is not defined")}o=null,s=null}t=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},o.import=function(t,n){var i,o,s,a,c,u,d,l,h="/";if("string"==typeof n){if(e.Util.IS_NODE,!0===this.files[n])return this.reset();this.files[n]=!0}else if("object"==typeof n){if(i=n.root,e.Util.IS_NODE,(i.indexOf("\\")>=0||n.file.indexOf("\\")>=0)&&(h="\\"),o=i+h+n.file,!0===this.files[o])return this.reset();this.files[o]=!0}if(t.imports&&t.imports.length>0){for(a=!1,"object"==typeof n?(this.importRoot=n.root,a=!0,s=this.importRoot,n=n.file,(s.indexOf("\\")>=0||n.indexOf("\\")>=0)&&(h="\\")):"string"==typeof n?this.importRoot?s=this.importRoot:n.indexOf("/")>=0?""===(s=n.replace(/\/[^\/]*$/,""))&&(s="/"):n.indexOf("\\")>=0?(s=n.replace(/\\[^\\]*$/,""),h="\\"):s=".":s=null,c=0;c<t.imports.length;c++)if("string"==typeof t.imports[c]){if(!s)throw Error("cannot determine import root");if("google/protobuf/descriptor.proto"===(u=t.imports[c]))continue;if(u=s+h+u,!0===this.files[u])continue;if(/\.proto$/i.test(u)&&!e.DotProto&&(u=u.replace(/\.proto$/,".json")),null===(d=e.Util.fetch(u)))throw Error("failed to import '"+u+"' in '"+n+"': file not found");/\.json$/i.test(u)?this.import(JSON.parse(d+""),u):this.import(e.DotProto.Parser.parse(d),u)}else n?/\.(\w+)$/.test(n)?this.import(t.imports[c],n.replace(/^(.+)\.(\w+)$/,(function(e,t,n){return t+"_import"+c+"."+n}))):this.import(t.imports[c],n+"_import"+c):this.import(t.imports[c]);a&&(this.importRoot=null)}return t.package&&this.define(t.package),t.syntax&&r(t),l=this.ptr,t.options&&Object.keys(t.options).forEach((function(e){l.options[e]=t.options[e]})),t.messages&&(this.create(t.messages),this.ptr=l),t.enums&&(this.create(t.enums),this.ptr=l),t.services&&(this.create(t.services),this.ptr=l),t.extends&&this.create(t.extends),this.reset()},o.resolveAll=function(){var r;if(null==this.ptr||"object"==typeof this.ptr.type)return this;if(this.ptr instanceof n.Namespace)this.ptr.children.forEach((function(e){this.ptr=e,this.resolveAll()}),this);else if(this.ptr instanceof n.Message.Field){if(t.TYPE.test(this.ptr.type))this.ptr.type=e.TYPES[this.ptr.type];else{if(!t.TYPEREF.test(this.ptr.type))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(!(r=(this.ptr instanceof n.Message.ExtensionField?this.ptr.extension.parent:this.ptr.parent).resolve(this.ptr.type,!0)))throw Error("unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=r,r instanceof n.Enum){if(this.ptr.type=e.TYPES.enum,"proto3"===this.ptr.syntax&&"proto3"!==r.syntax)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(r instanceof n.Message))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=r.isGroup?e.TYPES.group:e.TYPES.message}}if(this.ptr.map){if(!t.TYPE.test(this.ptr.keyType))throw Error("illegal key type for map field in "+this.ptr.toString(!0)+": "+this.ptr.keyType);this.ptr.keyType=e.TYPES[this.ptr.keyType]}}else if(this.ptr instanceof e.Reflect.Service.Method){if(!(this.ptr instanceof e.Reflect.Service.RPCMethod))throw Error("illegal service type in "+this.ptr.toString(!0));if(!((r=this.ptr.parent.resolve(this.ptr.requestName,!0))&&r instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=r,!((r=this.ptr.parent.resolve(this.ptr.responseName,!0))&&r instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=r}else if(!(this.ptr instanceof e.Reflect.Message.OneOf||this.ptr instanceof e.Reflect.Extension||this.ptr instanceof e.Reflect.Enum.Value))throw Error("illegal object in namespace: "+typeof this.ptr+": "+this.ptr);return this.reset()},o.build=function(e){var t,n,r;if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null===this.result&&(this.result=this.ns.build()),!e)return this.result;for(t="string"==typeof e?e.split("."):e,n=this.result,r=0;r<t.length;r++){if(!n[t[r]]){n=null;break}n=n[t[r]]}return n},o.lookup=function(e,t){return e?this.ns.resolve(e,t):this.ns},o.toString=function(){return"Builder"},i.Message=function(){},i.Enum=function(){},i.Service=function(){},i}(o,o.Lang,o.Reflect),o.Map=function(e,t){function n(e){var t=0;return{next:function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}}var r=function(e,n){var r,i,o,s;if(!e.map)throw Error("field is not a map");if(this.field=e,this.keyElem=new t.Element(e.keyType,null,!0,e.syntax),this.valueElem=new t.Element(e.type,e.resolvedType,!1,e.syntax),this.map={},Object.defineProperty(this,"size",{get:function(){return Object.keys(this.map).length}}),n)for(r=Object.keys(n),i=0;i<r.length;i++)o=this.keyElem.valueFromString(r[i]),s=this.valueElem.verifyValue(n[r[i]]),this.map[this.keyElem.valueToString(o)]={key:o,value:s}},i=r.prototype;return i.clear=function(){this.map={}},i.delete=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e)),n=t in this.map;return delete this.map[t],n},i.entries=function(){var e,t,r=[],i=Object.keys(this.map);for(t=0;t<i.length;t++)r.push([(e=this.map[i[t]]).key,e.value]);return n(r)},i.keys=function(){var e,t=[],r=Object.keys(this.map);for(e=0;e<r.length;e++)t.push(this.map[r[e]].key);return n(t)},i.values=function(){var e,t=[],r=Object.keys(this.map);for(e=0;e<r.length;e++)t.push(this.map[r[e]].value);return n(t)},i.forEach=function(e,t){var n,r,i=Object.keys(this.map);for(r=0;r<i.length;r++)e.call(t,(n=this.map[i[r]]).value,n.key,this)},i.set=function(e,t){var n=this.keyElem.verifyValue(e),r=this.valueElem.verifyValue(t);return this.map[this.keyElem.valueToString(n)]={key:n,value:r},this},i.get=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e));return t in this.map?this.map[t].value:void 0},i.has=function(e){return this.keyElem.valueToString(this.keyElem.verifyValue(e))in this.map},r}(0,o.Reflect),o.loadProto=function(e,t,n){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(n=t,t=void 0),o.loadJson(o.DotProto.Parser.parse(e),t,n)},o.protoFromString=o.loadProto,o.loadProtoFile=function(e,t,n){if(t&&"object"==typeof t?(n=t,t=null):t&&"function"==typeof t||(t=null),t)return o.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,(function(r){if(null!==r)try{t(null,o.loadProto(r,n,e))}catch(e){t(e)}else t(Error("Failed to fetch file"))}));var r=o.Util.fetch("object"==typeof e?e.root+"/"+e.file:e);return null===r?null:o.loadProto(r,n,e)},o.protoFromFile=o.loadProtoFile,o.newBuilder=function(e){return void 0===(e=e||{}).convertFieldsToCamelCase&&(e.convertFieldsToCamelCase=o.convertFieldsToCamelCase),void 0===e.populateAccessors&&(e.populateAccessors=o.populateAccessors),new o.Builder(e)},o.loadJson=function(e,t,n){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(n=t,t=null),t&&"object"==typeof t||(t=o.newBuilder()),"string"==typeof e&&(e=JSON.parse(e)),t.import(e,n),t.resolveAll(),t},o.loadJsonFile=function(e,t,n){if(t&&"object"==typeof t?(n=t,t=null):t&&"function"==typeof t||(t=null),t)return o.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,(function(r){if(null!==r)try{t(null,o.loadJson(JSON.parse(r),n,e))}catch(e){t(e)}else t(Error("Failed to fetch file"))}));var r=o.Util.fetch("object"==typeof e?e.root+"/"+e.file:e);return null===r?null:o.loadJson(JSON.parse(r),n,e)},i=Sn,o.loadProto(i,void 0,"").build("Modules").probuf}(function(e){function t(e){var t=0;return function(){return t<e.length?e.charCodeAt(t++):null}}function n(){var e=[],t=[];return function(){return 0===arguments.length?t.join("")+a.apply(String,e):(e.length+arguments.length>1024&&(t.push(a.apply(String,e)),e.length=0),void Array.prototype.push.apply(e,arguments))}}function r(e,t,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,u=c>>1,d=-7,l=n?i-1:0,h=n?-1:1,f=e[t+l];for(l+=h,o=f&(1<<-d)-1,f>>=-d,d+=a;d>0;o=256*o+e[t+l],l+=h,d-=8);for(s=o&(1<<-d)-1,o>>=-d,d+=r;d>0;s=256*s+e[t+l],l+=h,d-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),o-=u}return(f?-1:1)*s*Math.pow(2,o-r)}function i(e,t,n,r,i,o){var s,a,c,u=8*o-i-1,d=(1<<u)-1,l=d>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||1/0===t?(a=isNaN(t)?1:0,s=d):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+l>=1?h/c:h*Math.pow(2,1-l))*c>=2&&(s++,c/=2),s+l>=d?(a=0,s=d):s+l>=1?(a=(t*c-1)*Math.pow(2,i),s+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;e[n+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[n+f]=255&s,f+=p,s/=256,u-=8);e[n+f-p]|=128*g}var o,s,a,c,u,d=function(e,t,n){if(void 0===e&&(e=d.DEFAULT_CAPACITY),void 0===t&&(t=d.DEFAULT_ENDIAN),void 0===n&&(n=d.DEFAULT_NOASSERT),!n){if((e|=0)<0)throw RangeError("Illegal capacity");t=!!t,n=!!n}this.buffer=0===e?s:new ArrayBuffer(e),this.view=0===e?null:new Uint8Array(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=e,this.littleEndian=t,this.noAssert=n};return d.VERSION="5.0.1",d.LITTLE_ENDIAN=!0,d.BIG_ENDIAN=!1,d.DEFAULT_CAPACITY=16,d.DEFAULT_ENDIAN=d.BIG_ENDIAN,d.DEFAULT_NOASSERT=!1,d.Long=e||null,(o=d.prototype).__isByteBuffer__,Object.defineProperty(o,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1}),s=new ArrayBuffer(0),a=String.fromCharCode,d.accessor=function(){return Uint8Array},d.allocate=function(e,t,n){return new d(e,t,n)},d.concat=function(e,t,n,r){var i,o,s,a,c,u;for(("boolean"==typeof t||"string"!=typeof t)&&(r=n,n=t,t=void 0),i=0,s=0,a=e.length;a>s;++s)d.isByteBuffer(e[s])||(e[s]=d.wrap(e[s],t)),(o=e[s].limit-e[s].offset)>0&&(i+=o);if(0===i)return new d(0,n,r);for(u=new d(i,n,r),s=0;a>s;)(o=(c=e[s++]).limit-c.offset)<=0||(u.view.set(c.view.subarray(c.offset,c.limit),u.offset),u.offset+=o);return u.limit=u.offset,u.offset=0,u},d.isByteBuffer=function(e){return!0===(e&&e.__isByteBuffer__)},d.type=function(){return ArrayBuffer},d.wrap=function(e,t,n,r){var i,s;if("string"!=typeof t&&(r=n,n=t,t=void 0),"string"==typeof e)switch(void 0===t&&(t="utf8"),t){case"base64":return d.fromBase64(e,n);case"hex":return d.fromHex(e,n);case"binary":return d.fromBinary(e,n);case"utf8":return d.fromUTF8(e,n);case"debug":return d.fromDebug(e,n);default:throw Error("Unsupported encoding: "+t)}if(null===e||"object"!=typeof e)throw TypeError("Illegal buffer");if(d.isByteBuffer(e))return(i=o.clone.call(e)).markedOffset=-1,i;if(e instanceof Uint8Array)i=new d(0,n,r),e.length>0&&(i.buffer=e.buffer,i.offset=e.byteOffset,i.limit=e.byteOffset+e.byteLength,i.view=new Uint8Array(e.buffer));else if(e instanceof ArrayBuffer)i=new d(0,n,r),e.byteLength>0&&(i.buffer=e,i.offset=0,i.limit=e.byteLength,i.view=e.byteLength>0?new Uint8Array(e):null);else{if("[object Array]"!==Object.prototype.toString.call(e))throw TypeError("Illegal buffer");for((i=new d(e.length,n,r)).limit=e.length,s=0;s<e.length;++s)i.view[s]=e[s]}return i},o.writeBitSet=function(e,t){var n,r,i,o,s,a,c=void 0===t;if(c&&(t=this.offset),!this.noAssert){if(!(e instanceof Array))throw TypeError("Illegal BitSet: Not an array");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}for(r=t,o=(i=e.length)>>3,s=0,t+=this.writeVarint32(i,t);o--;)n=1&!!e[s++]|(1&!!e[s++])<<1|(1&!!e[s++])<<2|(1&!!e[s++])<<3|(1&!!e[s++])<<4|(1&!!e[s++])<<5|(1&!!e[s++])<<6|(1&!!e[s++])<<7,this.writeByte(n,t++);if(i>s){for(a=0,n=0;i>s;)n|=(1&!!e[s++])<<a++;this.writeByte(n,t++)}return c?(this.offset=t,this):t-r},o.readBitSet=function(e){var t,n,r,i,o,s,a,c=void 0===e;for(c&&(e=this.offset),i=(r=(n=this.readVarint32(e)).value)>>3,o=0,s=[],e+=n.length;i--;)t=this.readByte(e++),s[o++]=!!(1&t),s[o++]=!!(2&t),s[o++]=!!(4&t),s[o++]=!!(8&t),s[o++]=!!(16&t),s[o++]=!!(32&t),s[o++]=!!(64&t),s[o++]=!!(128&t);if(r>o)for(a=0,t=this.readByte(e++);r>o;)s[o++]=!!(1&t>>a++);return c&&(this.offset=e),s},o.readBytes=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+"+e+") <= "+this.buffer.byteLength)}return n=this.slice(t,t+e),r&&(this.offset+=e),n},o.writeBytes=o.append,o.writeInt8=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=1)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=1,this.view[t]=e,r&&(this.offset+=1),this},o.writeByte=o.writeInt8,o.readInt8=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return 128==(128&(t=this.view[e]))&&(t=-(255-t+1)),n&&(this.offset+=1),t},o.readByte=o.readInt8,o.writeUint8=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=1)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=1,this.view[t]=e,r&&(this.offset+=1),this},o.writeUInt8=o.writeUint8,o.readUint8=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return t=this.view[e],n&&(this.offset+=1),t},o.readUInt8=o.readUint8,o.writeInt16=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=2)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),r&&(this.offset+=2),this},o.writeShort=o.writeInt16,o.readInt16=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}return t=0,this.littleEndian?(t=this.view[e],t|=this.view[e+1]<<8):(t=this.view[e]<<8,t|=this.view[e+1]),32768==(32768&t)&&(t=-(65535-t+1)),n&&(this.offset+=2),t},o.readShort=o.readInt16,o.writeUint16=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=2)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),r&&(this.offset+=2),this},o.writeUInt16=o.writeUint16,o.readUint16=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}return t=0,this.littleEndian?(t=this.view[e],t|=this.view[e+1]<<8):(t=this.view[e]<<8,t|=this.view[e+1]),n&&(this.offset+=2),t},o.readUInt16=o.readUint16,o.writeInt32=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=4)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=4,this.littleEndian?(this.view[t+3]=255&e>>>24,this.view[t+2]=255&e>>>16,this.view[t+1]=255&e>>>8,this.view[t]=255&e):(this.view[t]=255&e>>>24,this.view[t+1]=255&e>>>16,this.view[t+2]=255&e>>>8,this.view[t+3]=255&e),r&&(this.offset+=4),this},o.writeInt=o.writeInt32,o.readInt32=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return t=0,this.littleEndian?(t=this.view[e+2]<<16,t|=this.view[e+1]<<8,t|=this.view[e],t+=this.view[e+3]<<24>>>0):(t=this.view[e+1]<<16,t|=this.view[e+2]<<8,t|=this.view[e+3],t+=this.view[e]<<24>>>0),t|=0,n&&(this.offset+=4),t},o.readInt=o.readInt32,o.writeUint32=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=4)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=4,this.littleEndian?(this.view[t+3]=255&e>>>24,this.view[t+2]=255&e>>>16,this.view[t+1]=255&e>>>8,this.view[t]=255&e):(this.view[t]=255&e>>>24,this.view[t+1]=255&e>>>16,this.view[t+2]=255&e>>>8,this.view[t+3]=255&e),r&&(this.offset+=4),this},o.writeUInt32=o.writeUint32,o.readUint32=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return t=0,this.littleEndian?(t=this.view[e+2]<<16,t|=this.view[e+1]<<8,t|=this.view[e],t+=this.view[e+3]<<24>>>0):(t=this.view[e+1]<<16,t|=this.view[e+2]<<8,t|=this.view[e+3],t+=this.view[e]<<24>>>0),n&&(this.offset+=4),t},o.readUInt32=o.readUint32,e&&(o.writeInt64=function(t,n){var r,i,o,s=void 0===n;if(s&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t)),(n+=8)>(r=this.buffer.byteLength)&&this.resize((r*=2)>n?r:n),n-=8,i=t.low,o=t.high,this.littleEndian?(this.view[n+3]=255&i>>>24,this.view[n+2]=255&i>>>16,this.view[n+1]=255&i>>>8,this.view[n]=255&i,n+=4,this.view[n+3]=255&o>>>24,this.view[n+2]=255&o>>>16,this.view[n+1]=255&o>>>8,this.view[n]=255&o):(this.view[n]=255&o>>>24,this.view[n+1]=255&o>>>16,this.view[n+2]=255&o>>>8,this.view[n+3]=255&o,n+=4,this.view[n]=255&i>>>24,this.view[n+1]=255&i>>>16,this.view[n+2]=255&i>>>8,this.view[n+3]=255&i),s&&(this.offset+=8),this},o.writeLong=o.writeInt64,o.readInt64=function(t){var n,r,i,o=void 0===t;if(o&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}return n=0,r=0,this.littleEndian?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0,t+=4,r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0,t+=4,n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0),i=new e(n,r,!1),o&&(this.offset+=8),i},o.readLong=o.readInt64,o.writeUint64=function(t,n){var r,i,o,s=void 0===n;if(s&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t)),(n+=8)>(r=this.buffer.byteLength)&&this.resize((r*=2)>n?r:n),n-=8,i=t.low,o=t.high,this.littleEndian?(this.view[n+3]=255&i>>>24,this.view[n+2]=255&i>>>16,this.view[n+1]=255&i>>>8,this.view[n]=255&i,n+=4,this.view[n+3]=255&o>>>24,this.view[n+2]=255&o>>>16,this.view[n+1]=255&o>>>8,this.view[n]=255&o):(this.view[n]=255&o>>>24,this.view[n+1]=255&o>>>16,this.view[n+2]=255&o>>>8,this.view[n+3]=255&o,n+=4,this.view[n]=255&i>>>24,this.view[n+1]=255&i>>>16,this.view[n+2]=255&i>>>8,this.view[n+3]=255&i),s&&(this.offset+=8),this},o.writeUInt64=o.writeUint64,o.readUint64=function(t){var n,r,i,o=void 0===t;if(o&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}return n=0,r=0,this.littleEndian?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0,t+=4,r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0,t+=4,n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0),i=new e(n,r,!0),o&&(this.offset+=8),i},o.readUInt64=o.readUint64),o.writeFloat32=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=4)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=4,i(this.view,e,t,this.littleEndian,23,4),r&&(this.offset+=4),this},o.writeFloat=o.writeFloat32,o.readFloat32=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return t=r(this.view,e,this.littleEndian,23,4),n&&(this.offset+=4),t},o.readFloat=o.readFloat32,o.writeFloat64=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=8)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=8,i(this.view,e,t,this.littleEndian,52,8),r&&(this.offset+=8),this},o.writeDouble=o.writeFloat64,o.readFloat64=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}return t=r(this.view,e,this.littleEndian,52,8),n&&(this.offset+=8),t},o.readDouble=o.readFloat64,d.MAX_VARINT32_BYTES=5,d.calculateVarint32=function(e){return(e>>>=0)<128?1:e<16384?2:1<<21>e?3:1<<28>e?4:5},d.zigZagEncode32=function(e){return((e|=0)<<1^e>>31)>>>0},d.zigZagDecode32=function(e){return 0|e>>>1^-(1&e)},o.writeVarint32=function(e,t){var n,r,i,o=void 0===t;if(o&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}for((t+=r=d.calculateVarint32(e))>(i=this.buffer.byteLength)&&this.resize((i*=2)>t?i:t),t-=r,e>>>=0;e>=128;)n=128|127&e,this.view[t++]=n,e>>>=7;return this.view[t++]=e,o?(this.offset=t,this):r},o.writeVarint32ZigZag=function(e,t){return this.writeVarint32(d.zigZagEncode32(e),t)},o.readVarint32=function(e){var t,n,r,i,o=void 0===e;if(o&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}n=0,r=0;do{if(!this.noAssert&&e>this.limit)throw(i=Error("Truncated")).truncated=!0,i;t=this.view[e++],n<5&&(r|=(127&t)<<7*n),++n}while(0!=(128&t));return r|=0,o?(this.offset=e,r):{value:r,length:n}},o.readVarint32ZigZag=function(e){var t=this.readVarint32(e);return"object"==typeof t?t.value=d.zigZagDecode32(t.value):t=d.zigZagDecode32(t),t},e&&(d.MAX_VARINT64_BYTES=10,d.calculateVarint64=function(t){"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t));var n=t.toInt()>>>0,r=t.shiftRightUnsigned(28).toInt()>>>0,i=t.shiftRightUnsigned(56).toInt()>>>0;return 0==i?0==r?n<16384?n<128?1:2:1<<21>n?3:4:r<16384?r<128?5:6:1<<21>r?7:8:i<128?9:10},d.zigZagEncode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):!1!==t.unsigned&&(t=t.toSigned()),t.shiftLeft(1).xor(t.shiftRight(63)).toUnsigned()},d.zigZagDecode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):!1!==t.unsigned&&(t=t.toSigned()),t.shiftRightUnsigned(1).xor(t.and(e.ONE).toSigned().negate()).toSigned()},o.writeVarint64=function(t,n){var r,i,o,s,a,c=void 0===n;if(c&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}switch("number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):!1!==t.unsigned&&(t=t.toSigned()),r=d.calculateVarint64(t),i=t.toInt()>>>0,o=t.shiftRightUnsigned(28).toInt()>>>0,s=t.shiftRightUnsigned(56).toInt()>>>0,(n+=r)>(a=this.buffer.byteLength)&&this.resize((a*=2)>n?a:n),n-=r,r){case 10:this.view[n+9]=1&s>>>7;case 9:this.view[n+8]=9!==r?128|s:127&s;case 8:this.view[n+7]=8!==r?128|o>>>21:127&o>>>21;case 7:this.view[n+6]=7!==r?128|o>>>14:127&o>>>14;case 6:this.view[n+5]=6!==r?128|o>>>7:127&o>>>7;case 5:this.view[n+4]=5!==r?128|o:127&o;case 4:this.view[n+3]=4!==r?128|i>>>21:127&i>>>21;case 3:this.view[n+2]=3!==r?128|i>>>14:127&i>>>14;case 2:this.view[n+1]=2!==r?128|i>>>7:127&i>>>7;case 1:this.view[n]=1!==r?128|i:127&i}return c?(this.offset+=r,this):r},o.writeVarint64ZigZag=function(e,t){return this.writeVarint64(d.zigZagEncode64(e),t)},o.readVarint64=function(t){var n,r,i,o,s,a,c=void 0===t;if(c&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}if(n=t,r=0,i=0,o=0,s=0,r=127&(s=this.view[t++]),128&s&&(r|=(127&(s=this.view[t++]))<<7,(128&s||this.noAssert&&void 0===s)&&(r|=(127&(s=this.view[t++]))<<14,(128&s||this.noAssert&&void 0===s)&&(r|=(127&(s=this.view[t++]))<<21,(128&s||this.noAssert&&void 0===s)&&(i=127&(s=this.view[t++]),(128&s||this.noAssert&&void 0===s)&&(i|=(127&(s=this.view[t++]))<<7,(128&s||this.noAssert&&void 0===s)&&(i|=(127&(s=this.view[t++]))<<14,(128&s||this.noAssert&&void 0===s)&&(i|=(127&(s=this.view[t++]))<<21,(128&s||this.noAssert&&void 0===s)&&(o=127&(s=this.view[t++]),(128&s||this.noAssert&&void 0===s)&&(o|=(127&(s=this.view[t++]))<<7,128&s||this.noAssert&&void 0===s))))))))))throw Error("Buffer overrun");return a=e.fromBits(r|i<<28,i>>>4|o<<24,!1),c?(this.offset=t,a):{value:a,length:t-n}},o.readVarint64ZigZag=function(t){var n=this.readVarint64(t);return n&&n.value instanceof e?n.value=d.zigZagDecode64(n.value):n=d.zigZagDecode64(n),n}),o.writeCString=function(e,n){var r,i,o,s=void 0===n;if(s&&(n=this.offset),i=e.length,!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");for(r=0;i>r;++r)if(0===e.charCodeAt(r))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return i=u.calculateUTF16asUTF8(t(e))[1],n+=i+1,o=this.buffer.byteLength,n>o&&this.resize((o*=2)>n?o:n),n-=i+1,u.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),this.view[n++]=0,s?(this.offset=n,this):i},o.readCString=function(e){var t,r,i,o=void 0===e;if(o&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return t=e,i=-1,u.decodeUTF8toUTF16(function(){if(0===i)return null;if(e>=this.limit)throw RangeError("Illegal range: Truncated data, "+e+" < "+this.limit);return 0===(i=this.view[e++])?null:i}.bind(this),r=n(),!0),o?(this.offset=e,r()):{string:r(),length:e-t}},o.writeIString=function(e,n){var r,i,o,s=void 0===n;if(s&&(n=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}if(i=n,r=u.calculateUTF16asUTF8(t(e),this.noAssert)[1],n+=4+r,o=this.buffer.byteLength,n>o&&this.resize((o*=2)>n?o:n),n-=4+r,this.littleEndian?(this.view[n+3]=255&r>>>24,this.view[n+2]=255&r>>>16,this.view[n+1]=255&r>>>8,this.view[n]=255&r):(this.view[n]=255&r>>>24,this.view[n+1]=255&r>>>16,this.view[n+2]=255&r>>>8,this.view[n+3]=255&r),n+=4,u.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),n!==i+4+r)throw RangeError("Illegal range: Truncated data, "+n+" == "+(n+4+r));return s?(this.offset=n,this):n-i},o.readIString=function(e){var t,n,r,i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return t=e,n=this.readUint32(e),r=this.readUTF8String(n,d.METRICS_BYTES,e+=4),e+=r.length,i?(this.offset=e,r.string):{string:r.string,length:e-t}},d.METRICS_CHARS="c",d.METRICS_BYTES="b",o.writeUTF8String=function(e,n){var r,i,o,s=void 0===n;if(s&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return i=n,r=u.calculateUTF16asUTF8(t(e))[1],n+=r,o=this.buffer.byteLength,n>o&&this.resize((o*=2)>n?o:n),n-=r,u.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),s?(this.offset=n,this):n-i},o.writeString=o.writeUTF8String,d.calculateUTF8Chars=function(e){return u.calculateUTF16asUTF8(t(e))[0]},d.calculateUTF8Bytes=function(e){return u.calculateUTF16asUTF8(t(e))[1]},d.calculateString=d.calculateUTF8Bytes,o.readUTF8String=function(e,t,r){var i,o,s,a,c;if("number"==typeof t&&(r=t,t=void 0),(i=void 0===r)&&(r=this.offset),void 0===t&&(t=d.METRICS_CHARS),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");if(e|=0,"number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.byteLength)}if(s=0,a=r,t===d.METRICS_CHARS){if(o=n(),u.decodeUTF8(function(){return e>s&&r<this.limit?this.view[r++]:null}.bind(this),(function(e){++s,u.UTF8toUTF16(e,o)})),s!==e)throw RangeError("Illegal range: Truncated data, "+s+" == "+e);return i?(this.offset=r,o()):{string:o(),length:r-a}}if(t===d.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+"+e+") <= "+this.buffer.byteLength)}if(c=r+e,u.decodeUTF8toUTF16(function(){return c>r?this.view[r++]:null}.bind(this),o=n(),this.noAssert),r!==c)throw RangeError("Illegal range: Truncated data, "+r+" == "+c);return i?(this.offset=r,o()):{string:o(),length:r-a}}throw TypeError("Unsupported metrics: "+t)},o.readString=o.readUTF8String,o.writeVString=function(e,n){var r,i,o,s,a=void 0===n;if(a&&(n=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}if(o=n,r=u.calculateUTF16asUTF8(t(e),this.noAssert)[1],i=d.calculateVarint32(r),n+=i+r,s=this.buffer.byteLength,n>s&&this.resize((s*=2)>n?s:n),n-=i+r,n+=this.writeVarint32(r,n),u.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),n!==o+r+i)throw RangeError("Illegal range: Truncated data, "+n+" == "+(n+r+i));return a?(this.offset=n,this):n-o},o.readVString=function(e){var t,n,r,i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return t=e,n=this.readVarint32(e),r=this.readUTF8String(n.value,d.METRICS_BYTES,e+=n.length),e+=r.length,i?(this.offset=e,r.string):{string:r.string,length:e-t}},o.append=function(e,t,n){var r,i,o;if(("number"==typeof t||"string"!=typeof t)&&(n=t,t=void 0),(r=void 0===n)&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return e instanceof d||(e=d.wrap(e,t)),(i=e.limit-e.offset)<=0||((n+=i)>(o=this.buffer.byteLength)&&this.resize((o*=2)>n?o:n),n-=i,this.view.set(e.view.subarray(e.offset,e.limit),n),e.offset+=i,r&&(this.offset+=i)),this},o.appendTo=function(e,t){return e.append(this,t),this},o.assert=function(e){return this.noAssert=!e,this},o.capacity=function(){return this.buffer.byteLength},o.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},o.clone=function(e){var t=new d(0,this.littleEndian,this.noAssert);return e?(t.buffer=new ArrayBuffer(this.buffer.byteLength),t.view=new Uint8Array(t.buffer)):(t.buffer=this.buffer,t.view=this.view),t.offset=this.offset,t.markedOffset=this.markedOffset,t.limit=this.limit,t},o.compact=function(e,t){var n,r,i;if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}return 0===e&&t===this.buffer.byteLength?this:0==(n=t-e)?(this.buffer=s,this.view=null,this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=0,this):(r=new ArrayBuffer(n),(i=new Uint8Array(r)).set(this.view.subarray(e,t)),this.buffer=r,this.view=i,this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=n,this)},o.copy=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(e===t)return new d(0,this.littleEndian,this.noAssert);var n=t-e,r=new d(n,this.littleEndian,this.noAssert);return r.offset=0,r.limit=n,r.markedOffset>=0&&(r.markedOffset-=e),this.copyTo(r,0,e,t),r},o.copyTo=function(e,t,n,r){var i,o,s;if(!this.noAssert&&!d.isByteBuffer(e))throw TypeError("Illegal target: Not a ByteBuffer");if(t=(o=void 0===t)?e.offset:0|t,n=(i=void 0===n)?this.offset:0|n,r=void 0===r?this.limit:0|r,t<0||t>e.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+t+" <= "+e.buffer.byteLength);if(n<0||r>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+n+" <= "+this.buffer.byteLength);return 0==(s=r-n)?e:(e.ensureCapacity(t+s),e.view.set(this.view.subarray(n,r),t),i&&(this.offset+=s),o&&(e.offset+=s),this)},o.ensureCapacity=function(e){var t=this.buffer.byteLength;return e>t?this.resize((t*=2)>e?t:e):this},o.fill=function(e,t,n){var r=void 0===t;if(r&&(t=this.offset),"string"==typeof e&&e.length>0&&(e=e.charCodeAt(0)),void 0===t&&(t=this.offset),void 0===n&&(n=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal end: Not an integer");if(n>>>=0,t<0||t>n||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+n+" <= "+this.buffer.byteLength)}if(t>=n)return this;for(;n>t;)this.view[t++]=e;return r&&(this.offset=t),this},o.flip=function(){return this.limit=this.offset,this.offset=0,this},o.mark=function(e){if(e=void 0===e?this.offset:e,!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=e,this},o.order=function(e){if(!this.noAssert&&"boolean"!=typeof e)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!e,this},o.LE=function(e){return this.littleEndian=void 0===e||!!e,this},o.BE=function(e){return this.littleEndian=void 0!==e&&!e,this},o.prepend=function(e,t,n){var r,i,o,s,a;if(("number"==typeof t||"string"!=typeof t)&&(n=t,t=void 0),(r=void 0===n)&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return e instanceof d||(e=d.wrap(e,t)),(i=e.limit-e.offset)<=0||((o=i-n)>0?(s=new ArrayBuffer(this.buffer.byteLength+o),(a=new Uint8Array(s)).set(this.view.subarray(n,this.buffer.byteLength),i),this.buffer=s,this.view=a,this.offset+=o,this.markedOffset>=0&&(this.markedOffset+=o),this.limit+=o,n+=o):new Uint8Array(this.buffer),this.view.set(e.view.subarray(e.offset,e.limit),n-i),e.offset=e.limit,r&&(this.offset-=i)),this},o.prependTo=function(e,t){return e.prepend(this,t),this},o.printDebug=function(e){"function"!=typeof e&&(e=console.log.bind(console)),e(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},o.remaining=function(){return this.limit-this.offset},o.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},o.resize=function(e){var t,n;if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal capacity: "+e+" (not an integer)");if((e|=0)<0)throw RangeError("Illegal capacity: 0 <= "+e)}return this.buffer.byteLength<e&&(t=new ArrayBuffer(e),(n=new Uint8Array(t)).set(this.view),this.buffer=t,this.view=n),this},o.reverse=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}return e===t||Array.prototype.reverse.call(this.view.subarray(e,t)),this},o.skip=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");e|=0}var t=this.offset+e;if(!this.noAssert&&(t<0||t>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+e+" <= "+this.buffer.byteLength);return this.offset=t,this},o.slice=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var n=this.clone();return n.offset=e,n.limit=t,n},o.toBuffer=function(e){var t,n=this.offset,r=this.limit;if(!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: Not an integer");if(n>>>=0,"number"!=typeof r||r%1!=0)throw TypeError("Illegal limit: Not an integer");if(r>>>=0,n<0||n>r||r>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+n+" <= "+r+" <= "+this.buffer.byteLength)}return e||0!==n||r!==this.buffer.byteLength?n===r?s:(t=new ArrayBuffer(r-n),new Uint8Array(t).set(new Uint8Array(this.buffer).subarray(n,r),0),t):this.buffer},o.toArrayBuffer=o.toBuffer,o.toString=function(e,t,n){if(void 0===e)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof e&&(n=t=e="utf8"),e){case"utf8":return this.toUTF8(t,n);case"base64":return this.toBase64(t,n);case"hex":return this.toHex(t,n);case"binary":return this.toBinary(t,n);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+e)}},c=function(){var e,t,n={},r=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],i=[];for(e=0,t=r.length;t>e;++e)i[r[e]]=e;return n.encode=function(e,t){for(var n,i;null!==(n=e());)t(r[63&n>>2]),i=(3&n)<<4,null!==(n=e())?(t(r[63&((i|=15&n>>4)|15&n>>4)]),i=(15&n)<<2,null!==(n=e())?(t(r[63&(i|3&n>>6)]),t(r[63&n])):(t(r[63&i]),t(61))):(t(r[63&i]),t(61),t(61))},n.decode=function(e,t){function n(e){throw Error("Illegal character code: "+e)}for(var r,o,s;null!==(r=e());)if(void 0===(o=i[r])&&n(r),null!==(r=e())&&(void 0===(s=i[r])&&n(r),t(o<<2>>>0|(48&s)>>4),null!==(r=e()))){if(void 0===(o=i[r])){if(61===r)break;n(r)}if(t((15&s)<<4>>>0|(60&o)>>2),null!==(r=e())){if(void 0===(s=i[r])){if(61===r)break;n(r)}t((3&o)<<6>>>0|s)}}},n.test=function(e){return/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e)},n}(),o.toBase64=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),t|=0,(e|=0)<0||t>this.capacity||e>t)throw RangeError("begin, end");var r;return c.encode(function(){return t>e?this.view[e++]:null}.bind(this),r=n()),r()},d.fromBase64=function(e,n){if("string"!=typeof e)throw TypeError("str");var r=new d(e.length/4*3,n),i=0;return c.decode(t(e),(function(e){r.view[i++]=e})),r.limit=i,r},d.btoa=function(e){return d.fromBinary(e).toBase64()},d.atob=function(e){return d.fromBase64(e).toBinary()},o.toBinary=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),t|=0,(e|=0)<0||t>this.capacity()||e>t)throw RangeError("begin, end");if(e===t)return"";for(var n=[],r=[];t>e;)n.push(this.view[e++]),n.length>=1024&&(r.push(String.fromCharCode.apply(String,n)),n=[]);return r.join("")+String.fromCharCode.apply(String,n)},d.fromBinary=function(e,t){if("string"!=typeof e)throw TypeError("str");for(var n,r=0,i=e.length,o=new d(i,t);i>r;){if((n=e.charCodeAt(r))>255)throw RangeError("illegal char code: "+n);o.view[r++]=n}return o.limit=i,o},o.toDebug=function(e){for(var t,n=-1,r=this.buffer.byteLength,i="",o="",s="";r>n;){if(-1!==n&&(i+=(t=this.view[n])<16?"0"+t.toString(16).toUpperCase():t.toString(16).toUpperCase(),e&&(o+=t>32&&t<127?String.fromCharCode(t):".")),++n,e&&n>0&&n%16==0&&n!==r){for(;i.length<51;)i+=" ";s+=i+o+"\n",i=o=""}i+=n===this.offset&&n===this.limit?n===this.markedOffset?"!":"|":n===this.offset?n===this.markedOffset?"[":"<":n===this.limit?n===this.markedOffset?"]":">":n===this.markedOffset?"'":e||0!==n&&n!==r?" ":""}if(e&&" "!==i){for(;i.length<51;)i+=" ";s+=i+o+"\n"}return e?s:i},d.fromDebug=function(e,t,n){for(var r,i,o=e.length,s=new d(0|(o+1)/3,t,n),a=0,c=0,u=!1,l=!1,h=!1,f=!1,p=!1;o>a;){switch(r=e.charAt(a++)){case"!":if(!n){if(l||h||f){p=!0;break}l=h=f=!0}s.offset=s.markedOffset=s.limit=c,u=!1;break;case"|":if(!n){if(l||f){p=!0;break}l=f=!0}s.offset=s.limit=c,u=!1;break;case"[":if(!n){if(l||h){p=!0;break}l=h=!0}s.offset=s.markedOffset=c,u=!1;break;case"<":if(!n){if(l){p=!0;break}l=!0}s.offset=c,u=!1;break;case"]":if(!n){if(f||h){p=!0;break}f=h=!0}s.limit=s.markedOffset=c,u=!1;break;case">":if(!n){if(f){p=!0;break}f=!0}s.limit=c,u=!1;break;case"'":if(!n){if(h){p=!0;break}h=!0}s.markedOffset=c,u=!1;break;case" ":u=!1;break;default:if(!n&&u){p=!0;break}if(i=parseInt(r+e.charAt(a++),16),!n&&(isNaN(i)||i<0||i>255))throw TypeError("Illegal str: Not a debug encoded string");s.view[c++]=i,u=!0}if(p)throw TypeError("Illegal str: Invalid symbol at "+a)}if(!n){if(!l||!f)throw TypeError("Illegal str: Missing offset or limit");if(c<s.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+c+" < "+o)}return s},o.toHex=function(e,t){if(e=void 0===e?this.offset:e,t=void 0===t?this.limit:t,!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}for(var n,r=new Array(t-e);t>e;)(n=this.view[e++])<16?r.push("0",n.toString(16)):r.push(n.toString(16));return r.join("")},d.fromHex=function(e,t,n){var r,i,o,s,a;if(!n){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if(e.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(i=e.length,o=new d(0|i/2,t),s=0,a=0;i>s;s+=2){if(r=parseInt(e.substring(s,s+2),16),!n&&(!isFinite(r)||r<0||r>255))throw TypeError("Illegal str: Contains non-hex characters");o.view[a++]=r}return o.limit=a,o},u=function(){var e={MAX_CODEPOINT:1114111,encodeUTF8:function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<128?t(127&n):n<2048?(t(192|31&n>>6),t(128|63&n)):n<65536?(t(224|15&n>>12),t(128|63&n>>6),t(128|63&n)):(t(240|7&n>>18),t(128|63&n>>12),t(128|63&n>>6),t(128|63&n)),n=null},decodeUTF8:function(e,t){for(var n,r,i,o,s=function(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(n=e());)if(0==(128&n))t(n);else if(192==(224&n))null===(r=e())&&s([n,r]),t((31&n)<<6|63&r);else if(224==(240&n))(null===(r=e())||null===(i=e()))&&s([n,r,i]),t((15&n)<<12|(63&r)<<6|63&i);else{if(240!=(248&n))throw RangeError("Illegal starting byte: "+n);(null===(r=e())||null===(i=e())||null===(o=e()))&&s([n,r,i,o]),t((7&n)<<18|(63&r)<<12|(63&i)<<6|63&o)}},UTF16toUTF8:function(e,t){for(var n,r=null;null!==(n=null!==r?r:e());)n>=55296&&n<=57343&&null!==(r=e())&&r>=56320&&r<=57343?(t(1024*(n-55296)+r-56320+65536),r=null):t(n);null!==r&&t(r)},UTF8toUTF16:function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<=65535?t(n):(t(55296+((n-=65536)>>10)),t(n%1024+56320)),n=null},encodeUTF16toUTF8:function(t,n){e.UTF16toUTF8(t,(function(t){e.encodeUTF8(t,n)}))},decodeUTF8toUTF16:function(t,n){e.decodeUTF8(t,(function(t){e.UTF8toUTF16(t,n)}))},calculateCodePoint:function(e){return e<128?1:e<2048?2:e<65536?3:4},calculateUTF8:function(e){for(var t,n=0;null!==(t=e());)n+=t<128?1:t<2048?2:t<65536?3:4;return n},calculateUTF16asUTF8:function(t){var n=0,r=0;return e.UTF16toUTF8(t,(function(e){++n,r+=e<128?1:e<2048?2:e<65536?3:4})),[n,r]}};return e}(),o.toUTF8=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var r;try{u.decodeUTF8toUTF16(function(){return t>e?this.view[e++]:null}.bind(this),r=n())}catch(n){if(e!==t)throw RangeError("Illegal range: Truncated data, "+e+" != "+t)}return r()},d.fromUTF8=function(e,n,r){if(!r&&"string"!=typeof e)throw TypeError("Illegal str: Not a string");var i=new d(u.calculateUTF16asUTF8(t(e),!0)[1],n,r),o=0;return u.encodeUTF16toUTF8(t(e),(function(e){i.view[o++]=e})),i.limit=o,i},d}(bn=function(){function e(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function t(e){return!0===(e&&e.__isLong__)}function n(e,t){var n,r,o;return t?(o=(e>>>=0)>=0&&e<256)&&(r=c[e])?r:(n=i(e,(0|e)<0?-1:0,!0),o&&(c[e]=n),n):(o=(e|=0)>=-128&&e<128)&&(r=a[e])?r:(n=i(e,e<0?-1:0,!1),o&&(a[e]=n),n)}function r(e,t){if(isNaN(e)||!isFinite(e))return t?g:p;if(t){if(e<0)return g;if(e>=l)return E}else{if(-h>=e)return T;if(e+1>=h)return y}return e<0?r(-e,t).neg():i(0|e%d,0|e/d,t)}function i(t,n,r){return new e(t,n,r)}function o(e,t,n){var i,s,a,c,d,l,h;if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return p;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||n>36)throw RangeError("radix");if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return o(e.substring(1),t,n).neg();for(s=r(u(n,8)),a=p,c=0;c<e.length;c+=8)d=Math.min(8,e.length-c),l=parseInt(e.substring(c,c+d),n),d<8?(h=r(u(n,d)),a=a.mul(h).add(r(l))):a=(a=a.mul(s)).add(r(l));return a.unsigned=t,a}function s(t){return t instanceof e?t:"number"==typeof t?r(t):"string"==typeof t?o(t):i(t.low,t.high,t.unsigned)}var a,c,u,d,l,h,f,p,g,m,v,_,y,E,T,C;return e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),e.isLong=t,a={},c={},e.fromInt=n,e.fromNumber=r,e.fromBits=i,u=Math.pow,e.fromString=o,e.fromValue=s,h=(l=(d=4294967296)*d)/2,f=n(16777216),p=n(0),e.ZERO=p,g=n(0,!0),e.UZERO=g,m=n(1),e.ONE=m,v=n(1,!0),e.UONE=v,_=n(-1),e.NEG_ONE=_,y=i(-1,2147483647,!1),e.MAX_VALUE=y,E=i(-1,-1,!0),e.MAX_UNSIGNED_VALUE=E,T=i(0,-2147483648,!1),e.MIN_VALUE=T,(C=e.prototype).toInt=function(){return this.unsigned?this.low>>>0:this.low},C.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},C.toString=function(e){var t,n,i,o,s,a,c,d;if((e=e||10)<2||e>36)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())return this.eq(T)?(t=r(e),i=(n=this.div(t)).mul(t).sub(this),n.toString(e)+i.toInt().toString(e)):"-"+this.neg().toString(e);for(o=r(u(e,6),this.unsigned),s=this,a="";;){if(c=s.div(o),d=(s.sub(c.mul(o)).toInt()>>>0).toString(e),(s=c).isZero())return d+a;for(;d.length<6;)d="0"+d;a=""+d+a}},C.getHighBits=function(){return this.high},C.getHighBitsUnsigned=function(){return this.high>>>0},C.getLowBits=function(){return this.low},C.getLowBitsUnsigned=function(){return this.low>>>0},C.getNumBitsAbs=function(){var e,t;if(this.isNegative())return this.eq(T)?64:this.neg().getNumBitsAbs();for(e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},C.isZero=function(){return 0===this.high&&0===this.low},C.isNegative=function(){return!this.unsigned&&this.high<0},C.isPositive=function(){return this.unsigned||this.high>=0},C.isOdd=function(){return 1==(1&this.low)},C.isEven=function(){return 0==(1&this.low)},C.equals=function(e){return t(e)||(e=s(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},C.eq=C.equals,C.notEquals=function(e){return!this.eq(e)},C.neq=C.notEquals,C.lessThan=function(e){return this.comp(e)<0},C.lt=C.lessThan,C.lessThanOrEqual=function(e){return this.comp(e)<=0},C.lte=C.lessThanOrEqual,C.greaterThan=function(e){return this.comp(e)>0},C.gt=C.greaterThan,C.greaterThanOrEqual=function(e){return this.comp(e)>=0},C.gte=C.greaterThanOrEqual,C.compare=function(e){if(t(e)||(e=s(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},C.comp=C.compare,C.negate=function(){return!this.unsigned&&this.eq(T)?T:this.not().add(m)},C.neg=C.negate,C.add=function(e){var n,r,o,a,c,u,d,l,h,f,p;return t(e)||(e=s(e)),n=this.high>>>16,r=65535&this.high,o=this.low>>>16,a=65535&this.low,c=e.high>>>16,u=65535&e.high,d=e.low>>>16,l=0,h=0,f=0,p=0,f+=(p+=a+(65535&e.low))>>>16,h+=(f+=o+d)>>>16,l+=(h+=r+u)>>>16,l+=n+c,i((f&=65535)<<16|(p&=65535),(l&=65535)<<16|(h&=65535),this.unsigned)},C.subtract=function(e){return t(e)||(e=s(e)),this.add(e.neg())},C.sub=C.subtract,C.multiply=function(e){var n,o,a,c,u,d,l,h,g,m,v,_;return this.isZero()?p:(t(e)||(e=s(e)),e.isZero()?p:this.eq(T)?e.isOdd()?T:p:e.eq(T)?this.isOdd()?T:p:this.isNegative()?e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg():e.isNegative()?this.mul(e.neg()).neg():this.lt(f)&&e.lt(f)?r(this.toNumber()*e.toNumber(),this.unsigned):(n=this.high>>>16,o=65535&this.high,a=this.low>>>16,c=65535&this.low,u=e.high>>>16,d=65535&e.high,l=e.low>>>16,g=0,m=0,v=0,_=0,v+=(_+=c*(h=65535&e.low))>>>16,m+=(v+=a*h)>>>16,v&=65535,m+=(v+=c*l)>>>16,g+=(m+=o*h)>>>16,m&=65535,g+=(m+=a*l)>>>16,m&=65535,g+=(m+=c*d)>>>16,g+=n*h+o*l+a*d+c*u,i((v&=65535)<<16|(_&=65535),(g&=65535)<<16|(m&=65535),this.unsigned)))},C.mul=C.multiply,C.divide=function(e){var n,i,o,a,c,d,l;if(t(e)||(e=s(e)),e.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?g:p;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return g;if(e.gt(this.shru(1)))return v;o=g}else{if(this.eq(T))return e.eq(m)||e.eq(_)?T:e.eq(T)?m:(n=this.shr(1).div(e).shl(1)).eq(p)?e.isNegative()?m:_:(i=this.sub(e.mul(n)),o=n.add(i.div(e)));if(e.eq(T))return this.unsigned?g:p;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=p}for(i=this;i.gte(e);){for(n=Math.max(1,Math.floor(i.toNumber()/e.toNumber())),c=(a=Math.ceil(Math.log(n)/Math.LN2))<=48?1:u(2,a-48),l=(d=r(n)).mul(e);l.isNegative()||l.gt(i);)l=(d=r(n-=c,this.unsigned)).mul(e);d.isZero()&&(d=m),o=o.add(d),i=i.sub(l)}return o},C.div=C.divide,C.modulo=function(e){return t(e)||(e=s(e)),this.sub(this.div(e).mul(e))},C.mod=C.modulo,C.not=function(){return i(~this.low,~this.high,this.unsigned)},C.and=function(e){return t(e)||(e=s(e)),i(this.low&e.low,this.high&e.high,this.unsigned)},C.or=function(e){return t(e)||(e=s(e)),i(this.low|e.low,this.high|e.high,this.unsigned)},C.xor=function(e){return t(e)||(e=s(e)),i(this.low^e.low,this.high^e.high,this.unsigned)},C.shiftLeft=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?i(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):i(0,this.low<<e-32,this.unsigned)},C.shl=C.shiftLeft,C.shiftRight=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?i(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):i(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},C.shr=C.shiftRight,C.shiftRightUnsigned=function(e){var n;return t(e)&&(e=e.toInt()),0==(e&=63)?this:(n=this.high,e<32?i(this.low>>>e|n<<32-e,n>>>e,this.unsigned):i(32===e?n:n>>>e-32,0,this.unsigned))},C.shru=C.shiftRightUnsigned,C.toSigned=function(){return this.unsigned?i(this.low,this.high,!1):this},C.toUnsigned=function(){return this.unsigned?this:i(this.low,this.high,!0)},C.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},C.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,255&t>>>8,255&t>>>16,255&t>>>24,255&e,255&e>>>8,255&e>>>16,255&e>>>24]},C.toBytesBE=function(){var e=this.high,t=this.low;return[255&e>>>24,255&e>>>16,255&e>>>8,255&e,255&t>>>24,255&t>>>16,255&t>>>8,255&t]},e}()),bn));wn.getModule=function(e){var t=new wn[e];return t.getArrayData=function(){var e=t.toArrayBuffer();return ie(e)?[].slice.call(new Int8Array(e)):e},t},function(e){e[e.ALL=1]="ALL",e[e.SINGAL=2]="SINGAL"}(In||(In={}));var Nn,An=In;!function(e){e.TextMessage="RC:TxtMsg",e.VOICE="RC:VcMsg",e.HQ_VOICE="RC:HQVCMsg",e.IMAGE="RC:ImgMsg",e.GIF="RC:GIFMsg",e.RICH_CONTENT="RC:ImgTextMsg",e.LOCATION="RC:LBSMsg",e.FILE="RC:FileMsg",e.SIGHT="RC:SightMsg",e.COMBINE="RC:CombineMsg",e.CHRM_KV_NOTIFY="RC:chrmKVNotiMsg",e.LOG_COMMAND="RC:LogCmdMsg",e.EXPANSION_NOTIFY="RC:MsgExMsg",e.REFERENCE="RC:ReferenceMsg",e.RECALL="RC:RcCmd",e.READ_RECEIPT="RC:ReadNtf",e.READ_RECEIPT_REQUEST="RC:RRReqMsg",e.READ_RECEIPT_RESPONSE="RC:RRRspMsg",e.SYNC_READ_STATUS="RC:SRSMsg",e.GROUP_READ_RECEIPT_REQUEST="RC:RRMsg"}(Nn||(Nn={}));var Mn,Pn=Nn;!function(e){e[e.OPEN=1]="OPEN",e[e.CLOSE=2]="CLOSE"}(Mn||(Mn={}));var kn,Ln,xn,Un,Dn,jn,Vn=Mn,Bn="pgMsgP",Fn="chatMsg",Hn="pcMsgP",Gn={PRIVATE:"ppMsgS",GROUP:"pgMsgS",CHATROOM:"chatMsgS"},Yn="delMsg",qn="joinChrm",Kn="joinChrmR",Wn="exitChrm",$n="setKV",Jn="delKV",zn="qryRelationR",Qn="delRelation",Zn="setSeAtt",Xn={PRIVATE:"cleanPMsg",GROUP:"cleanGMsg",CUSTOMER_SERVICE:"cleanCMsg",SYSTEM:"cleanSMsg"},er="qryPMsg",tr="qryGMsg",nr="qryCHMsg",rr="qryCMsg",ir="qrySMsg",or=((kn={})["ppMsgP"]=J.PRIVATE,kn[Bn]=J.GROUP,kn[Fn]=J.CHATROOM,kn[Hn]=J.CUSTOMER_SERVICE,kn),sr=((Ln={})[J.PRIVATE]=er,Ln[J.GROUP]=tr,Ln[J.CHATROOM]=nr,Ln[J.CUSTOMER_SERVICE]=rr,Ln[J.SYSTEM]=ir,Ln),ar=((xn={})[J.PRIVATE]=Xn.PRIVATE,xn[J.GROUP]=Xn.GROUP,xn[J.CUSTOMER_SERVICE]=Xn.CUSTOMER_SERVICE,xn[J.SYSTEM]=Xn.SYSTEM,xn),cr="1",ur="0",dr=1,lr=2,hr=3;!function(e){e[e.RTC=0]="RTC",e[e.LIVE=2]="LIVE"}(Un||(Un={})),function(e){e[e.AUDIO_AND_VIDEO=0]="AUDIO_AND_VIDEO",e[e.AUDIO=1]="AUDIO"}(Dn||(Dn={})),function(e){e[e.ANCHOR=1]="ANCHOR",e[e.AUDIENCE=2]="AUDIENCE"}(jn||(jn={}));var fr,pr,gr,mr={"RC:VCAccept":"RC:VCAccept","RC:VCRinging":"RC:VCRinging","RC:VCSummary":"RC:VCSummary","RC:VCHangup":"RC:VCHangup","RC:VCInvite":"RC:VCInvite","RC:VCModifyMedia":"RC:VCModifyMedia","RC:VCModifyMem":"RC:VCModifyMem"};!function(e){e[e.ROOM=1]="ROOM",e[e.PERSON=2]="PERSON"}(fr||(fr={})),function(e){e[e.AnchorToViewer=1]="AnchorToViewer",e[e.ViewerToAnchor=2]="ViewerToAnchor"}(pr||(pr={})),function(e){e[e.SEND=1]="SEND",e[e.RECEIVE=2]="RECEIVE"}(gr||(gr={}));var vr,_r=gr,yr=function(){function e(e){this._codec="websocket"===e?wn:Tn,this._connectType=e}return e.prototype.decodeByPBName=function(e,t,n){var r,i=this,o=e,s=((r={})[it]=i._formatSyncMessages,r[rt]=i._formatReceivedMessage,r[tt]=i._formatSentMessage,r[lt]=i._formatHistoryMessages,r[ft]=i._formatConversationList,r[Rt]=i._formatChatRoomInfos,r[bt]=i._formatRTCUserList,r[kt]=i._formatRTCData,r[Wt]=i._formatChatRoomKVList,r[Zt]=i._formatUserSetting,r[tn]=i._formatConversationStatus,r[un]=i._formatGrpReadReceiptQryResp,r[zt]=i._formatSetUserSettingOutput,r[Xt]=i._formatUserSettingNotification,r[yn]=i._formatRTCRoomKVList,r[Pt]=i._formatRTCAuidenceJoinRoomData,r)[t];try{o=e.length>0&&i._codec[t].decode(e),ae(o)&&(o=function(e){for(var t in e)ae(e[t])&&(e[t]=we(e[t]));return e}(o)),ce(s)&&(o=s.call(this,o,n))}catch(n){ye.error("PB parse error\n",n,e,t)}return o},e.prototype._readBytes=function(e){var t=e.offset,n=e.buffer,r=e.limit;if(t)try{var i=ie(n)?new Uint8Array(n):n;return Ze.readUTF(i.subarray(t,r))}catch(e){ye.info("readBytes error\n",e)}return e},e.prototype._formatBytes=function(e){var t=this._readBytes(e);try{t=JSON.parse(t)}catch(e){ye.info("formatBytes error\n",e)}return t||e},e.prototype._formatSyncMessages=function(e,t){t=t||{};var n=this,r=e.list,i=e.syncTime,o=e.finished;return(ue(o)||null===o)&&(e.finished=!0),e.syncTime=we(i),e.list=Ue(r,(function(e){return n._formatReceivedMessage(e,t)})),e},e.prototype._formatReceivedMessage=function(e,t){var n=(t=t||{}).currentUserId,r=t.connectedTime,i=e.content,o=e.fromUserId,a=e.type,c=e.groupId,u=e.status,d=e.dataTime,l=e.classname,h=e.msgId,f=e.extraContent,p=e.pushContent,g=e.pushExt,m=e.configFlag,v=(e.direction||_r.RECEIVE)===_r.SEND,_=function(e){var t=s.READ;return{isPersited:!!(16&e),isCounted:!!(32&e),isMentioned:!!(64&e),disableNotification:!!(512&e),receivedStatus:t=2&e?s.RETRIEVED:t,canIncludeExpansion:!!(1024&e)}}(u),y=_.isPersited,E=_.isCounted,T=_.isMentioned,C=_.disableNotification,R=_.receivedStatus,S=_.canIncludeExpansion,b=[J.GROUP,J.CHATROOM,J.RTC_ROOM].indexOf(a)>-1?c:o,I=v?n:o,O=we(d),w=O<r,N=a===J.CHATROOM,M=this._formatBytes(i),P={};g&&(P=Pe(g.pushConfigs,g.pushId));var k,L=A(A({},P),{pushTitle:null==g?void 0:g.title,pushContent:p,pushData:p,disablePushTitle:!!m&&Boolean(4&m),forceShowDetailContent:!!m&&Boolean(8&m),templateId:null==g?void 0:g.templateId}),x=v?_r.SEND:_r.RECEIVE;return N&&o===n&&(x=_r.SEND),f&&(k={},k=$e(f)),{conversationType:a,targetId:b,senderUserId:I,messageType:l,messageUId:h,isPersited:y,isCounted:E,isMentioned:T,sentTime:O,isOffLineMessage:w,messageDirection:x,receivedTime:Je.getTime(),disableNotification:C,receivedStatus:R,canIncludeExpansion:S,content:M,expansion:k,configFlag:m,pushConfig:L}},e.prototype._formatSentMessage=function(e,t){var n,r=e.content,i=e.classname,o=e.sessionId,s=e.msgId,a=e.extraContent,c=e.pushExt,u=e.pushContent,d=e.configFlag,l=t.signal,h=t.currentUserId,f=l.date,p=l.topic,g=l.targetId,m=function(e){return{isPersited:!!(1&e),isCounted:!!(2&e),disableNotification:!!(32&e),canIncludeExpansion:!!(64&e)}}(o),v=m.isPersited,_=m.isCounted,y=m.disableNotification,E=m.canIncludeExpansion,T=or[p]||J.PRIVATE,C=Ve(Gn,p);a&&(n={},n=$e(a));var R={};c&&(R=Pe(c.pushConfigs,c.pushId));var S=A(A({},R),{pushTitle:null==c?void 0:c.title,pushContent:u,pushData:u,disablePushTitle:!!d&&Boolean(4&d),forceShowDetailContent:!!d&&Boolean(8&d),templateId:null==c?void 0:c.templateId});return{conversationType:T,targetId:g,messageType:i,messageUId:s,isPersited:v,isCounted:_,isStatusMessage:C,senderUserId:h,content:this._formatBytes(r),sentTime:1e3*f,receivedTime:Je.getTime(),messageDirection:_r.SEND,isOffLineMessage:!1,disableNotification:y,canIncludeExpansion:E,expansion:n,pushConfig:S}},e.prototype._formatHistoryMessages=function(e,t){var n=this,r=t.conversation||{},i=e.list,o=e.hasMsg,s=r.targetId,a=we(e.syncTime),c=[];return xe(i,(function(e){var r=n._formatReceivedMessage(e,t);r.targetId=s,c.push(r)}),{isReverse:!0}),{syncTime:a,list:c,hasMore:!!o}},e.prototype._formatConversationList=function(e,t){var n=this,r=e.info,i=t.afterDecode||function(){};return(r=Ue(r,(function(e){var r=e.msg,o=e.userId,s=e.type,a=e.unreadCount,c=e.channelId,u=n._formatReceivedMessage(r,t);u.targetId=o;var d={targetId:o,conversationType:s,unreadMessageCount:a,latestMessage:u,channelId:c||""};return i(d)||d})))||[]},e.prototype._formatSetUserSettingOutput=function(e){return e},e.prototype._formatChatRoomInfos=function(e){var t=e.userTotalNums,n=e.userInfos;return{userCount:t,userInfos:Ue(n,(function(e){var t=e.id,n=e.time;return{id:t,time:we(n)}}))}},e.prototype._formatChatRoomKVList=function(e){var t=e.entries,n=e.bFullUpdate,r=e.syncTime;return{kvEntries:t=Ue(t=t||[],(function(e){var t=e.key,n=e.value,r=e.status,i=e.timestamp,o=e.uid,s=function(e){return{isAutoDelete:!!(1&e),isOverwrite:!!(2&e),type:4&e?We.DELETE:We.UPDATE}}(r);return{key:t,value:n,isAutoDelete:s.isAutoDelete,isOverwrite:s.isOverwrite,type:s.type,userId:o,timestamp:we(i)}})),isFullUpdate:n,syncTime:r}},e.prototype._formatUserSetting=function(e){var t=this,n=e.items,r=e.version,i={};return xe(n||[],(function(e){var n=e.key,r=e.version,o=e.value;e.version=we(r),e.value=t._readBytes(o),"Tag"===n&&e.tags.forEach((function(e){e.createdTime=we(e.createdTime),e.tagName=e.name})),i[n]=e})),{settings:i,version:r}},e.prototype._formatConversationStatus=function(e){var t=e.state,n=[];return xe(t,(function(e){var t=e.type,r=e.channelId,i=e.time,o=e.stateItem,s=Vn.CLOSE,a=!1,c=[];xe(o,(function(e){var t=e.sessionStateType,n=e.value,r=e.tags;switch(t){case dr:s=n===cr?Vn.OPEN:Vn.CLOSE;break;case lr:a=n===cr;break;case hr:c=r}})),n.push({type:t,targetId:r,notificationStatus:s,isTop:a,updatedTime:we(i),tags:c})})),n},e.prototype._formatRTCUserList=function(e){var t=e.list,n=e.token,r=e.sessionId,i={};return xe(t,(function(e){var t=e.userId,n=e.userData,r={};xe(n,(function(e){var t=e.key,n=e.value;r[t]=n})),i[t]=r})),{users:i,token:n,sessionId:r}},e.prototype._formatRTCData=function(e){var t=e.outInfo,n={};return xe(t,(function(e){n[e.key]=e.value})),n},e.prototype._formatRTCRoomInfo=function(e){var t=e.roomId,n=e.userCount,r=e.roomData,i={id:t,total:n};return xe(r,(function(e){i[e.key]=e.value})),i},e.prototype._formatGrpReadReceiptQryResp=function(e){var t=e.totalMemberNum,n=e.list;return n.forEach((function(e){e.readTime=we(e.readTime)})),{totalMemberCount:t,list:n}},e.prototype._formatUserSettingNotification=function(e){return e},e.prototype._formatRTCRoomKVList=function(e){var t=e.entries,n=e.bFullUpdate,r=e.syncTime;return{kvEntries:t=(t=t||[]).map((function(e){var t=e.timestamp;return Object.assign(e,{timestamp:we(t)})})),isFullUpdate:n,syncTime:r}},e.prototype._formatRTCAuidenceJoinRoomData=function(e){return e},e.prototype.encodeServerConfParams=function(){var e=this._codec.getModule(ot);return e.setNothing(1),e.getArrayData()},e.prototype._getUpMsgModule=function(e,t){var n="comet"===this._connectType,r=e.type,i=t.messageType,o=t.isMentioned,s=t.mentionedType,a=t.mentionedUserIdList,c=t.content,u=t.pushContent,d=t.directionalUserIdList,l=t.isFilerWhiteBlacklist,h=t.isVoipPush,f=t.canIncludeExpansion,p=t.expansion,g=t.pushConfig,m=r===J.GROUP,v=this._codec.getModule(tt),_=function(e){var t=e.isStatusMessage,n=e.isPersited,r=e.isCounted;t&&(n=r=!1);var i=0;return n&&(i|=1),r&&(i|=2),e.isMentioned&&(i|=4),e.disableNotification&&(i|=32),e.canIncludeExpansion&&(i|=64),i}(t),y=g||{},E=y.pushTitle,T=y.pushData,C=y.iOSConfig,R=y.androidConfig,S=y.templateId,b=y.disablePushTitle,I=y.forceShowDetailContent,O=0;if(v.setSessionId(_),m&&o&&c&&(c.mentionedInfo={userIdList:a,type:s||An.ALL}),u&&v.setPushText(u),T&&v.setAppData(T),d&&v.setUserId(d),O|=h?1:0,O|=l?2:0,O|=b?4:0,O|=I?8:0,v.setConfigFlag(O),v.setClassname(i),v.setContent(JSON.stringify(c)),f&&p){var w={};xe(p,(function(e,t){w[t]={v:e}})),v.setExtraContent(JSON.stringify(w))}if(g){var N=this._codec.getModule(nt);if(E&&N.setTitle(E),C&&R){var A=Me(C,R);N.setPushConfigs(A)}(null==R?void 0:R.notificationId)&&N.setPushId(null==R?void 0:R.notificationId),N.setTemplateId(S||""),v.setPushExt(n?N.getArrayData():N)}return v},e.prototype.encodeUpMsg=function(e,t){return this._getUpMsgModule(e,t).getArrayData()},e.prototype.encodeSyncMsg=function(e){var t=e.sendboxTime,n=e.inboxTime,r=this._codec.getModule(at);return r.setIspolling(!1),r.setIsPullSend(!0),r.setSendBoxSyncTime(t),r.setSyncTime(n),r.getArrayData()},e.prototype.encodeChrmSyncMsg=function(e,t){e=e||0,t=t||0;var n=this._codec.getModule(ct);return n.setCount(t),n.setSyncTime(e),n.getArrayData()},e.prototype.encodeGetHistoryMsg=function(e,t){var n=t.count,r=t.order,i=t.timestamp,o=this._codec.getModule(dt);return o.setTargetId(e),o.setTime(i),o.setCount(n),o.setOrder(r),o.getArrayData()},e.prototype.encodeGetConversationList=function(e){var t=(e=e||{}).count,n=e.startTime,r=this._codec.getModule(ht);return r.setType(1),r.setCount(t),r.setStartTime(n),r.getArrayData()},e.prototype.encodeOldConversationList=function(e){var t=(e=e||{}).count,n=e.type,r=e.startTime,i=e.order;t=t||0,r=r||0,i=i||0;var o=this._codec.getModule(ht);return o.setType(n),o.setCount(t),o.setStartTime(r),o.setOrder(i),o.getArrayData()},e.prototype.encodeRemoveConversationList=function(e){var t=this,n=this._codec.getModule(pt),r=[];return xe(e,(function(e){var n=e.type,i=e.targetId,o=t._codec.getModule(gt);o.setType(n),o.setChannelId(i),r.push(o)})),n.setSessions(r),n.getArrayData()},e.prototype.encodeDeleteMessages=function(e,t,n){var r=this._codec.getModule(_t),i=[];return xe(n,(function(e){i.push({msgId:e.messageUId,msgDataTime:e.sentTime,direct:e.messageDirection})})),r.setType(e),r.setConversationId(t),r.setMsgs(i),r.getArrayData()},e.prototype.encodeClearMessages=function(e,t){var n=this._codec.getModule(yt);return t=t||(new Date).getTime(),n.setDataTime(t),n.setTargetId(e),n.getArrayData()},e.prototype.encodeClearUnreadCount=function(e,t){var n=e.type,r=e.targetId,i=t.timestamp,o=this._codec.getModule(Et);return i=i||+new Date,o.setType(n),o.setChannelId(r),o.setMsgTime(i),o.getArrayData()},e.prototype.encodeJoinOrQuitChatRoom=function(){var e=this._codec.getModule(Tt);return e.setNothing(1),e.getArrayData()},e.prototype.encodeGetChatRoomInfo=function(e,t){var n=this._codec.getModule(Ct);return n.setCount(e),n.setOrder(t),n.getArrayData()},e.prototype.encodeGetFileToken=function(e,t,n,r){var i=this._codec.getModule(Bt);return i.setType(e),i.setKey(t),i.setHttpMethod(n),i.setQueryString(r),i.getArrayData()},e.prototype.encodeGetFileUrl=function(e,t,n,r){var i=this._codec.getModule(e);return i.setType(t),i.setKey(n),r&&i.setFileName(r),i.getArrayData()},e.prototype.encodeModifyChatRoomKV=function(e,t,n){var r="comet"===this._connectType,i=this._codec.getModule(Kt),o=t.key,s=t.value,a=t.notificationExtra,c=t.isSendNotification,u=t.type||We.UPDATE,d=function(e,t){var n=0;return e.isAutoDelete&&(n|=1),e.isOverwrite&&(n|=2),2===t&&(n|=4),n}(t,u),l={key:o,value:s||"",uid:n};if(ue(d)||(l.status=d),i.setEntry(l),c){var h={type:J.CHATROOM,targetId:e},f={key:o,value:s,extra:a,type:u},p=this._getUpMsgModule(h,{messageType:Pn.CHRM_KV_NOTIFY,content:f,isPersited:!1,isCounted:!1});r?i.setNotification(p.getArrayData()):i.setNotification(p),i.setBNotify(!0),i.setType(J.CHATROOM)}return i.getArrayData()},e.prototype.encodePullChatRoomKV=function(e){var t=this._codec.getModule($t);return t.setTimestamp(e),t.getArrayData()},e.prototype.encodePullUserSetting=function(e){var t=this._codec.getModule(Qt);return t.setVersion(e),t.getArrayData()},e.prototype.encodeGetConversationStatus=function(e){var t=this._codec.getModule(en);return t.setTime(e),t.getArrayData()},e.prototype.encodeSetConversationStatus=function(e){var t=this,n="comet"===this._connectType,r=this._codec.getModule(on),i=Je.getTime(),o=[];return xe(e,(function(e){var r=t._codec.getModule(nn),s=e.conversationType,a=e.targetId,c=e.notificationStatus,u=e.isTop,d=[];r.setType(s),r.setChannelId(a),r.setTime(i);var l=c===Vn.OPEN,h={};ue(c)||(h[dr]=l),ue(u)||(h[lr]=u),xe(h,(function(e,r){if(!ue(e)){var i=t._codec.getModule(rn);e=e?cr:ur,i.setSessionStateType(Number(r)),i.setValue(e);var o=n?i.getArrayData():i;d.push(o)}})),r.setStateItem(d);var f=n?r.getArrayData():r;o.push(f)})),r.setVersion(i),r.setState(o),r.getArrayData()},e.prototype.encodeReadReceipt=function(e,t){var n=this._codec.getModule(an);return n.setMsgId(e),t&&n.setChannelId(t),n.getArrayData()},e.prototype.encodeCreateTag=function(e,t){var n=this,r="comet"===this._connectType,i=this._codec.getModule(ln),o=[];return e.forEach((function(e){var t=n._codec.getModule(hn);t.setTagId(e.tagId),t.setName(e.tagName),o.push(r?t.getArrayData():t)})),i.setTags(o),i.setVersion(t),i.getArrayData()},e.prototype.encodeMessageReader=function(e,t){var n=this._codec.getModule(an);return n.setMsgId(e),t&&n.setChannelId(t),n.getArrayData()},e.prototype.encodeRemoveTag=function(e,t){var n=this,r="comet"===this._connectType,i=this._codec.getModule(fn),o=[];return e.forEach((function(e){var t=n._codec.getModule(hn);t.setTagId(e),o.push(r?t.getArrayData():t)})),i.setTags(o),i.setVersion(t),i.getArrayData()},e.prototype.encodeDisConversationTag=function(e){var t=this._codec.getModule(pn);return t.setTagId(e),t.getArrayData()},e.prototype.encodeUpdateConversationTag=function(e,t){var n=this,r="comet"===this._connectType,i=this._codec.getModule(on),o=[];return t.forEach((function(t){var i=n._codec.getModule(nn),s=n._codec.getModule(rn),a=[];e.forEach((function(e){var t=n._codec.getModule(hn);t.setTagId(e.tagId),ue(e.isTop)||t.setIsTop(e.isTop),a.push(r?t.getArrayData():t)})),s.setSessionStateType(hr),s.setValue(JSON.stringify(a)),s.setTags(a),i.setType(t.type),i.setChannelId(t.targetId),i.setTime(Date.now()),i.setStateItem([r?s.getArrayData():s]),o.push(r?i.getArrayData():i)})),i.setState(o),i.setVersion(Je.getTime()),i.getArrayData()},e.prototype.encodeReportSDKInfo=function(e){var t=this._codec.getModule(gn);return t.setSdkInfo(e),t.getArrayData()},e.prototype.encodeJoinRTCRoom=function(e,t){var n=this._codec.getModule(St);return e=e||0,n.setRoomType(e),ue(t)||n.setBroadcastType(t),n.getArrayData()},e.prototype.encodeQuitRTCRoom=function(){return this._codec.getModule(It).getArrayData()},e.prototype.encodeSetRTCData=function(e,t,n,r,i){var o=this._codec.getModule(Ot);if(o.setInterior(n),o.setTarget(r),o.setKey(e),o.setValue(t),i){i.name&&o.setObjectName(i.name);var s=i.content;s&&(ae(s)&&(s=JSON.stringify(s)),o.setContent(s))}return o.getArrayData()},e.prototype.encodeUserSetRTCData=function(e,t,n,r){var i=this,o=this._codec.getModule(wt);o.setObjectName(n);var s=this._codec.getModule(jt);s.setKey(e.name),s.setValue(e.content),o.setContent(s);var a=[];return["uris","mcu_uris"].forEach((function(e){var n=i._codec.getModule(jt);n.setKey(e),"uris"===e?n.setValue(t):n.setValue(r),a.push(n)})),o.setValueInfo(a),o.getArrayData()},e.prototype.encodeGetRTCData=function(e,t,n){var r=this._codec.getModule(Nt);return r.setInterior(t),r.setTarget(n),r.setKey(e),r.getArrayData()},e.prototype.encodeRemoveRTCData=function(e,t,n,r){var i=this._codec.getModule(Nt);i.setInterior(t),i.setTarget(n),i.setKey(e);var o=(r=r||{}).name,s=r.content;return!ue(o)&&i.setObjectName(o),ue(s)||(ae(s)&&(s=JSON.stringify(s)),i.setContent(s)),i.getArrayData()},e.prototype.encodeSetRTCOutData=function(e,t,n){var r=this._codec.getModule(At);r.setTarget(t),re(e)||(e=[e]),xe(e,(function(t,n){t.key=t.key?t.key.toString():t.key,t.value=t.value?t.value.toString():t.value,e[n]=t})),r.setValueInfo(e);var i=(n=n||{}).name,o=n.content;return!ue(i)&&r.setObjectName(i),ue(o)||(ae(o)&&(o=JSON.stringify(o)),r.setContent(o)),r.getArrayData()},e.prototype.ecnodeGetRTCOutData=function(e){var t=this._codec.getModule(Lt);return t.setUserId(e),t.getArrayData()},e.prototype.encodeSetRTCState=function(e){var t=this._codec.getModule(Mt);return t.setId(e),t.getArrayData()},e.prototype.encodeGetRTCRoomInfo=function(){var e=this._codec.getModule(Ut);return e.setOrder(2),e.getArrayData()},e.prototype.encodeSetRTCUserInfo=function(e,t){var n=this._codec.getModule(jt);return n.setKey(e),n.setValue(t),n.getArrayData()},e.prototype.encodeRemoveRTCUserInfo=function(e){var t=this._codec.getModule(Vt);return t.setKey(e),t.getArrayData()},e.prototype.encodeIdentityChangeInfo=function(e,t,n){void 0===n&&(n=!1);var r=this._codec.getModule(St);return r.setRoomType(Un.LIVE),t&&r.setBroadcastType(t),r.setIdentityChangeType(e),r.setNeedSysChatroom(n),r.getArrayData()},e.prototype.encodePullRTCRoomKV=function(e,t){var n=this._codec.getModule(_n);return n.setTimestamp(t),n.setRoomId(e),n.getArrayData()},e}(),Er=function(e,t){this._watcher=t,this.codec=new yr(e)},Tr=function(e,t){return e&&t?t+"_"+e:e||Date.now()},Cr=function(){function e(e){this.header=e,this._name=null,this.lengthSize=0,this.messageId=0,this.timestamp=0,this.syncMsg=!1,this.identifier=""}return e.prototype.getIdentifier=function(){var e=this.messageId,t=this.identifier;return Tr(e,t)},e.prototype.read=function(e,t){this.readMessage(e,t)},e.prototype.readMessage=function(e,t){return{stream:e,length:t}},e}(),Rr=function(){function e(e){this.lengthSize=0,this.messageId=0,this.topic="",this.targetId="",this.identifier="",this._header=new Qe(e,!1,Ge.AT_MOST_ONCE,!1)}return e.prototype.getIdentifier=function(){var e=this.messageId,t=this.identifier;return Tr(e,t)},e.prototype.write=function(e){var t=this.getHeaderFlag();e.write(t),this.writeMessage(e)},e.prototype.setHeaderQos=function(e){this._header.qos=e},e.prototype.getHeaderFlag=function(){return this._header.encode()},e.prototype.getLengthSize=function(){return this.lengthSize},e.prototype.getBufferData=function(){var e=new et;this.write(e);var t=e.getBytesArray();return new Int8Array(t)},e.prototype.getCometData=function(){var e=this.data||{};return JSON.stringify(e)},e}(),Sr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name=qe.CONN_ACK,t.status=null,t.userId=null,t.timestamp=0,t}return N(t,e),t.prototype.readMessage=function(e,n){if(e.readByte(),this.status=+e.readByte(),n>t.MESSAGE_LENGTH){this.userId=e.readUTF();var r=e.readUTF();ye.debug("server sessionId -> "+r),this.timestamp=e.readLong()}return{stream:e,length:n}},t.MESSAGE_LENGTH=2,t}(Cr),br=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name=qe.DISCONNECT,t.status=0,t}return N(t,e),t.prototype.readMessage=function(e,t){return e.readByte(),this.status=+e.readByte(),{stream:e,length:t}},t.MESSAGE_LENGTH=2,t}(Cr),Ir=function(e){function t(){var t=e.call(this,Ye.PING_REQ)||this;return t._name=qe.PING_REQ,t}return N(t,e),t.prototype.writeMessage=function(e){},t}(Rr),Or=function(e){function t(t){var n=e.call(this,t)||this;return n._name=qe.PING_RESP,n}return N(t,e),t}(Cr),wr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.messageId=0,t}return N(t,e),t.prototype.readMessage=function(e,t){var n=256*e.readByte()+e.readByte();return this.messageId=parseInt(n.toString(),10),{stream:e,length:t}},t}(Cr),Nr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.messageId=0,t}return N(t,e),t.prototype.writeMessage=function(e){var t=this.messageId,n=255&t,r=(65280&t)>>8;e.write(r),e.write(n)},t}(Rr),Ar=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name=qe.PUBLISH,t.topic="",t.targetId="",t.syncMsg=!1,t.identifier=Ke.PUB,t}return N(t,e),t.prototype.readMessage=function(t,n){return this.date=t.readInt(),this.topic=t.readUTF(),this.targetId=t.readUTF(),e.prototype.readMessage.call(this,t,n),this.data=t.readAll(),{stream:t,length:n}},t}(wr),Mr=function(e){function t(t,n,r){var i=e.call(this,Ye.PUBLISH)||this;return i._name=qe.PUBLISH,i.syncMsg=!1,i.identifier=Ke.PUB,i.topic=t,i.data=ee(n)?Ze.writeUTF(n):n,i.targetId=r,i}return N(t,e),t.prototype.writeMessage=function(t){t.writeUTF(this.topic),t.writeUTF(this.targetId),e.prototype.writeMessage.call(this,t),t.write(this.data)},t}(Nr),Pr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name=qe.PUB_ACK,t.status=0,t.date=0,t.millisecond=0,t.messageUId="",t.timestamp=0,t.identifier=Ke.PUB,t.topic="",t.targetId="",t}return N(t,e),t.prototype.readMessage=function(t,n){return e.prototype.readMessage.call(this,t,n),this.date=t.readInt(),this.status=256*t.readByte()+t.readByte(),this.millisecond=256*t.readByte()+t.readByte(),this.timestamp=1e3*this.date+this.millisecond,this.messageUId=t.readUTF(),{stream:t,length:n}},t}(wr),kr=function(e){function t(t){var n=e.call(this,Ye.PUB_ACK)||this;return n._name=qe.PUB_ACK,n.status=0,n.date=0,n.millisecond=0,n.messageUId="",n.timestamp=0,n.messageId=t,n}return N(t,e),t.prototype.writeMessage=function(t){e.prototype.writeMessage.call(this,t)},t}(Nr),Lr=function(e){function t(t,n,r){var i=e.call(this,Ye.QUERY)||this;return i.name=qe.QUERY,i.identifier=Ke.QUERY,i.topic=t,i.data=ee(n)?Ze.writeUTF(n):n,i.targetId=r,i}return N(t,e),t.prototype.writeMessage=function(t){t.writeUTF(this.topic),t.writeUTF(this.targetId),e.prototype.writeMessage.call(this,t),t.write(this.data)},t}(Nr),xr=function(e){function t(t){var n=e.call(this,Ye.QUERY_CONFIRM)||this;return n._name=qe.QUERY_CON,n.messageId=t,n}return N(t,e),t}(Nr),Ur=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name=qe.QUERY_ACK,t.status=0,t.identifier=Ke.QUERY,t.topic="",t.targetId="",t}return N(t,e),t.prototype.readMessage=function(t,n){return e.prototype.readMessage.call(this,t,n),this.date=t.readInt(),this.status=256*t.readByte()+t.readByte(),this.data=t.readAll(),{stream:t,length:n}},t}(wr),Dr=function(e){var t,n=e.type;switch(n){case Ye.CONN_ACK:t=new Sr(e);break;case Ye.PUBLISH:(t=new Ar(e)).syncMsg=e.syncMsg;break;case Ye.PUB_ACK:t=new Pr(e);break;case Ye.QUERY_ACK:t=new Ur(e);break;case Ye.SUB_ACK:case Ye.UNSUB_ACK:case Ye.PING_RESP:t=new Or(e);break;case Ye.DISCONNECT:t=new br(e);break;default:t=new Cr(e),ye.error("No support for deserializing "+n+" messages")}return t},jr={ACCEPTED:0,UNACCEPTABLE_PROTOCOL_VERSION:1,IDENTIFIER_REJECTED:2,SERVER_UNAVAILABLE:3,TOKEN_INCORRECT:4,NOT_AUTHORIZED:5,REDIRECT:6,PACKAGE_ERROR:7,APP_BLOCK_OR_DELETE:8,BLOCK:9,TOKEN_EXPIRE:10,DEVICE_ERROR:11,HOSTNAME_ERROR:12,HASOHTERSAMECLIENTONLINE:13};!function(e){e[e.CONNECTED=0]="CONNECTED",e[e.CONNECTING=1]="CONNECTING",e[e.DISCONNECTED=2]="DISCONNECTED",e[e.NETWORK_UNAVAILABLE=3]="NETWORK_UNAVAILABLE",e[e.CONNECTION_CLOSED=4]="CONNECTION_CLOSED",e[e.KICKED_OFFLINE_BY_OTHER_CLIENT=6]="KICKED_OFFLINE_BY_OTHER_CLIENT",e[e.WEBSOCKET_UNAVAILABLE=7]="WEBSOCKET_UNAVAILABLE",e[e.WEBSOCKET_ERROR=8]="WEBSOCKET_ERROR",e[e.BLOCKED=9]="BLOCKED",e[e.DOMAIN_INCORRECT=12]="DOMAIN_INCORRECT",e[e.DISCONNECT_BY_SERVER=13]="DISCONNECT_BY_SERVER",e[e.REDIRECT=14]="REDIRECT",e[e.APPKEY_IS_FAKE=20]="APPKEY_IS_FAKE",e[e.ULTRALIMIT=1101]="ULTRALIMIT",e[e.REQUEST_NAVI=201]="REQUEST_NAVI",e[e.RESPONSE_NAVI=202]="RESPONSE_NAVI",e[e.RESPONSE_NAVI_ERROR=203]="RESPONSE_NAVI_ERROR",e[e.RESPONSE_NAVI_TIMEOUT=204]="RESPONSE_NAVI_TIMEOUT"}(vr||(vr={}));var Vr,Br=vr;!function(e){e[e.ppMsgP=1]="ppMsgP",e[e.ppMsgN=2]="ppMsgN",e[e.ppMsgS=3]="ppMsgS",e[e.pgMsgP=4]="pgMsgP",e[e.chatMsg=5]="chatMsg",e[e.pcMsgP=6]="pcMsgP",e[e.qryPMsg=7]="qryPMsg",e[e.qryGMsg=8]="qryGMsg",e[e.qryCHMsg=9]="qryCHMsg",e[e.qryCMsg=10]="qryCMsg",e[e.qrySMsg=11]="qrySMsg",e[e.recallMsg=12]="recallMsg",e[e.prMsgS=13]="prMsgS",e[e.rrMsg=14]="rrMsg",e[e.rrList=15]="rrList",e[e.s_ntf=16]="s_ntf",e[e.s_msg=17]="s_msg",e[e.s_stat=18]="s_stat",e[e.s_cmd=19]="s_cmd",e[e.s_us=20]="s_us",e[e.pullUS=21]="pullUS",e[e.pgMsgS=22]="pgMsgS",e[e.chatMsgS=23]="chatMsgS",e[e.qrySessionsAtt=24]="qrySessionsAtt",e[e.pullMsg=25]="pullMsg",e[e.qrySessions=26]="qrySessions",e[e.delSessions=27]="delSessions",e[e.delMsg=28]="delMsg",e[e.updRRTime=29]="updRRTime",e[e.chrmPull=30]="chrmPull",e[e.joinChrm=31]="joinChrm",e[e.joinChrmR=32]="joinChrmR",e[e.exitChrm=33]="exitChrm",e[e.queryChrmI=34]="queryChrmI",e[e.setKV=35]="setKV",e[e.delKV=36]="delKV",e[e.pullKV=37]="pullKV",e[e.qryRelation=38]="qryRelation",e[e.delRelation=39]="delRelation",e[e.pullSeAtts=40]="pullSeAtts",e[e.setSeAtt=41]="setSeAtt",e[e.qnTkn=42]="qnTkn",e[e.qnUrl=43]="qnUrl",e[e.aliUrl=44]="aliUrl",e[e.s3Url=45]="s3Url",e[e.stcUrl=46]="stcUrl",e[e.cleanPMsg=47]="cleanPMsg",e[e.cleanGMsg=48]="cleanGMsg",e[e.cleanCMsg=49]="cleanCMsg",e[e.cleanSMsg=50]="cleanSMsg",e[e.rtcRJoin_data=51]="rtcRJoin_data",e[e.rtcRExit=52]="rtcRExit",e[e.rtcPing=53]="rtcPing",e[e.rtcSetData=54]="rtcSetData",e[e.rtc_ntf=55]="rtc_ntf",e[e.viewerJoinR=56]="viewerJoinR",e[e.viewerExitR=57]="viewerExitR",e[e.rtcPullKv=58]="rtcPullKv",e[e.rtcIdentityChange=59]="rtcIdentityChange",e[e.userSetData=60]="userSetData",e[e.rtcQryData=61]="rtcQryData",e[e.rtcDelData=62]="rtcDelData",e[e.rtcSetOutData=63]="rtcSetOutData",e[e.rtcQryUserOutData=64]="rtcQryUserOutData",e[e.rtcToken=65]="rtcToken",e[e.rtcUserState=66]="rtcUserState",e[e.rtcRInfo=67]="rtcRInfo",e[e.rtcUData=68]="rtcUData",e[e.rtcUPut=69]="rtcUPut",e[e.rtcUDel=70]="rtcUDel",e[e.rtcUList=71]="rtcUList",e[e.addSeTag=72]="addSeTag",e[e.delSeTag=73]="delSeTag",e[e.addTag=74]="addTag",e[e.delTag=75]="delTag",e[e.disTag=76]="disTag",e[e.reportsdk=77]="reportsdk"}(Vr||(Vr={}));var Fr,Hr=Vr,Gr=function(e,t,n){return M(void 0,void 0,void 0,(function(){var r;return P(this,(function(i){switch(i.label){case 0:return[4,Promise.all(e.map((function(e){return M(void 0,void 0,void 0,(function(){var r,i;return P(this,(function(o){switch(o.label){case 0:return r=Date.now(),i=t+"://"+e+"/ping?r="+(a=9999,(s=1e3)+Math.floor(Math.random()*(a-s))),[4,n.httpReq({url:i,timeout:5e3})];case 1:return[2,{status:o.sent().status,host:e,cost:Date.now()-r}]}var s,a}))}))})))];case 1:return(r=(r=i.sent()).filter((function(e){return 200===e.status}))).length>1&&(r=r.sort((function(e,t){return e.cost-t.cost}))),[2,r.map((function(e){return e.host}))]}}))}))},Yr=function(e,t,n,r,i,o,s){return e+"://"+t+"/websocket?appId="+n+"&token="+encodeURIComponent(r)+"&sdkVer="+o+"&pid="+s+"&apiVer="+(i.isFromUniapp?"uniapp":"normal")+(i.connectPlatform?"&platform="+i.connectPlatform:"")},qr=function(e){return[Hr.ppMsgS,Hr.pgMsgS,Hr.chatMsgS].map((function(e){return Hr[e]})).indexOf(e)>=0};!function(e){e[e.REDIRECT=0]="REDIRECT",e[e.OTHER_DEVICE_LOGIN=1]="OTHER_DEVICE_LOGIN",e[e.BLOCK=2]="BLOCK",e[e.REMOTE_CLOSE=3]="REMOTE_CLOSE",e[e.LOGOUT=4]="LOGOUT",e[e.BLOCK_NEW=5]="BLOCK_NEW",e[e.REDIRECT_NEW=6]="REDIRECT_NEW"}(Fr||(Fr={}));var Kr,Wr=function(e,t){ye.debug("websocket send -> messageId: "+e.messageId);var n=e.getBufferData();t.send(n.buffer)},$r=function(e){function t(t,n){var r=e.call(this,"websocket",n)||this;return r._runtime=t,r._socket=null,r._messageIds={},r._syncMessageIds={},r._failedCount=0,r.ALLOW_FAILED_TIMES=2,r._timer=null,r._idCount=0,r._generateMessageId=function(){return r._idCount>=65535&&(r._idCount=0),++r._idCount},r}return N(t,e),t.prototype.connect=function(e,t,n,r,i){return M(this,void 0,void 0,(function(){var o,s,a,c,u,d,l,h=this;return P(this,(function(f){switch(f.label){case 0:return i=F(i),this._watcher.status(Br.CONNECTING),ye.debug("ping -> protocol: "+r+", hosts: "+JSON.stringify(n)),[4,Gr(n,r,this._runtime)];case 1:if(o=f.sent(),ye.debug("valid hosts -> "+o.join(",")),0===o.length)return ye.error("No valid websocket server hosts!"),[2,Oe.RC_SOCKET_NOT_CREATED];s=r.replace("http","ws"),a=function(n,r){var a,u,d,l;return P(this,(function(r){switch(r.label){case 0:return a=Yr(s,o[n],e,t,c._runtime,i),ye.debug("conenct start -> "+a),u=c._runtime.createWebSocket(a),d=function(e){h._timer&&(clearTimeout(h._timer),h._timer=null),h._socket===u&&(h._socket=null,h._watcher.status(e))},[4,new Promise((function(e){u.onMessage((function(t){if("[object ArrayBuffer]"===Object.prototype.toString.call(t)){var n=function(e){var t=new Uint8Array(e),n=new Xe(t),r=n.readByte(),i=new Qe(r),o=Dr(i);return o.read(n,t.length-1),o}(t);if(n instanceof Or&&h._pingResolve)return h._pingResolve(Oe.SUCCESS),void(h._pingResolve=void 0);if(n instanceof Sr)return ye.debug("recv connect ack -> "+n.status),n.status!==jr.ACCEPTED?(ye.warn("connect failed: "+n.status),void e(n.status)):(ye.info("connect success -> "+a),h.connectedTime=n.timestamp,h.userId=n.userId||"",void e(Oe.SUCCESS));if(n instanceof br){var r=n.status;switch(ye.warn("recv disconnect signal -> status: "+r),r){case Fr.BLOCK:h._watcher.status(Br.BLOCKED);break;case Fr.OTHER_DEVICE_LOGIN:h._watcher.status(Br.KICKED_OFFLINE_BY_OTHER_CLIENT);break;case Fr.REDIRECT_NEW:case Fr.REDIRECT:h._watcher.status(Br.REDIRECT);break;default:h._watcher.status(Br.DISCONNECT_BY_SERVER)}}else h._onReceiveSignal(n)}else ye.error("Socket received invalid data:",t)})),u.onClose((function(t,n){ye.warn("websocket closed! code:",t,"reason:",n),d(Br.CONNECTION_CLOSED),e(t)})),u.onError((function(t){var n;ye.error("websocket error!",null===(n=t)||void 0===n?void 0:n.stack),d(Br.WEBSOCKET_ERROR),e(Oe.NETWORK_ERROR)})),u.onOpen((function(){return ye.debug("websocket open =>",a)})),setTimeout((function(){e(Oe.TIMEOUT)}),5e3)}))];case 1:return(l=r.sent())===jr.REDIRECT?[2,{value:l}]:l===Oe.SUCCESS?(c._socket=u,c._checkAlive(),[2,{value:l}]):(ye.warn("connect result -> code: "+l+", url: "+a),u.close(),[2])}}))},c=this,u=0,d=o.length,f.label=2;case 2:return u<d?[5,a(u,d)]:[3,5];case 3:if("object"==typeof(l=f.sent()))return[2,l.value];f.label=4;case 4:return u+=1,[3,2];case 5:return[2,Oe.RC_NET_UNAVAILABLE]}}))}))},t.prototype._checkAlive=function(){var e;return M(this,void 0,void 0,(function(){var t,n=this;return P(this,(function(r){switch(r.label){case 0:return this._socket?(ye.debug("send ping ->"),this.sendOnly(new Ir),[4,new Promise((function(e){n._pingResolve=e,n._timer&&clearTimeout(n._timer),n._timer=setTimeout((function(){n._pingResolve=void 0,e(Oe.TIMEOUT)}),15e3)}))]):[2];case 1:return(t=r.sent())!==Oe.SUCCESS?(this._failedCount+=1,ye.warn("ping failed count: "+this._failedCount+", code: "+t),this._failedCount>=this.ALLOW_FAILED_TIMES?(this._failedCount=0,ye.warn("ping timeout, close current websocket to reconnect!"),null===(e=this._socket)||void 0===e||e.close()):this._checkAlive(),[2]):(ye.debug("recv pong <-"),this._failedCount=0,setTimeout((function(){return n._checkAlive()}),15e3),[2])}}))}))},t.prototype._onReceiveSignal=function(e){return M(this,void 0,void 0,(function(){var t,n,r,i,o,s,a=this;return P(this,(function(c){switch(c.label){case 0:return t=e.messageId,e.header&&e.header.qos!==Ge.AT_MOST_ONCE&&(e instanceof Ar&&!e.syncMsg&&(ye.debug("send pubAck -> "+t),this.sendOnly(new kr(t))),e instanceof Ur&&(ye.debug("send queryCon -> "+t),this.sendOnly(new xr(t)))),t>0&&(ye.debug("recv ack -> messageId: "+t),(n=this._messageIds[t])&&(n(e),delete this._messageIds[t]),(r=this._syncMessageIds[t])&&(delete this._syncMessageIds[t],r(e))),e instanceof Ar?(i=e.syncMsg,(o=e.topic)===Hr[Hr.userSetData]?[2]:!i||qr(o)?(this._watcher.signal(e),[2]):[4,new Promise((function(e){a._syncMessageIds[t]=e}))]):[3,2];case 1:s=c.sent(),delete this._syncMessageIds[t],this._watcher.signal(e,s),c.label=2;case 2:return[2]}}))}))},t.prototype.sendOnly=function(e){this._socket&&Wr(e,this._socket)},t.prototype.send=function(e,t,n,r){return void 0===r&&(r=3e4),M(this,void 0,void 0,(function(){var i,o,s,a=this;return P(this,(function(c){switch(c.label){case 0:return this._socket?(i=this._generateMessageId(),e.messageId=i,Wr(e,this._socket),[4,new Promise((function(e){a._messageIds[i]=e,setTimeout((function(){a._messageIds[i]&&delete a._messageIds[i],e()}),r)}))]):[3,2];case 1:return(o=c.sent())?0!==o.status?(ye.warn("send failed -> message: "+i+", respPBName: "+t+", status: "+o.status),[2,{code:o.status}]):(s=t?this.codec.decodeByPBName(o.data,t,n):o,[2,{code:Oe.SUCCESS,data:s}]):(ye.warn("send timeout -> message: "+i+", respPBName: "+t+", timeout: "+r),[2,{code:Oe.TIMEOUT}]);case 2:return[2,{code:Oe.RC_NET_CHANNEL_INVALID}]}}))}))},t.prototype.close=function(){this._socket&&(this._socket.close(),this._socket=null,this._watcher.status(Br.DISCONNECTED))},t}(Er);!function(e){e.GET="GET",e.POST="POST"}(Kr||(Kr={}));var Jr=function(e){function t(t,n){var r=e.call(this,"comet",n)||this;return r._runtime=t,r._messageIds={},r._syncMessageIds={},r._idCount=0,r._generateMessageId=function(){return++r._idCount},r._pid=encodeURIComponent((new Date).getTime()+Math.random()+""),r}return N(t,e),t.prototype.handleCometRes=function(e){var t=this;if(200!==e.status&&202!==e.status)return!1;var n=ee(e.data)?JSON.parse(e.data):e.data;return n?!re(n)||(xe(n,(function(e){return M(t,void 0,void 0,(function(){var t,n,r,i,o,s,a,c,u,d,l,h=this;return P(this,(function(f){switch(f.label){case 0:if((t=e.sessionid)&&(this._sessionid=t),n=function(e){var t=e.headerCode,n=new Qe(t),r=Dr(n);for(var i in e)r[i]=e[i];return r}(e),r=n.messageId,i=n._header,o=n.status,n.identifier,s=i&&i.qos!==Ge.AT_MOST_ONCE,r&&n.getIdentifier&&((a=this._messageIds[r])&&a(n),this._syncMessageIds[r]&&this._syncMessageIds[r](n)),s&&(n instanceof Ar&&!n.syncMsg&&(c=new kr(r),this.sendOnly(c)),n instanceof Ur&&(c=new xr(r),this.sendOnly(c))),n instanceof br){switch(o){case Fr.OTHER_DEVICE_LOGIN:this._watcher.status(Br.KICKED_OFFLINE_BY_OTHER_CLIENT);break;case Fr.BLOCK:this._watcher.status(Br.BLOCKED);break;case Fr.REDIRECT_NEW:case Fr.REDIRECT:this._watcher.status(Br.REDIRECT);break;default:this._watcher.status(Br.DISCONNECT_BY_SERVER)}return[2]}return n instanceof Ar?(u=n.syncMsg,d=n.topic,!u||qr(d)?(this._watcher.signal(n),[2,!1]):[4,new Promise((function(e){h._syncMessageIds[r]=e}))]):[3,2];case 1:l=f.sent(),delete this._syncMessageIds[r],this._watcher.signal(n,l),f.label=2;case 2:return[2]}}))}))})),!0):(ye.error("received data is not a validJson",n),!1)},t.prototype._startPullSignal=function(e){return M(this,void 0,void 0,(function(){var t,n,r,i;return P(this,(function(o){switch(o.label){case 0:return t=(new Date).getTime(),n=e+"://"+this._domain+"/pullmsg.js?sessionid="+this._sessionid+"&timestrap="+t+"&pid="+this._pid,[4,this._runtime.httpReq({url:n,body:{pid:this._pid},timeout:45e3})];case 1:return r=o.sent(),i=this.handleCometRes(r),this._isDisconnected||(i?this._startPullSignal(e):(this._watcher.status(Br.NETWORK_UNAVAILABLE),this.close())),[2]}}))}))},t.prototype.connect=function(e,t,n,r,i){return M(this,void 0,void 0,(function(){var o,s,a,c,u,d,l;return P(this,(function(h){switch(h.label){case 0:return i=F(i),this._protocol=r,this._isDisconnected=!1,this._watcher.status(Br.CONNECTING),[4,Gr(n,r,this._runtime)];case 1:if(0===(o=h.sent()).length)return ye.error("No valid comet server hosts!"),[2,Oe.RC_SOCKET_NOT_CREATED];s=function(e){return(200===e.status||202===e.status)&&!!e.data&&(function(e){if(ae(e))return!0;var t=!1;try{var n=JSON.parse(e);t=JSON.stringify(n)===e}catch(e){t=!1}return t}(e.data)?ae(e.data)?e.data:JSON.parse(e.data):(ye.error("received data is not a validJson",e.data),!1))},a=0,c=o.length,h.label=2;case 2:return a<c?(u=Yr(r,o[a],e,t,this._runtime,i,this._pid),[4,this._runtime.httpReq({url:u,body:{pid:this._pid},timeout:5e3})]):[3,5];case 3:if(d=h.sent(),l=s(d),this._domain=o[a],l&&l.status===jr.REDIRECT)return[2,l.status];if(l&&0===l.status)return this._watcher.status(Br.CONNECTED),this._sessionid=l.sessionid,this._startPullSignal(r),this.userId=l.userId,this.connectedTime=l.timestamp,[2,l.status];h.label=4;case 4:return a+=1,[3,2];case 5:return[2,Oe.RC_NET_UNAVAILABLE]}}))}))},t.prototype.sendCometData=function(e,t){return M(this,void 0,void 0,(function(){var t,n,r,i,o,s,a,c,u,d;return P(this,(function(l){switch(l.label){case 0:return n=(t=this)._domain,r=t._sessionid,i=t._pid,o=e.messageId,s=e.topic,a=e.targetId,e.identifier,c=e.getHeaderFlag(),u=s?this._protocol+"://"+n+"/websocket?messageid="+o+"&header="+c+"&sessionid="+r+"&topic="+s+"&targetid="+a+"&pid="+i:this._protocol+"://"+n+"/websocket?messageid="+o+"&header="+c+"&sessionid="+r+"&pid="+i,[4,this._runtime.httpReq({url:u,method:Kr.POST,body:e.getCometData()})];case 1:return d=l.sent(),this.handleCometRes(d),[2]}}))}))},t.prototype.sendOnly=function(e){this.sendCometData(e)},t.prototype.send=function(e,t,n,r){return void 0===r&&(r=3e4),M(this,void 0,void 0,(function(){var i,o,s,a=this;return P(this,(function(c){switch(c.label){case 0:return i=this._generateMessageId(),e.messageId=i,this.sendCometData(e),[4,new Promise((function(e){a._messageIds[i]=e,setTimeout((function(){delete a._messageIds[i],e()}),r)}))];case 1:return(o=c.sent())?0!==o.status?[2,{code:o.status}]:(s=t?this.codec.decodeByPBName(o.data,t,n):o,[2,{code:Oe.SUCCESS,data:s}]):[2,{code:Oe.TIMEOUT}]}}))}))},t.prototype.close=function(){this._isDisconnected=!0,this._watcher.status(Br.DISCONNECTED)},t}(Er),zr=function(e,t,n){this.runtime=e,this._watcher=t,this._options=n,this.currentUserId="",this._appkey=this._options.appkey,this._apiVer=this._options.apiVersion,this.navi=this._createNavi()},Qr=function(e){return["navi",e].join("_")},Zr=function(){function e(e,t){this._runtime=e,this._options=t,this._naviInfo=null,this._appkey=this._options.appkey,this._apiVersion=F(this._options.apiVersion)}return e.prototype.getInfo=function(e,t,n){return M(this,void 0,void 0,(function(){var r,i;return P(this,(function(o){switch(o.label){case 0:return n&&this._clear(e),(r=function(e,t,n){var r,i,o=Qr(e);try{var s=n.getItem(o);i=s?JSON.parse(s):[]}catch(e){i=[]}var a=Date.now();return i.length>0&&(i=i.filter((function(e){return a-e.timestamp<72e5}))),0===i.length?n.removeItem(o):n.setItem(o,JSON.stringify(i)),(null===(r=i.find((function(e){return e.token===t})))||void 0===r?void 0:r.naviInfo)||null}(this._appkey,e,this._runtime.localStorage))?(this._naviInfo=r,[2,r]):(i=this._options.navigators.slice(),t.length&&t.forEach((function(e){i.indexOf(e)<0&&i.unshift(e)})),[4,this._reqNavi(i,this._appkey,e)]);case 1:return(r=o.sent())?(this._naviInfo=r,this.setNaviInfo2Cache(e,r),[2,r]):[2,r]}}))}))},e.prototype.setNaviInfo2Cache=function(e,t){this._naviInfo=t,function(e,t,n,r){var i,o=Qr(e);try{var s=r.getItem(o);i=s?JSON.parse(s):[]}catch(e){i=[]}var a=Date.now();i.length>0&&(i=i.filter((function(e){return a-e.timestamp<72e5&&t!==e.token}))),i.push({timestamp:a,naviInfo:n,token:t}),r.setItem(o,JSON.stringify(i))}(this._appkey,e,t,this._runtime.localStorage)},e.prototype.getInfoFromCache=function(e){return this._naviInfo},e.prototype._clear=function(e){!function(e,t,n){var r,i=Qr(e);try{var o=n.getItem(i);r=o?JSON.parse(o):[]}catch(e){r=[]}var s=Date.now();r.length>0&&(r=r.filter((function(e){return s-e.timestamp<72e5&&t!==e.token}))),0===r.length?n.removeItem(i):n.setItem(i,JSON.stringify(r))}(this._appkey,e,this._runtime.localStorage)},e}(),Xr=function(e,t,n){return[e,t,n].join("_")},ei=function(){function e(e,t){this._runtime=e,this._appkey=t,this._inboxTime=0,this._outboxTime=0}return e.prototype.setInboxTime=function(e,t){if(!(this._inboxTime>e)){this._inboxTime=e;var n=Xr("inbox",this._appkey,t);this._runtime.localStorage.setItem(n,e.toString())}},e.prototype.getInboxTime=function(e){if(0===this._inboxTime){var t=Xr("inbox",this._appkey,e);this._inboxTime=parseInt(this._runtime.localStorage.getItem(t))||0}return this._inboxTime},e.prototype.setOutboxTime=function(e,t){if(!(this._outboxTime>=e)){this._outboxTime=e;var n=Xr("outbox",this._appkey,t);this._runtime.localStorage.setItem(n,e.toString())}},e.prototype.getOutboxTime=function(e){if(0===this._outboxTime){var t=Xr("outbox",this._appkey,e);this._outboxTime=parseInt(this._runtime.localStorage.getItem(t))||0}return this._outboxTime},e}(),ti={_caches:{},set:function(e,t){this._caches[e]=t},get:function(e){return this._caches[e]||0},clear:function(e){this._caches[e]=0}},ni=function(){function e(e,t){this._kvCaches={},this._chatroomId=e,this._currentUserId=t}return e.prototype._add=function(e){var t=e.key;e.isDeleted=!1,this._kvCaches[t]=e},e.prototype._remove=function(e){var t=e.key,n=this._kvCaches[t];n.isDeleted=!0,this._kvCaches[t]=n},e.prototype._setEntry=function(e,t){var n=e.key,r=e.type,i=e.isOverwrite,o=e.userId,s=this._getSetUserId(n),a=r===We.DELETE,c=s===o,u=!this._isExisted(n),d=a?this._remove:this._add;(t||i||c||u)&&d.call(this,e)},e.prototype.getValue=function(e){var t=this._kvCaches[e]||{};return t.isDeleted?null:t.value},e.prototype.getAllValue=function(){var e={};for(var t in this._kvCaches)this._kvCaches[t].isDeleted||(e[t]=this._kvCaches[t].value);return e},e.prototype._getSetUserId=function(e){return(this._kvCaches[e]||{}).userId},e.prototype._isExisted=function(e){var t=this._kvCaches[e]||{},n=t.value,r=t.isDeleted;return n&&!r},e.prototype.setEntries=function(e){var t=this,n=e.kvEntries,r=e.isFullUpdate;n=n||[],(r=r||!1)&&this.clear(),n.forEach((function(e){t._setEntry(e,r)}))},e.prototype.clear=function(){this._kvCaches={}},e}(),ri=function(){function e(e){this._pullQueue=[],this._isPulling=!1,this._storeCaches={},this._engine=e}return e.prototype._startPull=function(){return M(this,void 0,void 0,(function(){var e,t,n,r,i,o,s;return P(this,(function(a){switch(a.label){case 0:return this._isPulling||0===this._pullQueue.length?[2]:(this._isPulling=!0,e=this._pullQueue.splice(0,1)[0],t=e.chrmId,n=e.timestamp,(r=ti.get(t))>n?(this._isPulling=!1,this._startPull(),[2]):[4,this._engine.pullChatroomEntry(t,r)]);case 1:return i=a.sent(),o=i.code,s=i.data,o===Oe.SUCCESS?(this._isPulling=!1,ti.set(t,s.syncTime||0),this._startPull()):this._startPull(),[2]}}))}))},e.prototype.reset=function(e){ti.clear(e);var t=this._storeCaches[e];t&&t.clear()},e.prototype.pullEntry=function(e,t){this._pullQueue.push({chrmId:e,timestamp:t}),this._startPull()},e.prototype.setLocal=function(e,t,n){var r=this._storeCaches[e];he(r)||(r=new ni(e,n)),r.setEntries(t),this._storeCaches[e]=r},e.prototype.getValue=function(e,t){var n=this._storeCaches[e];return n?n.getValue(t):null},e.prototype.getAll=function(e){var t=this._storeCaches[e],n={};return t&&(n=t.getAllValue()),n},e}(),ii=function(){function e(e,t,n,r){this._runtime=e,this._appkey=t,this._userId=n,this._canJoinMulipleChrm=r,this._sessionKey="",this._joinedChrmsInfo={},this._sessionKey="sync-chrm-"+this._appkey+"-"+this._userId}return e.prototype.set=function(e,t){void 0===t&&(t=10),!this._canJoinMulipleChrm&&(this._joinedChrmsInfo={}),this._joinedChrmsInfo[e]=t,this._runtime.sessionStorage.setItem(this._sessionKey,JSON.stringify(this._joinedChrmsInfo))},e.prototype.get=function(){var e,t;try{t=this._runtime.sessionStorage.getItem(this._sessionKey),e=JSON.parse(t||"{}")}catch(o){ye.error("parse rejoined chrm infos error -> "+t),e={}}return e},e.prototype.remove=function(e){delete this._joinedChrmsInfo[e],he(this._joinedChrmsInfo)?this._runtime.sessionStorage.setItem(this._sessionKey,JSON.stringify(this._joinedChrmsInfo)):this.clear()},e.prototype.clear=function(){this._joinedChrmsInfo={},this._runtime.sessionStorage.removeItem(this._sessionKey)},e}(),oi="converStatusChanged",si=function(){function e(e,t,n){this._eventEmitter=new Ee,this._pullQueue=[],this._isPulling=!1,this._storage=b(e.runtime),this._appkey=t,this._currentUserId=n,this._engine=e,this._storagePullTimeKey="con-s-"+t+"-"+n}return e.prototype._set=function(e){var t=this;if(!ue(e)){var n=this._storage.get(this._storagePullTimeKey)||0,r=e.length;e.forEach((function(e,i){var o=e.updatedTime||0;n=o>n?o:n,e.conversationType=e.type,t._eventEmitter.emit(oi,{statusItem:e,isLastPull:i===r-1})})),this._storage.set(this._storagePullTimeKey,n)}},e.prototype._startPull=function(){return M(this,void 0,void 0,(function(){var e,t,n,r;return P(this,(function(i){switch(i.label){case 0:return this._isPulling||0===this._pullQueue.length?[2]:(this._isPulling=!0,e=this._pullQueue.splice(0,1)[0],[4,this._engine.pullConversationStatus(e)]);case 1:return t=i.sent(),n=t.code,r=t.data,n===Oe.SUCCESS?(this._isPulling=!1,this._set(r),this._startPull()):this._startPull(),[2]}}))}))},e.prototype.pull=function(e){var t=this._storage.get(this._storagePullTimeKey)||0;(e>t||0===e)&&(this._pullQueue.push(t),this._startPull())},e.prototype.watch=function(e){this._eventEmitter.on(oi,(function(t){e(t)}))},e.prototype.unwatch=function(){this._eventEmitter.off(oi,(function(e){}))},e}(),ai={c:{keyName:"unreadMessageCount",defaultVal:0},hm:{keyName:"hasMentioned",defaultVal:!1},m:{keyName:"mentionedInfo",defaultVal:null},t:{keyName:"lastUnreadTime",defaultVal:0},nc:{keyName:"notificationStatus",defaultVal:2},to:{keyName:"isTop",defaultVal:!1},tg:{keyName:"tags",defaultVal:{}}},ci={};for(var ui in ai){var di=ai[ui].keyName;ci[di]=ui}var li,hi=function(){function e(e,t,n){this._appkey=t,this._currentUserId=n;var r="con-"+t+"-"+n;this.storage=new O(e,r)}return e.prototype._getStoreKey=function(e,t){return e+"_"+t},e.prototype._getConOptionByKey=function(e){var t=(e=e||"").split("_");return t.length>=2?{conversationType:t[0],targetId:e.match(/_.*/g)[0].substring(1)}:{conversationType:J.PRIVATE,targetId:""}},e.prototype.updateMentionedData=function(e){var t=this,n=e.conversationType,r=e.targetId,i=e.messageType,o=e.isMentioned,s=e.content,a=e.senderUserId,c=this._getStoreKey(n,r),u=this.storage.get(c)||{},d=ci.mentionedInfo,l=ci.hasMentioned,h=u[d]||{},f=h.userIdList||[],p=s.mentionedInfo;if(o&&n===J.GROUP&&((p.userIdList||[]).forEach((function(e){e===t._currentUserId&&f.indexOf(a)<0&&f.push(a)})),p.type===An.ALL&&f.indexOf(a)<0&&f.push(a)),i===Pn.RECALL&&n===J.GROUP){var g=f.indexOf(a);g>=0&&f.splice(g,1)}p={userIdList:f,type:(null==p?void 0:p.type)||h.type},0!==f.length?(u[d]=p,u[l]=!0):(delete u[d],delete u[l]),he(u)?this.storage.set(c,u):this.storage.remove(c)},e.prototype.set=function(e,t,n){var r=this._getStoreKey(e,t),i=this.storage.get(r)||{};for(var o in n){var s=ci[o],a=n[o];if(!ue(s)&&!ue(a)&&"hasMentioned"!==o&&"MentionedInfo"!==o){if(a===ai[s].defaultVal||"tags"===o&&!he(a))delete i[s];else if("tags"===o){var c=a;for(var u in c)c[u].isTop||delete c[u].isTop;i[s]=a}else i[s]=a;i.c||(delete i.t,delete i.hm,delete i.m)}}he(i)?this.storage.set(r,i):this.storage.remove(r)},e.prototype.get=function(e,t){var n=this._getStoreKey(e,t),r=this.storage.get(n)||{},i={};for(var o in ai){var s=ai[o],a=s.keyName,c=s.defaultVal;i[a]=r[o]||Be(c)}return i},e.prototype.getValue=function(e){var t=this.storage.getValues()||{},n=[];for(var r in t){var i=this._getConOptionByKey(r),o={conversationType:i.conversationType,targetId:i.targetId},s=t[r];for(var a in s){var c=ai[a],u=c.keyName,d=c.defaultVal;o[u]=s[a]||Be(d)}o=e?e(o):o,n.push(o)}return n},e.prototype.getValueForTag=function(){var e=this.storage.getValues()||{},t={};for(var n in e){var r=this._getConOptionByKey(n),i=r.conversationType,o=r.targetId,s={},a=e[n];for(var c in a){var u=ai[c],d=u.keyName,l=u.defaultVal;s[d]=a[c]||Be(l)}for(var h in s.tags){ue(t[h])&&(t[h]=[]);var f=Object.assign({},s,{conversationType:i,targetId:o});delete f.tags,t[h].push(f)}}return t},e}(),fi=[J.PRIVATE,J.GROUP,J.SYSTEM],pi="conversationChanged",gi=function(){function e(e,t,n,r){var i=this;this._updatedConversations={},this._eventEmitter=new Ee,this._draftMap={},this._appkey=t,this._loginUserId=n,this._store=new hi(e.runtime,t,n),this._statusManager=new si(e,t,n),this._statusManager.watch((function(e){var t=e.statusItem,n=e.isLastPull;i.addStatus(t,n)})),this._eventEmitter.on(pi,(function(e){r(e)}))}return e.prototype._calcUnreadCount=function(e,t){var n=e.content,r=e.messageType,i=e.sentTime,o=e.isCounted,s=e.messageDirection,a=e.senderUserId,c=s===_r.SEND&&a===this._loginUserId,u=r===Pn.RECALL,d=ae(n),l=!1,h=t.lastUnreadTime||0,f=t.unreadMessageCount||0;return h>i||c||(o&&(t.unreadMessageCount=f+1,t.lastUnreadTime=i,l=!0),u&&d&&h>=n.sentTime&&f&&(t.unreadMessageCount=f-1,l=!0)),{hasChanged:l,localConversation:t}},e.prototype._calcMentionedInfo=function(e,t){var n=e.content,r=(e.messageDirection,e.isMentioned);_r.SEND;var i=ae(n),o=!1;return r&&i&&n.mentionedInfo&&(t.hasMentioned=!0,o=!0),{hasChanged:o,localConversation:t}},e.prototype._setUpdatedConversation=function(e){if(ae(e)){var t=e.conversationType,n=e.targetId,r=t+"_"+n,i=this._store.get(t,n)||{};this._updatedConversations[r]=Object.assign(i,e)}},e.prototype.addStatus=function(e,t){var n=e.conversationType,r=e.targetId,i=e.updatedTime,o=e.notificationStatus,s=e.isTop,a=e.tags,c={},u={};ue(o)||(u.notificationStatus={time:i,val:o}),ue(s)||(u.isTop={time:i,val:s}),ue(a)||(u.tags={time:i,val:a},null==a||a.forEach((function(e){c[e.tagId]={isTop:e.isTop}}))),this._store.set(n,r,{notificationStatus:o,isTop:s,tags:c}),this._setUpdatedConversation({conversationType:n,targetId:r,updatedItems:u}),t&&this._notifyConversationChanged()},e.prototype._notifyConversationChanged=function(){var e=[];for(var t in this._updatedConversations)e.push(this._updatedConversations[t]);this._eventEmitter.emit(pi,e),this._updatedConversations={}},e.prototype.setConversationCacheByMessage=function(e,t){var n=this,r=e.conversationType,i=e.isPersited,o=e.targetId;if(fi.indexOf(r)>=0){var s=!1,a=this._store.get(r,o);if([this._calcUnreadCount,this._calcMentionedInfo].forEach((function(t){var r=t.call(n,e,a),i=r.hasChanged,o=r.localConversation;s=s||i,a=Be(o)})),s&&this._store.set(r,o,a),this._store.updateMentionedData(e),i){var c=this._store.get(r,o);c.updatedItems={latestMessage:{time:e.sentTime,val:e}},c.latestMessage=e;var u=Object.assign(c,{conversationType:r,targetId:o});this._setUpdatedConversation(u)}t&&this._notifyConversationChanged()}},e.prototype.get=function(e,t){return this._store.get(e,t)},e.prototype.getAllUnreadCount=function(e,t,n){var r=this._store.getValue(),i=0;return r.forEach((function(e){var t=e.unreadMessageCount;t=t||0,i+=Number(t)})),i},e.prototype.getUnreadCountByTag=function(e,t){var n=this._store.getValueForTag()[e]||[],r=0;return n.forEach((function(e){var n=e.unreadMessageCount,i=e.notificationStatus;(t||1!==i)&&(n=n||0,r+=Number(n))})),r},e.prototype.getUnreadCount=function(e,t){return this._store.get(e,t).unreadMessageCount||0},e.prototype.clearUnreadCount=function(e,t){var n=this._store.get(e,t),r=n.unreadMessageCount,i=n.hasMentioned;(r||i)&&(n.unreadMessageCount=0,n.hasMentioned=!1),this._store.set(e,t,n);var o=Object.assign(n,{conversationType:e,targetId:t});this._setUpdatedConversation(o),this._notifyConversationChanged()},e.prototype.startPullConversationStatus=function(e){this._statusManager.pull(e)},e.prototype.setDraft=function(e,t,n){var r=e+"_"+t;this._draftMap[r]=n},e.prototype.getDraft=function(e,t){var n=e+"_"+t;return this._draftMap[n]},e.prototype.clearDraft=function(e,t){var n=e+"_"+t;delete this._draftMap[n]},e.prototype.addTagStatus=function(e,t,n){var r=this._store.get(e,t).tags;r=Object.assign(r,n),this._store.set(e,t,{tags:r})},e.prototype.deleteTagStatus=function(e,t,n){var r=this._store.get(e,t).tags;n.forEach((function(e){delete r[e]})),this._store.set(e,t,{tags:r})},e.prototype.getConversationListForTag=function(){return this._store.getValueForTag()},e}();!function(e){e[e.QINIU=1]="QINIU",e[e.ALI=2]="ALI",e[e.AWS=3]="AWS",e[e.STC=4]="STC"}(li||(li={}));var mi=li,vi=function(){function e(e,t,n,r){this._pullQueue=[],this._isPulling=!1,this._storageTagKey="tag-"+t+"-"+n,this._storagePullTimeKey="us-s-"+t+"-"+n,this._storage=b(e.runtime),this._engine=e,this._tagWatcherFunc=r}return e.prototype._updateTag=function(e){var t=e.tags,n={};t.forEach((function(e){n[e.tagId]={tagName:e.tagName,createdTime:e.createdTime}})),this._storage.set(this._storageTagKey,n),this._tagWatcherFunc()},e.prototype.addTag=function(e,t){var n=this._storage.get(this._storageTagKey)||{};e.forEach((function(e){var t,r=(null===(t=n[e.tagId])||void 0===t?void 0:t.createdTime)||e.createdTime||0;n[e.tagId]={tagName:e.tagName,createdTime:r}})),this._storage.set(this._storageTagKey,n),this._storage.set(this._storagePullTimeKey,t)},e.prototype.deleteTag=function(e,t){var n=this._storage.get(this._storageTagKey)||{};e.forEach((function(e){delete n[e]})),this._storage.set(this._storageTagKey,n),this._storage.set(this._storagePullTimeKey,t)},e.prototype.getTagsInfo=function(){return this._storage.get(this._storageTagKey)||{}},e.prototype.getTags=function(){var e=this._storage.get(this._storageTagKey)||{},t=[];for(var n in e)t.push({tagId:n,tagName:e[n].tagName,createdTime:e[n].createdTime,conversationCount:0});return t.sort((function(e,t){return(e.createdTime||0)-(t.createdTime||0)}))},e.prototype.getTagById=function(e){var t=this._storage.get(this._storageTagKey)||{};return t[e]?{tagId:e,tagName:t[e].tagName,createdTime:t[e].createdTime,conversationCount:0}:null},e.prototype._startPull=function(){return M(this,void 0,void 0,(function(){var e,t,n,r,i,o,s,a;return P(this,(function(c){switch(c.label){case 0:return this._isPulling||0===this._pullQueue.length?[2]:(this._isPulling=!0,e=this._pullQueue.splice(0,1)[0],[4,this._engine.pullUserSettings(e)]);case 1:return t=c.sent(),n=t.code,r=t.data,n!==Oe.SUCCESS||ue(r)?(this._isPulling=!1,this._startPull()):(o=(i=r).settings,s=i.version,a=o.Tag,ue(a)||this._updateTag(a),this._storage.set(this._storagePullTimeKey,s),this._isPulling=!1,this._startPull()),[2]}}))}))},e.prototype.pullUserSettings=function(e){var t=this._storage.get(this._storagePullTimeKey)||0;(e>t||0===e)&&(this._pullQueue.push(t),this._startPull())},e.prototype.getVersion=function(){return this._storage.get(this._storagePullTimeKey)||0},e}(),_i=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r._connectType=n.connectionType,r}return N(t,e),t.prototype._formatJSONPUrl=function(e,t,n,r){return e+"/"+(this._runtime.isSupportSocket()&&"websocket"===this._connectType?"navi":"cometnavi")+".js?appId="+n+"&token="+encodeURIComponent(t)+"&callBack="+r+"&v="+this._apiVersion+"&r="+Date.now()},t.prototype.getInfo=function(t,n,r){var i;return M(this,void 0,void 0,(function(){var o,s;return P(this,(function(a){return this._runtime.useNavi?[2,e.prototype.getInfo.call(this,t,n,r)]:(o=void 0,o=this._runtime.isSupportSocket()&&"websocket"===this._connectType?h.join(","):f.join(","),s={code:200,protocol:"https",server:"",voipCallInfo:"",kvStorage:0,openHttpDNS:!1,historyMsg:!1,chatroomMsg:!1,uploadServer:"https://upload.qiniup.com",bosAddr:"https://gz.bcebos.com",location:"",monitor:0,joinMChrm:!1,openMp:0,openUS:0,grpMsgLimit:0,isFormatted:0,gifSize:2048,logSwitch:0,logPolicy:"",compDays:0,msgAck:"",activeServer:"",qnAddr:"",extkitSwitch:0,alone:!1,voipServer:"",offlinelogserver:"",backupServer:(null===(i=this._options.miniCMPProxy)||void 0===i?void 0:i.length)?this._options.miniCMPProxy.join(","):o},this.setNaviInfo2Cache(t,s),[2,s])}))}))},t.prototype._reqNavi=function(e,t,n){return M(this,void 0,void 0,(function(){var r,i,o,s,a,c,u,d;return P(this,(function(l){switch(l.label){case 0:r="getServerEndpoint",i=0,o=e.length,l.label=1;case 1:return i<o?(s=this._formatJSONPUrl(e[i],n,t,r),ye.debug("req navi => "+s),[4,this._runtime.httpReq({url:s,timeout:1e4})]):[3,4];case 2:if(200!==(a=l.sent()).status)return[3,3];try{return c=a.data.replace(r+"(","").replace(/\);?$/,""),u=JSON.parse(c),d=/^https/.test(s)?"https":"http",u.protocol=d,[2,u]}catch(e){ye.error("parse navi err =>",e)}l.label=3;case 3:return i+=1,[3,1];case 4:return[2,null]}}))}))},t}(Zr),yi=function(){function e(e){this._pullQueue=[],this._isPulling=!1,this._pullTime=0,this._engine=e}return e.prototype._startPull=function(){return M(this,void 0,void 0,(function(){var e,t,n,r,i,o,s;return P(this,(function(a){switch(a.label){case 0:return this._isPulling||0===this._pullQueue.length?[2]:(this._isPulling=!0,e=this._pullQueue.splice(0,1)[0],t=e.roomId,n=e.timestamp,(r=this._pullTime)>n?(this._isPulling=!1,this._startPull(),[2]):[4,this._engine.pullRTCRoomEntry(t,r)]);case 1:return i=a.sent(),o=i.code,s=i.data,o===Oe.SUCCESS?(this._isPulling=!1,this._pullTime=s.syncTime||0,this._startPull()):this._startPull(),[2]}}))}))},e.prototype.pullEntry=function(e,t){this._pullQueue.push({roomId:e,timestamp:t}),this._startPull()},e.prototype.reset=function(){this._pullTime=0,this._isPulling=!1},e}(),Ei=function(e,t,n,r,i,o){return{conversationType:e,targetId:t,senderUserId:o,messageDirection:_r.SEND,isCounted:!!n.isCounted,isMentioned:!!n.isMentioned,content:n.content,messageType:n.messageType,isOffLineMessage:!1,isPersited:!!n.isPersited,messageUId:r,sentTime:i,receivedTime:0,disableNotification:!!n.disableNotification,isStatusMessage:!!n.isStatusMessage,canIncludeExpansion:!!n.canIncludeExpansion,expansion:n.canIncludeExpansion?n.expansion:null,receivedStatus:s.UNREAD,pushConfig:n.pushConfig}},Ti=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;return i._customMessageType={},i._connectedTime=0,i._localConnectedTime=0,i._pullingMsg=!1,i._pullQueue=[],i._chrmsQueue={},i._latestSyncTimestamp=0,i._intervalTimer=-1,i._sentMessageMap={},i._letterbox=new ei(t,r.appkey),i._chrmEntryHandler=new ri(i),i}return N(t,e),t.prototype._createNavi=function(){return new _i(this.runtime,this._options)},t.prototype.getConnectedTime=function(){return this._connectedTime},t.prototype.connect=function(e,t){return M(this,void 0,void 0,(function(){var n,r,i,o,s=this;return P(this,(function(a){switch(a.label){case 0:return n=[],this._naviInfo=t,t.server?n.push(t.server):ye.warn("navi.server is invalid"),(r=t.backupServer)&&r.split(",").forEach((function(e){n.indexOf(e)<0&&n.push(e)})),0===n.length?(ye.error("navi invaild.",n),[2,Oe.UNKNOWN]):[4,(i=this.runtime.createDataChannel({status:function(r){s._connectionStatusHandler(r,e,n,t.protocol)},signal:this._signalHandler.bind(this)},this._options.connectionType)).connect(this._appkey,e,n,t.protocol,this._apiVer)];case 1:return(o=a.sent())===Oe.SUCCESS?(this._channel=i,this.currentUserId=i.userId,this._connectedTime=i.connectedTime,this._localConnectedTime=Date.now(),this._watcher.status(Br.CONNECTED),this._conversationManager=new gi(this,this._appkey,this.currentUserId,this._watcher.conversation),this._conversationManager.startPullConversationStatus(0),this._userSettingManager=new vi(this,this._appkey,this.currentUserId,this._watcher.tag),this._userSettingManager.pullUserSettings(0),this._rtcKVManager=new yi(this),this._joinedChrmManager=new ii(this.runtime,this._appkey,this.currentUserId,t.joinMChrm),this._startSyncInterval()):i.close(),[2,o]}}))}))},t.prototype._connectionStatusHandler=function(e,t,n,r){if(ye.warn("connection status changed:",e),e!==Br.CONNECTING&&e!==Br.CONNECTED){if(this._channel&&e!==Br.DISCONNECTED)return e===Br.BLOCKED||e===Br.KICKED_OFFLINE_BY_OTHER_CLIENT||e===Br.DISCONNECT_BY_SERVER?(this.disconnect(),void this._watcher.status(e)):void(e!==Br.REDIRECT?this._try2Reconnect(t,n,r):this._watcher.status(e));this._watcher.status(e)}else this._watcher.status(e)},t.prototype._try2Reconnect=function(e,t,n){return M(this,void 0,void 0,(function(){var r=this;return P(this,(function(i){switch(i.label){case 0:return this._channel?[4,this._channel.connect(this._appkey,e,t,n,this._apiVer)]:[2];case 1:return i.sent()===Oe.SUCCESS?(this._startSyncInterval(),this._watcher.status(Br.CONNECTED),this._rejoinChrm(),ye.__insertLogIntoDatabase(),[2]):(this._watcher.status(Br.WEBSOCKET_UNAVAILABLE),setTimeout((function(){r._try2Reconnect(e,t,n)}),5e3),[2])}}))}))},t.prototype._signalHandler=function(e,t){var n=e.syncMsg,r=e.topic;if(n)this._receiveSyncMsg(e,t);else{var i=Hr[r];if(i)switch(i){case Hr.s_ntf:ye.debug("recv s_ntf -> signal.messageId: "+e.messageId),this._pullMsg(e);break;case Hr.s_msg:this._receiveMsg(e);break;case Hr.s_cmd:this._receiveStateNotify(e);break;case Hr.s_us:this._receiveSettingNotify(e);break;case Hr.rtc_ntf:this._receiveRtcKv(e)}else ye.error("unknown topic:",r)}},t.prototype._receiveStateNotify=function(e){var t,n=null===(t=this._channel)||void 0===t?void 0:t.codec.decodeByPBName(e.data,ut),r=n.time,i=n.type,o=n.chrmId;switch(i){case 2:this._chrmEntryHandler.pullEntry(o,r);break;case 3:this._conversationManager.startPullConversationStatus(r)}},t.prototype._receiveSettingNotify=function(e){var t,n=(null===(t=this._channel)||void 0===t?void 0:t.codec.decodeByPBName(e.data,Xt)).version;this._userSettingManager.pullUserSettings(n)},t.prototype._receiveRtcKv=function(e){var t,n=null===(t=this._channel)||void 0===t?void 0:t.codec.decodeByPBName(e.data,vn),r=n.time,i=n.type,o=n.roomId;switch(i){case 1:this._rtcKVManager.pullEntry(o,r)}},t.prototype._receiveMessageExpansion=function(e){var t=e.content,n=t.put,r=t.del,i=t.mid;n&&this._watcher.expansion({updatedExpansion:{messageUId:i,expansion:n}}),r&&this._watcher.expansion({deletedExpansion:{messageUId:i,deletedKeys:r}})},t.prototype._receiveSyncMsg=function(e,t){var n,r=null===(n=this._channel)||void 0===n?void 0:n.codec.decodeByPBName(e.data,tt,{currentUserId:this.currentUserId,signal:e});(r=this._handleMsgProperties(r)).sentTime=t.timestamp,r.messageUId=t.messageUId,this._pullingMsg?this._pullQueue.push(t.timestamp):(this._sentMessageMap[t.messageUId]=t.timestamp,r.messageType!==Pn.EXPANSION_NOTIFY?(this._watcher.message(r),this._conversationManager.setConversationCacheByMessage(r,!0)):this._receiveMessageExpansion(r))},t.prototype._pullMsg=function(e){if(this._channel){var t=this._channel.codec.decodeByPBName(e.data,ut),n=t.type,r=t.chrmId,i=t.time;if(ye.debug("s_ntf -> type: "+n+", chrmId: "+r+", time: "+i),2===n){var o=this._chrmsQueue[r];if(!o)return;o.queue.push(i),this._pullChrmMsg(r)}else this._pullQueue.push(i),this._syncMsg()}},t.prototype._startSyncInterval=function(){var e=this;this._stopSyncInterval(),this._intervalTimer=setInterval((function(){Date.now()-e._latestSyncTimestamp>=18e4&&e._syncMsg()}),3e4),this._latestSyncTimestamp=Date.now(),this._syncMsg()},t.prototype._stopSyncInterval=function(){-1!==this._intervalTimer&&(clearInterval(this._intervalTimer),this._intervalTimer=-1)},t.prototype._syncMsg=function(){return M(this,void 0,void 0,(function(){var e,t,n,r,i,o,s,a,c,u,d,l,h,f=this;return P(this,(function(p){switch(p.label){case 0:return this._pullingMsg?[2]:this._channel?(this._pullingMsg=!0,e=this._letterbox.getOutboxTime(this.currentUserId),t=this._letterbox.getInboxTime(this.currentUserId),ye.debug("pullMsg -> sendboxTime: "+e+", inboxTime: "+t),n=this._channel.codec.encodeSyncMsg({sendboxTime:e,inboxTime:t}),r=new Lr(Hr[Hr.pullMsg],n,this.currentUserId),[4,this._channel.send(r,it,{connectedTime:this._channel.connectedTime,currentUserId:this.currentUserId})]):(this._pullingMsg=!1,[2]);case 1:return i=p.sent(),o=i.code,s=i.data,this._latestSyncTimestamp=Date.now(),o===Oe.SUCCESS&&s?(a=s.list,c=s.finished,u=s.syncTime,ye.debug("pullMsg success -> syncTime: "+u+", finished: "+c),d=0,a.forEach((function(e){if(e.messageDirection===_r.SEND&&(d=Math.max(e.sentTime,d),f._sentMessageMap[e.messageUId]))delete f._sentMessageMap[e.messageUId];else if(e.messageType!==Pn.EXPANSION_NOTIFY){var t=f._handleMsgProperties(e);f._conversationManager.setConversationCacheByMessage(t,!0),f._watcher.message(t)}else f._receiveMessageExpansion(e)})),this._letterbox.setInboxTime(u,this.currentUserId),this._letterbox.setOutboxTime(d,this.currentUserId),this._pullingMsg=!1,l=this._pullQueue.filter((function(e){return e>u})),this._pullQueue.length=0,(h=this._pullQueue).push.apply(h,l),(!c||l.length>0)&&this._syncMsg(),[2]):(ye.warn("pullMsg failed -> code:",o,", data: ",s),this._pullingMsg=!1,[2])}}))}))},t.prototype._receiveMsg=function(e){if(this._channel&&!this._pullingMsg){var t=this._channel.codec.decodeByPBName(e.data,rt,{currentUserId:this.currentUserId,connectedTime:this._channel.connectedTime});(t=this._handleMsgProperties(t)).isStatusMessage||this._letterbox.setInboxTime(t.sentTime,this.currentUserId),t.messageType!==Pn.EXPANSION_NOTIFY?(this._watcher.message(t),this._conversationManager.setConversationCacheByMessage(t,!0)):this._receiveMessageExpansion(t)}},t.prototype._handleMsgProperties=function(e,t){void 0===t&&(t=!1);var n,r=e.messageType,i=e.isCounted,o=e.isPersited,s=e.isStatusMessage,a=r in C,c=r in this._customMessageType;return n=a?C[r]:c?this._customMessageType[r]:{isCounted:!de(i)&&i,isPersited:!de(o)&&o},Object.assign(e,{isCounted:n.isCounted,isPersited:n.isPersited,isStatusMessage:S.includes(r)}),t&&(e.isStatusMessage=s),e},t.prototype.getHistoryMessage=function(e,t,n,r,i){return M(this,void 0,void 0,(function(){var o,s,a,c,u,d,l,h,f;return P(this,(function(p){switch(p.label){case 0:return s=(o=this).currentUserId,a=o._channel,c=sr[e]||er,u=1===r&&0===n,a?(d=a.codec.encodeGetHistoryMsg(t,{timestamp:n,count:u?2:r,order:i}),[4,a.send(new Lr(c,d,s),lt,{currentUserId:s,connectedTime:a.connectedTime,conversation:{targetId:t}})]):[3,2];case 1:return l=p.sent(),(h=l.code)!==Oe.SUCCESS?[2,{code:h}]:(f=l.data,u&&2===f.list.length&&(f.hasMore=!0,0===i?f.list.shift():f.list.pop()),[2,{code:h,data:{list:f.list,hasMore:f.hasMore}}]);case 2:return[2,{code:Oe.RC_NET_CHANNEL_INVALID}]}}))}))},t.prototype.reportSDKInfo=function(e){var t=this.currentUserId,n=this._channel;if(n){ye.debug("reportSDKInfo ->",e);var r=n.codec.encodeReportSDKInfo(JSON.stringify(e)),i=new Lr(Hr[Hr.reportsdk],r,t);n.send(i).then((function(e){var t=e.code;t!==Oe.SUCCESS&&ye.warn("reportSDKInfo failed -> code: "+t)}))}},t.prototype.deleteRemoteMessage=function(e,t,n){return M(this,void 0,void 0,(function(){var r,i,o,s,a,c,u;return P(this,(function(d){switch(d.label){case 0:return i=(r=this).currentUserId,(o=r._channel)?(s=o.codec.encodeDeleteMessages(e,t,n),a=new Lr(Yn,s,i),[4,o.send(a)]):[3,2];case 1:return c=d.sent(),u=c.code,Oe.SUCCESS,[2,u];case 2:return[2,Oe.RC_NET_CHANNEL_INVALID]}}))}))},t.prototype.deleteRemoteMessageByTimestamp=function(e,t,n){return M(this,void 0,void 0,(function(){var r,i,o,s,a,c,u,d;return P(this,(function(l){switch(l.label){case 0:return i=(r=this).currentUserId,(o=r._channel)?(s=o.codec.encodeClearMessages(t,n),a=ar[e],c=new Lr(a,s,i),[4,o.send(c)]):[3,2];case 1:return u=l.sent(),d=u.code,Oe.SUCCESS,[2,d];case 2:return[2,Oe.RC_NET_CHANNEL_INVALID]}}))}))},t.prototype.getConversationList=function(e,t,n,r,i){return void 0===e&&(e=300),M(this,void 0,void 0,(function(){var i,o,s,a,c,u,d,l,h=this;return P(this,(function(f){switch(f.label){case 0:return o=(i=this).currentUserId,s=i._channel,t=t||J.PRIVATE,s?(a=s.codec.encodeOldConversationList({count:e,type:t,startTime:n,order:r}),c=new Lr(zn,a,o),[4,s.send(c,ft,{currentUserId:o,connectedTime:s.connectedTime,afterDecode:function(e){var t=e.conversationType,n=e.targetId,r=h._conversationManager.get(t,n);return Object.assign(e,r),e}})]):[3,2];case 1:return u=f.sent(),d=u.code,l=u.data,d!==Oe.SUCCESS?[2,{code:d}]:[2,{code:d,data:l}];case 2:return[2,{code:Oe.RC_NET_CHANNEL_INVALID}]}}))}))},t.prototype.removeConversation=function(e,t){return M(this,void 0,void 0,(function(){var n,r,i,o,s;return P(this,(function(a){switch(a.label){case 0:return(n=this._channel)?(r=n.codec.encodeOldConversationList({type:e}),i=new Lr(Qn,r,t),[4,n.send(i)]):[3,2];case 1:return o=a.sent(),ye.info("RemoveConversation =>",o),s=o.code,Oe.SUCCESS,[2,s];case 2:return[2,Oe.RC_NET_CHANNEL_INVALID]}}))}))},t.prototype.getConversation=function(e,t,n){return M(this,void 0,void 0,(function(){var r,i,o,s,a,c;return P(this,(function(u){switch(u.label){case 0:return(r=this._conversationManager.get(e,t))?[4,this.getHistoryMessage(e,t,0,1,0)]:[2,{code:Oe.CONVER_GET_ERROR}];case 1:return i=u.sent(),o=i.code,s=i.data,o!==Oe.SUCCESS?[2,{code:Oe.CONVER_GET_ERROR}]:(a=(null==s?void 0:s.list[0])||null,c={conversationType:e,targetId:t,channelId:n,unreadMessageCount:r.unreadMessageCount||0,latestMessage:a,notificationStatus:r.notificationStatus||Vn.CLOSE,isTop:r.isTop||!1,lastUnreadTime:r.lastUnreadTime||0},[2,{code:Oe.SUCCESS,data:c}])}}))}))},t.prototype.getAllConversationUnreadCount=function(e,t,n){var r=this._conversationManager.getAllUnreadCount(e,t,n);return Promise.resolve({code:Oe.SUCCESS,data:r})},t.prototype.getConversationUnreadCount=function(e,t){var n=this._conversationManager.getUnreadCount(e,t);return Promise.resolve({code:Oe.SUCCESS,data:n})},t.prototype.clearConversationUnreadCount=function(e,t){return this._conversationManager.clearUnreadCount(e,t),Promise.resolve(Oe.SUCCESS)},t.prototype.saveConversationMessageDraft=function(e,t,n){return this._conversationManager.setDraft(e,t,n),Promise.resolve(Oe.SUCCESS)},t.prototype.getConversationMessageDraft=function(e,t){var n=this._conversationManager.getDraft(e,t);return Promise.resolve({code:Oe.SUCCESS,data:n})},t.prototype.clearConversationMessageDraft=function(e,t){return this._conversationManager.clearDraft(e,t),Promise.resolve(Oe.SUCCESS)},t.prototype.pullConversationStatus=function(e){return M(this,void 0,void 0,(function(){var t,n,r,i,o,s,a,c;return P(this,(function(u){switch(u.label){case 0:return n=(t=this)._channel,r=t.currentUserId,n?(i=n.codec.encodeGetConversationStatus(e),o=new Lr(Hr[Hr.pullSeAtts],i,r),[4,n.send(o,tn)]):[3,2];case 1:return s=u.sent(),a=s.code,c=s.data,a!==Oe.SUCCESS?[2,{code:a}]:[2,{code:a,data:c}];case 2:return[2,{code:Oe.RC_NET_CHANNEL_INVALID}]}}))}))},t.prototype.batchSetConversationStatus=function(e){return M(this,void 0,void 0,(function(){var t,n,r,i,o,s,a,c,u,d=this;return P(this,(function(l){switch(l.label){case 0:return n=(t=this).currentUserId,(r=t._channel)?(i=r.codec.encodeSetConversationStatus(e),o=new Lr(Zn,i,n),[4,r.send(o,sn)]):[3,2];case 1:return s=l.sent(),a=s.code,c=s.data,a===Oe.SUCCESS?(u=c,e.forEach((function(e){d._conversationManager.addStatus(A(A({},e),{updatedTime:u.version}),!0)})),[2,a]):[2,a];case 2:return[2,Oe.RC_NET_CHANNEL_INVALID]}}))}))},t.prototype._joinChrm=function(e,t,n){return M(this,void 0,void 0,(function(){var r,i,o,s,a;return P(this,(function(c){switch(c.label){case 0:return(r=this._channel)?(i=r.codec.encodeJoinOrQuitChatRoom(),o=new Lr(n?Kn:qn,i,e),[4,r.send(o)]):[2,Oe.RC_NET_CHANNEL_INVALID];case 1:return s=c.sent(),a=s.code,s.data,a===Oe.SUCCESS&&(this._chrmsQueue[e]||(this._chrmsQueue[e]={pulling:!1,queue:[],timestamp:0}),this._pullChrmMsg(e,t),this._naviInfo.kvStorage&&this._chrmEntryHandler.pullEntry(e,0),this._joinedChrmManager.set(e,t)),[2,a]}}))}))},t.prototype._rejoinChrm=function(){return M(this,void 0,void 0,(function(){var e,t,n,r,i,o;return P(this,(function(s){switch(s.label){case 0:for(n in e=this._joinedChrmManager.get(),t=[],e)t.push(n);r=0,s.label=1;case 1:return r<t.length?(i=t[r],[4,this._joinChrm(i,e[i]||10,!0)]):[3,4];case 2:(o=s.sent())===Oe.SUCCESS?this._watcher.chatroom({rejoinedRoom:{chatroomId:i,count:e[i]}}):this._watcher.chatroom({rejoinedRoom:{chatroomId:i,errorCode:o}}),s.label=3;case 3:return r++,[3,1];case 4:return[2]}}))}))},t.prototype._pullChrmMsg=function(e,t){return void 0===t&&(t=10),M(this,void 0,void 0,(function(){var n,r,i,o,s,a,c,u,d,l,h,f=this;return P(this,(function(p){switch(p.label){case 0:return this._channel?(n=this._chrmsQueue[e],r=n.pulling,i=n.timestamp,r?[2]:(n.pulling=!0,o=this._channel.codec.encodeChrmSyncMsg(i,t),s=new Lr(Hr[Hr.chrmPull],o,e),[4,this._channel.send(s,it,{connectedTime:this._channel.connectedTime,currentUserId:this.currentUserId})])):[2];case 1:return a=p.sent(),c=a.code,u=a.data,n.pulling=!1,c===Oe.SUCCESS&&u?(d=u.list,l=u.syncTime,h=u.finished,n.timestamp=l,n.queue=n.queue.filter((function(e){return e>l})),d.forEach((function(e){e.sentTime<i||f._watcher.message(e)})),(!h||n.queue.length>0)&&this._pullChrmMsg(e),[2]):(ye.warn("pull chatroom msg failed, code:",c,", data:",u),[2])}}))}))},t.prototype.joinChatroom=function(e,t){return M(this,void 0,void 0,(function(){return P(this,(function(n){return[2,this._joinChrm(e,t,!1)]}))}))},t.prototype.joinExistChatroom=function(e,t){return M(this,void 0,void 0,(function(){return P(this,(function(n){return[2,this._joinChrm(e,t,!0)]}))}))},t.prototype.quitChatroom=function(e){return M(this,void 0,void 0,(function(){var t,n,r,i,o;return P(this,(function(s){switch(s.label){case 0:return(t=this._channel)?(n=t.codec.encodeJoinOrQuitChatRoom(),r=new Lr(Wn,n,e),[4,t.send(r)]):[2,Oe.RC_NET_CHANNEL_INVALID];case 1:return i=s.sent(),(o=i.code)===Oe.SUCCESS&&(delete this._chrmsQueue[e],this._chrmEntryHandler.reset(e),this._joinedChrmManager.remove(e)),[2,o]}}))}))},t.prototype.getChatroomInfo=function(e,t,n){return M(this,void 0,void 0,(function(){var r,i,o,s,a,c;return P(this,(function(u){switch(u.label){case 0:return(r=this._channel)?(i=r.codec.encodeGetChatRoomInfo(t,n),o=new Lr(Hr[Hr.queryChrmI],i,e),[4,r.send(o,Rt)]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return s=u.sent(),a=s.code,c=s.data,a!==Oe.SUCCESS?[2,{code:a}]:[2,{code:a,data:c}]}}))}))},t.prototype.getChatroomHistoryMessages=function(e,t,n,r){return M(this,void 0,void 0,(function(){var i,o,s,a,c,u;return P(this,(function(d){switch(d.label){case 0:return(i=this._channel)?(o=i.codec.encodeGetHistoryMsg(e,{timestamp:t,count:n,order:r}),s=new Lr(nr,o,e),[4,i.send(s,lt,{conversation:{targetId:e}})]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return a=d.sent(),c=a.code,u=a.data,c!==Oe.SUCCESS?[2,{code:c}]:[2,{code:c,data:{list:u.list,hasMore:u.hasMore}}]}}))}))},t.prototype._modifyChatroomKV=function(e,t){return M(this,void 0,void 0,(function(){var n,r,i,o,s,a,c,u;return P(this,(function(d){switch(d.label){case 0:return r=(n=this)._channel,i=n.currentUserId,r?(o=r.codec.encodeModifyChatRoomKV(e,t,i),s=t.type===We.UPDATE?$n:Jn,a=new Lr(s,o,e),[4,r.send(a)]):[2,Oe.RC_NET_CHANNEL_INVALID];case 1:return c=d.sent(),(u=c.code)===Oe.SUCCESS?(this._chrmEntryHandler.setLocal(e,{kvEntries:[t],syncTime:(new Date).getTime()},i),[2,u]):[2,u]}}))}))},t.prototype.setChatroomEntry=function(e,t){return M(this,void 0,void 0,(function(){return P(this,(function(n){return t.type=We.UPDATE,[2,this._modifyChatroomKV(e,t)]}))}))},t.prototype.forceSetChatroomEntry=function(e,t){return M(this,void 0,void 0,(function(){return P(this,(function(n){return t.type=We.UPDATE,t.isOverwrite=!0,[2,this._modifyChatroomKV(e,t)]}))}))},t.prototype.removeChatroomEntry=function(e,t){return M(this,void 0,void 0,(function(){return P(this,(function(n){return t.type=We.DELETE,[2,this._modifyChatroomKV(e,t)]}))}))},t.prototype.forceRemoveChatroomEntry=function(e,t){return M(this,void 0,void 0,(function(){return P(this,(function(n){return t.type=We.DELETE,t.isOverwrite=!0,[2,this._modifyChatroomKV(e,t)]}))}))},t.prototype.getChatroomEntry=function(e,t){var n=this._chrmEntryHandler.getValue(e,t);return n?Promise.resolve({code:Oe.SUCCESS,data:n}):Promise.resolve({code:Oe.CHATROOM_KEY_NOT_EXIST})},t.prototype.getAllChatroomEntry=function(e){var t=this._chrmEntryHandler.getAll(e);return Promise.resolve({code:Oe.SUCCESS,data:t})},t.prototype.pullChatroomEntry=function(e,t){return M(this,void 0,void 0,(function(){var n,r,i,o,s,a,c,u,d,l;return P(this,(function(h){switch(h.label){case 0:return r=(n=this)._channel,i=n.currentUserId,r?(o=r.codec.encodePullChatRoomKV(t),s=new Lr(Hr[Hr.pullKV],o,e),[4,r.send(s,Wt)]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return a=h.sent(),c=a.code,u=a.data,c===Oe.SUCCESS?(this._chrmEntryHandler.setLocal(e,u,i),d=u.kvEntries,l=[],d.length>0&&(d.forEach((function(t){var n=t.key,r=t.value,i=t.type,o=t.timestamp;l.push({key:n,value:r,type:i,timestamp:o,chatroomId:e})})),this._watcher.chatroom({updatedEntries:l})),[2,{code:c,data:u}]):[2,{code:c}]}}))}))},t.prototype.sendMessage=function(e,t,n){var r;return M(this,void 0,void 0,(function(){var i,o,s,a,c,u,d,l,h,f;return P(this,(function(p){switch(p.label){case 0:return this._channel?(n=function(e,t){return"RC:SRSMsg"===e.messageType&&Object.assign(e,{directionalUserIdList:[t]}),e}(n,this.currentUserId),n=this._handleMsgProperties(n,!0),i=!![J.PRIVATE,J.GROUP].includes(e)&&n.isStatusMessage,o=i?function(e){var t;return(t={},t[J.PRIVATE]=Hr.ppMsgS,t[J.GROUP]=Hr.pgMsgS,t)[e]}(e):function(e){var t;return(t={},t[J.PRIVATE]=Hr.ppMsgP,t[J.GROUP]=Hr.pgMsgP,t[J.CHATROOM]=Hr.chatMsg,t[J.CUSTOMER_SERVICE]=Hr.pcMsgP,t[J.RTC_ROOM]=Hr.prMsgS,t)[e]}(e)||Hr.ppMsgP,i&&(n.isPersited=!1,n.isCounted=!1),n.pushContent=(null===(r=n.pushConfig)||void 0===r?void 0:r.pushContent)||n.pushContent||"",s=this._channel.codec.encodeUpMsg({type:e,targetId:t},n),(a=new Mr(Hr[o],s,t)).setHeaderQos(Ge.AT_LEAST_ONCE),i?(this._channel.sendOnly(a),[2,{code:Oe.SUCCESS,data:Ei(e,t,A({},n),"",0,this.currentUserId)}]):(c=Date.now()-this._localConnectedTime+this._connectedTime,u=Ei(e,t,A({},n),"",c,this.currentUserId),[4,this._channel.send(a)])):[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return d=p.sent(),l=d.code,h=d.data,l!==Oe.SUCCESS?[2,{code:l,data:u}]:(f=h,this._sentMessageMap[f.messageUId]=f.timestamp,u.sentTime=f.timestamp,u.messageUId=f.messageUId,this._conversationManager.setConversationCacheByMessage(u,!0),[2,{code:Oe.SUCCESS,data:u}])}}))}))},t.prototype.recallMsg=function(e,t,n,r,i){var o;return M(this,void 0,void 0,(function(){var s,a,c,u,d,l,h,f,p;return P(this,(function(g){switch(g.label){case 0:return this._channel?(s=i.user,a={content:{conversationType:e,targetId:t,messageUId:n,sentTime:r,user:s},messageType:"RC:RcCmd",disableNotification:null==i?void 0:i.disableNotification,pushConfig:null==i?void 0:i.pushConfig,pushContent:(null===(o=i.pushConfig)||void 0===o?void 0:o.pushContent)||i.pushContent||""},c=Hr[Hr.recallMsg],u=this._channel.codec.encodeUpMsg({type:e,targetId:t},a),(d=new Mr(c,u,this.currentUserId)).setHeaderQos(Ge.AT_LEAST_ONCE),[4,this._channel.send(d)]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return l=g.sent(),h=l.code,f=l.data,h!==Oe.SUCCESS?[2,{code:h}]:(p=f,[2,{code:Oe.SUCCESS,data:Ei(e,t,A({},a),p.messageUId,p.timestamp,this.currentUserId)}])}}))}))},t.prototype.sendReadReceiptMessage=function(e,t,n){return M(this,void 0,void 0,(function(){var r,i;return P(this,(function(o){switch(o.label){case 0:return this._channel?(r=this._channel.codec.encodeReadReceipt(t,n),i=new Lr(Hr[Hr.rrMsg],r,e),[4,this._channel.send(i)]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return[2,o.sent()]}}))}))},t.prototype.getMessageReader=function(e,t,n){return M(this,void 0,void 0,(function(){var r,i;return P(this,(function(o){switch(o.label){case 0:return this._channel?(r=this._channel.codec.encodeMessageReader(t,n),i=new Lr(Hr[Hr.rrList],r,e),[4,this._channel.send(i,un)]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return[2,o.sent()]}}))}))},t.prototype.pullUserSettings=function(e){return M(this,void 0,void 0,(function(){var t,n;return P(this,(function(r){return this._channel?(t=this._channel.codec.encodePullUserSetting(e),n=new Lr(Hr[Hr.pullUS],t,this.currentUserId),[2,this._channel.send(n,Zt)]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}]}))}))},t.prototype.getFileToken=function(e,t,n,r){return M(this,void 0,void 0,(function(){var i,o,s,a,c,u;return P(this,(function(d){switch(d.label){case 0:return this._channel?(i=r&&"uploads"!==r?t||"":Ne(e,t),o=this._channel.codec.encodeGetFileToken(e,i,n||"",r||""),s=new Lr(Hr[Hr.qnTkn],o,this.currentUserId),[4,this._channel.send(s,Ft)]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return a=d.sent(),c=a.code,u=a.data,u=Object.assign(u,{fileName:i}),c===Oe.SUCCESS?[2,{code:c,data:u}]:[2,{code:c}]}}))}))},t.prototype.getFileUrl=function(e,t,n,r){return M(this,void 0,void 0,(function(){var i,o,s,a,c,u,d,l,h;return P(this,(function(f){switch(f.label){case 0:return this._channel?(i="",o="",s="",t===mi.QINIU?(o=Ht,s=Yt):(o=Gt,s=qt),i=t===mi.QINIU?Hr[Hr.qnUrl]:t===mi.AWS?Hr[Hr.s3Url]:t===mi.STC?Hr[Hr.stcUrl]:Hr[Hr.aliUrl],a=this._channel.codec.encodeGetFileUrl(o,e,n,r),c=new Lr(i,a,this.currentUserId),[4,this._channel.send(c,s)]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return u=f.sent(),d=u.code,l=u.data,h=l,d===Oe.SUCCESS?[2,{code:d,data:h}]:[2,{code:d}]}}))}))},t.prototype.disconnect=function(){this._channel&&(this._channel.close(),this._channel=void 0),this._stopSyncInterval()},t.prototype.destroy=function(){throw new Error("JSEngine's method not implemented.")},t.prototype.registerMessageType=function(e,t,n,r){this._customMessageType[e]={isPersited:t,isCounted:n}},t.prototype.createTag=function(e){return M(this,void 0,void 0,(function(){var t,n,r,i,o,s,a;return P(this,(function(c){switch(c.label){case 0:return this._channel?(t=this._userSettingManager.getVersion(),n=this._channel.codec.encodeCreateTag([e],t),r=new Lr(Hr[Hr.addSeTag],n,this.currentUserId),[4,this._channel.send(r,zt)]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return i=c.sent(),o=i.code,s=i.data,o!==Oe.SUCCESS?[2,{code:o}]:(a=s.version,this._userSettingManager.addTag([A(A({},e),{createdTime:a})],a),[2,{code:Oe.SUCCESS,data:s}])}}))}))},t.prototype.removeTag=function(e){return M(this,void 0,void 0,(function(){var t,n,r,i,o,s,a;return P(this,(function(c){switch(c.label){case 0:return this._channel?(t=this._userSettingManager.getVersion(),n=this._channel.codec.encodeRemoveTag([e],t),r=new Lr(Hr[Hr.delSeTag],n,this.currentUserId),[4,this._channel.send(r,zt)]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return i=c.sent(),o=i.code,s=i.data,o!==Oe.SUCCESS?[2,{code:o}]:(a=s.version,this._userSettingManager.deleteTag([e],a),[2,{code:Oe.SUCCESS}])}}))}))},t.prototype.updateTag=function(e){return M(this,void 0,void 0,(function(){var t,n,r,i,o,s,a;return P(this,(function(c){switch(c.label){case 0:return this._channel?(t=this._userSettingManager.getVersion(),n=this._channel.codec.encodeCreateTag([e],t),r=new Lr(Hr[Hr.addSeTag],n,this.currentUserId),[4,this._channel.send(r,zt)]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return i=c.sent(),o=i.code,s=i.data,o!==Oe.SUCCESS?[2,{code:o}]:(a=s.version,this._userSettingManager.addTag([e],a),[2,{code:Oe.SUCCESS,data:s}])}}))}))},t.prototype.getTagList=function(){return M(this,void 0,void 0,(function(){var e,t;return P(this,(function(n){return e=this._userSettingManager.getTags(),t=this._conversationManager.getConversationListForTag(),e.forEach((function(e){e.conversationCount=t[e.tagId]?t[e.tagId].length:0})),[2,{code:Oe.SUCCESS,data:e}]}))}))},t.prototype.addTagForConversations=function(e,t){return M(this,void 0,void 0,(function(){var n,r,i,o,s=this;return P(this,(function(a){switch(a.label){case 0:return this._channel?this._userSettingManager.getTagById(e)?(n=this._channel.codec.encodeUpdateConversationTag([{tagId:e}],t),r=new Lr(Hr[Hr.addTag],n,this.currentUserId),[4,this._channel.send(r)]):[2,{code:Oe.TAG_NOT_EXIST}]:[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return(i=a.sent().code)!==Oe.SUCCESS?[2,{code:i}]:((o={})[e]={},t.forEach((function(e){s._conversationManager.addTagStatus(e.type,e.targetId,o)})),[2,{code:Oe.SUCCESS}])}}))}))},t.prototype.removeTagForConversations=function(e,t){return M(this,void 0,void 0,(function(){var n,r,i,o=this;return P(this,(function(s){switch(s.label){case 0:return this._channel?(n=this._channel.codec.encodeUpdateConversationTag([{tagId:e}],t),r=new Lr(Hr[Hr.delTag],n,this.currentUserId),[4,this._channel.send(r)]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return(i=s.sent().code)!==Oe.SUCCESS?[2,{code:i}]:(t.forEach((function(t){o._conversationManager.deleteTagStatus(t.type,t.targetId,[e])})),[2,{code:Oe.SUCCESS}])}}))}))},t.prototype.removeTagsForConversation=function(e,t){return M(this,void 0,void 0,(function(){var n,r,i,o,s,a;return P(this,(function(c){switch(c.label){case 0:return this._channel?(n=e.type,r=e.targetId,i=t.map((function(e){return{tagId:e}})),o=this._channel.codec.encodeUpdateConversationTag(i,[e]),s=new Lr(Hr[Hr.delTag],o,this.currentUserId),[4,this._channel.send(s)]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return(a=c.sent().code)!==Oe.SUCCESS?[2,{code:a}]:(this._conversationManager.deleteTagStatus(n,r,t),[2,{code:Oe.SUCCESS}])}}))}))},t.prototype.getConversationListByTag=function(e,t,n){return M(this,void 0,void 0,(function(){var r,i,o,s,a,c,u,d,l;return P(this,(function(h){switch(h.label){case 0:return i=(r=this).currentUserId,(o=r._channel)?(s=o.codec.encodeOldConversationList({count:n,type:J.PRIVATE,startTime:t}),a=new Lr(zn,s,i),[4,o.send(a,ft,{currentUserId:i,connectedTime:o.connectedTime})]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return c=h.sent(),u=c.code,d=c.data,l=this._conversationHasTagFilter(e,d),ye.info("GetConversationListByTag",l),u!==Oe.SUCCESS?[2,{code:u}]:[2,{code:u,data:l}]}}))}))},t.prototype._conversationHasTagFilter=function(e,t){var n=this,r=[],i=[];function o(e,t){return e.latestMessage&&t.latestMessage?e.latestMessage.sentTime-t.latestMessage.sentTime:0}return t.forEach((function(t){var o=t.conversationType,s=t.targetId,a=n._conversationManager.get(o,s),c=a.hasMentioned,u=a.mentionedInfo,d=a.lastUnreadTime,l=a.notificationStatus,h=a.isTop,f=a.tags,p=a.unreadMessageCount,g=f&&f[e];if(g){var m=A(A({},t),{hasMentioned:c,mentionedInfo:u,lastUnreadTime:d,notificationStatus:l,isTop:h,unreadMessageCount:p});g.isTop?r.push(A(A({},m),{isTopInTag:!0})):i.push(A(A({},m),{isTopInTag:!1}))}})),k(k([],r.sort(o)),i.sort(o))},t.prototype.getUnreadCountByTag=function(e,t){return M(this,void 0,void 0,(function(){var n;return P(this,(function(r){return this._channel?(n=this._conversationManager.getUnreadCountByTag(e,t),[2,{code:Oe.SUCCESS,data:n}]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}]}))}))},t.prototype.setConversationStatusInTag=function(e,t,n){return M(this,void 0,void 0,(function(){var r,i,o,s,a,c,u,d,l;return P(this,(function(h){switch(h.label){case 0:return this._channel?(r=t.targetId,i=t.type,o=n.isTop,s=[{tagId:e,isTop:o}],(a=this._conversationManager.get(i,r)).tags&&Object.hasOwnProperty.call(a.tags,e)?(c=this._channel.codec.encodeUpdateConversationTag(s,[t]),u=new Lr(Hr[Hr.addTag],c,this.currentUserId),[4,this._channel.send(u)]):[2,{code:Oe.NO_TAG_IN_CONVER}]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return(d=h.sent().code)!==Oe.SUCCESS?[2,{code:d}]:((l={})[e]={},o&&(l[e].isTop=!0),this._conversationManager.addTagStatus(i,r,l),[2,{code:Oe.SUCCESS}])}}))}))},t.prototype.getTagsForConversation=function(e){var t;return M(this,void 0,void 0,(function(){var n,r,i,o;return P(this,(function(s){if(!this._channel)return[2,{code:Oe.RC_NET_CHANNEL_INVALID}];if(n=this._conversationManager.get(e.type,e.targetId),r=this._userSettingManager.getTagsInfo(),i=[],n.tags)for(o in n.tags)i.push({tagId:o,tagName:null===(t=r[o])||void 0===t?void 0:t.tagName});return[2,{code:Oe.SUCCESS,data:i}]}))}))},t.prototype.joinRTCRoom=function(e,t,n){return M(this,void 0,void 0,(function(){var r,i;return P(this,(function(o){return this._channel?(r=this._channel.codec.encodeJoinRTCRoom(t,n),i=new Lr(Hr[Hr.rtcRJoin_data],r,e),[2,this._channel.send(i,bt)]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}]}))}))},t.prototype.quitRTCRoom=function(e){return M(this,void 0,void 0,(function(){var t,n;return P(this,(function(r){switch(r.label){case 0:return this._channel?(t=this._channel.codec.encodeQuitRTCRoom(),n=new Lr(Hr[Hr.rtcRExit],t,e),[4,this._channel.send(n)]):[2,Oe.RC_NET_CHANNEL_INVALID];case 1:return[2,r.sent().code]}}))}))},t.prototype.rtcPing=function(e,t,n){return M(this,void 0,void 0,(function(){var r,i;return P(this,(function(o){switch(o.label){case 0:return this._channel?(r=this._channel.codec.encodeJoinRTCRoom(t,n),i=new Lr(Hr[Hr.rtcPing],r,e),[4,this._channel.send(i)]):[2,Oe.RC_NET_CHANNEL_INVALID];case 1:return[2,o.sent().code]}}))}))},t.prototype.getRTCRoomInfo=function(e){return M(this,void 0,void 0,(function(){var t,n;return P(this,(function(r){return this._channel?(t=this._channel.codec.encodeGetRTCRoomInfo(),n=new Lr(Hr[Hr.rtcRInfo],t,e),[2,this._channel.send(n,Dt)]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}]}))}))},t.prototype.getRTCUserInfoList=function(e){return M(this,void 0,void 0,(function(){var t,n,r,i,o;return P(this,(function(s){switch(s.label){case 0:return this._channel?(t=this._channel.codec.encodeGetRTCRoomInfo(),n=new Lr(Hr[Hr.rtcUData],t,e),[4,this._channel.send(n,bt)]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return r=s.sent(),i=r.code,o=r.data,[2,{code:i,data:o?{users:o.users}:o}]}}))}))},t.prototype.setRTCUserInfo=function(e,t,n){return M(this,void 0,void 0,(function(){var r,i;return P(this,(function(o){switch(o.label){case 0:return this._channel?(r=this._channel.codec.encodeSetRTCUserInfo(t,n),i=new Lr(Hr[Hr.rtcUPut],r,e),[4,this._channel.send(i)]):[2,Oe.RC_NET_CHANNEL_INVALID];case 1:return[2,o.sent().code]}}))}))},t.prototype.removeRTCUserInfo=function(e,t){return M(this,void 0,void 0,(function(){var n,r;return P(this,(function(i){switch(i.label){case 0:return this._channel?(n=this._channel.codec.encodeRemoveRTCUserInfo(t),r=new Mr(Hr[Hr.rtcUDel],n,e),[4,this._channel.send(r)]):[2,Oe.RC_NET_CHANNEL_INVALID];case 1:return[2,i.sent().code]}}))}))},t.prototype.setRTCData=function(e,t,n,r,i,o){return M(this,void 0,void 0,(function(){var s,a;return P(this,(function(c){switch(c.label){case 0:return this._channel?(s=this._channel.codec.encodeSetRTCData(t,n,r,i,o),a=new Mr(Hr[Hr.rtcSetData],s,e),[4,this._channel.send(a)]):[2,Oe.RC_NET_CHANNEL_INVALID];case 1:return[2,c.sent().code]}}))}))},t.prototype.setRTCTotalRes=function(e,t,n,r,i){return M(this,void 0,void 0,(function(){var o,s;return P(this,(function(a){switch(a.label){case 0:return this._channel?(o=this._channel.codec.encodeUserSetRTCData(t,n,r,i),s=new Mr(Hr[Hr.userSetData],o,e),[4,this._channel.send(s)]):[2,Oe.RC_NET_CHANNEL_INVALID];case 1:return[2,a.sent().code]}}))}))},t.prototype.getRTCData=function(e,t,n,r){if(!this._channel)return Promise.resolve({code:Oe.RC_NET_CHANNEL_INVALID});var i=this._channel.codec.encodeGetRTCData(t,n,r),o=new Lr(Hr[Hr.rtcQryData],i,e);return this._channel.send(o,kt)},t.prototype.removeRTCData=function(e,t,n,r,i){return M(this,void 0,void 0,(function(){var o,s;return P(this,(function(a){switch(a.label){case 0:return this._channel?(o=this._channel.codec.encodeRemoveRTCData(t,n,r,i),s=new Mr(Hr[Hr.rtcDelData],o,e),[4,this._channel.send(s)]):[2,Oe.RC_NET_CHANNEL_INVALID];case 1:return[2,a.sent().code]}}))}))},t.prototype.setRTCOutData=function(e,t,n,r){throw new Error("JSEngine's method not implemented.")},t.prototype.getRTCOutData=function(e,t){throw new Error("JSEngine's method not implemented.")},t.prototype.getRTCToken=function(e,t,n){return M(this,void 0,void 0,(function(){var r,i;return P(this,(function(o){return this._channel?(r=this._channel.codec.encodeJoinRTCRoom(t,n),i=new Lr(Hr[Hr.rtcToken],r,e),[2,this._channel.send(i,Pt)]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}]}))}))},t.prototype.setRTCState=function(e,t){return M(this,void 0,void 0,(function(){var n,r;return P(this,(function(i){switch(i.label){case 0:return this._channel?(n=this._channel.codec.encodeSetRTCState(t),r=new Lr(Hr[Hr.rtcUserState],n,e),[4,this._channel.send(r)]):[2,Oe.RC_NET_CHANNEL_INVALID];case 1:return[2,i.sent().code]}}))}))},t.prototype.getRTCUserInfo=function(e){return M(this,void 0,void 0,(function(){return P(this,(function(e){throw new Error("Method not implemented.")}))}))},t.prototype.getRTCUserList=function(e){if(!this._channel)return Promise.resolve({code:Oe.RC_NET_CHANNEL_INVALID});var t=this._channel.codec.encodeGetRTCRoomInfo(),n=new Lr(Hr[Hr.rtcUList],t,e);return this._channel.send(n,bt)},t.prototype.joinLivingRoomAsAudience=function(e,t,n){return void 0===t&&(t=Un.LIVE),M(this,void 0,void 0,(function(){var r,i,o,s,a;return P(this,(function(c){switch(c.label){case 0:return this._channel?(r=this._channel.codec.encodeJoinRTCRoom(t,n),i=new Lr(Hr[Hr.viewerJoinR],r,e),[4,this._channel.send(i,Pt)]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return o=c.sent(),s=o.code,a=o.data,s!==Oe.SUCCESS?[2,{code:s}]:(this._rtcKVManager.pullEntry(e,0),[2,{code:s,data:{token:a.rtcToken}}])}}))}))},t.prototype.quitLivingRoomAsAudience=function(e){return M(this,void 0,void 0,(function(){var t,n,r;return P(this,(function(i){switch(i.label){case 0:return this._channel?(t=this._channel.codec.encodeQuitRTCRoom(),n=new Lr(Hr[Hr.viewerExitR],t,e),[4,this._channel.send(n)]):[2,Oe.RC_NET_CHANNEL_INVALID];case 1:return r=i.sent().code,this._rtcKVManager.reset(),[2,r]}}))}))},t.prototype.rtcIdentityChange=function(e,t,n){return M(this,void 0,void 0,(function(){var r,i,o,s,a;return P(this,(function(c){switch(c.label){case 0:return this._channel?(r=this._channel.codec.encodeIdentityChangeInfo(t,n),i=new Lr(Hr[Hr.rtcIdentityChange],r,e),[4,this._channel.send(i,bt)]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return o=c.sent(),s=o.code,a=o.data,s===Oe.SUCCESS&&t===pr.AnchorToViewer&&(this._rtcKVManager.reset(),this._rtcKVManager.pullEntry(e,0)),s!==Oe.SUCCESS?[2,{code:s}]:[2,{code:s,data:a}]}}))}))},t.prototype.pullRTCRoomEntry=function(e,t){return M(this,void 0,void 0,(function(){var t,n,r,i,o,s,a,c,u;return P(this,(function(d){switch(d.label){case 0:return n=(t=this)._channel,r=t.currentUserId,n?(i=n.codec.encodePullRTCRoomKV(e,0),o=new Lr(Hr[Hr.rtcPullKv],i,r),[4,n.send(o,yn)]):[2,{code:Oe.RC_NET_CHANNEL_INVALID}];case 1:return s=d.sent(),a=s.code,c=s.data,a===Oe.SUCCESS?(u=c.kvEntries,this._watcher.onRTCDataChange(u),[2,{code:a,data:c}]):[2,{code:a}]}}))}))},t.prototype.callExtra=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Promise.resolve({code:Oe.EXTRA_METHOD_UNDEFINED})},t.prototype.clearConversations=function(){throw new Error("Method not implemented.")},t.prototype.setUserStatusListener=function(e,t){throw new Error("Method not implemented.")},t.prototype.setUserStatus=function(e){throw new Error("Method not implemented.")},t.prototype.subscribeUserStatus=function(e){throw new Error("Method not implemented.")},t.prototype.getUserStatus=function(e){throw new Error("Method not implemented.")},t.prototype.addToBlacklist=function(e){throw new Error("Method not implemented.")},t.prototype.removeFromBlacklist=function(e){throw new Error("Method not implemented.")},t.prototype.getBlacklist=function(){throw new Error("Method not implemented.")},t.prototype.getBlacklistStatus=function(e){throw new Error("Method not implemented.")},t.prototype.insertMessage=function(e,t,n){throw new Error("Method not implemented.")},t.prototype.deleteMessages=function(e){throw new Error("Method not implemented.")},t.prototype.deleteMessagesByTimestamp=function(e,t,n,r,i){throw new Error("Method not implemented.")},t.prototype.clearMessages=function(e,t,n){throw new Error("Method not implemented.")},t.prototype.getMessage=function(e){throw new Error("Method not implemented.")},t.prototype.setMessageContent=function(e,t,n){throw new Error("Method not implemented.")},t.prototype.setMessageSearchField=function(e,t,n){throw new Error("Method not implemented.")},t.prototype.searchConversationByContent=function(e,t,n,r){throw new Error("Method not implemented.")},t.prototype.searchMessageByContent=function(e,t,n,r,i,o){throw new Error("Method not implemented.")},t.prototype.getUnreadMentionedMessages=function(e,t){throw new Error("Method not implemented.")},t.prototype.setMessageSentStatus=function(e,t){throw new Error("Method not implemented.")},t.prototype.setMessageReceivedStatus=function(e,t){throw new Error("Method not implemented.")},t.prototype.clearUnreadCountByTimestamp=function(e,t,n,r){throw new Error("Method not implemented.")},t.prototype.getConversationNotificationStatus=function(e,t,n){throw new Error("Method not implemented.")},t.prototype.getRemoteHistoryMessages=function(e,t,n,r,i,o){throw new Error("Method not implemented.")},t}(zr),Ci=function(){function e(e){this._context=e}return e.prototype.getCoreVersion=function(){return this._context.coreVersion},e.prototype.getAPIVersion=function(){return this._context.apiVersion},e.prototype.getAppkey=function(){return this._context.appkey},e.prototype.getCurrentId=function(){return this._context.getCurrentUserId()},e.prototype.getConnectionStatus=function(){return this._context.getConnectionStatus()},e.prototype.sendMessage=function(e,t,n){return this._context.sendMessage(e,t,n)},e.prototype.registerMessageType=function(e,t,n,r){void 0===r&&(r=[]),this._context.registerMessageType(e,t,n,r)},e}(),Ri=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return N(t,e),t.prototype.getNaviInfo=function(){return this._context.getInfoFromCache()},t.prototype.joinRTCRoom=function(e,t,n){return this._context.joinRTCRoom(e,t,n)},t.prototype.quitRTCRoom=function(e){return this._context.quitRTCRoom(e)},t.prototype.rtcPing=function(e,t,n){return this._context.rtcPing(e,t,n)},t.prototype.getRTCRoomInfo=function(e){return this._context.getRTCRoomInfo(e)},t.prototype.getRTCUserInfoList=function(e){return this._context.getRTCUserInfoList(e)},t.prototype.getRTCUserInfo=function(e){return this._context.getRTCUserInfo(e)},t.prototype.setRTCUserInfo=function(e,t,n){return this._context.setRTCUserInfo(e,t,n)},t.prototype.removeRTCUserInfo=function(e,t){return this._context.removeRTCUserInfo(e,t)},t.prototype.setRTCData=function(e,t,n,r,i,o){return this._context.setRTCData(e,t,n,r,i,o)},t.prototype.setRTCTotalRes=function(e,t,n,r,i){return this._context.setRTCTotalRes(e,t,n,r,i)},t.prototype.getRTCData=function(e,t,n,r){return this._context.getRTCData(e,t,n,r)},t.prototype.removeRTCData=function(e,t,n,r,i){return this._context.removeRTCData(e,t,n,r,i)},t.prototype.setRTCOutData=function(e,t,n,r){return this._context.setRTCOutData(e,t,n,r)},t.prototype.getRTCOutData=function(e,t){return this._context.getRTCOutData(e,t)},t.prototype.getRTCToken=function(e,t,n){return this._context.getRTCToken(e,t,n)},t.prototype.setRTCState=function(e,t){return this._context.setRTCState(e,t)},t.prototype.getRTCUserList=function(e){return this._context.getRTCUserList(e)},t.prototype.joinLivingRoomAsAudience=function(e,t,n){return this._context.joinLivingRoomAsAudience(e,t,n)},t.prototype.quitLivingRoomAsAudience=function(e){return this._context.quitLivingRoomAsAudience(e)},t.prototype.rtcIdentityChange=function(e,t,n){return this._context.rtcIdentityChange(e,t,n)},t}(Ci),Si=function(){function e(){}return e.compress=function(e){for(var t=this,n={},r=0;r<e.length-1;r++){var i=e.charAt(r)+e.charAt(r+1);n.hasOwnProperty(i)?n[i].push(r):n[i]=[r]}for(var o=[],s=[],a=function(){if(s.length>0){var e=s.join("");if(s=[],e.length>26){var n=t.numberEncode(e.length),r=String.fromCharCode(t.dataType.NormalExt|n.length);o.push(r+n)}else{var i=String.fromCharCode(t.dataType.Normal|e.length);o.push(i)}o.push(e)}},c=0;c<e.length;){var u=t.indexOf(n,e,c);if(u.length<2)s.push(e.charAt(c++));else if(u.length<4)s.push(e.substr(c,u.length)),c+=u.length;else{var d=t.numberEncode(c-u.offset),l=t.numberEncode(u.length);if(d.length+l.length>=u.length)s.push(e.substr(c,u.length)),c+=u.length;else{a();var h=String.fromCharCode(t.dataType.Compressed|d.length<<2|l.length);o.push(h+d+l),c+=u.length}}}a();var f=t.numberEncode(e.length),p=String.fromCharCode(t.dataType.Tail|f.length);return o.push(p+f),o.join("")},e.uncompress=function(e){var t=this,n=0,r="";e:do{var i=e.charCodeAt(n++),o=i&t.dataType.Mark,s=15&i,a=void 0;switch(o){case t.dataType.Compressed:var c=s>>2,u=3&s;if(0===c||0===u)throw new Error("Data parsing error,at "+n);var d=t.numberDecode(e.substr(n,c)),l=t.numberDecode(e.substr(n+=c,u));if((d=r.length-d)+l>r.length)throw new Error("Data parsing error,at "+n);n+=u,r+=r.substr(d,l);break;case t.dataType.Tail:if((a=t.numberDecode(e.substr(n,s)))!==r.length)throw console.log(r.length),console.log(a),new Error("Data parsing error,at "+n);n+=s;break e;case t.dataType.NormalExt:a=t.numberDecode(e.substr(n,s)),r+=e.substr(n+=s,a),n+=a;break;case t.dataType.Normal:r+=e.substr(n,s),n+=s;break;case t.dataType.Mark:if(s>10)throw new Error("Data parsing error,at "+n);r+=e.substr(n,16+s),n+=16+s;break;default:throw new Error("Data parsing error,at "+n+" header:"+o)}}while(n<e.length);return r},e.indexOf=function(e,t,n){var r={length:0,offset:-1};if(t.length,n>=t.length-1)return r;var i=e[t.charAt(n)+t.charAt(n+1)];if(i[0]===n)return r;for(var o=t.length-n,s=0,a=i.length;s<a;s++){var c=i[s],u=n-c;if(!(u>this.max)){var d=Math.min(o,u);if(d<=r.length)break;if(!(r.length>2&&t.charAt(c+r.length-1)!==t.charAt(n+r.length-1))){for(var l=2,h=l;h<d&&t.charAt(c+h)===t.charAt(n+h);h++)l++;l>=r.length&&(r.length=l,r.offset=c)}}}return r},e.numberEncode=function(e){var t=this,n=[],r=0;do{r=e%t.scale,n.push(t.chars.charAt(r)),e=(e-r)/t.scale}while(e>0);return n.join("")},e.numberDecode=function(e){for(var t=0,n=0,r=e.length-1;r>=0;r--){if(-1===(n=this.chars.indexOf(e.charAt(r))))throw new Error('decode number error, data is "'+e+'"');t=t*this.scale+n}return t},e.dataType={Tail:48,Compressed:64,NormalExt:80,Normal:96,Mark:112},e.chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",e.scale=e.chars.length,e.max=238327,e}(),bi=1,Ii=!1,Oi="undefined"!=typeof location&&"https://"===location.protocol?"https://":"http://",wi=function(){function e(e){this.info=e,this.logUrl="logcollection.ronghub.com",this.level=1,this.itv=30,this.times=5,this.deviceId="",this.deviceInfo="",this.logSwitch=0,this.logUrl=e.logPolicy.url||this.logUrl,this.level=e.logPolicy.level||this.level,this.itv=e.logPolicy.itv||this.itv,this.times=e.logPolicy.times||this.times,this.deviceId=function(e){var t="RCDeviceId",n=b(e),r="",i=n.get(t);return i?r=i:(r=W(),n.set(t,r)),r}(e.runtime),this.logSwitch=e.logSwitch;var t=He(e.runtime);this.deviceInfo=t.type+"|"+t.version+"|"+_e.sessionId,this.startReport()}return e.init=function(t){return Ii=!0,e._instance||(e._instance=new e(t)),e._instance},e.getInstance=function(){return e._instance},e.prototype.startReport=function(){var e=this;if(this.logSwitch&&Ii){var t=this.itv*Math.pow(2,bi-1);bi<this.times&&bi++,setTimeout((function(){e.reportRealtimeLog()}),1e3*t)}},e.prototype.reportRealtimeLog=function(){var e=this,t=_e.realTimeLogList.filter((function(t){return t.level<=e.level}));if(0!==t.length){var n=Si.compress(t.map((function(e){return e.content})).join("")),r=""+Oi+this.logUrl+"?version="+this.info.version+"&appkey="+this.info.appkey+"&userId="+this.info.userId+"&deviceId="+this.deviceId+"&deviceInfo="+this.deviceInfo+"&platform=Web";this.info.runtime.httpReq({method:"POST",url:r,body:n}).then((function(t){ye.__clearRealTimeLog(),ye.debug("report real-time log success");var n=t.data;n&&(n=JSON.parse(n),e.itv=n.nextTime,e.level=n.level,e.logSwitch=n.logSwitch,bi=1),e.startReport()})).catch((function(t){ye.debug("report real-time log error -> "+t),e.startReport()}))}else this.startReport()},e.prototype.reportFullLog=function(e){return M(this,void 0,void 0,(function(){var t,n,r,i,o,s,a,c,u,d,l=this;return P(this,(function(h){switch(h.label){case 0:return t=e.startTime,n=e.endTime,r=e.platform,i=e.logId,o=e.uri,s=q.getInstance(),"web"===r.toLowerCase()&&s?t>n?(ye.warn("report error: The start time("+t+") cannot be greater than the end time("+t+")"),[2]):[4,ye.__insertLogIntoDatabase()]:[2];case 1:return h.sent(),[4,s.getRangeData(H,"time",t,n)];case 2:return a=(a=h.sent()).filter((function(e){return!e.userId||e.userId===l.info.userId})),c=Si.compress(a.map((function(e){return e.content})).join("")||"no data"),u=1,(d=function(){if(!(u>3)&&Ii){var e=o||l.logUrl,t=""+Oi+e+"?version="+l.info.version+"&appkey="+l.info.appkey+"&userId="+l.info.userId+"&logId="+i+"&deviceId="+l.deviceId+"&deviceInfo="+l.deviceInfo+"&platform=Web",n=5e3*(u-1);u++,setTimeout((function(){Ii&&l.info.runtime.httpReq({url:t,method:"POST",body:c}).then((function(){ye.debug("report full log success!")})).catch((function(e){d(),ye.warn("report full log error -> "+e)}))}),n)}})(),[2]}}))}))},e.prototype.distroy=function(){bi=1,Ii=!1},e}();function Ni(e){return Object.assign({},e)}var Ai,Mi=function(){function e(e,t){var n;this._runtime=e,this._token="",this._pluginContextQueue=[],this._pluginInstanseMap={},this.coreVersion="4.4.1",this._versionInfo={},this._typingInfo={},this._connectionStatus=Br.DISCONNECTED,this._canRedirectConnect=!1,this._watcher={message:void 0,conversationState:void 0,chatroomState:void 0,connectionState:void 0,rtcInnerWatcher:void 0,expansion:void 0,tag:void 0,conversationTagChanged:void 0,typingState:void 0},this._typingInternalTimer=-1,this._typingExpireTime=2e3,this._typingChangedList=[],this._options=Object.assign({},t),this.appkey=this._options.appkey,this.apiVersion=this._options.apiVersion,this._options.typingExpireTime&&(this._options.typingExpireTime<2e3?this._typingExpireTime=2e3:this._options.typingExpireTime>6e3?this._typingExpireTime=6e3:this._typingExpireTime=this._options.typingExpireTime),this._options.navigators=this._options.navigators.filter((function(e){return/^https?:\/\//.test(e)})),this._options.navigators=this._options.navigators.map((function(e){return e.replace(/\/$/g,"")})),0===this._options.navigators.length&&(n=this._options.navigators).push.apply(n,l);var r={status:this._connectionStatusListener.bind(this),message:this._messageReceiver.bind(this),chatroom:this._chatroomInfoListener.bind(this),conversation:this._conversationInfoListener.bind(this),expansion:this._expansionInfoListener.bind(this),tag:this._tagListener.bind(this),conversationTag:this._conversationTagListener.bind(this),onRTCDataChange:this._rtcDataChange.bind(this)};this._engine=Fe()?new RCCppEngine(e,r,this._options):new Ti(e,r,this._options)}return e.init=function(t,n){return ye.setLogLevel(n.logLevel),ye.setLogStdout(n.logStdout),n.indexDBSwitch&&q.init(),ye.debug("APIContext.init =>",n.appkey,n.navigators),this._context?(ye.error("Repeat initialize!"),this._context):(ye.warn("RCEngine Commit:","b4eb286e983e6b97206d0ddc0ec37be9f6f164bf"),this._context=new e(t,n),ye.__insertLogIntoDatabase(),this._context)},e.destroy=function(){this._context&&(this._context._destroy(),this._context=void 0)},e.prototype.install=function(e,t){if(this._pluginInstanseMap[e.tag])return ye.warn("Repeat install plugin: "+e.tag),this._pluginInstanseMap[e.tag];var n="RCRTC"===e.tag?new Ri(this):new Ci(this),r=null;try{if(!e.verify(this._runtime))return null;r=e.setup(n,this._runtime,t)}catch(e){ye.error("install plugin error!\n",e)}return["RCRTC","RCCall"].includes(e.tag)&&e.version&&e.name&&(this._versionInfo[e.name]=e.version),r&&this._pluginContextQueue.push(n),r&&(this._pluginInstanseMap[e.tag]=r),r},e.prototype._handleRedirect=function(){return M(this,void 0,void 0,(function(){var e=this;return P(this,(function(t){switch(t.label){case 0:return ye.debug("_handleRedirct",this._token),[4,this.connect(this._token,!0)];case 1:return t.sent().code!==Oe.SUCCESS&&this._canRedirectConnect&&setTimeout((function(){e._handleRedirect()}),5e3),[2]}}))}))},e.prototype._connectionStatusListener=function(e){var t;return M(this,void 0,void 0,(function(){return P(this,(function(n){return e===Br.REDIRECT&&(this._canRedirectConnect=!0,this._handleRedirect()),e!==Br.BLOCKED&&e!==Br.KICKED_OFFLINE_BY_OTHER_CLIENT&&e!==Br.DISCONNECT_BY_SERVER||(this._canRedirectConnect=!1),this._connectionStatus=e,(null===(t=this._watcher.rtcInnerWatcher)||void 0===t?void 0:t.status)&&this._watcher.rtcInnerWatcher.status(e),this._pluginContextQueue.forEach((function(t){t.onconnectionstatechange&&t.onconnectionstatechange(e)})),this._watcher.connectionState&&this._watcher.connectionState(e),[2]}))}))},e.prototype._messageReceiver=function(e,t,n){var r;if((e.conversationType===J.RTC_ROOM||Object.prototype.hasOwnProperty.call(mr,e.messageType))&&this._watcher.rtcInnerWatcher&&this._watcher.rtcInnerWatcher.message)this._watcher.rtcInnerWatcher.message(Ni(e));else if("RC:TypSts"!==e.messageType||(this._addTypingInfo(Ni(e)),!this._watcher.typingState))if(e.messageType!==Pn.LOG_COMMAND||"rongcloudsystem"!==e.senderUserId)this._pluginContextQueue.some((function(t){if(!t.onmessage)return!1;try{return t.onmessage(Ni(e))}catch(e){return ye.error("plugin error =>",e),!1}}))||this._watcher.message&&this._watcher.message(Ni(e),t,n);else{var i=e.content,o=i.startTime,s=i.endTime,a=i.platform,c=i.logId,u=i.uri,d=i.packageName,l={startTime:parseInt(o),endTime:parseInt(s),platform:a,logId:c,uri:u,packageName:d};null===(r=wi.getInstance())||void 0===r||r.reportFullLog(l)}},e.prototype._chatroomInfoListener=function(e){this._watcher.chatroomState&&this._watcher.chatroomState(e)},e.prototype._conversationInfoListener=function(e){this._watcher.conversationState&&this._watcher.conversationState(e)},e.prototype._expansionInfoListener=function(e){this._watcher.expansion&&this._watcher.expansion(e)},e.prototype._tagListener=function(){this._watcher.tag&&this._watcher.tag()},e.prototype._conversationTagListener=function(){this._watcher.conversationTagChanged&&this._watcher.conversationTagChanged()},e.prototype._typingStatusListener=function(e){this._watcher.typingState&&this._watcher.typingState(e)},e.prototype._rtcDataChange=function(e){this._pluginContextQueue.forEach((function(t){t.onrtcdatachange&&t.onrtcdatachange(e)}))},e.prototype.assignWatcher=function(e){var t=this;Object.keys(this._watcher).forEach((function(n){if(Object.prototype.hasOwnProperty.call(e,n)){var r=e[n];t._watcher[n]=ce(r)||ae(r)?r:void 0}}))},e.prototype._addTypingInfo=function(e){var t=e.senderUserId,n=e.conversationType,r=e.targetId,i=e.content,o=e.channelId,s=i.typingContentType,a=n+"#"+r+"#"+(o||"");this._typingInfo[a]||(this._typingInfo[a]=[]);var c=this._typingInfo[a].findIndex((function(e){return e.userId===t}));c>=0&&this._typingInfo[a][c].messageType===s?this._typingInfo[a][c].timestamp=Date.now():(c>=0&&this._typingInfo[a].splice(c,1),this._typingInfo[a].push({userId:t,messageType:s,timestamp:Date.now()}),this._typingChangedList.includes(a)||this._typingChangedList.push(a),this._startCheckTypingInfo())},e.prototype._startCheckTypingInfo=function(){var e=this;-1===this._typingInternalTimer&&0!==Object.keys(this._typingInfo).length&&(this._typingInternalTimer=setInterval((function(){for(var t in e._typingInfo){var n=e._typingInfo[t].length;e._typingInfo[t]=e._typingInfo[t].filter((function(t){return Date.now()-t.timestamp<e._typingExpireTime})),e._typingInfo[t].length===n||e._typingChangedList.includes(t)||e._typingChangedList.push(t),0===e._typingInfo[t].length&&delete e._typingInfo[t]}if(e._typingChangedList.length>0){var r=e._typingChangedList.map((function(t){return{conversationType:Number(t.split("#")[0]),targetId:t.split("#")[1],channelId:t.split("#")[2],list:e._typingInfo[t]||[]}}));e._typingStatusListener(r),e._typingChangedList=[]}0===Object.keys(e._typingInfo).length&&(clearInterval(e._typingInternalTimer),e._typingInternalTimer=-1)}),500))},e.prototype.getConnectedTime=function(){return this._engine.getConnectedTime()},e.prototype.getCurrentUserId=function(){return this._engine.currentUserId},e.prototype.getConnectionStatus=function(){return this._connectionStatus},e.prototype.connect=function(e,t){return void 0===t&&(t=!1),M(this,void 0,void 0,(function(){var n,r,i,o,s,a;return P(this,(function(c){switch(c.label){case 0:return this._connectionStatus===Br.CONNECTED?[2,{code:Oe.SUCCESS,userId:this._engine.currentUserId}]:this._connectionStatus===Br.CONNECTING?[2,{code:Oe.BIZ_ERROR_CONNECTING}]:"string"!=typeof e||0===e.length?[2,{code:Oe.RC_CONN_USER_OR_PASSWD_ERROR}]:(this._token=e,n=e.split("@"),r=n[1],i=r?r.split(";").map((function(e){return/^https?:/.test(e)?e:"https://"+e})):[],[4,this._engine.navi.getInfo(this._getTokenWithoutNavi(),i,t)]);case 1:return(o=c.sent())?(s=A({engine:this.coreVersion,imlib:this.apiVersion},this._versionInfo),[4,this._engine.connect(this._getTokenWithoutNavi(),o)]):[2,{code:Oe.RC_NAVI_RESOURCE_ERROR}];case 2:return a=c.sent(),ye.__insertLogIntoDatabase(),a!==jr.REDIRECT?[3,4]:(this._connectionStatus=Br.REDIRECT,[4,this.connect(e,!0)]);case 3:return[2,c.sent()];case 4:return a===Oe.SUCCESS&&(ye.info("connect success, userId: "+this._engine.currentUserId),this._engine.reportSDKInfo&&this._engine.reportSDKInfo(s),wi.init({runtime:this._runtime,logSwitch:(null==o?void 0:o.logSwitch)||0,logPolicy:JSON.parse((null==o?void 0:o.logPolicy)||"{}"),appkey:this.appkey,version:this.apiVersion,userId:this._engine.currentUserId}),_e.init(this._engine.currentUserId)),a!==Oe.SUCCESS||Fe()||1===o.openUS&&this._pullUserSettings(),a!==Oe.SUCCESS&&(this._connectionStatus=Br.CONNECTION_CLOSED),[2,{code:a,userId:this._engine.currentUserId}]}}))}))},e.prototype._pullUserSettings=function(){return M(this,void 0,void 0,(function(){return P(this,(function(e){return[2]}))}))},e.prototype.disconnect=function(){var e;return clearInterval(this._typingInternalTimer),this._typingInternalTimer=-1,null===(e=wi.getInstance())||void 0===e||e.distroy(),ye.__insertLogIntoDatabase(),_e.reset(),this._engine.disconnect(),this._pluginContextQueue.forEach((function(e){if(e.ondisconnect)try{e.ondisconnect()}catch(e){ye.error("plugin error =>",e)}})),Promise.resolve()},e.prototype.reconnect=function(){return this.connect(this._getTokenWithoutNavi())},e.prototype._getTokenWithoutNavi=function(){return this._token.replace(/@.+$/,"@")},e.prototype.getInfoFromCache=function(){return this._engine.navi.getInfoFromCache(this._getTokenWithoutNavi())},e.prototype.registerMessageType=function(e,t,n,r){void 0===r&&(r=[]),this._engine.registerMessageType(e,t,n,r)},e.prototype.sendMessage=function(e,t,n,r){var i=this.getInfoFromCache();if(1===((null==i?void 0:i.grpRRVer)||0)&&n.messageType===Pn.READ_RECEIPT_RESPONSE)return Promise.resolve({code:Oe.READ_RECEIPT_ERROR});if(e===J.SYSTEM)return Promise.resolve({code:Oe.BIZ_ERROR_INVALID_PARAMETER});var o=JSON.stringify(n.content);return V(o)>131072?Promise.resolve({code:Oe.RC_MSG_CONTENT_EXCEED_LIMIT}):this._engine.sendMessage(e,t,n,r)},e.prototype.sendExpansionMessage=function(e){return M(this,void 0,void 0,(function(){var t,n,r,i,o,s,a,c,u,d,l,h,f,p,g,m;return P(this,(function(v){switch(v.label){case 0:if(t=e.channelId,n=e.conversationType,r=e.targetId,i=e.messageUId,o=e.keys,s=e.expansion,a=e.originExpansion,c=e.removeAll,!e.canIncludeExpansion)return[2,{code:Oe.MESSAGE_KV_NOT_SUPPORT}];if(u=!1,d=!1,ae(s))for(p in a=a||{},l=Object.keys(s).length,h=Object.assign(a,s),f=Object.keys(h).length,u=f>300||l>20,s)g=s[p],u=p.length>32||g.length>64,d=!/^[A-Za-z0-9_=+-]+$/.test(p);return u?[2,{code:Oe.EXPANSION_LIMIT_EXCEET}]:d?[2,{code:Oe.BIZ_ERROR_INVALID_PARAMETER}]:(m={mid:i},s&&(m.put=s),o&&(m.del=o),c&&(m.removeAll=1),[4,this._engine.sendMessage(n,r,{content:m,messageType:Pn.EXPANSION_NOTIFY,channelId:t})]);case 1:return[2,{code:v.sent().code}]}}))}))},e.prototype.sendReadReceiptMessage=function(e,t,n){return M(this,void 0,void 0,(function(){var r;return P(this,(function(i){return r=this.getInfoFromCache(),0===((null==r?void 0:r.grpRRVer)||0)?[2,{code:Oe.READ_RECEIPT_ERROR,data:"The read receipt switch is not on, please call the sendMessage method!"}]:[2,this._engine.sendReadReceiptMessage(e,t,n)]}))}))},e.prototype.getMessageReader=function(e,t,n){return M(this,void 0,void 0,(function(){var r;return P(this,(function(i){return r=this.getInfoFromCache(),0===((null==r?void 0:r.grpRRVer)||0)?[2,{code:Oe.READ_RECEIPT_ERROR}]:[2,this._engine.getMessageReader(e,t,n)]}))}))},e.prototype._destroy=function(){var e;this._watcher={},this._engine.disconnect(),this._pluginContextQueue.forEach((function(e){if(e.ondestroy)try{e.ondestroy()}catch(e){ye.error("plugin error =>",e)}})),this._pluginContextQueue.length=0,this._pluginInstanseMap={},null===(e=wi.getInstance())||void 0===e||e.distroy(),_e.reset()},e.prototype.getHistoryMessage=function(e,t,n,r,i,o,s){return void 0===n&&(n=0),void 0===r&&(r=20),void 0===i&&(i=0),void 0===o&&(o=""),void 0===s&&(s=""),this._engine.getHistoryMessage(e,t,n,r,i,o,s||"")},e.prototype.getConversationList=function(e,t,n,r,i){return void 0===e&&(e=300),void 0===i&&(i=""),this._engine.getConversationList(e,t,n,r,i)},e.prototype.getConversation=function(e,t,n){return this._engine.getConversation(e,t,n)},e.prototype.removeConversation=function(e,t,n){return void 0===n&&(n=""),this._engine.removeConversation(e,t,n)},e.prototype.clearUnreadCount=function(e,t,n){return void 0===n&&(n=""),this._engine.clearConversationUnreadCount(e,t,n)},e.prototype.getUnreadCount=function(e,t,n){return void 0===n&&(n=""),this._engine.getConversationUnreadCount(e,t,n)},e.prototype.getTotalUnreadCount=function(e,t,n){return this._engine.getAllConversationUnreadCount(e,t&&t.length>0?t:[J.PRIVATE,J.GROUP,J.SYSTEM,J.PUBLIC_SERVICE],!!n)},e.prototype.setConversationStatus=function(e,t,n,r,i){void 0===i&&(i="");var o=[{conversationType:e,targetId:t,isTop:n,notificationStatus:r,channelId:i}];return this._engine.batchSetConversationStatus(o)},e.prototype.saveConversationMessageDraft=function(e,t,n){return this._engine.saveConversationMessageDraft(e,t,n)},e.prototype.getConversationMessageDraft=function(e,t){return this._engine.getConversationMessageDraft(e,t)},e.prototype.clearConversationMessageDraft=function(e,t){return this._engine.clearConversationMessageDraft(e,t)},e.prototype.recallMessage=function(e,t,n,r,i){return this._engine.recallMsg(e,t,n,r,i)},e.prototype.deleteRemoteMessage=function(e,t,n,r){return void 0===r&&(r=""),this._engine.deleteRemoteMessage(e,t,n,r)},e.prototype.deleteRemoteMessageByTimestamp=function(e,t,n,r){return void 0===r&&(r=""),this._engine.deleteRemoteMessageByTimestamp(e,t,n,r)},e.prototype.joinChatroom=function(e,t){return void 0===t&&(t=10),this._engine.joinChatroom(e,t)},e.prototype.joinExistChatroom=function(e,t){return void 0===t&&(t=10),this._engine.joinExistChatroom(e,t)},e.prototype.quitChatroom=function(e){return this._engine.quitChatroom(e)},e.prototype.getChatroomInfo=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),this._engine.getChatroomInfo(e,t,n)},e.prototype.setChatroomEntry=function(e,t){var n=t.key,r=t.value;return ke(n)&&Le(r)?this._engine.setChatroomEntry(e,t):Promise.resolve(Oe.BIZ_ERROR_INVALID_PARAMETER)},e.prototype.forceSetChatroomEntry=function(e,t){var n=t.key,r=t.value;return ke(n)&&Le(r)?this._engine.forceSetChatroomEntry(e,t):Promise.resolve(Oe.BIZ_ERROR_INVALID_PARAMETER)},e.prototype.removeChatroomEntry=function(e,t){var n=t.key;return ke(n)?this._engine.removeChatroomEntry(e,t):Promise.resolve(Oe.BIZ_ERROR_INVALID_PARAMETER)},e.prototype.forceRemoveChatroomEntry=function(e,t){var n=t.key;return ke(n)?this._engine.forceRemoveChatroomEntry(e,t):Promise.resolve(Oe.BIZ_ERROR_INVALID_PARAMETER)},e.prototype.getChatroomEntry=function(e,t){return this._engine.getChatroomEntry(e,t)},e.prototype.getAllChatroomEntries=function(e){return this._engine.getAllChatroomEntry(e)},e.prototype.getChatRoomHistoryMessages=function(e,t,n,r){return void 0===t&&(t=20),void 0===n&&(n=0),void 0===r&&(r=0),this._engine.getChatroomHistoryMessages(e,r,t,n)},e.prototype.getFileToken=function(e,t,n,r){return M(this,void 0,void 0,(function(){var i,o,s,a,c,u,d;return P(this,(function(l){switch(l.label){case 0:return i=this.getInfoFromCache(),o=(null==i?void 0:i.bosAddr)||"",s=(null==i?void 0:i.uploadServer)||"",a=(null==i?void 0:i.ossConfig)||"",[4,this._engine.getFileToken(e,t,n,r)];case 1:return c=l.sent(),u=c.code,d=c.data,u===Oe.SUCCESS?[2,Promise.resolve(Object.assign(d,{bos:o,qiniu:s,ossConfig:a}))]:[2,Promise.reject(u)]}}))}))},e.prototype.getFileUrl=function(e,t,n,r,i){return void 0===i&&(i=mi.QINIU),M(this,void 0,void 0,(function(){var o,s,a;return P(this,(function(c){switch(c.label){case 0:return(null==r?void 0:r.isBosRes)?[2,Promise.resolve(r)]:[4,this._engine.getFileUrl(e,i,t,n)];case 1:return o=c.sent(),s=o.code,a=o.data,s===Oe.SUCCESS?[2,Promise.resolve(a)]:[2,Promise.reject(s)]}}))}))},e.prototype.createTag=function(e){return M(this,void 0,void 0,(function(){return P(this,(function(t){return[2,this._engine.createTag(e)]}))}))},e.prototype.removeTag=function(e){return M(this,void 0,void 0,(function(){return P(this,(function(t){return[2,this._engine.removeTag(e)]}))}))},e.prototype.updateTag=function(e){return M(this,void 0,void 0,(function(){return P(this,(function(t){return[2,this._engine.updateTag(e)]}))}))},e.prototype.getTagList=function(){return M(this,void 0,void 0,(function(){return P(this,(function(e){return[2,this._engine.getTagList()]}))}))},e.prototype.addTagForConversations=function(e,t){return M(this,void 0,void 0,(function(){return P(this,(function(n){return t.length>1e3?[2,Promise.reject(Oe.CONVER_OUT_LIMIT_ERROR)]:[2,this._engine.addTagForConversations(e,t)]}))}))},e.prototype.removeTagForConversations=function(e,t){return M(this,void 0,void 0,(function(){return P(this,(function(n){return[2,this._engine.removeTagForConversations(e,t)]}))}))},e.prototype.removeTagsForConversation=function(e,t){return M(this,void 0,void 0,(function(){return P(this,(function(n){return[2,this._engine.removeTagsForConversation(e,t)]}))}))},e.prototype.getConversationListByTag=function(e,t,n,r){return M(this,void 0,void 0,(function(){return P(this,(function(i){return[2,this._engine.getConversationListByTag(e,t,n,r)]}))}))},e.prototype.getUnreadCountByTag=function(e,t){return M(this,void 0,void 0,(function(){return P(this,(function(n){return[2,this._engine.getUnreadCountByTag(e,t)]}))}))},e.prototype.setConversationStatusInTag=function(e,t,n){return M(this,void 0,void 0,(function(){return P(this,(function(r){return[2,this._engine.setConversationStatusInTag(e,t,n)]}))}))},e.prototype.getTagsForConversation=function(e){return M(this,void 0,void 0,(function(){return P(this,(function(t){return[2,this._engine.getTagsForConversation(e)]}))}))},e.prototype.callExtra=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return(t=this._engine).callExtra.apply(t,k([e],n))},e.prototype.clearConversations=function(e,t){return M(this,void 0,void 0,(function(){return P(this,(function(n){switch(n.label){case 0:return[4,this._engine.clearConversations(e,t)];case 1:return[2,n.sent()]}}))}))},e.prototype.setUserStatusListener=function(e,t){return this._engine.setUserStatusListener(e,(function(e){try{t(e)}catch(e){ye.error(e)}}))},e.prototype.addToBlacklist=function(e){return M(this,void 0,void 0,(function(){return P(this,(function(t){return[2,this._engine.addToBlacklist(e)]}))}))},e.prototype.removeFromBlacklist=function(e){return M(this,void 0,void 0,(function(){return P(this,(function(t){return[2,this._engine.removeFromBlacklist(e)]}))}))},e.prototype.getBlacklist=function(){return M(this,void 0,void 0,(function(){return P(this,(function(e){return[2,this._engine.getBlacklist()]}))}))},e.prototype.getBlacklistStatus=function(e){return M(this,void 0,void 0,(function(){return P(this,(function(t){return[2,this._engine.getBlacklistStatus(e)]}))}))},e.prototype.insertMessage=function(e,t,n){return M(this,void 0,void 0,(function(){return P(this,(function(r){return[2,this._engine.insertMessage(e,t,n)]}))}))},e.prototype.deleteMessages=function(e){return M(this,void 0,void 0,(function(){return P(this,(function(t){return[2,this._engine.deleteMessages(e)]}))}))},e.prototype.deleteMessagesByTimestamp=function(e,t,n,r,i){return void 0===i&&(i=""),M(this,void 0,void 0,(function(){return P(this,(function(o){return[2,this._engine.deleteMessagesByTimestamp(e,t,n,r,i)]}))}))},e.prototype.clearMessages=function(e,t,n){return void 0===n&&(n=""),M(this,void 0,void 0,(function(){return P(this,(function(r){return[2,this._engine.clearMessages(e,t,n)]}))}))},e.prototype.getMessage=function(e){return M(this,void 0,void 0,(function(){return P(this,(function(t){return[2,this._engine.getMessage(e)]}))}))},e.prototype.setMessageContent=function(e,t,n){return M(this,void 0,void 0,(function(){return P(this,(function(r){return[2,this._engine.setMessageContent(e,t,n)]}))}))},e.prototype.setMessageSearchField=function(e,t,n){return M(this,void 0,void 0,(function(){return P(this,(function(r){return[2,this._engine.setMessageSearchField(e,t,n)]}))}))},e.prototype.setMessageSentStatus=function(e,t){return M(this,void 0,void 0,(function(){return P(this,(function(n){return[2,this._engine.setMessageSentStatus(e,t)]}))}))},e.prototype.setMessageReceivedStatus=function(e,t){return M(this,void 0,void 0,(function(){return P(this,(function(n){return[2,this._engine.setMessageReceivedStatus(e,t)]}))}))},e.prototype.setUserStatus=function(e){return M(this,void 0,void 0,(function(){return P(this,(function(t){return[2,this._engine.setUserStatus(e)]}))}))},e.prototype.subscribeUserStatus=function(e){return M(this,void 0,void 0,(function(){return P(this,(function(t){return[2,this._engine.subscribeUserStatus(e)]}))}))},e.prototype.getUserStatus=function(e){return M(this,void 0,void 0,(function(){return P(this,(function(t){return[2,this._engine.getUserStatus(e)]}))}))},e.prototype.searchConversationByContent=function(e,t,n,r){return void 0===t&&(t=[]),void 0===n&&(n=""),M(this,void 0,void 0,(function(){return P(this,(function(i){return[2,this._engine.searchConversationByContent(e,t,n,r)]}))}))},e.prototype.searchMessageByContent=function(e,t,n,r,i,o,s){return void 0===s&&(s=""),M(this,void 0,void 0,(function(){return P(this,(function(a){return[2,this._engine.searchMessageByContent(e,t,n,r,i,o,s)]}))}))},e.prototype.getUnreadMentionedMessages=function(e,t,n){return void 0===n&&(n=""),this._engine.getUnreadMentionedMessages(e,t,n)},e.prototype.clearUnreadCountByTimestamp=function(e,t,n,r){return void 0===r&&(r=""),this._engine.clearUnreadCountByTimestamp(e,t,n,r)},e.prototype.getConversationNotificationStatus=function(e,t,n){return void 0===n&&(n=""),this._engine.getConversationNotificationStatus(e,t,n)},e.prototype.getRemoteHistoryMessages=function(e,t,n,r,i,o){return this._engine.getRemoteHistoryMessages(e,t,n,r,i,o)},e.prototype.joinRTCRoom=function(e,t,n){return this._engine.joinRTCRoom(e,t,n)},e.prototype.quitRTCRoom=function(e){return this._engine.quitRTCRoom(e)},e.prototype.rtcPing=function(e,t,n){return this._engine.rtcPing(e,t,n)},e.prototype.getRTCRoomInfo=function(e){return this._engine.getRTCRoomInfo(e)},e.prototype.getRTCUserInfoList=function(e){return this._engine.getRTCUserInfoList(e)},e.prototype.getRTCUserInfo=function(e){return this._engine.getRTCUserInfo(e)},e.prototype.setRTCUserInfo=function(e,t,n){return this._engine.setRTCUserInfo(e,t,n)},e.prototype.removeRTCUserInfo=function(e,t){return this._engine.removeRTCUserInfo(e,t)},e.prototype.setRTCData=function(e,t,n,r,i,o){return this._engine.setRTCData(e,t,n,r,i,o)},e.prototype.setRTCTotalRes=function(e,t,n,r,i){return void 0===i&&(i=""),this._engine.setRTCTotalRes(e,t,n,r,i)},e.prototype.getRTCData=function(e,t,n,r){return this._engine.getRTCData(e,t,n,r)},e.prototype.removeRTCData=function(e,t,n,r,i){return this._engine.removeRTCData(e,t,n,r,i)},e.prototype.setRTCOutData=function(e,t,n,r){return this._engine.setRTCOutData(e,t,n,r)},e.prototype.getRTCOutData=function(e,t){return this._engine.getRTCOutData(e,t)},e.prototype.getRTCToken=function(e,t,n){return this._engine.getRTCToken(e,t,n)},e.prototype.setRTCState=function(e,t){return this._engine.setRTCState(e,t)},e.prototype.getRTCUserList=function(e){return this._engine.getRTCUserList(e)},e.prototype.joinLivingRoomAsAudience=function(e,t,n){return this._engine.joinLivingRoomAsAudience(e,t,n)},e.prototype.quitLivingRoomAsAudience=function(e){return this._engine.quitLivingRoomAsAudience(e)},e.prototype.rtcIdentityChange=function(e,t,n){return this._engine.rtcIdentityChange(e,t,n)},e}();!function(e){e[e.add=1]="add",e[e.update=2]="update",e[e.delete=3]="delete"}(Ai||(Ai={}));var Pi="4.4.1"}.call(this,n("4362"))},"7a23":function(e,t,n){"use strict";n.d(t,"q",(function(){return pe})),n.d(t,"r",(function(){return Se})),n.d(t,"t",(function(){return be})),n.d(t,"u",(function(){return we})),n.d(t,"a",(function(){return Zr})),n.d(t,"c",(function(){return mr})),n.d(t,"d",(function(){return Ir})),n.d(t,"e",(function(){return br})),n.d(t,"f",(function(){return Cr})),n.d(t,"g",(function(){return Gt})),n.d(t,"h",(function(){return Vr})),n.d(t,"i",(function(){return Xr})),n.d(t,"j",(function(){return It})),n.d(t,"k",(function(){return Ze})),n.d(t,"l",(function(){return Wt})),n.d(t,"m",(function(){return $t})),n.d(t,"n",(function(){return an})),n.d(t,"o",(function(){return hr})),n.d(t,"p",(function(){return bt})),n.d(t,"s",(function(){return nr})),n.d(t,"v",(function(){return wt})),n.d(t,"b",(function(){return eo}));var r=n("9ff4");const i=new WeakMap,o=[];let s;const a=Symbol(""),c=Symbol("");function u(e){return e&&!0===e._isEffect}function d(e,t=r["b"]){u(e)&&(e=e.raw);const n=f(e,t);return t.lazy||n(),n}function l(e){e.active&&(p(e),e.options.onStop&&e.options.onStop(),e.active=!1)}let h=0;function f(e,t){const n=function(){if(!n.active)return e();if(!o.includes(n)){p(n);try{return _(),o.push(n),s=n,e()}finally{o.pop(),y(),s=o[o.length-1]}}};return n.id=h++,n.allowRecurse=!!t.allowRecurse,n._isEffect=!0,n.active=!0,n.raw=e,n.deps=[],n.options=t,n}function p(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}let g=!0;const m=[];function v(){m.push(g),g=!1}function _(){m.push(g),g=!0}function y(){const e=m.pop();g=void 0===e||e}function E(e,t,n){if(!g||void 0===s)return;let r=i.get(e);r||i.set(e,r=new Map);let o=r.get(n);o||r.set(n,o=new Set),o.has(s)||(o.add(s),s.deps.push(o))}function T(e,t,n,o,u,d){const l=i.get(e);if(!l)return;const h=new Set,f=e=>{e&&e.forEach(e=>{(e!==s||e.allowRecurse)&&h.add(e)})};if("clear"===t)l.forEach(f);else if("length"===n&&Object(r["m"])(e))l.forEach((e,t)=>{("length"===t||t>=o)&&f(e)});else switch(void 0!==n&&f(l.get(n)),t){case"add":Object(r["m"])(e)?Object(r["q"])(n)&&f(l.get("length")):(f(l.get(a)),Object(r["r"])(e)&&f(l.get(c)));break;case"delete":Object(r["m"])(e)||(f(l.get(a)),Object(r["r"])(e)&&f(l.get(c)));break;case"set":Object(r["r"])(e)&&f(l.get(a));break}const p=e=>{e.options.scheduler?e.options.scheduler(e):e()};h.forEach(p)}const C=Object(r["F"])("__proto__,__v_isRef,__isVue"),R=new Set(Object.getOwnPropertyNames(Symbol).map(e=>Symbol[e]).filter(r["C"])),S=N(),b=N(!1,!0),I=N(!0),O=N(!0,!0),w={};function N(e=!1,t=!1){return function(n,i,o){if("__v_isReactive"===i)return!e;if("__v_isReadonly"===i)return e;if("__v_raw"===i&&o===(e?t?le:de:t?ue:ce).get(n))return n;const s=Object(r["m"])(n);if(!e&&s&&Object(r["j"])(w,i))return Reflect.get(w,i,o);const a=Reflect.get(n,i,o);if(Object(r["C"])(i)?R.has(i):C(i))return a;if(e||E(n,"get",i),t)return a;if(Re(a)){const e=!s||!Object(r["q"])(i);return e?a.value:a}return Object(r["t"])(a)?e?me(a):pe(a):a}}["includes","indexOf","lastIndexOf"].forEach(e=>{const t=Array.prototype[e];w[e]=function(...e){const n=Te(this);for(let t=0,i=this.length;t<i;t++)E(n,"get",t+"");const r=t.apply(n,e);return-1===r||!1===r?t.apply(n,e.map(Te)):r}}),["push","pop","shift","unshift","splice"].forEach(e=>{const t=Array.prototype[e];w[e]=function(...e){v();const n=t.apply(this,e);return y(),n}});const A=P(),M=P(!0);function P(e=!1){return function(t,n,i,o){let s=t[n];if(!e&&(i=Te(i),s=Te(s),!Object(r["m"])(t)&&Re(s)&&!Re(i)))return s.value=i,!0;const a=Object(r["m"])(t)&&Object(r["q"])(n)?Number(n)<t.length:Object(r["j"])(t,n),c=Reflect.set(t,n,i,o);return t===Te(o)&&(a?Object(r["i"])(i,s)&&T(t,"set",n,i,s):T(t,"add",n,i)),c}}function k(e,t){const n=Object(r["j"])(e,t),i=e[t],o=Reflect.deleteProperty(e,t);return o&&n&&T(e,"delete",t,void 0,i),o}function L(e,t){const n=Reflect.has(e,t);return Object(r["C"])(t)&&R.has(t)||E(e,"has",t),n}function x(e){return E(e,"iterate",Object(r["m"])(e)?"length":a),Reflect.ownKeys(e)}const U={get:S,set:A,deleteProperty:k,has:L,ownKeys:x},D={get:I,set(e,t){return!0},deleteProperty(e,t){return!0}},j=Object(r["h"])({},U,{get:b,set:M}),V=(Object(r["h"])({},D,{get:O}),e=>Object(r["t"])(e)?pe(e):e),B=e=>Object(r["t"])(e)?me(e):e,F=e=>e,H=e=>Reflect.getPrototypeOf(e);function G(e,t,n=!1,r=!1){e=e["__v_raw"];const i=Te(e),o=Te(t);t!==o&&!n&&E(i,"get",t),!n&&E(i,"get",o);const{has:s}=H(i),a=r?F:n?B:V;return s.call(i,t)?a(e.get(t)):s.call(i,o)?a(e.get(o)):void(e!==i&&e.get(t))}function Y(e,t=!1){const n=this["__v_raw"],r=Te(n),i=Te(e);return e!==i&&!t&&E(r,"has",e),!t&&E(r,"has",i),e===i?n.has(e):n.has(e)||n.has(i)}function q(e,t=!1){return e=e["__v_raw"],!t&&E(Te(e),"iterate",a),Reflect.get(e,"size",e)}function K(e){e=Te(e);const t=Te(this),n=H(t),r=n.has.call(t,e);return r||(t.add(e),T(t,"add",e,e)),this}function W(e,t){t=Te(t);const n=Te(this),{has:i,get:o}=H(n);let s=i.call(n,e);s||(e=Te(e),s=i.call(n,e));const a=o.call(n,e);return n.set(e,t),s?Object(r["i"])(t,a)&&T(n,"set",e,t,a):T(n,"add",e,t),this}function $(e){const t=Te(this),{has:n,get:r}=H(t);let i=n.call(t,e);i||(e=Te(e),i=n.call(t,e));const o=r?r.call(t,e):void 0,s=t.delete(e);return i&&T(t,"delete",e,void 0,o),s}function J(){const e=Te(this),t=0!==e.size,n=void 0,r=e.clear();return t&&T(e,"clear",void 0,void 0,n),r}function z(e,t){return function(n,r){const i=this,o=i["__v_raw"],s=Te(o),c=t?F:e?B:V;return!e&&E(s,"iterate",a),o.forEach((e,t)=>n.call(r,c(e),c(t),i))}}function Q(e,t,n){return function(...i){const o=this["__v_raw"],s=Te(o),u=Object(r["r"])(s),d="entries"===e||e===Symbol.iterator&&u,l="keys"===e&&u,h=o[e](...i),f=n?F:t?B:V;return!t&&E(s,"iterate",l?c:a),{next(){const{value:e,done:t}=h.next();return t?{value:e,done:t}:{value:d?[f(e[0]),f(e[1])]:f(e),done:t}},[Symbol.iterator](){return this}}}}function Z(e){return function(...t){return"delete"!==e&&this}}const X={get(e){return G(this,e)},get size(){return q(this)},has:Y,add:K,set:W,delete:$,clear:J,forEach:z(!1,!1)},ee={get(e){return G(this,e,!1,!0)},get size(){return q(this)},has:Y,add:K,set:W,delete:$,clear:J,forEach:z(!1,!0)},te={get(e){return G(this,e,!0)},get size(){return q(this,!0)},has(e){return Y.call(this,e,!0)},add:Z("add"),set:Z("set"),delete:Z("delete"),clear:Z("clear"),forEach:z(!0,!1)},ne={get(e){return G(this,e,!0,!0)},get size(){return q(this,!0)},has(e){return Y.call(this,e,!0)},add:Z("add"),set:Z("set"),delete:Z("delete"),clear:Z("clear"),forEach:z(!0,!0)},re=["keys","values","entries",Symbol.iterator];function ie(e,t){const n=t?e?ne:ee:e?te:X;return(t,i,o)=>"__v_isReactive"===i?!e:"__v_isReadonly"===i?e:"__v_raw"===i?t:Reflect.get(Object(r["j"])(n,i)&&i in t?n:t,i,o)}re.forEach(e=>{X[e]=Q(e,!1,!1),te[e]=Q(e,!0,!1),ee[e]=Q(e,!1,!0),ne[e]=Q(e,!0,!0)});const oe={get:ie(!1,!1)},se={get:ie(!1,!0)},ae={get:ie(!0,!1)};ie(!0,!0);const ce=new WeakMap,ue=new WeakMap,de=new WeakMap,le=new WeakMap;function he(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function fe(e){return e["__v_skip"]||!Object.isExtensible(e)?0:he(Object(r["L"])(e))}function pe(e){return e&&e["__v_isReadonly"]?e:ve(e,!1,U,oe,ce)}function ge(e){return ve(e,!1,j,se,ue)}function me(e){return ve(e,!0,D,ae,de)}function ve(e,t,n,i,o){if(!Object(r["t"])(e))return e;if(e["__v_raw"]&&(!t||!e["__v_isReactive"]))return e;const s=o.get(e);if(s)return s;const a=fe(e);if(0===a)return e;const c=new Proxy(e,2===a?i:n);return o.set(e,c),c}function _e(e){return ye(e)?_e(e["__v_raw"]):!(!e||!e["__v_isReactive"])}function ye(e){return!(!e||!e["__v_isReadonly"])}function Ee(e){return _e(e)||ye(e)}function Te(e){return e&&Te(e["__v_raw"])||e}const Ce=e=>Object(r["t"])(e)?pe(e):e;function Re(e){return Boolean(e&&!0===e.__v_isRef)}function Se(e){return Oe(e)}function be(e){return Oe(e,!0)}class Ie{constructor(e,t=!1){this._rawValue=e,this._shallow=t,this.__v_isRef=!0,this._value=t?e:Ce(e)}get value(){return E(Te(this),"get","value"),this._value}set value(e){Object(r["i"])(Te(e),this._rawValue)&&(this._rawValue=e,this._value=this._shallow?e:Ce(e),T(Te(this),"set","value",e))}}function Oe(e,t=!1){return Re(e)?e:new Ie(e,t)}function we(e){return Re(e)?e.value:e}const Ne={get:(e,t,n)=>we(Reflect.get(e,t,n)),set:(e,t,n,r)=>{const i=e[t];return Re(i)&&!Re(n)?(i.value=n,!0):Reflect.set(e,t,n,r)}};function Ae(e){return _e(e)?e:new Proxy(e,Ne)}class Me{constructor(e,t){this._object=e,this._key=t,this.__v_isRef=!0}get value(){return this._object[this._key]}set value(e){this._object[this._key]=e}}function Pe(e,t){return Re(e[t])?e[t]:new Me(e,t)}class ke{constructor(e,t,n){this._setter=t,this._dirty=!0,this.__v_isRef=!0,this.effect=d(e,{lazy:!0,scheduler:()=>{this._dirty||(this._dirty=!0,T(Te(this),"set","value"))}}),this["__v_isReadonly"]=n}get value(){const e=Te(this);return e._dirty&&(e._value=this.effect(),e._dirty=!1),E(e,"get","value"),e._value}set value(e){this._setter(e)}}function Le(e){let t,n;return Object(r["n"])(e)?(t=e,n=r["d"]):(t=e.get,n=e.set),new ke(t,n,Object(r["n"])(e)||!e.set)}function xe(e,t,n,r){let i;try{i=r?e(...r):e()}catch(o){De(o,t,n)}return i}function Ue(e,t,n,i){if(Object(r["n"])(e)){const o=xe(e,t,n,i);return o&&Object(r["w"])(o)&&o.catch(e=>{De(e,t,n)}),o}const o=[];for(let r=0;r<e.length;r++)o.push(Ue(e[r],t,n,i));return o}function De(e,t,n,r=!0){const i=t?t.vnode:null;if(t){let r=t.parent;const i=t.proxy,o=n;while(r){const t=r.ec;if(t)for(let n=0;n<t.length;n++)if(!1===t[n](e,i,o))return;r=r.parent}const s=t.appContext.config.errorHandler;if(s)return void xe(s,null,10,[e,i,o])}je(e,n,i,r)}function je(e,t,n,r=!0){console.error(e)}let Ve=!1,Be=!1;const Fe=[];let He=0;const Ge=[];let Ye=null,qe=0;const Ke=[];let We=null,$e=0;const Je=Promise.resolve();let ze=null,Qe=null;function Ze(e){const t=ze||Je;return e?t.then(this?e.bind(this):e):t}function Xe(e){let t=He+1,n=Fe.length;const r=ct(e);while(t<n){const e=t+n>>>1,i=ct(Fe[e]);i<r?t=e+1:n=e}return t}function et(e){if((!Fe.length||!Fe.includes(e,Ve&&e.allowRecurse?He+1:He))&&e!==Qe){const t=Xe(e);t>-1?Fe.splice(t,0,e):Fe.push(e),tt()}}function tt(){Ve||Be||(Be=!0,ze=Je.then(ut))}function nt(e){const t=Fe.indexOf(e);t>He&&Fe.splice(t,1)}function rt(e,t,n,i){Object(r["m"])(e)?n.push(...e):t&&t.includes(e,e.allowRecurse?i+1:i)||n.push(e),tt()}function it(e){rt(e,Ye,Ge,qe)}function ot(e){rt(e,We,Ke,$e)}function st(e,t=null){if(Ge.length){for(Qe=t,Ye=[...new Set(Ge)],Ge.length=0,qe=0;qe<Ye.length;qe++)Ye[qe]();Ye=null,qe=0,Qe=null,st(e,t)}}function at(e){if(Ke.length){const e=[...new Set(Ke)];if(Ke.length=0,We)return void We.push(...e);for(We=e,We.sort((e,t)=>ct(e)-ct(t)),$e=0;$e<We.length;$e++)We[$e]();We=null,$e=0}}const ct=e=>null==e.id?1/0:e.id;function ut(e){Be=!1,Ve=!0,st(e),Fe.sort((e,t)=>ct(e)-ct(t));try{for(He=0;He<Fe.length;He++){const e=Fe[He];e&&!1!==e.active&&xe(e,null,14)}}finally{He=0,Fe.length=0,at(e),Ve=!1,ze=null,(Fe.length||Ge.length||Ke.length)&&ut(e)}}new Set;new Map;Object.create(null),Object.create(null);function dt(e,t,...n){const i=e.vnode.props||r["b"];let o=n;const s=t.startsWith("update:"),a=s&&t.slice(7);if(a&&a in i){const e=("modelValue"===a?"model":a)+"Modifiers",{number:t,trim:s}=i[e]||r["b"];s?o=n.map(e=>e.trim()):t&&(o=n.map(r["K"]))}let c;let u=i[c=Object(r["J"])(t)]||i[c=Object(r["J"])(Object(r["e"])(t))];!u&&s&&(u=i[c=Object(r["J"])(Object(r["k"])(t))]),u&&Ue(u,e,6,o);const d=i[c+"Once"];if(d){if(e.emitted){if(e.emitted[c])return}else(e.emitted={})[c]=!0;Ue(d,e,6,o)}}function lt(e,t,n=!1){const i=t.emitsCache,o=i.get(e);if(void 0!==o)return o;const s=e.emits;let a={},c=!1;if(!Object(r["n"])(e)){const i=e=>{const n=lt(e,t,!0);n&&(c=!0,Object(r["h"])(a,n))};!n&&t.mixins.length&&t.mixins.forEach(i),e.extends&&i(e.extends),e.mixins&&e.mixins.forEach(i)}return s||c?(Object(r["m"])(s)?s.forEach(e=>a[e]=null):Object(r["h"])(a,s),i.set(e,a),a):(i.set(e,null),null)}function ht(e,t){return!(!e||!Object(r["u"])(t))&&(t=t.slice(2).replace(/Once$/,""),Object(r["j"])(e,t[0].toLowerCase()+t.slice(1))||Object(r["j"])(e,Object(r["k"])(t))||Object(r["j"])(e,t))}let ft=null,pt=null;function gt(e){const t=ft;return ft=e,pt=e&&e.type.__scopeId||null,t}function mt(e,t=ft,n){if(!t)return e;if(e._n)return e;const r=(...n)=>{r._d&&gr(-1);const i=gt(t),o=e(...n);return gt(i),r._d&&gr(1),o};return r._n=!0,r._c=!0,r._d=!0,r}function vt(e){const{type:t,vnode:n,proxy:i,withProxy:o,props:s,propsOptions:[a],slots:c,attrs:u,emit:d,render:l,renderCache:h,data:f,setupState:p,ctx:g,inheritAttrs:m}=e;let v;const _=gt(e);try{let e;if(4&n.shapeFlag){const t=o||i;v=Or(l.call(t,t,h,s,p,f,g)),e=u}else{const n=t;0,v=Or(n.length>1?n(s,{attrs:u,slots:c,emit:d}):n(s,null)),e=t.props?u:_t(u)}let _=v;if(e&&!1!==m){const t=Object.keys(e),{shapeFlag:n}=_;t.length&&(1&n||6&n)&&(a&&t.some(r["s"])&&(e=yt(e,a)),_=Sr(_,e))}0,n.dirs&&(_.dirs=_.dirs?_.dirs.concat(n.dirs):n.dirs),n.transition&&(_.transition=n.transition),v=_}catch(y){dr.length=0,De(y,e,1),v=Cr(cr)}return gt(_),v}const _t=e=>{let t;for(const n in e)("class"===n||"style"===n||Object(r["u"])(n))&&((t||(t={}))[n]=e[n]);return t},yt=(e,t)=>{const n={};for(const i in e)Object(r["s"])(i)&&i.slice(9)in t||(n[i]=e[i]);return n};function Et(e,t,n){const{props:r,children:i,component:o}=e,{props:s,children:a,patchFlag:c}=t,u=o.emitsOptions;if(t.dirs||t.transition)return!0;if(!(n&&c>=0))return!(!i&&!a||a&&a.$stable)||r!==s&&(r?!s||Tt(r,s,u):!!s);if(1024&c)return!0;if(16&c)return r?Tt(r,s,u):!!s;if(8&c){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const n=e[t];if(s[n]!==r[n]&&!ht(u,n))return!0}}return!1}function Tt(e,t,n){const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!0;for(let i=0;i<r.length;i++){const o=r[i];if(t[o]!==e[o]&&!ht(n,o))return!0}return!1}function Ct({vnode:e,parent:t},n){while(t&&t.subTree===e)(e=t.vnode).el=n,t=t.parent}const Rt=e=>e.__isSuspense;function St(e,t){t&&t.pendingBranch?Object(r["m"])(e)?t.effects.push(...e):t.effects.push(e):ot(e)}function bt(e,t){if(jr){let n=jr.provides;const r=jr.parent&&jr.parent.provides;r===n&&(n=jr.provides=Object.create(r)),n[e]=t}else 0}function It(e,t,n=!1){const i=jr||ft;if(i){const o=null==i.parent?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides;if(o&&e in o)return o[e];if(arguments.length>1)return n&&Object(r["n"])(t)?t():t}else 0}const Ot={};function wt(e,t,n){return Nt(e,t,n)}function Nt(e,t,{immediate:n,deep:i,flush:o,onTrack:s,onTrigger:a}=r["b"],c=jr){let u,h,f=!1,p=!1;if(Re(e)?(u=()=>e.value,f=!!e._shallow):_e(e)?(u=()=>e,i=!0):Object(r["m"])(e)?(p=!0,f=e.some(_e),u=()=>e.map(e=>Re(e)?e.value:_e(e)?Pt(e):Object(r["n"])(e)?xe(e,c,2):void 0)):u=Object(r["n"])(e)?t?()=>xe(e,c,2):()=>{if(!c||!c.isUnmounted)return h&&h(),Ue(e,c,3,[g])}:r["d"],t&&i){const e=u;u=()=>Pt(e())}let g=e=>{h=y.options.onStop=()=>{xe(e,c,4)}},m=p?[]:Ot;const v=()=>{if(y.active)if(t){const e=y();(i||f||(p?e.some((e,t)=>Object(r["i"])(e,m[t])):Object(r["i"])(e,m)))&&(h&&h(),Ue(t,c,3,[e,m===Ot?void 0:m,g]),m=e)}else y()};let _;v.allowRecurse=!!t,_="sync"===o?v:"post"===o?()=>Wn(v,c&&c.suspense):()=>{!c||c.isMounted?it(v):v()};const y=d(u,{lazy:!0,onTrack:s,onTrigger:a,scheduler:_});return Jr(y,c),t?n?v():m=y():"post"===o?Wn(y,c&&c.suspense):y(),()=>{l(y),c&&Object(r["I"])(c.effects,y)}}function At(e,t,n){const i=this.proxy,o=Object(r["B"])(e)?e.includes(".")?Mt(i,e):()=>i[e]:e.bind(i,i);let s;return Object(r["n"])(t)?s=t:(s=t.handler,n=t),Nt(o,s.bind(i),n,this)}function Mt(e,t){const n=t.split(".");return()=>{let t=e;for(let e=0;e<n.length&&t;e++)t=t[n[e]];return t}}function Pt(e,t=new Set){if(!Object(r["t"])(e)||t.has(e)||e["__v_skip"])return e;if(t.add(e),Re(e))Pt(e.value,t);else if(Object(r["m"])(e))for(let n=0;n<e.length;n++)Pt(e[n],t);else if(Object(r["z"])(e)||Object(r["r"])(e))e.forEach(e=>{Pt(e,t)});else if(Object(r["v"])(e))for(const n in e)Pt(e[n],t);return e}function kt(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return nn(()=>{e.isMounted=!0}),sn(()=>{e.isUnmounting=!0}),e}const Lt=[Function,Array],xt={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Lt,onEnter:Lt,onAfterEnter:Lt,onEnterCancelled:Lt,onBeforeLeave:Lt,onLeave:Lt,onAfterLeave:Lt,onLeaveCancelled:Lt,onBeforeAppear:Lt,onAppear:Lt,onAfterAppear:Lt,onAppearCancelled:Lt},setup(e,{slots:t}){const n=Vr(),r=kt();let i;return()=>{const o=t.default&&Ht(t.default(),!0);if(!o||!o.length)return;const s=Te(e),{mode:a}=s;const c=o[0];if(r.isLeaving)return Vt(c);const u=Bt(c);if(!u)return Vt(c);const d=jt(u,s,r,n);Ft(u,d);const l=n.subTree,h=l&&Bt(l);let f=!1;const{getTransitionKey:p}=u.type;if(p){const e=p();void 0===i?i=e:e!==i&&(i=e,f=!0)}if(h&&h.type!==cr&&(!_r(u,h)||f)){const e=jt(h,s,r,n);if(Ft(h,e),"out-in"===a)return r.isLeaving=!0,e.afterLeave=()=>{r.isLeaving=!1,n.update()},Vt(c);"in-out"===a&&u.type!==cr&&(e.delayLeave=(e,t,n)=>{const i=Dt(r,h);i[String(h.key)]=h,e._leaveCb=()=>{t(),e._leaveCb=void 0,delete d.delayedLeave},d.delayedLeave=n})}return c}}},Ut=xt;function Dt(e,t){const{leavingVNodes:n}=e;let r=n.get(t.type);return r||(r=Object.create(null),n.set(t.type,r)),r}function jt(e,t,n,r){const{appear:i,mode:o,persisted:s=!1,onBeforeEnter:a,onEnter:c,onAfterEnter:u,onEnterCancelled:d,onBeforeLeave:l,onLeave:h,onAfterLeave:f,onLeaveCancelled:p,onBeforeAppear:g,onAppear:m,onAfterAppear:v,onAppearCancelled:_}=t,y=String(e.key),E=Dt(n,e),T=(e,t)=>{e&&Ue(e,r,9,t)},C={mode:o,persisted:s,beforeEnter(t){let r=a;if(!n.isMounted){if(!i)return;r=g||a}t._leaveCb&&t._leaveCb(!0);const o=E[y];o&&_r(e,o)&&o.el._leaveCb&&o.el._leaveCb(),T(r,[t])},enter(e){let t=c,r=u,o=d;if(!n.isMounted){if(!i)return;t=m||c,r=v||u,o=_||d}let s=!1;const a=e._enterCb=t=>{s||(s=!0,T(t?o:r,[e]),C.delayedLeave&&C.delayedLeave(),e._enterCb=void 0)};t?(t(e,a),t.length<=1&&a()):a()},leave(t,r){const i=String(e.key);if(t._enterCb&&t._enterCb(!0),n.isUnmounting)return r();T(l,[t]);let o=!1;const s=t._leaveCb=n=>{o||(o=!0,r(),T(n?p:f,[t]),t._leaveCb=void 0,E[i]===e&&delete E[i])};E[i]=e,h?(h(t,s),h.length<=1&&s()):s()},clone(e){return jt(e,t,n,r)}};return C}function Vt(e){if(qt(e))return e=Sr(e),e.children=null,e}function Bt(e){return qt(e)?e.children?e.children[0]:void 0:e}function Ft(e,t){6&e.shapeFlag&&e.component?Ft(e.component.subTree,t):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Ht(e,t=!1){let n=[],r=0;for(let i=0;i<e.length;i++){const o=e[i];o.type===sr?(128&o.patchFlag&&r++,n=n.concat(Ht(o.children,t))):(t||o.type!==cr)&&n.push(o)}if(r>1)for(let i=0;i<n.length;i++)n[i].patchFlag=-2;return n}function Gt(e){return Object(r["n"])(e)?{setup:e,name:e.name}:e}const Yt=e=>!!e.type.__asyncLoader;const qt=e=>e.type.__isKeepAlive;RegExp,RegExp;function Kt(e,t){return Object(r["m"])(e)?e.some(e=>Kt(e,t)):Object(r["B"])(e)?e.split(",").indexOf(t)>-1:!!e.test&&e.test(t)}function Wt(e,t){Jt(e,"a",t)}function $t(e,t){Jt(e,"da",t)}function Jt(e,t,n=jr){const r=e.__wdc||(e.__wdc=()=>{let t=n;while(t){if(t.isDeactivated)return;t=t.parent}e()});if(Xt(t,r,n),n){let e=n.parent;while(e&&e.parent)qt(e.parent.vnode)&&zt(r,t,n,e),e=e.parent}}function zt(e,t,n,i){const o=Xt(t,e,i,!0);an(()=>{Object(r["I"])(i[t],o)},n)}function Qt(e){let t=e.shapeFlag;256&t&&(t-=256),512&t&&(t-=512),e.shapeFlag=t}function Zt(e){return 128&e.shapeFlag?e.ssContent:e}function Xt(e,t,n=jr,r=!1){if(n){const i=n[e]||(n[e]=[]),o=t.__weh||(t.__weh=(...r)=>{if(n.isUnmounted)return;v(),Br(n);const i=Ue(t,n,e,r);return Br(null),y(),i});return r?i.unshift(o):i.push(o),o}}const en=e=>(t,n=jr)=>(!Gr||"sp"===e)&&Xt(e,t,n),tn=en("bm"),nn=en("m"),rn=en("bu"),on=en("u"),sn=en("bum"),an=en("um"),cn=en("sp"),un=en("rtg"),dn=en("rtc");function ln(e,t=jr){Xt("ec",e,t)}let hn=!0;function fn(e){const t=vn(e),n=e.proxy,i=e.ctx;hn=!1,t.beforeCreate&&gn(t.beforeCreate,e,"bc");const{data:o,computed:s,methods:a,watch:c,provide:u,inject:d,created:l,beforeMount:h,mounted:f,beforeUpdate:p,updated:g,activated:m,deactivated:v,beforeDestroy:_,beforeUnmount:y,destroyed:E,unmounted:T,render:C,renderTracked:R,renderTriggered:S,errorCaptured:b,serverPrefetch:I,expose:O,inheritAttrs:w,components:N,directives:A,filters:M}=t,P=null;if(d&&pn(d,i,P),a)for(const L in a){const e=a[L];Object(r["n"])(e)&&(i[L]=e.bind(n))}if(o){0;const t=o.call(n,n);0,Object(r["t"])(t)&&(e.data=pe(t))}if(hn=!0,s)for(const L in s){const e=s[L],t=Object(r["n"])(e)?e.bind(n,n):Object(r["n"])(e.get)?e.get.bind(n,n):r["d"];0;const o=!Object(r["n"])(e)&&Object(r["n"])(e.set)?e.set.bind(n):r["d"],a=Zr({get:t,set:o});Object.defineProperty(i,L,{enumerable:!0,configurable:!0,get:()=>a.value,set:e=>a.value=e})}if(c)for(const r in c)mn(c[r],i,n,r);if(u){const e=Object(r["n"])(u)?u.call(n):u;Reflect.ownKeys(e).forEach(t=>{bt(t,e[t])})}function k(e,t){Object(r["m"])(t)?t.forEach(t=>e(t.bind(n))):t&&e(t.bind(n))}if(l&&gn(l,e,"c"),k(tn,h),k(nn,f),k(rn,p),k(on,g),k(Wt,m),k($t,v),k(ln,b),k(dn,R),k(un,S),k(sn,y),k(an,T),k(cn,I),Object(r["m"])(O))if(O.length){const t=e.exposed||(e.exposed=Ae({}));O.forEach(e=>{t[e]=Pe(n,e)})}else e.exposed||(e.exposed=r["b"]);C&&e.render===r["d"]&&(e.render=C),null!=w&&(e.inheritAttrs=w),N&&(e.components=N),A&&(e.directives=A)}function pn(e,t,n=r["d"]){Object(r["m"])(e)&&(e=Cn(e));for(const i in e){const n=e[i];Object(r["t"])(n)?t[i]="default"in n?It(n.from||i,n.default,!0):It(n.from||i):t[i]=It(n)}}function gn(e,t,n){Ue(Object(r["m"])(e)?e.map(e=>e.bind(t.proxy)):e.bind(t.proxy),t,n)}function mn(e,t,n,i){const o=i.includes(".")?Mt(n,i):()=>n[i];if(Object(r["B"])(e)){const n=t[e];Object(r["n"])(n)&&wt(o,n)}else if(Object(r["n"])(e))wt(o,e.bind(n));else if(Object(r["t"])(e))if(Object(r["m"])(e))e.forEach(e=>mn(e,t,n,i));else{const i=Object(r["n"])(e.handler)?e.handler.bind(n):t[e.handler];Object(r["n"])(i)&&wt(o,i,e)}else 0}function vn(e){const t=e.type,{mixins:n,extends:r}=t,{mixins:i,optionsCache:o,config:{optionMergeStrategies:s}}=e.appContext,a=o.get(t);let c;return a?c=a:i.length||n||r?(c={},i.length&&i.forEach(e=>_n(c,e,s,!0)),_n(c,t,s)):c=t,o.set(t,c),c}function _n(e,t,n,r=!1){const{mixins:i,extends:o}=t;o&&_n(e,o,n,!0),i&&i.forEach(t=>_n(e,t,n,!0));for(const s in t)if(r&&"expose"===s);else{const r=yn[s]||n&&n[s];e[s]=r?r(e[s],t[s]):t[s]}return e}const yn={data:En,props:Sn,emits:Sn,methods:Sn,computed:Sn,beforeCreate:Rn,created:Rn,beforeMount:Rn,mounted:Rn,beforeUpdate:Rn,updated:Rn,beforeDestroy:Rn,destroyed:Rn,activated:Rn,deactivated:Rn,errorCaptured:Rn,serverPrefetch:Rn,components:Sn,directives:Sn,watch:Sn,provide:En,inject:Tn};function En(e,t){return t?e?function(){return Object(r["h"])(Object(r["n"])(e)?e.call(this,this):e,Object(r["n"])(t)?t.call(this,this):t)}:t:e}function Tn(e,t){return Sn(Cn(e),Cn(t))}function Cn(e){if(Object(r["m"])(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function Rn(e,t){return e?[...new Set([].concat(e,t))]:t}function Sn(e,t){return e?Object(r["h"])(Object(r["h"])(Object.create(null),e),t):t}function bn(e,t,n,i=!1){const o={},s={};Object(r["g"])(s,yr,1),e.propsDefaults=Object.create(null),On(e,t,o,s);for(const r in e.propsOptions[0])r in o||(o[r]=void 0);n?e.props=i?o:ge(o):e.type.props?e.props=o:e.props=s,e.attrs=s}function In(e,t,n,i){const{props:o,attrs:s,vnode:{patchFlag:a}}=e,c=Te(o),[u]=e.propsOptions;let d=!1;if(!(i||a>0)||16&a){let i;On(e,t,o,s)&&(d=!0);for(const s in c)t&&(Object(r["j"])(t,s)||(i=Object(r["k"])(s))!==s&&Object(r["j"])(t,i))||(u?!n||void 0===n[s]&&void 0===n[i]||(o[s]=wn(u,c,s,void 0,e,!0)):delete o[s]);if(s!==c)for(const e in s)t&&Object(r["j"])(t,e)||(delete s[e],d=!0)}else if(8&a){const n=e.vnode.dynamicProps;for(let i=0;i<n.length;i++){let a=n[i];const l=t[a];if(u)if(Object(r["j"])(s,a))l!==s[a]&&(s[a]=l,d=!0);else{const t=Object(r["e"])(a);o[t]=wn(u,c,t,l,e,!1)}else l!==s[a]&&(s[a]=l,d=!0)}}d&&T(e,"set","$attrs")}function On(e,t,n,i){const[o,s]=e.propsOptions;let a,c=!1;if(t)for(let u in t){if(Object(r["x"])(u))continue;const d=t[u];let l;o&&Object(r["j"])(o,l=Object(r["e"])(u))?s&&s.includes(l)?(a||(a={}))[l]=d:n[l]=d:ht(e.emitsOptions,u)||d!==i[u]&&(i[u]=d,c=!0)}if(s){const t=Te(n),i=a||r["b"];for(let a=0;a<s.length;a++){const c=s[a];n[c]=wn(o,t,c,i[c],e,!Object(r["j"])(i,c))}}return c}function wn(e,t,n,i,o,s){const a=e[n];if(null!=a){const e=Object(r["j"])(a,"default");if(e&&void 0===i){const e=a.default;if(a.type!==Function&&Object(r["n"])(e)){const{propsDefaults:r}=o;n in r?i=r[n]:(Br(o),i=r[n]=e.call(null,t),Br(null))}else i=e}a[0]&&(s&&!e?i=!1:!a[1]||""!==i&&i!==Object(r["k"])(n)||(i=!0))}return i}function Nn(e,t,n=!1){const i=t.propsCache,o=i.get(e);if(o)return o;const s=e.props,a={},c=[];let u=!1;if(!Object(r["n"])(e)){const i=e=>{u=!0;const[n,i]=Nn(e,t,!0);Object(r["h"])(a,n),i&&c.push(...i)};!n&&t.mixins.length&&t.mixins.forEach(i),e.extends&&i(e.extends),e.mixins&&e.mixins.forEach(i)}if(!s&&!u)return i.set(e,r["a"]),r["a"];if(Object(r["m"])(s))for(let l=0;l<s.length;l++){0;const e=Object(r["e"])(s[l]);An(e)&&(a[e]=r["b"])}else if(s){0;for(const e in s){const t=Object(r["e"])(e);if(An(t)){const n=s[e],i=a[t]=Object(r["m"])(n)||Object(r["n"])(n)?{type:n}:n;if(i){const e=kn(Boolean,i.type),n=kn(String,i.type);i[0]=e>-1,i[1]=n<0||e<n,(e>-1||Object(r["j"])(i,"default"))&&c.push(t)}}}}const d=[a,c];return i.set(e,d),d}function An(e){return"$"!==e[0]}function Mn(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:""}function Pn(e,t){return Mn(e)===Mn(t)}function kn(e,t){return Object(r["m"])(t)?t.findIndex(t=>Pn(t,e)):Object(r["n"])(t)&&Pn(t,e)?0:-1}const Ln=e=>"_"===e[0]||"$stable"===e,xn=e=>Object(r["m"])(e)?e.map(Or):[Or(e)],Un=(e,t,n)=>{const r=mt(e=>xn(t(e)),n);return r._c=!1,r},Dn=(e,t,n)=>{const i=e._ctx;for(const o in e){if(Ln(o))continue;const n=e[o];if(Object(r["n"])(n))t[o]=Un(o,n,i);else if(null!=n){0;const e=xn(n);t[o]=()=>e}}},jn=(e,t)=>{const n=xn(t);e.slots.default=()=>n},Vn=(e,t)=>{if(32&e.vnode.shapeFlag){const n=t._;n?(e.slots=Te(t),Object(r["g"])(t,"_",n)):Dn(t,e.slots={})}else e.slots={},t&&jn(e,t);Object(r["g"])(e.slots,yr,1)},Bn=(e,t,n)=>{const{vnode:i,slots:o}=e;let s=!0,a=r["b"];if(32&i.shapeFlag){const e=t._;e?n&&1===e?s=!1:(Object(r["h"])(o,t),n||1!==e||delete o._):(s=!t.$stable,Dn(t,o)),a=t}else t&&(jn(e,t),a={default:1});if(s)for(const r in o)Ln(r)||r in a||delete o[r]};function Fn(e,t,n,r){const i=e.dirs,o=t&&t.dirs;for(let s=0;s<i.length;s++){const a=i[s];o&&(a.oldValue=o[s].value);let c=a.dir[r];c&&(v(),Ue(c,n,8,[e.el,a,e,t]),y())}}function Hn(){return{app:null,config:{isNativeTag:r["c"],performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Gn=0;function Yn(e,t){return function(n,i=null){null==i||Object(r["t"])(i)||(i=null);const o=Hn(),s=new Set;let a=!1;const c=o.app={_uid:Gn++,_component:n,_props:i,_container:null,_context:o,version:ei,get config(){return o.config},set config(e){0},use(e,...t){return s.has(e)||(e&&Object(r["n"])(e.install)?(s.add(e),e.install(c,...t)):Object(r["n"])(e)&&(s.add(e),e(c,...t))),c},mixin(e){return o.mixins.includes(e)||o.mixins.push(e),c},component(e,t){return t?(o.components[e]=t,c):o.components[e]},directive(e,t){return t?(o.directives[e]=t,c):o.directives[e]},mount(r,s,u){if(!a){const d=Cr(n,i);return d.appContext=o,s&&t?t(d,r):e(d,r,u),a=!0,c._container=r,r.__vue_app__=c,d.component.proxy}},unmount(){a&&(e(null,c._container),delete c._container.__vue_app__)},provide(e,t){return o.provides[e]=t,c}};return c}}function qn(){}const Kn={scheduler:et,allowRecurse:!0};const Wn=St,$n=(e,t,n,i,o=!1)=>{if(Object(r["m"])(e))return void e.forEach((e,s)=>$n(e,t&&(Object(r["m"])(t)?t[s]:t),n,i,o));if(Yt(i)&&!o)return;const s=4&i.shapeFlag?i.component.exposed||i.component.proxy:i.el,a=o?null:s,{i:c,r:u}=e;const d=t&&t.r,l=c.refs===r["b"]?c.refs={}:c.refs,h=c.setupState;if(null!=d&&d!==u&&(Object(r["B"])(d)?(l[d]=null,Object(r["j"])(h,d)&&(h[d]=null)):Re(d)&&(d.value=null)),Object(r["B"])(u)){const e=()=>{l[u]=a,Object(r["j"])(h,u)&&(h[u]=a)};a?(e.id=-1,Wn(e,n)):e()}else if(Re(u)){const e=()=>{u.value=a};a?(e.id=-1,Wn(e,n)):e()}else Object(r["n"])(u)&&xe(u,c,12,[a,l])};function Jn(e){return zn(e)}function zn(e,t){qn();const{insert:n,remove:i,patchProp:o,forcePatchProp:s,createElement:a,createText:c,createComment:u,setText:h,setElementText:f,parentNode:p,nextSibling:g,setScopeId:m=r["d"],cloneNode:_,insertStaticContent:E}=e,T=(e,t,n,r=null,i=null,o=null,s=!1,a=null,c=!1)=>{e&&!_r(e,t)&&(r=J(e),Y(e,i,o,!0),e=null),-2===t.patchFlag&&(c=!1,t.dynamicChildren=null);const{type:u,ref:d,shapeFlag:l}=t;switch(u){case ar:C(e,t,n,r);break;case cr:R(e,t,n,r);break;case ur:null==e&&S(t,n,r,s);break;case sr:L(e,t,n,r,i,o,s,a,c);break;default:1&l?O(e,t,n,r,i,o,s,a,c):6&l?x(e,t,n,r,i,o,s,a,c):(64&l||128&l)&&u.process(e,t,n,r,i,o,s,a,c,Q)}null!=d&&i&&$n(d,e&&e.ref,o,t||e,!t)},C=(e,t,r,i)=>{if(null==e)n(t.el=c(t.children),r,i);else{const n=t.el=e.el;t.children!==e.children&&h(n,t.children)}},R=(e,t,r,i)=>{null==e?n(t.el=u(t.children||""),r,i):t.el=e.el},S=(e,t,n,r)=>{[e.el,e.anchor]=E(e.children,t,n,r)},b=({el:e,anchor:t},r,i)=>{let o;while(e&&e!==t)o=g(e),n(e,r,i),e=o;n(t,r,i)},I=({el:e,anchor:t})=>{let n;while(e&&e!==t)n=g(e),i(e),e=n;i(t)},O=(e,t,n,r,i,o,s,a,c)=>{s=s||"svg"===t.type,null==e?w(t,n,r,i,o,s,a,c):M(e,t,i,o,s,a,c)},w=(e,t,i,s,c,u,d,l)=>{let h,p;const{type:g,props:m,shapeFlag:v,transition:y,patchFlag:E,dirs:T}=e;if(e.el&&void 0!==_&&-1===E)h=e.el=_(e.el);else{if(h=e.el=a(e.type,u,m&&m.is,m),8&v?f(h,e.children):16&v&&A(e.children,h,null,s,c,u&&"foreignObject"!==g,d,l||!!e.dynamicChildren),T&&Fn(e,null,s,"created"),m){for(const t in m)Object(r["x"])(t)||o(h,t,null,m[t],u,e.children,s,c,$);(p=m.onVnodeBeforeMount)&&Qn(p,s,e)}N(h,e,e.scopeId,d,s)}T&&Fn(e,null,s,"beforeMount");const C=(!c||c&&!c.pendingBranch)&&y&&!y.persisted;C&&y.beforeEnter(h),n(h,t,i),((p=m&&m.onVnodeMounted)||C||T)&&Wn(()=>{p&&Qn(p,s,e),C&&y.enter(h),T&&Fn(e,null,s,"mounted")},c)},N=(e,t,n,r,i)=>{if(n&&m(e,n),r)for(let o=0;o<r.length;o++)m(e,r[o]);if(i){let n=i.subTree;if(t===n){const t=i.vnode;N(e,t,t.scopeId,t.slotScopeIds,i.parent)}}},A=(e,t,n,r,i,o,s,a,c=0)=>{for(let u=c;u<e.length;u++){const c=e[u]=a?wr(e[u]):Or(e[u]);T(null,c,t,n,r,i,o,s,a)}},M=(e,t,n,i,a,c,u)=>{const d=t.el=e.el;let{patchFlag:l,dynamicChildren:h,dirs:p}=t;l|=16&e.patchFlag;const g=e.props||r["b"],m=t.props||r["b"];let v;if((v=m.onVnodeBeforeUpdate)&&Qn(v,n,t,e),p&&Fn(t,e,n,"beforeUpdate"),l>0){if(16&l)k(d,t,g,m,n,i,a);else if(2&l&&g.class!==m.class&&o(d,"class",null,m.class,a),4&l&&o(d,"style",g.style,m.style,a),8&l){const r=t.dynamicProps;for(let t=0;t<r.length;t++){const c=r[t],u=g[c],l=m[c];(l!==u||s&&s(d,c))&&o(d,c,u,l,a,e.children,n,i,$)}}1&l&&e.children!==t.children&&f(d,t.children)}else u||null!=h||k(d,t,g,m,n,i,a);const _=a&&"foreignObject"!==t.type;h?P(e.dynamicChildren,h,d,n,i,_,c):u||B(e,t,d,null,n,i,_,c,!1),((v=m.onVnodeUpdated)||p)&&Wn(()=>{v&&Qn(v,n,t,e),p&&Fn(t,e,n,"updated")},i)},P=(e,t,n,r,i,o,s)=>{for(let a=0;a<t.length;a++){const c=e[a],u=t[a],d=c.el&&(c.type===sr||!_r(c,u)||6&c.shapeFlag||64&c.shapeFlag)?p(c.el):n;T(c,u,d,null,r,i,o,s,!0)}},k=(e,t,n,i,a,c,u)=>{if(n!==i){for(const d in i){if(Object(r["x"])(d))continue;const l=i[d],h=n[d];(l!==h||s&&s(e,d))&&o(e,d,h,l,u,t.children,a,c,$)}if(n!==r["b"])for(const s in n)Object(r["x"])(s)||s in i||o(e,s,n[s],null,u,t.children,a,c,$)}},L=(e,t,r,i,o,s,a,u,d)=>{const l=t.el=e?e.el:c(""),h=t.anchor=e?e.anchor:c("");let{patchFlag:f,dynamicChildren:p,slotScopeIds:g}=t;p&&(d=!0),g&&(u=u?u.concat(g):g),null==e?(n(l,r,i),n(h,r,i),A(t.children,r,h,o,s,a,u,d)):f>0&&64&f&&p&&e.dynamicChildren?(P(e.dynamicChildren,p,r,o,s,a,u),(null!=t.key||o&&t===o.subTree)&&Zn(e,t,!0)):B(e,t,r,h,o,s,a,u,d)},x=(e,t,n,r,i,o,s,a,c)=>{t.slotScopeIds=a,null==e?512&t.shapeFlag?i.ctx.activate(t,n,r,s,c):U(t,n,r,i,o,s,c):D(e,t,c)},U=(e,t,n,r,i,o,s)=>{const a=e.component=Dr(e,r,i);if(qt(e)&&(a.ctx.renderer=Q),Yr(a),a.asyncDep){if(i&&i.registerDep(a,j),!e.el){const e=a.subTree=Cr(cr);R(null,e,t,n)}}else j(a,e,t,n,i,o,s)},D=(e,t,n)=>{const r=t.component=e.component;if(Et(e,t,n)){if(r.asyncDep&&!r.asyncResolved)return void V(r,t,n);r.next=t,nt(r.update),r.update()}else t.component=e.component,t.el=e.el,r.vnode=t},j=(e,t,n,i,o,s,a)=>{e.update=d((function(){if(e.isMounted){let t,{next:n,bu:i,u:c,parent:u,vnode:d}=e,l=n;0,n?(n.el=d.el,V(e,n,a)):n=d,i&&Object(r["l"])(i),(t=n.props&&n.props.onVnodeBeforeUpdate)&&Qn(t,u,n,d);const h=vt(e);0;const f=e.subTree;e.subTree=h,T(f,h,p(f.el),J(f),e,o,s),n.el=h.el,null===l&&Ct(e,h.el),c&&Wn(c,o),(t=n.props&&n.props.onVnodeUpdated)&&Wn(()=>Qn(t,u,n,d),o)}else{let a;const{el:c,props:u}=t,{bm:d,m:l,parent:h}=e;if(d&&Object(r["l"])(d),(a=u&&u.onVnodeBeforeMount)&&Qn(a,h,t),c&&X){const n=()=>{e.subTree=vt(e),X(c,e.subTree,e,o,null)};Yt(t)?t.type.__asyncLoader().then(()=>!e.isUnmounted&&n()):n()}else{0;const r=e.subTree=vt(e);0,T(null,r,n,i,e,o,s),t.el=r.el}if(l&&Wn(l,o),a=u&&u.onVnodeMounted){const e=t;Wn(()=>Qn(a,h,e),o)}256&t.shapeFlag&&e.a&&Wn(e.a,o),e.isMounted=!0,t=n=i=null}}),Kn)},V=(e,t,n)=>{t.component=e;const r=e.vnode.props;e.vnode=t,e.next=null,In(e,t.props,r,n),Bn(e,t.children,n),v(),st(void 0,e.update),y()},B=(e,t,n,r,i,o,s,a,c=!1)=>{const u=e&&e.children,d=e?e.shapeFlag:0,l=t.children,{patchFlag:h,shapeFlag:p}=t;if(h>0){if(128&h)return void H(u,l,n,r,i,o,s,a,c);if(256&h)return void F(u,l,n,r,i,o,s,a,c)}8&p?(16&d&&$(u,i,o),l!==u&&f(n,l)):16&d?16&p?H(u,l,n,r,i,o,s,a,c):$(u,i,o,!0):(8&d&&f(n,""),16&p&&A(l,n,r,i,o,s,a,c))},F=(e,t,n,i,o,s,a,c,u)=>{e=e||r["a"],t=t||r["a"];const d=e.length,l=t.length,h=Math.min(d,l);let f;for(f=0;f<h;f++){const r=t[f]=u?wr(t[f]):Or(t[f]);T(e[f],r,n,null,o,s,a,c,u)}d>l?$(e,o,s,!0,!1,h):A(t,n,i,o,s,a,c,u,h)},H=(e,t,n,i,o,s,a,c,u)=>{let d=0;const l=t.length;let h=e.length-1,f=l-1;while(d<=h&&d<=f){const r=e[d],i=t[d]=u?wr(t[d]):Or(t[d]);if(!_r(r,i))break;T(r,i,n,null,o,s,a,c,u),d++}while(d<=h&&d<=f){const r=e[h],i=t[f]=u?wr(t[f]):Or(t[f]);if(!_r(r,i))break;T(r,i,n,null,o,s,a,c,u),h--,f--}if(d>h){if(d<=f){const e=f+1,r=e<l?t[e].el:i;while(d<=f)T(null,t[d]=u?wr(t[d]):Or(t[d]),n,r,o,s,a,c,u),d++}}else if(d>f)while(d<=h)Y(e[d],o,s,!0),d++;else{const p=d,g=d,m=new Map;for(d=g;d<=f;d++){const e=t[d]=u?wr(t[d]):Or(t[d]);null!=e.key&&m.set(e.key,d)}let v,_=0;const y=f-g+1;let E=!1,C=0;const R=new Array(y);for(d=0;d<y;d++)R[d]=0;for(d=p;d<=h;d++){const r=e[d];if(_>=y){Y(r,o,s,!0);continue}let i;if(null!=r.key)i=m.get(r.key);else for(v=g;v<=f;v++)if(0===R[v-g]&&_r(r,t[v])){i=v;break}void 0===i?Y(r,o,s,!0):(R[i-g]=d+1,i>=C?C=i:E=!0,T(r,t[i],n,null,o,s,a,c,u),_++)}const S=E?Xn(R):r["a"];for(v=S.length-1,d=y-1;d>=0;d--){const e=g+d,r=t[e],h=e+1<l?t[e+1].el:i;0===R[d]?T(null,r,n,h,o,s,a,c,u):E&&(v<0||d!==S[v]?G(r,n,h,2):v--)}}},G=(e,t,r,i,o=null)=>{const{el:s,type:a,transition:c,children:u,shapeFlag:d}=e;if(6&d)return void G(e.component.subTree,t,r,i);if(128&d)return void e.suspense.move(t,r,i);if(64&d)return void a.move(e,t,r,Q);if(a===sr){n(s,t,r);for(let e=0;e<u.length;e++)G(u[e],t,r,i);return void n(e.anchor,t,r)}if(a===ur)return void b(e,t,r);const l=2!==i&&1&d&&c;if(l)if(0===i)c.beforeEnter(s),n(s,t,r),Wn(()=>c.enter(s),o);else{const{leave:e,delayLeave:i,afterLeave:o}=c,a=()=>n(s,t,r),u=()=>{e(s,()=>{a(),o&&o()})};i?i(s,a,u):u()}else n(s,t,r)},Y=(e,t,n,r=!1,i=!1)=>{const{type:o,props:s,ref:a,children:c,dynamicChildren:u,shapeFlag:d,patchFlag:l,dirs:h}=e;if(null!=a&&$n(a,null,n,e,!0),256&d)return void t.ctx.deactivate(e);const f=1&d&&h;let p;if((p=s&&s.onVnodeBeforeUnmount)&&Qn(p,t,e),6&d)W(e.component,n,r);else{if(128&d)return void e.suspense.unmount(n,r);f&&Fn(e,null,t,"beforeUnmount"),64&d?e.type.remove(e,t,n,i,Q,r):u&&(o!==sr||l>0&&64&l)?$(u,t,n,!1,!0):(o===sr&&(128&l||256&l)||!i&&16&d)&&$(c,t,n),r&&q(e)}((p=s&&s.onVnodeUnmounted)||f)&&Wn(()=>{p&&Qn(p,t,e),f&&Fn(e,null,t,"unmounted")},n)},q=e=>{const{type:t,el:n,anchor:r,transition:o}=e;if(t===sr)return void K(n,r);if(t===ur)return void I(e);const s=()=>{i(n),o&&!o.persisted&&o.afterLeave&&o.afterLeave()};if(1&e.shapeFlag&&o&&!o.persisted){const{leave:t,delayLeave:r}=o,i=()=>t(n,s);r?r(e.el,s,i):i()}else s()},K=(e,t)=>{let n;while(e!==t)n=g(e),i(e),e=n;i(t)},W=(e,t,n)=>{const{bum:i,effects:o,update:s,subTree:a,um:c}=e;if(i&&Object(r["l"])(i),o)for(let r=0;r<o.length;r++)l(o[r]);s&&(l(s),Y(a,e,t,n)),c&&Wn(c,t),Wn(()=>{e.isUnmounted=!0},t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},$=(e,t,n,r=!1,i=!1,o=0)=>{for(let s=o;s<e.length;s++)Y(e[s],t,n,r,i)},J=e=>6&e.shapeFlag?J(e.component.subTree):128&e.shapeFlag?e.suspense.next():g(e.anchor||e.el),z=(e,t,n)=>{null==e?t._vnode&&Y(t._vnode,null,null,!0):T(t._vnode||null,e,t,null,null,null,n),at(),t._vnode=e},Q={p:T,um:Y,m:G,r:q,mt:U,mc:A,pc:B,pbc:P,n:J,o:e};let Z,X;return t&&([Z,X]=t(Q)),{render:z,hydrate:Z,createApp:Yn(z,Z)}}function Qn(e,t,n,r=null){Ue(e,t,7,[n,r])}function Zn(e,t,n=!1){const i=e.children,o=t.children;if(Object(r["m"])(i)&&Object(r["m"])(o))for(let r=0;r<i.length;r++){const e=i[r];let t=o[r];1&t.shapeFlag&&!t.dynamicChildren&&((t.patchFlag<=0||32===t.patchFlag)&&(t=o[r]=wr(o[r]),t.el=e.el),n||Zn(e,t))}}function Xn(e){const t=e.slice(),n=[0];let r,i,o,s,a;const c=e.length;for(r=0;r<c;r++){const c=e[r];if(0!==c){if(i=n[n.length-1],e[i]<c){t[r]=i,n.push(r);continue}o=0,s=n.length-1;while(o<s)a=(o+s)/2|0,e[n[a]]<c?o=a+1:s=a;c<e[n[o]]&&(o>0&&(t[r]=n[o-1]),n[o]=r)}}o=n.length,s=n[o-1];while(o-- >0)n[o]=s,s=t[s];return n}const er=e=>e.__isTeleport;const tr="components";function nr(e,t){return ir(tr,e,!0,t)||e}const rr=Symbol();function ir(e,t,n=!0,i=!1){const o=ft||jr;if(o){const n=o.type;if(e===tr){const e=zr(n);if(e&&(e===t||e===Object(r["e"])(t)||e===Object(r["f"])(Object(r["e"])(t))))return n}const s=or(o[e]||n[e],t)||or(o.appContext[e],t);return!s&&i?n:s}}function or(e,t){return e&&(e[t]||e[Object(r["e"])(t)]||e[Object(r["f"])(Object(r["e"])(t))])}const sr=Symbol(void 0),ar=Symbol(void 0),cr=Symbol(void 0),ur=Symbol(void 0),dr=[];let lr=null;function hr(e=!1){dr.push(lr=e?null:[])}function fr(){dr.pop(),lr=dr[dr.length-1]||null}let pr=1;function gr(e){pr+=e}function mr(e,t,n,i,o){const s=Cr(e,t,n,i,o,!0);return s.dynamicChildren=pr>0?lr||r["a"]:null,fr(),pr>0&&lr&&lr.push(s),s}function vr(e){return!!e&&!0===e.__v_isVNode}function _r(e,t){return e.type===t.type&&e.key===t.key}const yr="__vInternal",Er=({key:e})=>null!=e?e:null,Tr=({ref:e})=>null!=e?Object(r["B"])(e)||Re(e)||Object(r["n"])(e)?{i:ft,r:e}:e:null,Cr=Rr;function Rr(e,t=null,n=null,i=0,o=null,s=!1){if(e&&e!==rr||(e=cr),vr(e)){const r=Sr(e,t,!0);return n&&Nr(r,n),r}if(Qr(e)&&(e=e.__vccOpts),t){(Ee(t)||yr in t)&&(t=Object(r["h"])({},t));let{class:e,style:n}=t;e&&!Object(r["B"])(e)&&(t.class=Object(r["G"])(e)),Object(r["t"])(n)&&(Ee(n)&&!Object(r["m"])(n)&&(n=Object(r["h"])({},n)),t.style=Object(r["H"])(n))}const a=Object(r["B"])(e)?1:Rt(e)?128:er(e)?64:Object(r["t"])(e)?4:Object(r["n"])(e)?2:0;const c={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Er(t),ref:t&&Tr(t),scopeId:pt,slotScopeIds:null,children:null,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:i,dynamicProps:o,dynamicChildren:null,appContext:null};return Nr(c,n),128&a&&e.normalize(c),pr>0&&!s&&lr&&(i>0||6&a)&&32!==i&&lr.push(c),c}function Sr(e,t,n=!1){const{props:i,ref:o,patchFlag:s,children:a}=e,c=t?Ar(i||{},t):i,u={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&Er(c),ref:t&&t.ref?n&&o?Object(r["m"])(o)?o.concat(Tr(t)):[o,Tr(t)]:Tr(t):o,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:a,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==sr?-1===s?16:16|s:s,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Sr(e.ssContent),ssFallback:e.ssFallback&&Sr(e.ssFallback),el:e.el,anchor:e.anchor};return u}function br(e=" ",t=0){return Cr(ar,null,e,t)}function Ir(e="",t=!1){return t?(hr(),mr(cr,null,e)):Cr(cr,null,e)}function Or(e){return null==e||"boolean"===typeof e?Cr(cr):Object(r["m"])(e)?Cr(sr,null,e.slice()):"object"===typeof e?wr(e):Cr(ar,null,String(e))}function wr(e){return null===e.el?e:Sr(e)}function Nr(e,t){let n=0;const{shapeFlag:i}=e;if(null==t)t=null;else if(Object(r["m"])(t))n=16;else if("object"===typeof t){if(1&i||64&i){const n=t.default;return void(n&&(n._c&&(n._d=!1),Nr(e,n()),n._c&&(n._d=!0)))}{n=32;const r=t._;r||yr in t?3===r&&ft&&(1===ft.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=ft}}else Object(r["n"])(t)?(t={default:t,_ctx:ft},n=32):(t=String(t),64&i?(n=16,t=[br(t)]):n=8);e.children=t,e.shapeFlag|=n}function Ar(...e){const t=Object(r["h"])({},e[0]);for(let n=1;n<e.length;n++){const i=e[n];for(const e in i)if("class"===e)t.class!==i.class&&(t.class=Object(r["G"])([t.class,i.class]));else if("style"===e)t.style=Object(r["H"])([t.style,i.style]);else if(Object(r["u"])(e)){const n=t[e],r=i[e];n!==r&&(t[e]=n?[].concat(n,r):r)}else""!==e&&(t[e]=i[e])}return t}const Mr=e=>e?Fr(e)?e.exposed?e.exposed:e.proxy:Mr(e.parent):null,Pr=Object(r["h"])(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Mr(e.parent),$root:e=>Mr(e.root),$emit:e=>e.emit,$options:e=>vn(e),$forceUpdate:e=>()=>et(e.update),$nextTick:e=>Ze.bind(e.proxy),$watch:e=>At.bind(e)}),kr={get({_:e},t){const{ctx:n,setupState:i,data:o,props:s,accessCache:a,type:c,appContext:u}=e;if("__v_skip"===t)return!0;let d;if("$"!==t[0]){const c=a[t];if(void 0!==c)switch(c){case 0:return i[t];case 1:return o[t];case 3:return n[t];case 2:return s[t]}else{if(i!==r["b"]&&Object(r["j"])(i,t))return a[t]=0,i[t];if(o!==r["b"]&&Object(r["j"])(o,t))return a[t]=1,o[t];if((d=e.propsOptions[0])&&Object(r["j"])(d,t))return a[t]=2,s[t];if(n!==r["b"]&&Object(r["j"])(n,t))return a[t]=3,n[t];hn&&(a[t]=4)}}const l=Pr[t];let h,f;return l?("$attrs"===t&&E(e,"get",t),l(e)):(h=c.__cssModules)&&(h=h[t])?h:n!==r["b"]&&Object(r["j"])(n,t)?(a[t]=3,n[t]):(f=u.config.globalProperties,Object(r["j"])(f,t)?f[t]:void 0)},set({_:e},t,n){const{data:i,setupState:o,ctx:s}=e;if(o!==r["b"]&&Object(r["j"])(o,t))o[t]=n;else if(i!==r["b"]&&Object(r["j"])(i,t))i[t]=n;else if(Object(r["j"])(e.props,t))return!1;return("$"!==t[0]||!(t.slice(1)in e))&&(s[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:i,appContext:o,propsOptions:s}},a){let c;return void 0!==n[a]||e!==r["b"]&&Object(r["j"])(e,a)||t!==r["b"]&&Object(r["j"])(t,a)||(c=s[0])&&Object(r["j"])(c,a)||Object(r["j"])(i,a)||Object(r["j"])(Pr,a)||Object(r["j"])(o.config.globalProperties,a)}};const Lr=Object(r["h"])({},kr,{get(e,t){if(t!==Symbol.unscopables)return kr.get(e,t,e)},has(e,t){const n="_"!==t[0]&&!Object(r["o"])(t);return n}});const xr=Hn();let Ur=0;function Dr(e,t,n){const i=e.type,o=(t?t.appContext:e.appContext)||xr,s={uid:Ur++,vnode:e,type:i,parent:t,appContext:o,root:null,next:null,subTree:null,update:null,render:null,proxy:null,exposed:null,withProxy:null,effects:null,provides:t?t.provides:Object.create(o.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Nn(i,o),emitsOptions:lt(i,o),emit:null,emitted:null,propsDefaults:r["b"],inheritAttrs:i.inheritAttrs,ctx:r["b"],data:r["b"],props:r["b"],attrs:r["b"],slots:r["b"],refs:r["b"],setupState:r["b"],setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=t?t.root:s,s.emit=dt.bind(null,s),s}let jr=null;const Vr=()=>jr||ft,Br=e=>{jr=e};function Fr(e){return 4&e.vnode.shapeFlag}let Hr,Gr=!1;function Yr(e,t=!1){Gr=t;const{props:n,children:r}=e.vnode,i=Fr(e);bn(e,n,i,t),Vn(e,r);const o=i?qr(e,t):void 0;return Gr=!1,o}function qr(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,kr);const{setup:i}=n;if(i){const n=e.setupContext=i.length>1?$r(e):null;jr=e,v();const o=xe(i,e,0,[e.props,n]);if(y(),jr=null,Object(r["w"])(o)){if(t)return o.then(n=>{Kr(e,n,t)}).catch(t=>{De(t,e,0)});e.asyncDep=o}else Kr(e,o,t)}else Wr(e,t)}function Kr(e,t,n){Object(r["n"])(t)?e.render=t:Object(r["t"])(t)&&(e.setupState=Ae(t)),Wr(e,n)}function Wr(e,t,n){const i=e.type;if(!e.render){if(Hr&&!i.render){const t=i.template;if(t){0;const{isCustomElement:n,compilerOptions:o}=e.appContext.config,{delimiters:s,compilerOptions:a}=i,c=Object(r["h"])(Object(r["h"])({isCustomElement:n,delimiters:s},o),a);i.render=Hr(t,c)}}e.render=i.render||r["d"],e.render._rc&&(e.withProxy=new Proxy(e.ctx,Lr))}jr=e,v(),fn(e),y(),jr=null}function $r(e){const t=t=>{e.exposed=Ae(t)};return{attrs:e.attrs,slots:e.slots,emit:e.emit,expose:t}}function Jr(e,t=jr){t&&(t.effects||(t.effects=[])).push(e)}function zr(e){return Object(r["n"])(e)&&e.displayName||e.name}function Qr(e){return Object(r["n"])(e)&&"__vccOpts"in e}function Zr(e){const t=Le(e);return Jr(t.effect),t}function Xr(e,t,n){const i=arguments.length;return 2===i?Object(r["t"])(t)&&!Object(r["m"])(t)?vr(t)?Cr(e,null,[t]):Cr(e,t):Cr(e,null,t):(i>3?n=Array.prototype.slice.call(arguments,2):3===i&&vr(n)&&(n=[n]),Cr(e,t,n))}Symbol("");const ei="3.1.1",ti="http://www.w3.org/2000/svg",ni="undefined"!==typeof document?document:null;let ri,ii;const oi={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,r)=>{const i=t?ni.createElementNS(ti,e):ni.createElement(e,n?{is:n}:void 0);return"select"===e&&r&&null!=r.multiple&&i.setAttribute("multiple",r.multiple),i},createText:e=>ni.createTextNode(e),createComment:e=>ni.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>ni.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,n,r){const i=r?ii||(ii=ni.createElementNS(ti,"svg")):ri||(ri=ni.createElement("div"));i.innerHTML=e;const o=i.firstChild;let s=o,a=s;while(s)a=s,oi.insert(s,t,n),s=i.firstChild;return[o,a]}};function si(e,t,n){if(null==t&&(t=""),n)e.setAttribute("class",t);else{const n=e._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),e.className=t}}function ai(e,t,n){const i=e.style;if(n)if(Object(r["B"])(n)){if(t!==n){const t=i.display;i.cssText=n,"_vod"in e&&(i.display=t)}}else{for(const e in n)ui(i,e,n[e]);if(t&&!Object(r["B"])(t))for(const e in t)null==n[e]&&ui(i,e,"")}else e.removeAttribute("style")}const ci=/\s*!important$/;function ui(e,t,n){if(Object(r["m"])(n))n.forEach(n=>ui(e,t,n));else if(t.startsWith("--"))e.setProperty(t,n);else{const i=hi(e,t);ci.test(n)?e.setProperty(Object(r["k"])(i),n.replace(ci,""),"important"):e[i]=n}}const di=["Webkit","Moz","ms"],li={};function hi(e,t){const n=li[t];if(n)return n;let i=Object(r["e"])(t);if("filter"!==i&&i in e)return li[t]=i;i=Object(r["f"])(i);for(let r=0;r<di.length;r++){const n=di[r]+i;if(n in e)return li[t]=n}return t}const fi="http://www.w3.org/1999/xlink";function pi(e,t,n,i,o){if(i&&t.startsWith("xlink:"))null==n?e.removeAttributeNS(fi,t.slice(6,t.length)):e.setAttributeNS(fi,t,n);else{const i=Object(r["A"])(t);null==n||i&&!1===n?e.removeAttribute(t):e.setAttribute(t,i?"":n)}}function gi(e,t,n,r,i,o,s){if("innerHTML"===t||"textContent"===t)return r&&s(r,i,o),void(e[t]=null==n?"":n);if("value"===t&&"PROGRESS"!==e.tagName){e._value=n;const r=null==n?"":n;return e.value!==r&&(e.value=r),void(null==n&&e.removeAttribute(t))}if(""===n||null==n){const r=typeof e[t];if(""===n&&"boolean"===r)return void(e[t]=!0);if(null==n&&"string"===r)return e[t]="",void e.removeAttribute(t);if("number"===r)return e[t]=0,void e.removeAttribute(t)}try{e[t]=n}catch(a){0}}let mi=Date.now,vi=!1;if("undefined"!==typeof window){mi()>document.createEvent("Event").timeStamp&&(mi=()=>performance.now());const e=navigator.userAgent.match(/firefox\/(\d+)/i);vi=!!(e&&Number(e[1])<=53)}let _i=0;const yi=Promise.resolve(),Ei=()=>{_i=0},Ti=()=>_i||(yi.then(Ei),_i=mi());function Ci(e,t,n,r){e.addEventListener(t,n,r)}function Ri(e,t,n,r){e.removeEventListener(t,n,r)}function Si(e,t,n,r,i=null){const o=e._vei||(e._vei={}),s=o[t];if(r&&s)s.value=r;else{const[n,a]=Ii(t);if(r){const s=o[t]=Oi(r,i);Ci(e,n,s,a)}else s&&(Ri(e,n,s,a),o[t]=void 0)}}const bi=/(?:Once|Passive|Capture)$/;function Ii(e){let t;if(bi.test(e)){let n;t={};while(n=e.match(bi))e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[Object(r["k"])(e.slice(2)),t]}function Oi(e,t){const n=e=>{const r=e.timeStamp||mi();(vi||r>=n.attached-1)&&Ue(wi(e,n.value),t,5,[e])};return n.value=e,n.attached=Ti(),n}function wi(e,t){if(Object(r["m"])(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(e=>t=>!t._stopped&&e(t))}return t}const Ni=/^on[a-z]/,Ai=(e,t)=>"value"===t,Mi=(e,t,n,i,o=!1,s,a,c,u)=>{switch(t){case"class":si(e,i,o);break;case"style":ai(e,n,i);break;default:Object(r["u"])(t)?Object(r["s"])(t)||Si(e,t,n,i,a):Pi(e,t,i,o)?gi(e,t,i,s,a,c,u):("true-value"===t?e._trueValue=i:"false-value"===t&&(e._falseValue=i),pi(e,t,i,o));break}};function Pi(e,t,n,i){return i?"innerHTML"===t||!!(t in e&&Ni.test(t)&&Object(r["n"])(n)):"spellcheck"!==t&&"draggable"!==t&&("form"!==t&&(("list"!==t||"INPUT"!==e.tagName)&&(("type"!==t||"TEXTAREA"!==e.tagName)&&((!Ni.test(t)||!Object(r["B"])(n))&&t in e))))}const ki="transition",Li="animation",xi=(e,{slots:t})=>Xr(Ut,Vi(e),t);xi.displayName="Transition";const Ui={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Di=(xi.props=Object(r["h"])({},Ut.props,Ui),(e,t=[])=>{Object(r["m"])(e)?e.forEach(e=>e(...t)):e&&e(...t)}),ji=e=>!!e&&(Object(r["m"])(e)?e.some(e=>e.length>1):e.length>1);function Vi(e){const t={};for(const r in e)r in Ui||(t[r]=e[r]);if(!1===e.css)return t;const{name:n="v",type:i,duration:o,enterFromClass:s=n+"-enter-from",enterActiveClass:a=n+"-enter-active",enterToClass:c=n+"-enter-to",appearFromClass:u=s,appearActiveClass:d=a,appearToClass:l=c,leaveFromClass:h=n+"-leave-from",leaveActiveClass:f=n+"-leave-active",leaveToClass:p=n+"-leave-to"}=e,g=Bi(o),m=g&&g[0],v=g&&g[1],{onBeforeEnter:_,onEnter:y,onEnterCancelled:E,onLeave:T,onLeaveCancelled:C,onBeforeAppear:R=_,onAppear:S=y,onAppearCancelled:b=E}=t,I=(e,t,n)=>{Gi(e,t?l:c),Gi(e,t?d:a),n&&n()},O=(e,t)=>{Gi(e,p),Gi(e,f),t&&t()},w=e=>(t,n)=>{const r=e?S:y,o=()=>I(t,e,n);Di(r,[t,o]),Yi(()=>{Gi(t,e?u:s),Hi(t,e?l:c),ji(r)||Ki(t,i,m,o)})};return Object(r["h"])(t,{onBeforeEnter(e){Di(_,[e]),Hi(e,s),Hi(e,a)},onBeforeAppear(e){Di(R,[e]),Hi(e,u),Hi(e,d)},onEnter:w(!1),onAppear:w(!0),onLeave(e,t){const n=()=>O(e,t);Hi(e,h),zi(),Hi(e,f),Yi(()=>{Gi(e,h),Hi(e,p),ji(T)||Ki(e,i,v,n)}),Di(T,[e,n])},onEnterCancelled(e){I(e,!1),Di(E,[e])},onAppearCancelled(e){I(e,!0),Di(b,[e])},onLeaveCancelled(e){O(e),Di(C,[e])}})}function Bi(e){if(null==e)return null;if(Object(r["t"])(e))return[Fi(e.enter),Fi(e.leave)];{const t=Fi(e);return[t,t]}}function Fi(e){const t=Object(r["K"])(e);return t}function Hi(e,t){t.split(/\s+/).forEach(t=>t&&e.classList.add(t)),(e._vtc||(e._vtc=new Set)).add(t)}function Gi(e,t){t.split(/\s+/).forEach(t=>t&&e.classList.remove(t));const{_vtc:n}=e;n&&(n.delete(t),n.size||(e._vtc=void 0))}function Yi(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let qi=0;function Ki(e,t,n,r){const i=e._endId=++qi,o=()=>{i===e._endId&&r()};if(n)return setTimeout(o,n);const{type:s,timeout:a,propCount:c}=Wi(e,t);if(!s)return r();const u=s+"end";let d=0;const l=()=>{e.removeEventListener(u,h),o()},h=t=>{t.target===e&&++d>=c&&l()};setTimeout(()=>{d<c&&l()},a+1),e.addEventListener(u,h)}function Wi(e,t){const n=window.getComputedStyle(e),r=e=>(n[e]||"").split(", "),i=r(ki+"Delay"),o=r(ki+"Duration"),s=$i(i,o),a=r(Li+"Delay"),c=r(Li+"Duration"),u=$i(a,c);let d=null,l=0,h=0;t===ki?s>0&&(d=ki,l=s,h=o.length):t===Li?u>0&&(d=Li,l=u,h=c.length):(l=Math.max(s,u),d=l>0?s>u?ki:Li:null,h=d?d===ki?o.length:c.length:0);const f=d===ki&&/\b(transform|all)(,|$)/.test(n[ki+"Property"]);return{type:d,timeout:l,propCount:h,hasTransform:f}}function $i(e,t){while(e.length<t.length)e=e.concat(e);return Math.max(...t.map((t,n)=>Ji(t)+Ji(e[n])))}function Ji(e){return 1e3*Number(e.slice(0,-1).replace(",","."))}function zi(){return document.body.offsetHeight}new WeakMap,new WeakMap;const Qi=Object(r["h"])({patchProp:Mi,forcePatchProp:Ai},oi);let Zi;function Xi(){return Zi||(Zi=Jn(Qi))}const eo=(...e)=>{const t=Xi().createApp(...e);const{mount:n}=t;return t.mount=e=>{const i=to(e);if(!i)return;const o=t._component;Object(r["n"])(o)||o.render||o.template||(o.template=i.innerHTML),i.innerHTML="";const s=n(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),s},t};function to(e){if(Object(r["B"])(e)){const t=document.querySelector(e);return t}return e}},"7b0b":function(e,t,n){var r=n("1d80");e.exports=function(e){return Object(r(e))}},"7c73":function(e,t,n){var r,i=n("825a"),o=n("37e8"),s=n("7839"),a=n("d012"),c=n("1be4"),u=n("cc12"),d=n("f772"),l=">",h="<",f="prototype",p="script",g=d("IE_PROTO"),m=function(){},v=function(e){return h+p+l+e+h+"/"+p+l},_=function(e){e.write(v("")),e.close();var t=e.parentWindow.Object;return e=null,t},y=function(){var e,t=u("iframe"),n="java"+p+":";return t.style.display="none",c.appendChild(t),t.src=String(n),e=t.contentWindow.document,e.open(),e.write(v("document.F=Object")),e.close(),e.F},E=function(){try{r=document.domain&&new ActiveXObject("htmlfile")}catch(t){}E=r?_(r):y();var e=s.length;while(e--)delete E[f][s[e]];return E()};a[g]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(m[f]=i(e),n=new m,m[f]=null,n[g]=e):n=E(),void 0===t?n:o(n,t)}},"7dd0":function(e,t,n){"use strict";var r=n("23e7"),i=n("9ed3"),o=n("e163"),s=n("d2bb"),a=n("d44e"),c=n("9112"),u=n("6eeb"),d=n("b622"),l=n("c430"),h=n("3f8c"),f=n("ae93"),p=f.IteratorPrototype,g=f.BUGGY_SAFARI_ITERATORS,m=d("iterator"),v="keys",_="values",y="entries",E=function(){return this};e.exports=function(e,t,n,d,f,T,C){i(n,t,d);var R,S,b,I=function(e){if(e===f&&M)return M;if(!g&&e in N)return N[e];switch(e){case v:return function(){return new n(this,e)};case _:return function(){return new n(this,e)};case y:return function(){return new n(this,e)}}return function(){return new n(this)}},O=t+" Iterator",w=!1,N=e.prototype,A=N[m]||N["@@iterator"]||f&&N[f],M=!g&&A||I(f),P="Array"==t&&N.entries||A;if(P&&(R=o(P.call(new e)),p!==Object.prototype&&R.next&&(l||o(R)===p||(s?s(R,p):"function"!=typeof R[m]&&c(R,m,E)),a(R,O,!0,!0),l&&(h[O]=E))),f==_&&A&&A.name!==_&&(w=!0,M=function(){return A.call(this)}),l&&!C||N[m]===M||c(N,m,M),h[t]=M,f)if(S={values:I(_),keys:T?M:I(v),entries:I(y)},C)for(b in S)(g||w||!(b in N))&&u(N,b,S[b]);else r({target:t,proto:!0,forced:g||w},S);return S}},"7f9a":function(e,t,n){var r=n("da84"),i=n("8925"),o=r.WeakMap;e.exports="function"===typeof o&&/native code/.test(i(o))},"825a":function(e,t,n){var r=n("861d");e.exports=function(e){if(!r(e))throw TypeError(String(e)+" is not an object");return e}},"83ab":function(e,t,n){var r=n("d039");e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},8418:function(e,t,n){"use strict";var r=n("c04e"),i=n("9bf2"),o=n("5c6c");e.exports=function(e,t,n){var s=r(t);s in e?i.f(e,s,o(0,n)):e[s]=n}},"861d":function(e,t){e.exports=function(e){return"object"===typeof e?null!==e:"function"===typeof e}},8925:function(e,t,n){var r=n("c6cd"),i=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(e){return i.call(e)}),e.exports=r.inspectSource},"8aa5":function(e,t,n){"use strict";var r=n("6547").charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},"90e3":function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++n+r).toString(36)}},9112:function(e,t,n){var r=n("83ab"),i=n("9bf2"),o=n("5c6c");e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},9263:function(e,t,n){"use strict";var r=n("ad6d"),i=n("9f7f"),o=n("5692"),s=RegExp.prototype.exec,a=o("native-string-replace",String.prototype.replace),c=s,u=function(){var e=/a/,t=/b*/g;return s.call(e,"a"),s.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),d=i.UNSUPPORTED_Y||i.BROKEN_CARET,l=void 0!==/()??/.exec("")[1],h=u||l||d;h&&(c=function(e){var t,n,i,o,c=this,h=d&&c.sticky,f=r.call(c),p=c.source,g=0,m=e;return h&&(f=f.replace("y",""),-1===f.indexOf("g")&&(f+="g"),m=String(e).slice(c.lastIndex),c.lastIndex>0&&(!c.multiline||c.multiline&&"\n"!==e[c.lastIndex-1])&&(p="(?: "+p+")",m=" "+m,g++),n=new RegExp("^(?:"+p+")",f)),l&&(n=new RegExp("^"+p+"$(?!\\s)",f)),u&&(t=c.lastIndex),i=s.call(h?n:c,m),h?i?(i.input=i.input.slice(g),i[0]=i[0].slice(g),i.index=c.lastIndex,c.lastIndex+=i[0].length):c.lastIndex=0:u&&i&&(c.lastIndex=c.global?i.index+i[0].length:t),l&&i&&i.length>1&&a.call(i[0],n,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)})),i}),e.exports=c},"94ca":function(e,t,n){var r=n("d039"),i=/#|\.prototype\./,o=function(e,t){var n=a[s(e)];return n==u||n!=c&&("function"==typeof t?r(t):!!t)},s=o.normalize=function(e){return String(e).replace(i,".").toLowerCase()},a=o.data={},c=o.NATIVE="N",u=o.POLYFILL="P";e.exports=o},"96cf":function(e,t,n){var r=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(P){c=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof m?t:m,o=Object.create(i.prototype),s=new N(r||[]);return o._invoke=b(e,n,s),o}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(P){return{type:"throw",arg:P}}}e.wrap=u;var l="suspendedStart",h="suspendedYield",f="executing",p="completed",g={};function m(){}function v(){}function _(){}var y={};y[o]=function(){return this};var E=Object.getPrototypeOf,T=E&&E(E(A([])));T&&T!==n&&r.call(T,o)&&(y=T);var C=_.prototype=m.prototype=Object.create(y);function R(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(i,o,s,a){var c=d(e[i],e,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"===typeof l&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(l).then((function(e){u.value=e,s(u)}),(function(e){return n("throw",e,s,a)}))}a(c.arg)}var i;function o(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}this._invoke=o}function b(e,t,n){var r=l;return function(i,o){if(r===f)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw o;return M()}n.method=i,n.arg=o;while(1){var s=n.delegate;if(s){var a=I(s,n);if(a){if(a===g)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===l)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=f;var c=d(e,t,n);if("normal"===c.type){if(r=n.done?p:h,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=p,n.method="throw",n.arg=c.arg)}}}function I(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator["return"]&&(n.method="return",n.arg=t,I(e,n),"throw"===n.method))return g;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var i=d(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function A(e){if(e){var n=e[o];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function n(){while(++i<e.length)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}return{next:M}}function M(){return{value:t,done:!0}}return v.prototype=C.constructor=_,_.constructor=v,v.displayName=c(_,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,c(e,a,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},R(S.prototype),S.prototype[s]=function(){return this},e.AsyncIterator=S,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new S(u(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},R(C),c(C,a,"Generator"),C[o]=function(){return this},C.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){while(t.length){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=A,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(w),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=r.call(s,"catchLoc"),u=r.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;w(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}(e.exports);try{regeneratorRuntime=r}catch(i){Function("r","regeneratorRuntime = r")(r)}},"970b":function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}e.exports=n,e.exports["default"]=e.exports,e.exports.__esModule=!0},"99af":function(e,t,n){"use strict";var r=n("23e7"),i=n("d039"),o=n("e8b5"),s=n("861d"),a=n("7b0b"),c=n("50c4"),u=n("8418"),d=n("65f0"),l=n("1dde"),h=n("b622"),f=n("2d00"),p=h("isConcatSpreadable"),g=9007199254740991,m="Maximum allowed index exceeded",v=f>=51||!i((function(){var e=[];return e[p]=!1,e.concat()[0]!==e})),_=l("concat"),y=function(e){if(!s(e))return!1;var t=e[p];return void 0!==t?!!t:o(e)},E=!v||!_;r({target:"Array",proto:!0,forced:E},{concat:function(e){var t,n,r,i,o,s=a(this),l=d(s,0),h=0;for(t=-1,r=arguments.length;t<r;t++)if(o=-1===t?s:arguments[t],y(o)){if(i=c(o.length),h+i>g)throw TypeError(m);for(n=0;n<i;n++,h++)n in o&&u(l,h,o[n])}else{if(h>=g)throw TypeError(m);u(l,h++,o)}return l.length=h,l}})},"9bdd":function(e,t,n){var r=n("825a"),i=n("2a62");e.exports=function(e,t,n,o){try{return o?t(r(n)[0],n[1]):t(n)}catch(s){throw i(e),s}}},"9bf2":function(e,t,n){var r=n("83ab"),i=n("0cfb"),o=n("825a"),s=n("c04e"),a=Object.defineProperty;t.f=r?a:function(e,t,n){if(o(e),t=s(t,!0),o(n),i)try{return a(e,t,n)}catch(r){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},"9ed3":function(e,t,n){"use strict";var r=n("ae93").IteratorPrototype,i=n("7c73"),o=n("5c6c"),s=n("d44e"),a=n("3f8c"),c=function(){return this};e.exports=function(e,t,n){var u=t+" Iterator";return e.prototype=i(r,{next:o(1,n)}),s(e,u,!1,!0),a[u]=c,e}},"9f7f":function(e,t,n){"use strict";var r=n("d039");function i(e,t){return RegExp(e,t)}t.UNSUPPORTED_Y=r((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=r((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},"9ff4":function(e,t,n){"use strict";(function(e){function r(e,t){const n=Object.create(null),r=e.split(",");for(let i=0;i<r.length;i++)n[r[i]]=!0;return t?e=>!!n[e.toLowerCase()]:e=>!!n[e]}n.d(t,"a",(function(){return T})),n.d(t,"b",(function(){return E})),n.d(t,"c",(function(){return R})),n.d(t,"d",(function(){return C})),n.d(t,"e",(function(){return $})),n.d(t,"f",(function(){return Q})),n.d(t,"g",(function(){return te})),n.d(t,"h",(function(){return O})),n.d(t,"i",(function(){return X})),n.d(t,"j",(function(){return A})),n.d(t,"k",(function(){return z})),n.d(t,"l",(function(){return ee})),n.d(t,"m",(function(){return M})),n.d(t,"n",(function(){return x})),n.d(t,"o",(function(){return o})),n.d(t,"p",(function(){return g})),n.d(t,"q",(function(){return Y})),n.d(t,"r",(function(){return P})),n.d(t,"s",(function(){return I})),n.d(t,"t",(function(){return j})),n.d(t,"u",(function(){return b})),n.d(t,"v",(function(){return G})),n.d(t,"w",(function(){return V})),n.d(t,"x",(function(){return q})),n.d(t,"y",(function(){return m})),n.d(t,"z",(function(){return k})),n.d(t,"A",(function(){return a})),n.d(t,"B",(function(){return U})),n.d(t,"C",(function(){return D})),n.d(t,"D",(function(){return _})),n.d(t,"E",(function(){return y})),n.d(t,"F",(function(){return r})),n.d(t,"G",(function(){return h})),n.d(t,"H",(function(){return c})),n.d(t,"I",(function(){return w})),n.d(t,"J",(function(){return Z})),n.d(t,"K",(function(){return ne})),n.d(t,"L",(function(){return H}));const i="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt",o=r(i);const s="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",a=r(s);function c(e){if(M(e)){const t={};for(let n=0;n<e.length;n++){const r=e[n],i=c(U(r)?l(r):r);if(i)for(const e in i)t[e]=i[e]}return t}if(j(e))return e}const u=/;(?![^(]*\))/g,d=/:(.+)/;function l(e){const t={};return e.split(u).forEach(e=>{if(e){const n=e.split(d);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function h(e){let t="";if(U(e))t=e;else if(M(e))for(let n=0;n<e.length;n++){const r=h(e[n]);r&&(t+=r+" ")}else if(j(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const f="html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot",p="svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistanceLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,text,textPath,title,tspan,unknown,use,view",g=r(f),m=r(p);function v(e,t){if(e.length!==t.length)return!1;let n=!0;for(let r=0;n&&r<e.length;r++)n=_(e[r],t[r]);return n}function _(e,t){if(e===t)return!0;let n=L(e),r=L(t);if(n||r)return!(!n||!r)&&e.getTime()===t.getTime();if(n=M(e),r=M(t),n||r)return!(!n||!r)&&v(e,t);if(n=j(e),r=j(t),n||r){if(!n||!r)return!1;const i=Object.keys(e).length,o=Object.keys(t).length;if(i!==o)return!1;for(const n in e){const r=e.hasOwnProperty(n),i=t.hasOwnProperty(n);if(r&&!i||!r&&i||!_(e[n],t[n]))return!1}}return String(e)===String(t)}function y(e,t){return e.findIndex(e=>_(e,t))}const E={},T=[],C=()=>{},R=()=>!1,S=/^on[^a-z]/,b=e=>S.test(e),I=e=>e.startsWith("onUpdate:"),O=Object.assign,w=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},N=Object.prototype.hasOwnProperty,A=(e,t)=>N.call(e,t),M=Array.isArray,P=e=>"[object Map]"===F(e),k=e=>"[object Set]"===F(e),L=e=>e instanceof Date,x=e=>"function"===typeof e,U=e=>"string"===typeof e,D=e=>"symbol"===typeof e,j=e=>null!==e&&"object"===typeof e,V=e=>j(e)&&x(e.then)&&x(e.catch),B=Object.prototype.toString,F=e=>B.call(e),H=e=>F(e).slice(8,-1),G=e=>"[object Object]"===F(e),Y=e=>U(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,q=r(",key,ref,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),K=e=>{const t=Object.create(null);return n=>{const r=t[n];return r||(t[n]=e(n))}},W=/-(\w)/g,$=K(e=>e.replace(W,(e,t)=>t?t.toUpperCase():"")),J=/\B([A-Z])/g,z=K(e=>e.replace(J,"-$1").toLowerCase()),Q=K(e=>e.charAt(0).toUpperCase()+e.slice(1)),Z=K(e=>e?"on"+Q(e):""),X=(e,t)=>e!==t&&(e===e||t===t),ee=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},te=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},ne=e=>{const t=parseFloat(e);return isNaN(t)?e:t}}).call(this,n("c8ba"))},a15b:function(e,t,n){"use strict";var r=n("23e7"),i=n("44ad"),o=n("fc6a"),s=n("a640"),a=[].join,c=i!=Object,u=s("join",",");r({target:"Array",proto:!0,forced:c||!u},{join:function(e){return a.call(o(this),void 0===e?",":e)}})},a434:function(e,t,n){"use strict";var r=n("23e7"),i=n("23cb"),o=n("a691"),s=n("50c4"),a=n("7b0b"),c=n("65f0"),u=n("8418"),d=n("1dde"),l=d("splice"),h=Math.max,f=Math.min,p=9007199254740991,g="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!l},{splice:function(e,t){var n,r,d,l,m,v,_=a(this),y=s(_.length),E=i(e,y),T=arguments.length;if(0===T?n=r=0:1===T?(n=0,r=y-E):(n=T-2,r=f(h(o(t),0),y-E)),y+n-r>p)throw TypeError(g);for(d=c(_,r),l=0;l<r;l++)m=E+l,m in _&&u(d,l,_[m]);if(d.length=r,n<r){for(l=E;l<y-r;l++)m=l+r,v=l+n,m in _?_[v]=_[m]:delete _[v];for(l=y;l>y-r+n;l--)delete _[l-1]}else if(n>r)for(l=y-r;l>E;l--)m=l+r-1,v=l+n-1,m in _?_[v]=_[m]:delete _[v];for(l=0;l<n;l++)_[l+E]=arguments[l+2];return _.length=y-r+n,d}})},a4b4:function(e,t,n){var r=n("342f");e.exports=/web0s(?!.*chrome)/i.test(r)},a4d3:function(e,t,n){"use strict";var r=n("23e7"),i=n("da84"),o=n("d066"),s=n("c430"),a=n("83ab"),c=n("4930"),u=n("fdbf"),d=n("d039"),l=n("5135"),h=n("e8b5"),f=n("861d"),p=n("825a"),g=n("7b0b"),m=n("fc6a"),v=n("c04e"),_=n("5c6c"),y=n("7c73"),E=n("df75"),T=n("241c"),C=n("057f"),R=n("7418"),S=n("06cf"),b=n("9bf2"),I=n("d1e7"),O=n("9112"),w=n("6eeb"),N=n("5692"),A=n("f772"),M=n("d012"),P=n("90e3"),k=n("b622"),L=n("e538"),x=n("746f"),U=n("d44e"),D=n("69f3"),j=n("b727").forEach,V=A("hidden"),B="Symbol",F="prototype",H=k("toPrimitive"),G=D.set,Y=D.getterFor(B),q=Object[F],K=i.Symbol,W=o("JSON","stringify"),$=S.f,J=b.f,z=C.f,Q=I.f,Z=N("symbols"),X=N("op-symbols"),ee=N("string-to-symbol-registry"),te=N("symbol-to-string-registry"),ne=N("wks"),re=i.QObject,ie=!re||!re[F]||!re[F].findChild,oe=a&&d((function(){return 7!=y(J({},"a",{get:function(){return J(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=$(q,t);r&&delete q[t],J(e,t,n),r&&e!==q&&J(q,t,r)}:J,se=function(e,t){var n=Z[e]=y(K[F]);return G(n,{type:B,tag:e,description:t}),a||(n.description=t),n},ae=u?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof K},ce=function(e,t,n){e===q&&ce(X,t,n),p(e);var r=v(t,!0);return p(n),l(Z,r)?(n.enumerable?(l(e,V)&&e[V][r]&&(e[V][r]=!1),n=y(n,{enumerable:_(0,!1)})):(l(e,V)||J(e,V,_(1,{})),e[V][r]=!0),oe(e,r,n)):J(e,r,n)},ue=function(e,t){p(e);var n=m(t),r=E(n).concat(pe(n));return j(r,(function(t){a&&!le.call(n,t)||ce(e,t,n[t])})),e},de=function(e,t){return void 0===t?y(e):ue(y(e),t)},le=function(e){var t=v(e,!0),n=Q.call(this,t);return!(this===q&&l(Z,t)&&!l(X,t))&&(!(n||!l(this,t)||!l(Z,t)||l(this,V)&&this[V][t])||n)},he=function(e,t){var n=m(e),r=v(t,!0);if(n!==q||!l(Z,r)||l(X,r)){var i=$(n,r);return!i||!l(Z,r)||l(n,V)&&n[V][r]||(i.enumerable=!0),i}},fe=function(e){var t=z(m(e)),n=[];return j(t,(function(e){l(Z,e)||l(M,e)||n.push(e)})),n},pe=function(e){var t=e===q,n=z(t?X:m(e)),r=[];return j(n,(function(e){!l(Z,e)||t&&!l(q,e)||r.push(Z[e])})),r};if(c||(K=function(){if(this instanceof K)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=P(e),n=function(e){this===q&&n.call(X,e),l(this,V)&&l(this[V],t)&&(this[V][t]=!1),oe(this,t,_(1,e))};return a&&ie&&oe(q,t,{configurable:!0,set:n}),se(t,e)},w(K[F],"toString",(function(){return Y(this).tag})),w(K,"withoutSetter",(function(e){return se(P(e),e)})),I.f=le,b.f=ce,S.f=he,T.f=C.f=fe,R.f=pe,L.f=function(e){return se(k(e),e)},a&&(J(K[F],"description",{configurable:!0,get:function(){return Y(this).description}}),s||w(q,"propertyIsEnumerable",le,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!c,sham:!c},{Symbol:K}),j(E(ne),(function(e){x(e)})),r({target:B,stat:!0,forced:!c},{for:function(e){var t=String(e);if(l(ee,t))return ee[t];var n=K(t);return ee[t]=n,te[n]=t,n},keyFor:function(e){if(!ae(e))throw TypeError(e+" is not a symbol");if(l(te,e))return te[e]},useSetter:function(){ie=!0},useSimple:function(){ie=!1}}),r({target:"Object",stat:!0,forced:!c,sham:!a},{create:de,defineProperty:ce,defineProperties:ue,getOwnPropertyDescriptor:he}),r({target:"Object",stat:!0,forced:!c},{getOwnPropertyNames:fe,getOwnPropertySymbols:pe}),r({target:"Object",stat:!0,forced:d((function(){R.f(1)}))},{getOwnPropertySymbols:function(e){return R.f(g(e))}}),W){var ge=!c||d((function(){var e=K();return"[null]"!=W([e])||"{}"!=W({a:e})||"{}"!=W(Object(e))}));r({target:"JSON",stat:!0,forced:ge},{stringify:function(e,t,n){var r,i=[e],o=1;while(arguments.length>o)i.push(arguments[o++]);if(r=t,(f(t)||void 0!==e)&&!ae(e))return h(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!ae(t))return t}),i[1]=t,W.apply(null,i)}})}K[F][H]||O(K[F],H,K[F].valueOf),U(K,B),M[V]=!0},a630:function(e,t,n){var r=n("23e7"),i=n("4df4"),o=n("1c7e"),s=!o((function(e){Array.from(e)}));r({target:"Array",stat:!0,forced:s},{from:i})},a640:function(e,t,n){"use strict";var r=n("d039");e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){throw 1},1)}))}},a691:function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},a79d:function(e,t,n){"use strict";var r=n("23e7"),i=n("c430"),o=n("fea9"),s=n("d039"),a=n("d066"),c=n("4840"),u=n("cdf9"),d=n("6eeb"),l=!!o&&s((function(){o.prototype["finally"].call({then:function(){}},(function(){}))}));if(r({target:"Promise",proto:!0,real:!0,forced:l},{finally:function(e){var t=c(this,a("Promise")),n="function"==typeof e;return this.then(n?function(n){return u(t,e()).then((function(){return n}))}:e,n?function(n){return u(t,e()).then((function(){throw n}))}:e)}}),!i&&"function"==typeof o){var h=a("Promise").prototype["finally"];o.prototype["finally"]!==h&&d(o.prototype,"finally",h,{unsafe:!0})}},ab13:function(e,t,n){var r=n("b622"),i=r("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[i]=!1,"/./"[e](t)}catch(r){}}return!1}},abc5:function(e,t,n){"use strict";(function(e){function r(){return i().__VUE_DEVTOOLS_GLOBAL_HOOK__}function i(){return"undefined"!==typeof navigator?window:"undefined"!==typeof e?e:{}}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}))}).call(this,n("c8ba"))},ac1f:function(e,t,n){"use strict";var r=n("23e7"),i=n("9263");r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},ad6d:function(e,t,n){"use strict";var r=n("825a");e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},ae93:function(e,t,n){"use strict";var r,i,o,s=n("d039"),a=n("e163"),c=n("9112"),u=n("5135"),d=n("b622"),l=n("c430"),h=d("iterator"),f=!1,p=function(){return this};[].keys&&(o=[].keys(),"next"in o?(i=a(a(o)),i!==Object.prototype&&(r=i)):f=!0);var g=void 0==r||s((function(){var e={};return r[h].call(e)!==e}));g&&(r={}),l&&!g||u(r,h)||c(r,h,p),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:f}},b041:function(e,t,n){"use strict";var r=n("00ee"),i=n("f5df");e.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},b0c0:function(e,t,n){var r=n("83ab"),i=n("9bf2").f,o=Function.prototype,s=o.toString,a=/^\s*function ([^ (]*)/,c="name";r&&!(c in o)&&i(o,c,{configurable:!0,get:function(){try{return s.call(this).match(a)[1]}catch(e){return""}}})},b575:function(e,t,n){var r,i,o,s,a,c,u,d,l=n("da84"),h=n("06cf").f,f=n("2cf4").set,p=n("1cdc"),g=n("a4b4"),m=n("605d"),v=l.MutationObserver||l.WebKitMutationObserver,_=l.document,y=l.process,E=l.Promise,T=h(l,"queueMicrotask"),C=T&&T.value;C||(r=function(){var e,t;m&&(e=y.domain)&&e.exit();while(i){t=i.fn,i=i.next;try{t()}catch(n){throw i?s():o=void 0,n}}o=void 0,e&&e.enter()},p||m||g||!v||!_?E&&E.resolve?(u=E.resolve(void 0),u.constructor=E,d=u.then,s=function(){d.call(u,r)}):s=m?function(){y.nextTick(r)}:function(){f.call(l,r)}:(a=!0,c=_.createTextNode(""),new v(r).observe(c,{characterData:!0}),s=function(){c.data=a=!a})),e.exports=C||function(e){var t={fn:e,next:void 0};o&&(o.next=t),i||(i=t,s()),o=t}},b622:function(e,t,n){var r=n("da84"),i=n("5692"),o=n("5135"),s=n("90e3"),a=n("4930"),c=n("fdbf"),u=i("wks"),d=r.Symbol,l=c?d:d&&d.withoutSetter||s;e.exports=function(e){return o(u,e)&&(a||"string"==typeof u[e])||(a&&o(d,e)?u[e]=d[e]:u[e]=l("Symbol."+e)),u[e]}},b64b:function(e,t,n){var r=n("23e7"),i=n("7b0b"),o=n("df75"),s=n("d039"),a=s((function(){o(1)}));r({target:"Object",stat:!0,forced:a},{keys:function(e){return o(i(e))}})},b727:function(e,t,n){var r=n("0366"),i=n("44ad"),o=n("7b0b"),s=n("50c4"),a=n("65f0"),c=[].push,u=function(e){var t=1==e,n=2==e,u=3==e,d=4==e,l=6==e,h=7==e,f=5==e||l;return function(p,g,m,v){for(var _,y,E=o(p),T=i(E),C=r(g,m,3),R=s(T.length),S=0,b=v||a,I=t?b(p,R):n||h?b(p,0):void 0;R>S;S++)if((f||S in T)&&(_=T[S],y=C(_,S,E),e))if(t)I[S]=y;else if(y)switch(e){case 3:return!0;case 5:return _;case 6:return S;case 2:c.call(I,_)}else switch(e){case 4:return!1;case 7:c.call(I,_)}return l?-1:u||d?d:I}};e.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterOut:u(7)}},b774:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="devtools-plugin:setup"},c04e:function(e,t,n){var r=n("861d");e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},c430:function(e,t){e.exports=!1},c6b6:function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},c6cd:function(e,t,n){var r=n("da84"),i=n("ce4e"),o="__core-js_shared__",s=r[o]||i(o,{});e.exports=s},c8ba:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}e.exports=n},ca84:function(e,t,n){var r=n("5135"),i=n("fc6a"),o=n("4d64").indexOf,s=n("d012");e.exports=function(e,t){var n,a=i(e),c=0,u=[];for(n in a)!r(s,n)&&r(a,n)&&u.push(n);while(t.length>c)r(a,n=t[c++])&&(~o(u,n)||u.push(n));return u}},caad:function(e,t,n){"use strict";var r=n("23e7"),i=n("4d64").includes,o=n("44d2");r({target:"Array",proto:!0},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o("includes")},cc12:function(e,t,n){var r=n("da84"),i=n("861d"),o=r.document,s=i(o)&&i(o.createElement);e.exports=function(e){return s?o.createElement(e):{}}},cca6:function(e,t,n){var r=n("23e7"),i=n("60da");r({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},cdf9:function(e,t,n){var r=n("825a"),i=n("861d"),o=n("f069");e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e),s=n.resolve;return s(t),n.promise}},ce4e:function(e,t,n){var r=n("da84"),i=n("9112");e.exports=function(e,t){try{i(r,e,t)}catch(n){r[e]=t}return t}},d012:function(e,t){e.exports={}},d039:function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},d066:function(e,t,n){var r=n("428f"),i=n("da84"),o=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?o(r[e])||o(i[e]):r[e]&&r[e][t]||i[e]&&i[e][t]}},d1e7:function(e,t,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);t.f=o?function(e){var t=i(this,e);return!!t&&t.enumerable}:r},d28b:function(e,t,n){var r=n("746f");r("iterator")},d2bb:function(e,t,n){var r=n("825a"),i=n("3bbe");e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,e.call(n,[]),t=n instanceof Array}catch(o){}return function(n,o){return r(n),i(o),t?e.call(n,o):n.__proto__=o,n}}():void 0)},d3b7:function(e,t,n){var r=n("00ee"),i=n("6eeb"),o=n("b041");r||i(Object.prototype,"toString",o,{unsafe:!0})},d44e:function(e,t,n){var r=n("9bf2").f,i=n("5135"),o=n("b622"),s=o("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,s)&&r(e,s,{configurable:!0,value:t})}},d784:function(e,t,n){"use strict";n("ac1f");var r=n("6eeb"),i=n("9263"),o=n("d039"),s=n("b622"),a=n("9112"),c=s("species"),u=RegExp.prototype,d=!o((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),l=function(){return"$0"==="a".replace(/./,"$0")}(),h=s("replace"),f=function(){return!!/./[h]&&""===/./[h]("a","$0")}(),p=!o((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));e.exports=function(e,t,n,h){var g=s(e),m=!o((function(){var t={};return t[g]=function(){return 7},7!=""[e](t)})),v=m&&!o((function(){var t=!1,n=/a/;return"split"===e&&(n={},n.constructor={},n.constructor[c]=function(){return n},n.flags="",n[g]=/./[g]),n.exec=function(){return t=!0,null},n[g](""),!t}));if(!m||!v||"replace"===e&&(!d||!l||f)||"split"===e&&!p){var _=/./[g],y=n(g,""[e],(function(e,t,n,r,o){var s=t.exec;return s===i||s===u.exec?m&&!o?{done:!0,value:_.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}),{REPLACE_KEEPS_$0:l,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:f}),E=y[0],T=y[1];r(String.prototype,e,E),r(u,g,2==t?function(e,t){return T.call(e,this,t)}:function(e){return T.call(e,this)})}h&&a(u[g],"sham",!0)}},d81d:function(e,t,n){"use strict";var r=n("23e7"),i=n("b727").map,o=n("1dde"),s=o("map");r({target:"Array",proto:!0,forced:!s},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},da84:function(e,t,n){(function(t){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||function(){return this}()||Function("return this")()}).call(this,n("c8ba"))},ddb0:function(e,t,n){var r=n("da84"),i=n("fdbc"),o=n("e260"),s=n("9112"),a=n("b622"),c=a("iterator"),u=a("toStringTag"),d=o.values;for(var l in i){var h=r[l],f=h&&h.prototype;if(f){if(f[c]!==d)try{s(f,c,d)}catch(g){f[c]=d}if(f[u]||s(f,u,l),i[l])for(var p in o)if(f[p]!==o[p])try{s(f,p,o[p])}catch(g){f[p]=o[p]}}}},df75:function(e,t,n){var r=n("ca84"),i=n("7839");e.exports=Object.keys||function(e){return r(e,i)}},df7c:function(e,t,n){(function(e){function n(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function r(e){"string"!==typeof e&&(e+="");var t,n=0,r=-1,i=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!i){n=t+1;break}}else-1===r&&(i=!1,r=t+1);return-1===r?"":e.slice(n,r)}function i(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}t.resolve=function(){for(var t="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var s=o>=0?arguments[o]:e.cwd();if("string"!==typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(t=s+"/"+t,r="/"===s.charAt(0))}return t=n(i(t.split("/"),(function(e){return!!e})),!r).join("/"),(r?"/":"")+t||"."},t.normalize=function(e){var r=t.isAbsolute(e),s="/"===o(e,-1);return e=n(i(e.split("/"),(function(e){return!!e})),!r).join("/"),e||r||(e="."),e&&s&&(e+="/"),(r?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(i(e,(function(e,t){if("string"!==typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,n){function r(e){for(var t=0;t<e.length;t++)if(""!==e[t])break;for(var n=e.length-1;n>=0;n--)if(""!==e[n])break;return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var i=r(e.split("/")),o=r(n.split("/")),s=Math.min(i.length,o.length),a=s,c=0;c<s;c++)if(i[c]!==o[c]){a=c;break}var u=[];for(c=a;c<i.length;c++)u.push("..");return u=u.concat(o.slice(a)),u.join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!==typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,r=-1,i=!0,o=e.length-1;o>=1;--o)if(t=e.charCodeAt(o),47===t){if(!i){r=o;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":e.slice(0,r)},t.basename=function(e,t){var n=r(e);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){"string"!==typeof e&&(e+="");for(var t=-1,n=0,r=-1,i=!0,o=0,s=e.length-1;s>=0;--s){var a=e.charCodeAt(s);if(47!==a)-1===r&&(i=!1,r=s+1),46===a?-1===t?t=s:1!==o&&(o=1):-1!==t&&(o=-1);else if(!i){n=s+1;break}}return-1===t||-1===r||0===o||1===o&&t===r-1&&t===n+1?"":e.slice(t,r)};var o="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,n("4362"))},e01a:function(e,t,n){"use strict";var r=n("23e7"),i=n("83ab"),o=n("da84"),s=n("5135"),a=n("861d"),c=n("9bf2").f,u=n("e893"),d=o.Symbol;if(i&&"function"==typeof d&&(!("description"in d.prototype)||void 0!==d().description)){var l={},h=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof h?new d(e):void 0===e?d():d(e);return""===e&&(l[t]=!0),t};u(h,d);var f=h.prototype=d.prototype;f.constructor=h;var p=f.toString,g="Symbol(test)"==String(d("test")),m=/^Symbol\((.*)\)[^)]+$/;c(f,"description",{configurable:!0,get:function(){var e=a(this)?this.valueOf():this,t=p.call(e);if(s(l,e))return"";var n=g?t.slice(7,-1):t.replace(m,"$1");return""===n?void 0:n}}),r({global:!0,forced:!0},{Symbol:h})}},e163:function(e,t,n){var r=n("5135"),i=n("7b0b"),o=n("f772"),s=n("e177"),a=o("IE_PROTO"),c=Object.prototype;e.exports=s?Object.getPrototypeOf:function(e){return e=i(e),r(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?c:null}},e177:function(e,t,n){var r=n("d039");e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},e260:function(e,t,n){"use strict";var r=n("fc6a"),i=n("44d2"),o=n("3f8c"),s=n("69f3"),a=n("7dd0"),c="Array Iterator",u=s.set,d=s.getterFor(c);e.exports=a(Array,"Array",(function(e,t){u(this,{type:c,target:r(e),index:0,kind:t})}),(function(){var e=d(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},e2cc:function(e,t,n){var r=n("6eeb");e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},e538:function(e,t,n){var r=n("b622");t.f=r},e667:function(e,t){e.exports=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}}},e6cf:function(e,t,n){"use strict";var r,i,o,s,a=n("23e7"),c=n("c430"),u=n("da84"),d=n("d066"),l=n("fea9"),h=n("6eeb"),f=n("e2cc"),p=n("d2bb"),g=n("d44e"),m=n("2626"),v=n("861d"),_=n("1c0b"),y=n("19aa"),E=n("8925"),T=n("2266"),C=n("1c7e"),R=n("4840"),S=n("2cf4").set,b=n("b575"),I=n("cdf9"),O=n("44de"),w=n("f069"),N=n("e667"),A=n("69f3"),M=n("94ca"),P=n("b622"),k=n("6069"),L=n("605d"),x=n("2d00"),U=P("species"),D="Promise",j=A.get,V=A.set,B=A.getterFor(D),F=l&&l.prototype,H=l,G=F,Y=u.TypeError,q=u.document,K=u.process,W=w.f,$=W,J=!!(q&&q.createEvent&&u.dispatchEvent),z="function"==typeof PromiseRejectionEvent,Q="unhandledrejection",Z="rejectionhandled",X=0,ee=1,te=2,ne=1,re=2,ie=!1,oe=M(D,(function(){var e=E(H)!==String(H);if(!e&&66===x)return!0;if(c&&!G["finally"])return!0;if(x>=51&&/native code/.test(H))return!1;var t=new H((function(e){e(1)})),n=function(e){e((function(){}),(function(){}))},r=t.constructor={};return r[U]=n,ie=t.then((function(){}))instanceof n,!ie||!e&&k&&!z})),se=oe||!C((function(e){H.all(e)["catch"]((function(){}))})),ae=function(e){var t;return!(!v(e)||"function"!=typeof(t=e.then))&&t},ce=function(e,t){if(!e.notified){e.notified=!0;var n=e.reactions;b((function(){var r=e.value,i=e.state==ee,o=0;while(n.length>o){var s,a,c,u=n[o++],d=i?u.ok:u.fail,l=u.resolve,h=u.reject,f=u.domain;try{d?(i||(e.rejection===re&&he(e),e.rejection=ne),!0===d?s=r:(f&&f.enter(),s=d(r),f&&(f.exit(),c=!0)),s===u.promise?h(Y("Promise-chain cycle")):(a=ae(s))?a.call(s,l,h):l(s)):h(r)}catch(p){f&&!c&&f.exit(),h(p)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&de(e)}))}},ue=function(e,t,n){var r,i;J?(r=q.createEvent("Event"),r.promise=t,r.reason=n,r.initEvent(e,!1,!0),u.dispatchEvent(r)):r={promise:t,reason:n},!z&&(i=u["on"+e])?i(r):e===Q&&O("Unhandled promise rejection",n)},de=function(e){S.call(u,(function(){var t,n=e.facade,r=e.value,i=le(e);if(i&&(t=N((function(){L?K.emit("unhandledRejection",r,n):ue(Q,n,r)})),e.rejection=L||le(e)?re:ne,t.error))throw t.value}))},le=function(e){return e.rejection!==ne&&!e.parent},he=function(e){S.call(u,(function(){var t=e.facade;L?K.emit("rejectionHandled",t):ue(Z,t,e.value)}))},fe=function(e,t,n){return function(r){e(t,r,n)}},pe=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=te,ce(e,!0))},ge=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw Y("Promise can't be resolved itself");var r=ae(t);r?b((function(){var n={done:!1};try{r.call(t,fe(ge,n,e),fe(pe,n,e))}catch(i){pe(n,i,e)}})):(e.value=t,e.state=ee,ce(e,!1))}catch(i){pe({done:!1},i,e)}}};if(oe&&(H=function(e){y(this,H,D),_(e),r.call(this);var t=j(this);try{e(fe(ge,t),fe(pe,t))}catch(n){pe(t,n)}},G=H.prototype,r=function(e){V(this,{type:D,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:X,value:void 0})},r.prototype=f(G,{then:function(e,t){var n=B(this),r=W(R(this,H));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=L?K.domain:void 0,n.parent=!0,n.reactions.push(r),n.state!=X&&ce(n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r,t=j(e);this.promise=e,this.resolve=fe(ge,t),this.reject=fe(pe,t)},w.f=W=function(e){return e===H||e===o?new i(e):$(e)},!c&&"function"==typeof l&&F!==Object.prototype)){s=F.then,ie||(h(F,"then",(function(e,t){var n=this;return new H((function(e,t){s.call(n,e,t)})).then(e,t)}),{unsafe:!0}),h(F,"catch",G["catch"],{unsafe:!0}));try{delete F.constructor}catch(me){}p&&p(F,G)}a({global:!0,wrap:!0,forced:oe},{Promise:H}),g(H,D,!1,!0),m(D),o=d(D),a({target:D,stat:!0,forced:oe},{reject:function(e){var t=W(this);return t.reject.call(void 0,e),t.promise}}),a({target:D,stat:!0,forced:c||oe},{resolve:function(e){return I(c&&this===o?H:this,e)}}),a({target:D,stat:!0,forced:se},{all:function(e){var t=this,n=W(t),r=n.resolve,i=n.reject,o=N((function(){var n=_(t.resolve),o=[],s=0,a=1;T(e,(function(e){var c=s++,u=!1;o.push(void 0),a++,n.call(t,e).then((function(e){u||(u=!0,o[c]=e,--a||r(o))}),i)})),--a||r(o)}));return o.error&&i(o.value),n.promise},race:function(e){var t=this,n=W(t),r=n.reject,i=N((function(){var i=_(t.resolve);T(e,(function(e){i.call(t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}})},e893:function(e,t,n){var r=n("5135"),i=n("56ef"),o=n("06cf"),s=n("9bf2");e.exports=function(e,t){for(var n=i(t),a=s.f,c=o.f,u=0;u<n.length;u++){var d=n[u];r(e,d)||a(e,d,c(t,d))}}},e8b5:function(e,t,n){var r=n("c6b6");e.exports=Array.isArray||function(e){return"Array"==r(e)}},e95a:function(e,t,n){var r=n("b622"),i=n("3f8c"),o=r("iterator"),s=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||s[o]===e)}},ed6d:function(e,t,n){var r=n("4a4b");function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}e.exports=i,e.exports["default"]=e.exports,e.exports.__esModule=!0},f069:function(e,t,n){"use strict";var r=n("1c0b"),i=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)};e.exports.f=function(e){return new i(e)}},f5df:function(e,t,n){var r=n("00ee"),i=n("c6b6"),o=n("b622"),s=o("toStringTag"),a="Arguments"==i(function(){return arguments}()),c=function(e,t){try{return e[t]}catch(n){}};e.exports=r?i:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=c(t=Object(e),s))?n:a?i(t):"Object"==(r=i(t))&&"function"==typeof t.callee?"Arguments":r}},f772:function(e,t,n){var r=n("5692"),i=n("90e3"),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},fb6a:function(e,t,n){"use strict";var r=n("23e7"),i=n("861d"),o=n("e8b5"),s=n("23cb"),a=n("50c4"),c=n("fc6a"),u=n("8418"),d=n("b622"),l=n("1dde"),h=l("slice"),f=d("species"),p=[].slice,g=Math.max;r({target:"Array",proto:!0,forced:!h},{slice:function(e,t){var n,r,d,l=c(this),h=a(l.length),m=s(e,h),v=s(void 0===t?h:t,h);if(o(l)&&(n=l.constructor,"function"!=typeof n||n!==Array&&!o(n.prototype)?i(n)&&(n=n[f],null===n&&(n=void 0)):n=void 0,n===Array||void 0===n))return p.call(l,m,v);for(r=new(void 0===n?Array:n)(g(v-m,0)),d=0;m<v;m++,d++)m in l&&u(r,d,l[m]);return r.length=d,r}})},fc6a:function(e,t,n){var r=n("44ad"),i=n("1d80");e.exports=function(e){return r(i(e))}},fdbc:function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(e,t,n){var r=n("4930");e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},fea9:function(e,t,n){var r=n("da84");e.exports=r.Promise}}]);
//# sourceMappingURL=chunk-vendors.0c8dfb59.js.map